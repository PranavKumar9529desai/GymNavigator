# app/(auth)/auth.config.ts

```ts
import type { AdapterUser } from '@auth/core/adapters';
import type { Profile } from '@auth/core/types';
import type { Account, NextAuthConfig, User } from 'next-auth';
import Credentials from 'next-auth/providers/credentials';
import GitHub from 'next-auth/providers/github';
import Google from 'next-auth/providers/google';

import SignupSA from '@/app/(common)/_actions/auth/signup-with-credentials';
import { getUserByEmail } from '../(common)/_actions/auth/get-userinfo';
import { getGoogleSignupRole } from '../(common)/_actions/auth/google-role-server-action';
import SigninSA from '../(common)/_actions/auth/signin-with-credentials';
import { checkUserExists } from '..//(common)/_actions/auth/check-user-exists';
import SigninGoogleSA from '..//(common)/_actions/auth/signin-with-google';
import SignupWithGoogle from '..//(common)/_actions/auth/signup-with-google';
import type { GymInfo, Rolestype } from '../types/next-auth';

// Import the relevant types from the auth client
import type {
  ApiResult,
  SigninResponseType,
  UserInfoResponse,
} from '@/lib/AxiosInstance/Signin/sign-in-client';
import type { RoleType } from '@/lib/AxiosInstance/Signup/sign-up-client';

// Extended User interface to include gymInfo property
interface ExtendedUser extends User {
  gymInfo?: GymInfo;
}

// Environment configuration
const isProduction = process.env.NODE_ENV === 'production';

// Centralized logger that respects environment
const logger = {
  // biome-ignore lint/suspicious/noExplicitAny: Logger needs to accept any argument types
  log: (...args: any[]) => !isProduction && console.log(...args),
  // biome-ignore lint/suspicious/noExplicitAny: Logger needs to accept any argument types
  error: (...args: any[]) => console.error(...args),
};

// Centralized error handler
const createError = (message: string, errorCode: string) => {
  return new Error(JSON.stringify({ message, error: errorCode }));
};

// Auth handlers extracted for better organization
const authHandlers = {
  // Handle sign-in attempt
  async handleSignIn(email: string, password: string): Promise<User> {
    const userFromDB = await getUserByEmail(email);

    if (!userFromDB || !userFromDB.success) {
      throw createError('User not found', 'USER_NOT_FOUND');
    }

    const result = await SigninSA(email, password);

    if (!result.success || !result.data) {
      throw createError(
        result.error?.message || 'Failed to login',
        result.error?.code || 'LOGIN_FAILED',
      );
    }

    const userData = result.data;
    console.log('User data from signin handler', userData);

    return {
      id: userData.user.id,
      name: userData.user.name,
      email: userData.user.email,
      role: userData.user.role as Rolestype,
      gym: userData.user.gym
        ? {
            gym_name: userData.user.gym.name,
            id: String(userData.user.gym.id),
          }
        : undefined,
    };
  },

  // Handle sign-up attempt
  async handleSignUp(role: string, name: string, email: string, password: string): Promise<User> {
    console.log('signup handler is called');

    // Use the appropriate method from signup client instead
    const userExistsResult = await checkUserExists(email);
    if (userExistsResult.success && userExistsResult.data === true) {
      throw createError('User already exists', 'USER_EXISTS');
    }

    const signupResult = await SignupSA(role, name, email, password);

    // Check if the API call was successful and contains data
    if (!signupResult.success || !signupResult.data) {
      throw createError(
        signupResult.error?.message || 'Failed to create user',
        signupResult.error?.code || 'SIGNUP_FAILED',
      );
    }

    // Extract the user data from the API result
    const userData = signupResult.data;
    console.log('User data from signup handler:', userData);

    return {
      id: userData.id,
      name: userData.name,
      email: userData.email,
      role: role as Rolestype,
    };
  },
};

export default {
  secret: process.env.NEXTAUTH_SECRET,

  providers: [
    Credentials({
      credentials: {
        name: {},
        email: {},
        password: {},
        role: {},
      },
      async authorize(credentials): Promise<User | null> {
        if (!credentials?.email || !credentials?.password) {
          throw createError('Email and password are required', 'INVALID_CREDENTIALS');
        }

        const { email, password, name, role } = credentials as {
          email: string;
          password: string;
          name?: string;
          role?: string;
        };

        // Determine if this is sign-up or sign-in
        const isSignUp = Boolean(role && name);

        try {
          // Route to appropriate handler
          if (isSignUp && role && name) {
            return await authHandlers.handleSignUp(role, name, email, password);
          }
          return await authHandlers.handleSignIn(email, password);
        } catch (error) {
          logger.error('Authentication error:', error);
          throw error;
        }
      },
    }),

    Google({
      clientId: process.env.GOOGLE_CLIENT_ID,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET,
    }),
    GitHub,
  ],

  session: {
    strategy: 'jwt',
    maxAge: 30 * 24 * 60 * 60, // 30 days
    updateAge: 7 * 24 * 60 * 60, // 7 days
  },

  cookies: {
    sessionToken: {
      name: 'next-auth.session-token',
      options: {
        httpOnly: true,
        sameSite: 'lax',
        path: '/',
        secure: isProduction,
      },
    },
  },

  callbacks: {
    async redirect({ url, baseUrl }) {
      // First, handle relative URLs properly
      if (url.startsWith('/')) {
        // For relative URLs, check if they contain role parameter in the query string
        if (url.includes('?') && url.includes('role=')) {
          const [path, query] = url.split('?');
          const params = new URLSearchParams(query);
          const role = params.get('role');

          if (role) {
            params.delete('role');
            const newQuery = params.toString();
            return `${baseUrl}${path}${newQuery ? `?${newQuery}` : ''}`;
          }
        }
        // If no processing needed, return the URL joined with baseUrl
        return `${baseUrl}${url}`;
      }

      // For absolute URLs, we can use the URL constructor safely
      try {
        const urlObj = new URL(url);

        // Only process URLs from the same origin
        if (urlObj.origin === baseUrl) {
          const role = urlObj.searchParams.get('role');
          if (role) {
            urlObj.searchParams.delete('role');
            return urlObj.toString();
          }
        }

        // Default: if same origin, return the URL, otherwise return baseUrl
        return urlObj.origin === baseUrl ? url : baseUrl;
      } catch (error) {
        console.error('Error processing redirect URL:', error);
        return baseUrl;
      }
    },

    async signIn(params: {
      user: User | AdapterUser;
      account: Account | null;
      profile?: Profile;
      email?: { verificationRequest?: boolean };
      credentials?: Record<string, unknown>;
    }) {
      const { user, account, profile } = params;
      console.log('user is received from the signin callback', user);

      // Only process special cases (like Google)
      if (!account || account.provider !== 'google' || !user?.email) {
        return true;
      }

      try {
        // Optimize by fetching user data only once for Google sign-in
        const userFromDb: ApiResult<UserInfoResponse> = await getUserByEmail(user.email);

        console.log('userFromDb is from the signin callback', userFromDb);

        // Handle the case where the user doesn't exist (needs signup)
        if (userFromDb.success && userFromDb.data && !userFromDb.data.exists) {
          console.log('New Google user, creating account');

          // Get name from profile or user object
          const userName = user.name || profile?.name || profile?.given_name || 'Google User';

          // Get the role from the cookie
          const selectedRole = await getGoogleSignupRole();

          // If no role was found in the cookie, redirect to role selection page
          if (!selectedRole) {
            // Return a URL to redirect to role selection
            return '/selectrole';
          }

          console.log('Signing up with Google:', {
            name: userName,
            email: user.email,
            role: selectedRole,
          });

          // Create a new user with Google signup
          const signupResult = await SignupWithGoogle(
            userName,
            user.email,
            selectedRole as RoleType,
          );

          console.log('Google signup result:', signupResult);

          if (!signupResult.success) {
            logger.error('Failed to create Google user:', signupResult.error);
            return false;
          }

          // After successful signup, proceed with signin
          const response = await SigninGoogleSA(user.email);

          if (response.success && response.data) {
            // Store the user data from the backend in the user object
            user.id = response.data.user.id;
            user.role = response.data.user.role as Rolestype;
            user.name = response.data.user.name;
            user.email = response.data.user.email;

            // Add custom properties for gym info
            (user as ExtendedUser).gymInfo = response.data.user.gym
              ? {
                  gym_name: response.data.user.gym.name,
                  id: String(response.data.user.gym.id),
                }
              : undefined;

            return true;
          }

          return false;
        }

        // Handle the case where the user exists
        if (userFromDb.success && userFromDb.data && userFromDb.data.exists) {
          const response: ApiResult<SigninResponseType> = await SigninGoogleSA(user.email);

          if (response.success && response.data) {
            // Store the user data from the backend in the user object
            user.id = response.data.user.id;
            user.role = response.data.user.role as Rolestype;
            user.name = response.data.user.name;
            user.email = response.data.user.email;

            // Add custom properties for gym info
            (user as ExtendedUser).gymInfo = response.data.user.gym
              ? {
                  gym_name: response.data.user.gym.name,
                  id: String(response.data.user.gym.id),
                }
              : undefined;

            return true;
          }

          return false;
        }

        // Handle other error cases
        logger.error('User lookup failed:', userFromDb.error);
        return false;
      } catch (error) {
        logger.error('Google sign-in error:', error);
        return false;
      }
    },

    async jwt({ token, user, trigger, session }) {
      // Add user data to token on first creation
      if (user) {
        token.role = user.role;
        token.id = user.id;
        token.sub = user.id; // Ensure sub is set to our database ID

        // Handle gym info from custom property for Google auth
        if ((user as ExtendedUser).gymInfo) {
          token.gym = (user as ExtendedUser).gymInfo;
        }
        // Regular credential flow
        else if (user.gym) {
          token.gym = {
            gym_name: user.gym.gym_name,
            id: String(user.gym.id),
          };
        }
      }

      // Handle session updates
      if (trigger === 'update' && session) {
        return { ...token, ...session };
      }
      return token;
    },

    async session({ session, token }) {
      if (token) {
        // Structure session according to the defined type
        session.user.id = token.sub as string;
        session.role = token.role as Rolestype;
        session.gym = token.gym as GymInfo;

        // Only attach access token if it exists
        if (token.accessToken) {
          session.accessToken = token.accessToken as string;
        }
      }
      return session;
    },
  },

  trustHost: true,
  pages: {
    signIn: '/signin',
    error: '/auth/error',
  },
  debug: !isProduction,
} satisfies NextAuthConfig;

```

# app/(auth)/auth.ts

```ts
import NextAuth from 'next-auth';
import authConfig from './auth.config';

export const { auth, handlers, signIn, signOut } = NextAuth({
  ...authConfig,
});

```

# app/(auth)/layout.tsx

```tsx
import GymDomImage from '@/app/assests/gymd.webp';
import type { Metadata } from 'next';
import Image from 'next/image';
import type React from 'react';

export const metadata: Metadata = {
  openGraph: {
    title: 'GymNavigator',
    description: 'Professional gym management solution',
    images: [
      {
        url: GymDomImage.src,
        width: 1200,
        height: 630,
        alt: 'GymNavigator Preview',
      },
    ],
    type: 'website',
  },
};

export default function AuthLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <main className="min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-900 via-black to-gray-950">
      {/* Centered Content */}
      <div className="min-h-screen md:flex flex-col items-center justify-center px-4 py-10">
        {/* Centered Logo with Name */}
        <div className="mb-10 flex flex-col items-center">
          <div className="relative h-16 w-16 mb-4">
            <Image
              src="/android-chrome-512x512.png"
              alt="GymNavigator Logo"
              fill
              priority
              className="object-contain"
            />
          </div>
          <h1 className="text-3xl font-extrabold tracking-tight text-white drop-shadow-sm">
            <span className="font-black">Gym</span>
            <span className="bg-gradient-to-r from-blue-400 to-blue-500 bg-clip-text text-transparent font-black">
              Navigator
            </span>
          </h1>
          <span className="text-white/45 text-sm py-1">Your Gym Manager</span>
        </div>

        {/* Auth Form */}
        <div className="w-full max-w-md relative z-10">{children}</div>
      </div>

      {/* Background effects */}
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        <div className="absolute w-[500px] h-[500px] rounded-full bg-blue-500/10 blur-3xl -top-[250px] -left-[250px]" />
        <div className="absolute w-[400px] h-[400px] rounded-full bg-indigo-500/10 blur-3xl -bottom-[200px] -right-[200px]" />
      </div>
    </main>
  );
}

```

# app/(auth)/signin/layout.tsx

```tsx
import type React from 'react';

export default function SignInLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return children;
}

```

# app/(auth)/signin/page.tsx

```tsx
import SignIn from '@/components/common/Signin';
import React from 'react';

export default async function Page() {
  return (
    <>
      <SignIn />
    </>
  );
}

```

# app/(auth)/signout/page.tsx

```tsx
import Signout from '@/components/common/Auth/Signout';

export default function SignoutPage() {
  return (
    <div className="flex items-center justify-center min-h-[400px]">
      <Signout />
    </div>
  );
}

```

# app/(auth)/signup/layout.tsx

```tsx
import type React from 'react';

export default function SignUpLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return children;
}

```

# app/(auth)/signup/page.tsx

```tsx
import SignUp from '@/components/common/Signup';
import React from 'react';

export default async function page() {
  return (
    <>
      <SignUp />
    </>
  );
}
// }

```

# app/(common)/_actions/auth/check-user-exists.ts

```ts
'use server';

import { type ApiResult, signupClient } from '@/lib/AxiosInstance/Signup/sign-up-client';

/**
 * Server action to check if a user email already exists in the system
 * @param email The email address to check
 * @returns Response indicating whether the email exists
 */
export async function checkUserExists(email: string): Promise<ApiResult<boolean>> {
  console.log('Checking if email exists:', email);
  return signupClient.checkUserExists(email);
}

```

# app/(common)/_actions/auth/get-userby-email.ts

```ts
'use server';
import axios, { type AxiosResponse } from 'axios';

interface MinimalGymInfo {
  id: string;
  gym_name: string;
}

export interface userType {
  id: string;
  name: string;
  email: string;
  password: string;
  role?: string;
  gym_id?: string;
  gym?: MinimalGymInfo;
}

interface LoginResponse {
  msg: string;
  user: {
    id: string;
    name: string;
    email: string;
    password: string;
    gym_id?: string;
    Gym?: MinimalGymInfo;
  };
  role?: string;
}

export default async function GetUserAndLogin(email: string): Promise<userType | false> {
  try {
    console.log('this is the response', process.env.NEXT_PUBLIC_BACKEND_URL);
    const response: AxiosResponse<LoginResponse> = await axios.post(
      `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/signup/isexist`,
      { email },
      {
        headers: { 'Content-Type': 'application/json' },
      },
    );

    const { user, role } = response.data;
    console.log('response from the backend isiexists', response.data);
    if (!user) return false;

    // Extract and format the gym data if it exists
    const gymData = user.Gym
      ? {
          id: user.Gym.id,
          gym_name: user.Gym.gym_name,
        }
      : undefined;

    console.log('user from the db from the getUserByEmail', gymData);
    const UserResponse: userType = {
      id: String(user.id), // Ensure id is always a string
      name: user.name,
      email: user.email,
      password: user.password,
      role: role,
      gym_id: user.gym_id,
      gym: gymData,
    };
    console.log('return from the getusermail', UserResponse);
    return UserResponse;
  } catch (error) {
    console.log('error getting user by email', error);
    return false;
  }
}

```

# app/(common)/_actions/auth/get-userinfo.ts

```ts
'use server';

import {
  type ApiResult,
  type UserInfoResponse,
  authClient,
} from '@/lib/AxiosInstance/Signin/sign-in-client';

/**
 * Server action to check if a user email exists in the system
 * @param email The email address to check
 * @returns Response indicating whether the email exsists and any associated role
 */
export async function getUserByEmail(email: string): Promise<ApiResult<UserInfoResponse>> {
  console.log('Checking email existence for:', email);
  return authClient.getUserInfo(email);
}

```

# app/(common)/_actions/auth/google-role-server-action.ts

```ts
'use server';

import type { Rolestype } from '@/app/types/next-auth';
import { cookies } from 'next/headers';

/**
 * Stores the selected role in a server-side cookie for Google sign-up flow
 */
export async function storeGoogleSignupRole(role: Rolestype): Promise<boolean> {
  try {
    // Set a cookie that will be available during Google callback
    (
      await // Set a cookie that will be available during Google callback
      cookies()
    ).set({
      name: 'google_signup_role',
      value: role,
      // Expires in 10 minutes - just enough time to complete the signup flow
      maxAge: 60 * 10,
      path: '/',
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
    });

    return true;
  } catch (error) {
    console.error('Error storing Google signup role:', error);
    return false;
  }
}

/**
 * Retrieves the selected role from server-side cookie
 */
export async function getGoogleSignupRole(): Promise<Rolestype | undefined> {
  try {
    const role = (await cookies()).get('google_signup_role')?.value as Rolestype | undefined;
    return role;
  } catch (error) {
    console.error('Error retrieving Google signup role:', error);
    return undefined;
  }
}

```

# app/(common)/_actions/auth/signin-with-credentials.ts

```ts
'use server';

import {
  type ApiResult,
  type SigninResponseType,
  authClient,
} from '@/lib/AxiosInstance/Signin/sign-in-client';

export default async function SigninSA(
  email: string,
  password: string,
): Promise<ApiResult<SigninResponseType>> {
  return authClient.signInWithCredentials(email, password);
}

```

# app/(common)/_actions/auth/signin-with-google.ts

```ts
'use server';

import {
  type ApiResult,
  type SigninResponseType,
  authClient,
} from '@/lib/AxiosInstance/Signin/sign-in-client';

export default async function SigninGoogleSA(
  email: string,
): Promise<ApiResult<SigninResponseType>> {
  console.log('Signing in with Google:', email);
  return authClient.signInWithGoogle(email);
}

```

# app/(common)/_actions/auth/signup-with-credentials.ts

```ts
'use server';

import {
  type ApiResult,
  type SignupResponseType,
  signupClient,
} from '@/lib/AxiosInstance/Signup/sign-up-client';

export default async function SignupSA(
  role: string,
  name: string,
  email: string,
  password: string,
): Promise<ApiResult<SignupResponseType>> {
  console.log('Signing up user with credentials:', { role, name, email });
  return signupClient.signupWithCredentials(role, name, email, password);
}

```

# app/(common)/_actions/auth/signup-with-google.ts

```ts
'use server';

import {
  type ApiResult,
  type GoogleSignupResponseType,
  type RoleType,
  signupClient,
} from '@/lib/AxiosInstance/Signup/sign-up-client';

export default async function SignupWithGoogle(
  name: string,
  email: string,
  role?: RoleType, // Make role optional
): Promise<ApiResult<GoogleSignupResponseType>> {
  console.log('Signing up with Google:', { name, email, role });
  return signupClient.signupWithGoogle(name, email, role as RoleType);
}

```

# app/(common)/_actions/clouldnary/UploadImageSA.ts

```ts
// actions/uploadImage.ts
import cloudinary from 'cloudinary';

cloudinary.v2.config({
  cloud_name: process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,
  api_key: process.env.NEXT_PUBLIC_CLOUDINARY_API_KEY,
  api_secret: process.env.CLOUDINARY_API_SECRET,
});

export default async function uploadImage(image: string) {
  try {
    const result = await cloudinary.v2.uploader.upload(image, {
      folder: 'gym',
    });
    return result.secure_url;
  } catch (error) {
    console.error('Error uploading image:', error);
    throw new Error('Failed to upload image');
  }
}

```

# app/(common)/_actions/session/updateSessionWithGym.ts

```ts
'use client';

export async function updateSesionWithGym(gym: gym, update: (data: unknown) => Promise<unknown>) {
  try {
    // Update the session using the passed update function
    const updateSession = await update({ gym: gym });
    // we will do a backend call pass down the role
    console.log('updated the sessiion with thes session with the gym is ', updateSession, gym);
    return { success: true };
  } catch (error) {
    console.error('Error updating session:', error);
    return { error: 'Failed to update session' };
  }
}

```

# app/(common)/_actions/session/updateSessionWithRole.ts

```ts
'use client';

export async function updateSessionWithRole(
  role: Rolestype,
  update: (data: unknown) => Promise<unknown>,
) {
  try {
    const newRole = role;
    // Update the session using the passed update function
    const updateSession = await update({ role: newRole });
    // we will do a backend call pass down the role
    console.log('updateSession is this ', updateSession);
    return { success: true };
  } catch (error) {
    console.error('Error updating session:', error);
    return { error: 'Failed to update session' };
  }
}

```

# app/(common)/selectgym/_actions/FetchallGyms.ts

```ts
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
export default async function FetchallGyms() {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get('availablegyms');
    const data = response.data.gyms as gym[];
    console.log('gyms data is from the fetchallgyms ', data);
    return data;
  } catch (error) {
    console.error('Error fetching gyms:', error);
    return [];
  }
}

```

# app/(common)/selectgym/_actions/VerifyAuthToken.ts

```ts
'use server';
import type { GymAtomType } from '@/app/state/Atoms/gymAtom';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { AxiosResponse } from 'axios';
interface responseType {
  success: boolean;
  msg: string;
}
export const VerifyAuthToken = async (gym: GymAtomType, authToken: string) => {
  try {
    const trainerAxios = await TrainerReqConfig();
    const response: AxiosResponse<responseType> = await trainerAxios.post('/authtokenverify', {
      gymname: gym.name,
      gymid: gym.id,
      authToken: authToken,
    });
    const data = {
      msg: response.data.msg,
      success: response.data.success,
    };
    console.log('data is this', data);
    return data;
  } catch (error) {
    console.error('Error verifying token:', error);
    return { success: false, msg: 'Error verifying token' };
  }
};

```

# app/(common)/selectgym/_components/SelectGym.tsx

```tsx
'use client';
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { Skeleton } from '@/components/ui/skeleton';
import { Building2, MapPin, Search } from 'lucide-react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import Swal from 'sweetalert2';

export interface gym {
  id: string;
  name: string;
  img: string;
}

const GymSkeleton = () => (
  <>
    {[1, 2, 3, 4].map((index) => (
      <div key={index} className="flex items-center p-4 bg-white rounded-xl border border-gray-100">
        {/* Skeleton Image */}
        <Skeleton className="w-16 h-16 rounded-lg flex-shrink-0" />

        {/* Skeleton Content */}
        <div className="ml-4 flex-grow">
          <Skeleton className="h-5 w-3/4 mb-2" />
          <div className="flex items-center space-x-4">
            <Skeleton className="h-4 w-20" />
            <Skeleton className="h-4 w-24" />
          </div>
        </div>
      </div>
    ))}
  </>
);

export default function SelectGym({ gyms }: { gyms: gym[] }) {
  const router = useRouter();
  const [isOpen, setIsOpen] = useState(true);
  const [, setSelectedGym] = useState<gym | null>(null);
  const [searchTerm, setSearchTerm] = useState('');
  const [, setIsGymSelected] = useState(false);
  // const setGymAtom = useSetRecoilState(GymAtom);
  const [isLoading, setIsLoading] = useState(true);
  const filteredGyms = gyms.filter((gym) =>
    gym.name.toLowerCase().includes(searchTerm.toLowerCase()),
  );

  useEffect(() => {
    // Simulate loading time or actual data fetching
    const timer = setTimeout(() => {
      setIsLoading(false);
    }, 1500);
    return () => clearTimeout(timer);
  }, []);

  const handleGymSelect = (gym: gym) => {
    setIsOpen(false);
    Swal.fire({
      title: 'Confirm Gym Selection',
      html: `
        <div class="p-4">
          <div class="mb-4">
            <img src="${gym.img}" alt="${gym.name}" class="w-24 h-24 mx-auto rounded-lg object-cover mb-3">
          </div>
          <p class="text-lg font-semibold text-gray-900">${gym.name}</p>
          <p class="text-sm text-gray-600 mt-2">Do you want to select this gym?</p>
        </div>
      `,
      icon: undefined,
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, Select',
      cancelButtonText: 'Cancel',
      customClass: {
        popup: 'rounded-xl',
        confirmButton: 'px-6 py-2.5 rounded-lg text-white font-medium',
        cancelButton: 'px-6 py-2.5 rounded-lg text-white font-medium',
      },
    }).then((result) => {
      if (result.isConfirmed) {
        setSelectedGym(gym);
        setIsGymSelected(true);
        router.push(`/selectgym/${gym.id}`);
      }
    });
  };

  return (
    <Dialog open={isOpen} onOpenChange={setIsOpen}>
      <DialogContent className="sm:max-w-[600px] p-0 overflow-hidden">
        <DialogHeader className="p-6 pb-0">
          <DialogTitle className="text-2xl font-bold text-center">Select Your Gym</DialogTitle>
        </DialogHeader>

        <div className="p-6">
          {/* Search Input with Icon */}
          <div className="relative mb-6">
            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5" />
            <Input
              type="text"
              placeholder="Search gyms..."
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
              className="pl-10 py-5 text-lg rounded-xl border-gray-200"
            />
          </div>

          {/* Gym List with Skeleton Loading */}
          <div className="space-y-3 max-h-[60vh] overflow-y-auto px-1 -mx-1">
            {isLoading ? (
              <GymSkeleton />
            ) : (
              <>
                {filteredGyms.map((gym) => (
                  <button
                    type="button"
                    key={gym.id}
                    onClick={() => handleGymSelect(gym)}
                    onKeyDown={(e) => {
                      if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        handleGymSelect(gym);
                      }
                    }}
                    className="w-full text-left flex items-center p-4 bg-white rounded-xl border border-gray-100 hover:border-blue-500 transition-all cursor-pointer shadow-sm hover:shadow-md"
                  >
                    {/* Gym Image */}
                    <div className="w-16 h-16 relative rounded-lg overflow-hidden flex-shrink-0">
                      <Image src={gym.img} alt={gym.name} fill className="object-cover" />
                    </div>

                    {/* Gym Details */}
                    <div className="ml-4 flex-grow">
                      <h3 className="font-semibold text-gray-900 text-lg mb-1">{gym.name}</h3>
                      <div className="flex items-center text-gray-500 text-sm">
                        <Building2 className="h-4 w-4 mr-1" />
                        <span>Branch</span>
                        <MapPin className="h-4 w-4 ml-3 mr-1" />
                        <span>Location</span>
                      </div>
                    </div>
                  </button>
                ))}

                {/* No Results Message */}
                {filteredGyms.length === 0 && (
                  <div className="text-center py-10 text-gray-500">
                    <Building2 className="h-12 w-12 mx-auto mb-3 opacity-50" />
                    <p>No gyms found matching your search.</p>
                  </div>
                )}
              </>
            )}
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}

```

# app/(common)/selectgym/[gymid]/_actions/fetch-gym-by-id.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { gym } from '../../_components/SelectGym';

/**
 * Fetches a gym by its ID using server actions
 */
export async function fetchGymById(gymId: string): Promise<gym | null> {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.get(`gym/${gymId}`);

    if (response.data.success) {
      return response.data.gym as gym;
    }

    console.error('Gym not found:', gymId);
    return null;
  } catch (error) {
    console.error('Error fetching gym details:', error);
    return null;
  }
}

```

# app/(common)/selectgym/[gymid]/_actions/verify-gym-token.ts

```ts
'use server';

import { VerifyAuthToken } from '../../_actions/VerifyAuthToken';
import type { gym } from '../../_components/SelectGym';

interface VerificationResult {
  success: boolean;
  message: string;
}

export async function verifyGymToken(gym: gym, authToken: string): Promise<VerificationResult> {
  try {
    const result = await VerifyAuthToken(gym, authToken);

    return {
      success: result.success,
      message: result.msg,
    };
  } catch (error) {
    console.error('Error in verifyGymToken:', error);
    return {
      success: false,
      message: 'Failed to verify authentication token',
    };
  }
}

```

# app/(common)/selectgym/[gymid]/_components/auth-token-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { useToast } from '@/hooks/use-toast';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import type { gym } from '../../_components/SelectGym';
import { verifyGymToken } from '../_actions/verify-gym-token';

interface AuthTokenFormProps {
  gym: gym;
}

export function AuthTokenForm({ gym }: AuthTokenFormProps) {
  const [authToken, setAuthToken] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const router = useRouter();
  const { toast } = useToast();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!authToken.trim()) {
      toast({
        title: 'Error',
        description: 'Authentication token is required',
        variant: 'destructive',
      });
      return;
    }

    setIsLoading(true);
    try {
      const result = await verifyGymToken(gym, authToken);

      if (result.success) {
        toast({
          title: 'Success',
          description: 'Authentication successful!',
        });
        // Redirect to the dashboard or another page
        router.push('/dashboard');
      } else {
        toast({
          title: 'Verification Failed',
          description: result.message || 'Invalid authentication token',
          variant: 'destructive',
        });
      }
    } catch (_error: unknown) {
      toast({
        title: 'Error',
        description: 'An error occurred during verification',
        variant: 'destructive',
      });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8">
      <div className="flex flex-col items-center mb-6">
        <div className="relative w-24 h-24 mb-4 rounded-lg overflow-hidden">
          <Image src={gym.img} alt={gym.name} fill className="object-cover" />
        </div>
        <h2 className="text-xl font-bold text-gray-900">{gym.name}</h2>
        <p className="text-sm text-gray-500 mt-1">Enter gym authentication token</p>
      </div>

      <form onSubmit={handleSubmit} className="space-y-6">
        <div className="space-y-2">
          <label htmlFor="authToken" className="block text-sm font-medium text-gray-700">
            Authentication Token
          </label>
          <Input
            id="authToken"
            type="text"
            value={authToken}
            onChange={(e) => setAuthToken(e.target.value)}
            placeholder="Enter your gym token"
            className="w-full py-5"
            required
            disabled={isLoading}
          />
        </div>

        <Button type="submit" className="w-full py-6 text-lg" disabled={isLoading}>
          {isLoading ? 'Verifying...' : 'Verify Token'}
        </Button>
      </form>
    </div>
  );
}

```

# app/(common)/selectgym/[gymid]/_components/auth-token-success.tsx

```tsx
'use client';

import { m } from 'framer-motion';
import { CheckCircle2, Loader2 } from 'lucide-react';
import Image from 'next/image';
import type { gym } from '../../_components/SelectGym';

interface AuthTokenSuccessProps {
  gym: gym;
  redirectingTo: string;
}

export function AuthTokenSuccess({ gym, redirectingTo }: AuthTokenSuccessProps) {
  return (
    <m.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="flex flex-col items-center justify-center p-6 text-center"
    >
      <div className="mb-6">
        <m.div
          initial={{ scale: 0 }}
          animate={{ scale: 1 }}
          transition={{ type: 'spring', stiffness: 200, damping: 15 }}
          className="bg-green-100 rounded-full p-3"
        >
          <CheckCircle2 className="h-12 w-12 text-green-600" />
        </m.div>
      </div>

      <div className="flex items-center space-x-4 mb-6">
        <div className="relative w-16 h-16 rounded-full overflow-hidden flex-shrink-0">
          <Image
            src={gym.img}
            alt={gym.name}
            layout="fill"
            objectFit="cover"
            className="rounded-full"
          />
        </div>
        <div>
          <h3 className="text-lg font-semibold text-gray-900">{gym.name}</h3>
          <p className="text-sm text-gray-500">Authentication successful</p>
        </div>
      </div>

      <div className="space-y-4">
        <h2 className="text-xl font-bold text-green-600">Token Verified!</h2>
        <p className="text-gray-600">Your gym connection has been successfully established.</p>

        <div className="flex items-center justify-center space-x-2 text-blue-600">
          <Loader2 className="h-4 w-4 animate-spin" />
          <span>Redirecting to {redirectingTo}...</span>
        </div>

        <div className="w-full bg-gray-200 h-1.5 rounded-full mt-4 overflow-hidden">
          <m.div
            className="h-full bg-blue-600 rounded-full"
            initial={{ width: '0%' }}
            animate={{ width: '100%' }}
            transition={{ duration: 1.5 }}
          />
        </div>
      </div>
    </m.div>
  );
}

```

# app/(common)/selectgym/[gymid]/AuthTokenSubmission.tsx

```tsx
'use client';
import { updateSesionWithGym } from '@/app/(common)/_actions/session/updateSessionWithGym';
import { Button } from '@/components/ui/button';
import { Dialog, DialogContent } from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { Skeleton } from '@/components/ui/skeleton';
import { useSession } from '@/node_modules/next-auth/react';
import { AnimatePresence, m } from 'framer-motion';
import { AlertCircle, CheckCircle2, Loader2, Shield } from 'lucide-react';
import dynamic from 'next/dynamic';
import Image from 'next/image';
import { useParams, useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import { VerifyAuthToken } from '../_actions/VerifyAuthToken';
import type { gym } from '../_components/SelectGym';
import { fetchGymById } from './_actions/fetch-gym-by-id';

// Dynamic import with no SSR
const AuthTokenWrong = dynamic(() => import('./AuthTokenWrong'), {
  ssr: false,
});

const AuthTokenSuccess = dynamic(
  () => import('./_components/auth-token-success').then((mod) => mod.AuthTokenSuccess),
  {
    ssr: false,
  },
);

// Update path - now referencing local _components folder correctly
// const GymAuthForm = dynamic(
//   () =>
//     import("./_components/auth-token-form").then((mod) => mod.AuthTokenForm),
//   {
//     loading: () => <GymFormSkeleton />,
//   }
// );

function GymFormSkeleton() {
  return (
    <div className="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8">
      <div className="flex flex-col items-center mb-6">
        <Skeleton className="w-24 h-24 rounded-lg mb-4" />
        <Skeleton className="h-6 w-40 mb-2" />
        <Skeleton className="h-4 w-56" />
      </div>
      <div className="space-y-6">
        <div className="space-y-2">
          <Skeleton className="h-5 w-40" />
          <Skeleton className="h-12 w-full" />
        </div>
        <Skeleton className="h-12 w-full" />
      </div>
    </div>
  );
}

export default function AuthTokenSubmission() {
  const { data: session, update } = useSession();
  console.log('session is ', session);
  const router = useRouter();
  const [authToken, setAuthToken] = useState('');
  const [loading, setLoading] = useState(false);
  const [isOpen, setIsOpen] = useState(true);
  const [step, setStep] = useState(1);
  const [error, setError] = useState('');
  const [isSuccess, setIsSuccess] = useState(false);
  const [showWrongToken, setShowWrongToken] = useState(false);
  const [gym, setGym] = useState<gym | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [showSuccess, setShowSuccess] = useState(false);
  const params = useParams();
  const gymId = params?.gymid as string;

  useEffect(() => {
    async function fetchGymData() {
      try {
        // Use server action instead of API route
        const gymData = await fetchGymById(gymId);

        if (gymData) {
          setGym(gymData);
        } else {
          setError('Gym not found');
        }
      } catch (err) {
        console.error('Error fetching gym:', err);
        setError('Failed to load gym details. Please try again.');
      } finally {
        setIsLoading(false);
      }
    }

    if (gymId) {
      fetchGymData();
    }
  }, [gymId]);

  if (error) {
    return (
      <div className="flex flex-col items-center justify-center p-8 text-center">
        <p className="text-red-500 mb-4">{error}</p>
        <button
          type="button"
          onClick={() => window.location.reload()}
          className="px-4 py-2 bg-blue-500 text-white rounded-md"
        >
          Retry
        </button>
      </div>
    );
  }

  if (isLoading || !gym) {
    return <GymFormSkeleton />;
  }

  const handleTokenChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value.toUpperCase(); // Convert to uppercase
    // Only allow letters and numbers, max 10 characters
    if (/^[A-Z0-9]*$/.test(value) && value.length <= 10) {
      setAuthToken(value);
      setError('');
    }
  };

  const handlePaste = (e: React.ClipboardEvent<HTMLInputElement>) => {
    e.preventDefault();
    const pastedText = e.clipboardData.getData('text').toUpperCase();
    if (pastedText.length <= 10 && /^[A-Z0-9]*$/.test(pastedText)) {
      setAuthToken(pastedText);
      setError('');
    } else {
      setError('Invalid token format');
    }
  };

  const handleSubmit = async () => {
    setLoading(true);
    setError('');

    try {
      const response = await VerifyAuthToken(gym, authToken);

      if (response.success) {
        setStep(2);
        setIsSuccess(true);
        await updateSesionWithGym(gym, update);

        // Show success component instead of immediate redirect
        setShowSuccess(true);

        // Delay redirect for animation
        setTimeout(() => {
          router.push('/dashboard/trainer');
        }, 2500);
      } else {
        setShowWrongToken(true); // Show wrong token component instead of error message
      }
    } catch (error) {
      console.error('Failed to verify token:', error);
      setShowWrongToken(true); // Show wrong token component on error
    } finally {
      setLoading(false);
    }
  };

  const handleRetry = () => {
    setShowWrongToken(false);
    setAuthToken('');
    setError('');
  };

  return (
    <Dialog open={isOpen} onOpenChange={setIsOpen}>
      <DialogContent className="sm:max-w-md p-0 overflow-hidden bg-white rounded-2xl">
        <AnimatePresence mode="wait">
          {showWrongToken ? (
            <AuthTokenWrong onRetry={handleRetry} />
          ) : showSuccess ? (
            <AuthTokenSuccess gym={gym} redirectingTo="Dashboard" />
          ) : (
            <m.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -20 }}
              className="p-6"
            >
              {/* Progress Indicator */}
              <div className="flex justify-center mb-6">
                <div className="flex items-center space-x-2">
                  <div
                    className={`h-2 w-2 rounded-full ${step === 1 ? 'bg-blue-600' : 'bg-gray-300'}`}
                  />
                  <div
                    className={`h-2 w-2 rounded-full ${step === 2 ? 'bg-blue-600' : 'bg-gray-300'}`}
                  />
                </div>
              </div>

              {/* Gym Info */}
              <div className="flex items-center space-x-4 mb-6">
                <div className="relative w-16 h-16 rounded-full overflow-hidden flex-shrink-0">
                  <Image
                    src={gym.img}
                    alt={gym.name}
                    layout="fill"
                    objectFit="cover"
                    className="rounded-full"
                  />
                </div>
                <div>
                  <h3 className="text-lg font-semibold text-gray-900">{gym.name}</h3>
                  <p className="text-sm text-gray-500">Enter authentication token</p>
                </div>
              </div>

              {/* Token Input */}
              <div className="space-y-6">
                <div className="flex justify-center">
                  <Shield className="h-12 w-12 text-blue-600" />
                </div>

                <div className="space-y-2">
                  <Input
                    type="text"
                    value={authToken}
                    onChange={handleTokenChange}
                    onPaste={handlePaste}
                    placeholder="Enter auth token (e.g., YSS59CTP37)"
                    className={`text-center text-xl tracking-[0.5em] h-14 font-mono ${
                      error ? 'border-red-500' : 'border-gray-200'
                    }`}
                    style={{ letterSpacing: '0.5em' }}
                    maxLength={10}
                    autoComplete="off"
                    spellCheck="false"
                  />

                  {error && (
                    <m.div
                      initial={{ opacity: 0 }}
                      animate={{ opacity: 1 }}
                      className="flex items-center justify-center text-red-500 text-sm mt-2"
                    >
                      <AlertCircle className="w-4 h-4 mr-1" />
                      {error}
                    </m.div>
                  )}

                  <p className="text-xs text-gray-500 text-center mt-2">
                    Token format: 10 characters, letters and numbers only
                  </p>
                </div>

                <Button
                  onClick={handleSubmit}
                  disabled={loading || authToken.length !== 10}
                  className={`w-full py-6 text-lg font-medium transition-all duration-200 ${
                    loading || authToken.length !== 10
                      ? 'bg-gray-100 text-gray-400'
                      : 'bg-blue-600 hover:bg-blue-700 text-white'
                  }`}
                >
                  {loading ? (
                    <Loader2 className="h-5 w-5 animate-spin" />
                  ) : isSuccess ? (
                    <CheckCircle2 className="h-5 w-5" />
                  ) : (
                    'Verify Token'
                  )}
                </Button>

                <p className="text-xs text-gray-500 text-center">
                  Contact the gym owner if you haven&apos;t received the token
                </p>
              </div>
            </m.div>
          )}
        </AnimatePresence>
      </DialogContent>
    </Dialog>
  );
}

```

# app/(common)/selectgym/[gymid]/AuthTokenWrong.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { m } from 'framer-motion';
import { ArrowLeft, RefreshCcw, XCircle } from 'lucide-react';
import { useRouter } from 'next/navigation';

interface AuthTokenWrongProps {
  onRetry: () => void;
}

const AuthTokenWrong = ({ onRetry }: AuthTokenWrongProps) => {
  const router = useRouter();

  return (
    <m.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="text-center p-6"
    >
      <div className="mb-6">
        <XCircle className="h-16 w-16 text-red-500 mx-auto" />
      </div>

      <h3 className="text-xl font-semibold text-gray-900 mb-3">Authentication Failed</h3>

      <p className="text-gray-600 mb-8">
        The authentication token you entered is incorrect. Please try again or select another gym.
      </p>

      <div className="space-y-3">
        <Button onClick={onRetry} className="w-full bg-blue-600 hover:bg-blue-700 text-white py-6">
          <RefreshCcw className="w-5 h-5 mr-2" />
          Try Again
        </Button>

        <Button
          onClick={() => router.push('/selectgym')}
          variant="outline"
          className="w-full border-gray-300 py-6"
        >
          <ArrowLeft className="w-5 h-5 mr-2" />
          Select Another Gym
        </Button>
      </div>
    </m.div>
  );
};

export default AuthTokenWrong;

```

# app/(common)/selectgym/[gymid]/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function Loading() {
  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
      <Skeleton className="h-8 w-64 mx-auto mb-8" />

      <div className="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8">
        <div className="flex flex-col items-center mb-6">
          <Skeleton className="w-24 h-24 rounded-lg mb-4" />
          <Skeleton className="h-6 w-40 mb-2" />
          <Skeleton className="h-4 w-56" />
        </div>
        <div className="space-y-6">
          <div className="space-y-2">
            <Skeleton className="h-5 w-40" />
            <Skeleton className="h-12 w-full" />
          </div>
          <Skeleton className="h-12 w-full" />
        </div>
      </div>
    </div>
  );
}

```

# app/(common)/selectgym/[gymid]/page.tsx

```tsx
import AuthTokenSubmission from './AuthTokenSubmission';

// Prevent static generation for this page
export const dynamic = 'force-dynamic';

export default async function GymPage({
  params,
}: {
  params: Promise<{ gymid: string }>;
}) {
  console.log('params', await params);
  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
      <h1 className="text-2xl font-bold text-center mb-8">Verify Gym Access</h1>
      <AuthTokenSubmission />
    </div>
  );
}

```

# app/(common)/selectgym/[gymid]/verifyauthtoken/_actions/verify-gym-token.ts

```ts
'use server';

import { VerifyAuthToken } from '@/app/(common)/selectgym/_actions/VerifyAuthToken';
import type { gym } from '@/app/(common)/selectgym/_components/SelectGym';

interface VerificationResult {
  success: boolean;
  message: string;
}

export async function verifyGymToken(gym: gym, authToken: string): Promise<VerificationResult> {
  // Convert gym object to format expected by VerifyAuthToken
  const gymAtom = {
    name: gym.name,
    id: gym.id,
    img: gym.img,
  };

  try {
    const result = await VerifyAuthToken(gymAtom, authToken);

    return {
      success: result.success,
      message: result.msg,
    };
  } catch (error) {
    console.error('Error in verifyGymToken:', error);
    return {
      success: false,
      message: 'Failed to verify authentication token',
    };
  }
}

```

# app/(common)/selectgym/[gymid]/verifyauthtoken/_components/auth-token-form.tsx

```tsx
'use client';

import type { gym } from '@/app/(common)/selectgym/_components/SelectGym';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { useToast } from '@/hooks/use-toast';
import { CheckCircle2, Loader2 } from 'lucide-react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import { verifyGymToken } from '../_actions/verify-gym-token';

interface AuthTokenFormProps {
  gym: gym;
}

export function AuthTokenForm({ gym }: AuthTokenFormProps) {
  const [authToken, setAuthToken] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [isRedirecting, setIsRedirecting] = useState(false);
  const router = useRouter();
  const { toast } = useToast();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!authToken.trim()) {
      toast({
        title: 'Error',
        description: 'Authentication token is required',
        variant: 'destructive',
      });
      return;
    }

    setIsLoading(true);
    try {
      const result = await verifyGymToken(gym, authToken);

      if (result.success) {
        setIsRedirecting(true);
        toast({
          title: 'Success',
          description: 'Authentication successful!',
        });

        // Add a slight delay before redirect to allow session update to complete
        setTimeout(() => {
          router.push('/dashboard');
        }, 2000);
      } else {
        toast({
          title: 'Verification Failed',
          description: result.message || 'Invalid authentication token',
          variant: 'destructive',
        });
      }
    } catch (error: unknown) {
      console.error('Error during verification:', error);
      toast({
        title: 'Error',
        description:
          error instanceof Error ? error.message : 'An error occurred during verification',
        variant: 'destructive',
      });
    } finally {
      if (!isRedirecting) {
        setIsLoading(false);
      }
    }
  };

  if (isRedirecting) {
    return (
      <div className="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8 text-center">
        <div className="flex flex-col items-center gap-6">
          <div className="bg-green-100 p-4 rounded-full">
            <CheckCircle2 className="h-12 w-12 text-green-600" />
          </div>

          <div className="space-y-2">
            <h2 className="text-xl font-semibold text-gray-900">Authentication Successful!</h2>
            <p className="text-gray-500">Redirecting to your dashboard...</p>
          </div>

          <div className="flex items-center justify-center w-full pt-4">
            <Loader2 className="h-6 w-6 animate-spin text-blue-600" />
            <span className="ml-2 text-sm text-gray-500">Setting up your session...</span>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8">
      <div className="flex flex-col items-center mb-6">
        <div className="relative w-24 h-24 mb-4 rounded-lg overflow-hidden">
          <Image src={gym.img} alt={gym.name} fill className="object-cover" />
        </div>
        <h2 className="text-xl font-bold text-gray-900">{gym.name}</h2>
        <p className="text-sm text-gray-500 mt-1">Enter gym authentication token</p>
      </div>

      <form onSubmit={handleSubmit} className="space-y-6">
        <div className="space-y-2">
          <label htmlFor="authToken" className="block text-sm font-medium text-gray-700">
            Authentication Token
          </label>
          <Input
            id="authToken"
            type="text"
            value={authToken}
            onChange={(e) => setAuthToken(e.target.value)}
            placeholder="Enter your gym token"
            className="w-full py-5"
            required
            disabled={isLoading}
          />
        </div>

        <Button type="submit" className="w-full py-6 text-lg" disabled={isLoading}>
          {isLoading ? (
            <>
              <Loader2 className="mr-2 h-4 w-4 animate-spin" />
              Verifying...
            </>
          ) : (
            'Verify Token'
          )}
        </Button>
      </form>
    </div>
  );
}

```

# app/(common)/selectgym/[gymid]/verifyauthtoken/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function Loading() {
  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
      <div className="w-full max-w-lg">
        <Skeleton className="h-8 w-64 mx-auto mb-8" />

        <div className="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8">
          <div className="flex flex-col items-center mb-6">
            <Skeleton className="w-24 h-24 rounded-lg mb-4" />
            <Skeleton className="h-6 w-40 mb-2" />
            <Skeleton className="h-4 w-56" />
          </div>

          <div className="space-y-6">
            <div className="space-y-2">
              <Skeleton className="h-5 w-40" />
              <Skeleton className="h-12 w-full" />
            </div>
            <Skeleton className="h-12 w-full" />
          </div>
        </div>
      </div>
    </div>
  );
}

```

# app/(common)/selectgym/[gymid]/verifyauthtoken/page.tsx

```tsx
import { notFound } from 'next/navigation';
import { fetchGymById } from '../../[gymid]/_actions/fetch-gym-by-id';
import { AuthTokenForm } from './_components/auth-token-form';

// Prevent static generation
export const dynamic = 'force-dynamic';

export default async function VerifyAuthTokenPage({
  params,
}: {
  params: Promise<{ id: string }>;
}) {
  const gym = await fetchGymById((await params).id);

  if (!gym) {
    notFound();
  }

  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
      <div className="w-full max-w-lg">
        <h1 className="text-2xl font-bold text-center mb-8">Verify Gym Access</h1>
        <AuthTokenForm gym={gym} />
      </div>
    </div>
  );
}

```

# app/(common)/selectgym/page.tsx

```tsx
import SelectGym from '@/app/(common)/selectgym/_components/SelectGym';
import React from 'react';
import FetchallGyms from './_actions/FetchallGyms';

// Prevent static generation
export const dynamic = 'force-dynamic';

export default async function Page() {
  const gyms: gym[] | [] = await FetchallGyms();
  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
      <h1 className="text-2xl font-bold mb-4">Select Your Gym</h1>
      <SelectGym gyms={gyms} />
    </div>
  );
}

```

# app/(common)/selectrole/page.tsx

```tsx
'use client';

import SelectRole from '@/components/common/SelectRole';

// Prevent static generation
export const dynamic = 'force-dynamic';

export default function SelectRolePage() {
  return (
    <div className="min-h-screen bg-gray-950 relative">
      <SelectRole />
    </div>
  );
}

```

# app/(home)/_component/AboutUs.tsx

```tsx
'use client';
import { BuildingOfficeIcon, SparklesIcon, UsersIcon } from '@heroicons/react/24/outline';
import { m } from 'framer-motion';

const AboutUs = () => {
  const features = [
    {
      icon: <BuildingOfficeIcon className="w-8 h-8" />,
      title: 'Modern Gym Management',
      description:
        'Revolutionizing how gyms operate with cutting-edge technology and seamless integration.',
    },
    {
      icon: <UsersIcon className="w-8 h-8" />,
      title: 'Member-Centric Approach',
      description: "Focusing on what matters most - your members' success and satisfaction.",
    },
    {
      icon: <SparklesIcon className="w-8 h-8" />,
      title: 'Innovation First',
      description:
        'Continuously evolving our platform to meet the changing needs of modern fitness facilities.',
    },
  ];

  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
        <m.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center mb-16"
        >
          <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
            About GymNavigator
          </h1>
          <p className="text-gray-300 text-lg max-w-3xl mx-auto">
            Transforming gym management through innovative technology and seamless experiences
          </p>
        </m.div>

        <div className="grid md:grid-cols-3 gap-8 mb-16">
          {features.map((feature, index) => (
            <m.div
              key={index as number}
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.2 }}
              className="bg-gray-800/50 backdrop-blur-lg rounded-xl p-6 border border-gray-700"
            >
              <div className="text-blue-400 mb-4">{feature.icon}</div>
              <h3 className="text-xl font-semibold text-white mb-2">{feature.title}</h3>
              <p className="text-gray-400">{feature.description}</p>
            </m.div>
          ))}
        </div>

        <m.div
          initial={{ opacity: 0 }}
          whileInView={{ opacity: 1 }}
          className="bg-gray-800/30 rounded-2xl p-8 border border-gray-700"
        >
          <div className="grid md:grid-cols-2 gap-12 items-center">
            <div>
              <h2 className="text-3xl font-bold text-white mb-4">Our Mission</h2>
              <p className="text-gray-300 leading-relaxed">
                At GymNavigator, we're committed to revolutionizing how gyms operate. Our platform
                brings together cutting-edge technology with user-friendly design to create the most
                efficient gym management solution available.
              </p>
            </div>
            <div className="grid grid-cols-2 gap-4">
              {[
                { number: '5+', label: 'Years Experience' },
                { number: '100+', label: 'Gyms' },
                { number: '10K+', label: 'Active Users' },
                { number: '98%', label: 'Satisfaction Rate' },
              ].map((stat, index) => (
                <m.div
                  key={index as number}
                  initial={{ opacity: 0, scale: 0.9 }}
                  whileInView={{ opacity: 1, scale: 1 }}
                  transition={{ delay: index * 0.1 }}
                  className="text-center p-4 bg-gray-800/50 rounded-lg border border-gray-700"
                >
                  <div className="text-2xl font-bold text-blue-400">{stat.number}</div>
                  <div className="text-sm text-gray-400">{stat.label}</div>
                </m.div>
              ))}
            </div>
          </div>
        </m.div>
      </div>
    </div>
  );
};

export default AboutUs;

```

# app/(home)/_component/AboutUs/AboutUs.tsx

```tsx
import { BuildingOfficeIcon, SparklesIcon, UsersIcon } from '@heroicons/react/24/outline';
import { ClientAnimatedFeature } from './ClientAnimatedFeature';
import { ClientAnimatedStats } from './ClientAnimatedStats';

const features = [
  {
    icon: <BuildingOfficeIcon className="w-8 h-8" />,
    title: 'Modern Gym Management',
    description:
      'Revolutionizing how gyms operate with cutting-edge technology and seamless integration.',
  },
  {
    icon: <UsersIcon className="w-8 h-8" />,
    title: 'Member-Centric Approach',
    description: "Focusing on what matters most - your members' success and satisfaction.",
  },
  {
    icon: <SparklesIcon className="w-8 h-8" />,
    title: 'Innovation First',
    description:
      'Continuously evolving our platform to meet the changing needs of modern fitness facilities.',
  },
];

const stats = [
  { number: '5+', label: 'Years Experience' },
  { number: '100+', label: 'Gyms' },
  { number: '10K+', label: 'Active Users' },
  { number: '98%', label: 'Satisfaction Rate' },
];

const AboutUs = () => {
  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
        <div className="text-center mb-16">
          <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
            About GymNavigator
          </h1>
          <p className="text-gray-300 text-lg max-w-3xl mx-auto">
            Transforming gym management through innovative technology and seamless experiences
          </p>
        </div>

        <div className="grid md:grid-cols-3 gap-8 mb-16">
          {features.map((feature, index) => (
            <ClientAnimatedFeature key={index as number} feature={feature} index={index} />
          ))}
        </div>

        <div className="bg-gray-800/30 rounded-2xl p-8 border border-gray-700">
          <div className="grid md:grid-cols-2 gap-12 items-center">
            <div>
              <h2 className="text-3xl font-bold text-white mb-4">Our Mission</h2>
              <p className="text-gray-300 leading-relaxed">
                At GymNavigator, we're committed to revolutionizing how gyms operate. Our platform
                brings together cutting-edge technology with user-friendly design to create the most
                efficient gym management solution available.
              </p>
            </div>
            <div className="grid grid-cols-2 gap-4">
              {stats.map((stat, index) => (
                <ClientAnimatedStats key={index as number} stat={stat} index={index} />
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default AboutUs;

```

# app/(home)/_component/AboutUs/ClientAnimatedFeature.tsx

```tsx
'use client';

import { m } from 'framer-motion';
import React from 'react';
import type { ReactNode } from 'react';

type FeatureProps = {
  feature: {
    icon: ReactNode;
    title: string;
    description: string;
  };
  index: number;
};

export const ClientAnimatedFeature = ({ feature, index }: FeatureProps) => {
  return (
    <m.div
      initial={{ opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      transition={{ delay: index * 0.2 }}
      className="bg-gray-800/50 backdrop-blur-lg rounded-xl p-6 border border-gray-700"
    >
      <div className="text-blue-400 mb-4">{feature.icon}</div>
      <h3 className="text-xl font-semibold text-white mb-2">{feature.title}</h3>
      <p className="text-gray-400">{feature.description}</p>
    </m.div>
  );
};

```

# app/(home)/_component/AboutUs/ClientAnimatedStats.tsx

```tsx
'use client';

import { m } from 'framer-motion';
import React from 'react';

type StatsProps = {
  stat: {
    number: string;
    label: string;
  };
  index: number;
};

export const ClientAnimatedStats = ({ stat, index }: StatsProps) => {
  return (
    <m.div
      initial={{ opacity: 0, scale: 0.9 }}
      whileInView={{ opacity: 1, scale: 1 }}
      transition={{ delay: index * 0.1 }}
      className="text-center p-4 bg-gray-800/50 rounded-lg border border-gray-700"
    >
      <div className="text-2xl font-bold text-blue-400">{stat.number}</div>
      <div className="text-sm text-gray-400">{stat.label}</div>
    </m.div>
  );
};

```

# app/(home)/_component/ContactUs.tsx

```tsx
'use client';
import { EnvelopeIcon, MapPinIcon, PhoneIcon } from '@heroicons/react/24/outline';
import { Box, Button, Container, TextField } from '@mui/material';
import { m } from 'framer-motion';
import type React from 'react';
import { useState } from 'react';

const ContactUs: React.FC = () => {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    subject: '',
    message: '',
  });

  const contactInfo = [
    {
      icon: <PhoneIcon className="w-6 h-6" />,
      title: 'Phone',
      detail: '+1 (555) 123-4567',
    },
    {
      icon: <EnvelopeIcon className="w-6 h-6" />,
      title: 'Email',
      detail: 'support@gymnavigator.com',
    },
    {
      icon: <MapPinIcon className="w-6 h-6" />,
      title: 'Location',
      detail: '123 Fitness Street, Gym City',
    },
  ];

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value,
    });
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // Add your form submission logic here
    console.log(formData);
  };

  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 pt-20">
      <Container maxWidth="lg">
        <Box py={8}>
          <m.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="text-center mb-16"
          >
            <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
              Get in Touch
            </h1>
            <p className="text-gray-300 text-lg max-w-2xl mx-auto">
              Have questions about GymNavigator? We're here to help you get started.
            </p>
          </m.div>

          <div className="grid lg:grid-cols-3 gap-8 mb-12">
            {contactInfo.map((info, index) => (
              <m.div
                key={info.title}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.1 }}
                className="bg-gray-800/50 backdrop-blur-lg rounded-xl p-6 border border-gray-700"
              >
                <div className="text-blue-400 mb-4">{info.icon}</div>
                <h3 className="text-xl font-semibold text-white mb-2">{info.title}</h3>
                <p className="text-gray-400">{info.detail}</p>
              </m.div>
            ))}
          </div>

          <m.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="bg-gray-800/30 backdrop-blur-lg rounded-xl p-8 border border-gray-700"
          >
            <Box component="form" onSubmit={handleSubmit}>
              <div className="grid md:grid-cols-2 gap-6 mb-6">
                <TextField
                  fullWidth
                  label="Name"
                  name="name"
                  value={formData.name}
                  onChange={handleChange}
                  required
                  variant="outlined"
                  sx={{
                    '& .MuiOutlinedInput-root': {
                      backgroundColor: 'rgba(30, 41, 59, 0.4)',
                      '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
                      '&:hover fieldset': {
                        borderColor: 'rgba(148, 163, 184, 0.4)',
                      },
                      '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
                    },
                    '& .MuiInputLabel-root': {
                      color: 'rgba(148, 163, 184, 0.8)',
                      '&.Mui-focused': {
                        color: '#60a5fa',
                      },
                    },
                    '& .MuiOutlinedInput-input': {
                      color: 'rgba(255, 255, 255, 0.9)',
                      '&::placeholder': {
                        color: 'rgba(148, 163, 184, 0.5)',
                      },
                    },
                  }}
                />
                <TextField
                  fullWidth
                  label="Email"
                  name="email"
                  type="email"
                  value={formData.email}
                  onChange={handleChange}
                  required
                  variant="outlined"
                  sx={{
                    '& .MuiOutlinedInput-root': {
                      backgroundColor: 'rgba(30, 41, 59, 0.4)',
                      '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
                      '&:hover fieldset': {
                        borderColor: 'rgba(148, 163, 184, 0.4)',
                      },
                      '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
                    },
                    '& .MuiInputLabel-root': {
                      color: 'rgba(148, 163, 184, 0.8)',
                      '&.Mui-focused': {
                        color: '#60a5fa',
                      },
                    },
                    '& .MuiOutlinedInput-input': {
                      color: 'rgba(255, 255, 255, 0.9)',
                      '&::placeholder': {
                        color: 'rgba(148, 163, 184, 0.5)',
                      },
                    },
                  }}
                />
              </div>
              <TextField
                fullWidth
                label="Subject"
                name="subject"
                value={formData.subject}
                onChange={handleChange}
                required
                variant="outlined"
                sx={{
                  marginBottom: 3,
                  '& .MuiOutlinedInput-root': {
                    backgroundColor: 'rgba(30, 41, 59, 0.4)',
                    '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
                    '&:hover fieldset': {
                      borderColor: 'rgba(148, 163, 184, 0.4)',
                    },
                    '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
                  },
                  '& .MuiInputLabel-root': {
                    color: 'rgba(148, 163, 184, 0.8)',
                    '&.Mui-focused': {
                      color: '#60a5fa',
                    },
                  },
                  '& .MuiOutlinedInput-input': {
                    color: 'rgba(255, 255, 255, 0.9)',
                    '&::placeholder': {
                      color: 'rgba(148, 163, 184, 0.5)',
                    },
                  },
                }}
              />
              <TextField
                fullWidth
                label="Message"
                name="message"
                multiline
                rows={4}
                value={formData.message}
                onChange={handleChange}
                required
                variant="outlined"
                sx={{
                  marginBottom: 3,
                  '& .MuiOutlinedInput-root': {
                    backgroundColor: 'rgba(30, 41, 59, 0.4)',
                    '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
                    '&:hover fieldset': {
                      borderColor: 'rgba(148, 163, 184, 0.4)',
                    },
                    '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
                  },
                  '& .MuiInputLabel-root': {
                    color: 'rgba(148, 163, 184, 0.8)',
                    '&.Mui-focused': {
                      color: '#60a5fa',
                    },
                  },
                  '& .MuiOutlinedInput-input': {
                    color: 'rgba(255, 255, 255, 0.9)',
                    '&::placeholder': {
                      color: 'rgba(148, 163, 184, 0.5)',
                    },
                  },
                }}
              />
              <Box display="flex" justifyContent="center">
                <Button
                  type="submit"
                  variant="contained"
                  size="large"
                  className="bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-3 rounded-lg 
                            font-medium hover:shadow-lg hover:from-blue-600 hover:to-cyan-600 
                            transition-all duration-200"
                >
                  Send Message
                </Button>
              </Box>
            </Box>
          </m.div>
        </Box>
      </Container>
    </div>
  );
};

export default ContactUs;

```

# app/(home)/_component/ContactUs/ClientAnimatedContactInfo.tsx

```tsx
'use client';

import { m } from 'framer-motion';
import React from 'react';
import type { ReactNode } from 'react';

type ContactInfoProps = {
  info: {
    icon: ReactNode;
    title: string;
    detail: string;
  };
  index: number;
};

export const ClientAnimatedContactInfo = ({ info, index }: ContactInfoProps) => {
  return (
    <m.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ delay: index * 0.1 }}
      className="bg-gray-800/50 backdrop-blur-lg rounded-xl p-6 border border-gray-700"
    >
      <div className="text-blue-400 mb-4">{info.icon}</div>
      <h3 className="text-xl font-semibold text-white mb-2">{info.title}</h3>
      <p className="text-gray-400">{info.detail}</p>
    </m.div>
  );
};

```

# app/(home)/_component/ContactUs/ContactForm.tsx

```tsx
'use client';

import { Box, Button, TextField } from '@mui/material';
import type React from 'react';
import { useState } from 'react';

export const ContactForm = () => {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    subject: '',
    message: '',
  });

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value,
    });
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // Add your form submission logic here
    console.log(formData);
  };

  return (
    <Box component="form" onSubmit={handleSubmit}>
      <div className="grid md:grid-cols-2 gap-6 mb-6">
        <TextField
          fullWidth
          label="Name"
          name="name"
          value={formData.name}
          onChange={handleChange}
          required
          variant="outlined"
          sx={{
            '& .MuiOutlinedInput-root': {
              backgroundColor: 'rgba(30, 41, 59, 0.4)',
              '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
              '&:hover fieldset': {
                borderColor: 'rgba(148, 163, 184, 0.4)',
              },
              '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
            },
            '& .MuiInputLabel-root': {
              color: 'rgba(148, 163, 184, 0.8)',
              '&.Mui-focused': {
                color: '#60a5fa',
              },
            },
            '& .MuiOutlinedInput-input': {
              color: 'rgba(255, 255, 255, 0.9)',
              '&::placeholder': {
                color: 'rgba(148, 163, 184, 0.5)',
              },
            },
          }}
        />
        <TextField
          fullWidth
          label="Email"
          name="email"
          type="email"
          value={formData.email}
          onChange={handleChange}
          required
          variant="outlined"
          sx={{
            '& .MuiOutlinedInput-root': {
              backgroundColor: 'rgba(30, 41, 59, 0.4)',
              '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
              '&:hover fieldset': {
                borderColor: 'rgba(148, 163, 184, 0.4)',
              },
              '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
            },
            '& .MuiInputLabel-root': {
              color: 'rgba(148, 163, 184, 0.8)',
              '&.Mui-focused': {
                color: '#60a5fa',
              },
            },
            '& .MuiOutlinedInput-input': {
              color: 'rgba(255, 255, 255, 0.9)',
              '&::placeholder': {
                color: 'rgba(148, 163, 184, 0.5)',
              },
            },
          }}
        />
      </div>
      <TextField
        fullWidth
        label="Subject"
        name="subject"
        value={formData.subject}
        onChange={handleChange}
        required
        variant="outlined"
        sx={{
          marginBottom: 3,
          '& .MuiOutlinedInput-root': {
            backgroundColor: 'rgba(30, 41, 59, 0.4)',
            '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
            '&:hover fieldset': {
              borderColor: 'rgba(148, 163, 184, 0.4)',
            },
            '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
          },
          '& .MuiInputLabel-root': {
            color: 'rgba(148, 163, 184, 0.8)',
            '&.Mui-focused': {
              color: '#60a5fa',
            },
          },
          '& .MuiOutlinedInput-input': {
            color: 'rgba(255, 255, 255, 0.9)',
            '&::placeholder': {
              color: 'rgba(148, 163, 184, 0.5)',
            },
          },
        }}
      />
      <TextField
        fullWidth
        label="Message"
        name="message"
        multiline
        rows={4}
        value={formData.message}
        onChange={handleChange}
        required
        variant="outlined"
        sx={{
          marginBottom: 3,
          '& .MuiOutlinedInput-root': {
            backgroundColor: 'rgba(30, 41, 59, 0.4)',
            '& fieldset': { borderColor: 'rgba(148, 163, 184, 0.2)' },
            '&:hover fieldset': {
              borderColor: 'rgba(148, 163, 184, 0.4)',
            },
            '&.Mui-focused fieldset': { borderColor: '#60a5fa' },
          },
          '& .MuiInputLabel-root': {
            color: 'rgba(148, 163, 184, 0.8)',
            '&.Mui-focused': {
              color: '#60a5fa',
            },
          },
          '& .MuiOutlinedInput-input': {
            color: 'rgba(255, 255, 255, 0.9)',
            '&::placeholder': {
              color: 'rgba(148, 163, 184, 0.5)',
            },
          },
        }}
      />
      <Box display="flex" justifyContent="center">
        <Button
          type="submit"
          variant="contained"
          size="large"
          className="bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-3 rounded-lg 
                    font-medium hover:shadow-lg hover:from-blue-600 hover:to-cyan-600 
                    transition-all duration-200"
        >
          Send Message
        </Button>
      </Box>
    </Box>
  );
};

```

# app/(home)/_component/ContactUs/ContactUs.tsx

```tsx
import { EnvelopeIcon, MapPinIcon, PhoneIcon } from '@heroicons/react/24/outline';
import { ClientAnimatedContactInfo } from './ClientAnimatedContactInfo';
import { ContactForm } from './ContactForm';

const contactInfo = [
  {
    icon: <PhoneIcon className="w-6 h-6" />,
    title: 'Phone',
    detail: '+1 (555) 123-4567',
  },
  {
    icon: <EnvelopeIcon className="w-6 h-6" />,
    title: 'Email',
    detail: 'support@gymnavigator.com',
  },
  {
    icon: <MapPinIcon className="w-6 h-6" />,
    title: 'Location',
    detail: '123 Fitness Street, Gym City',
  },
];

const ContactUs = () => {
  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 pt-20">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
        <div className="text-center mb-16">
          <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
            Get in Touch
          </h1>
          <p className="text-gray-300 text-lg max-w-2xl mx-auto">
            Have questions about GymNavigator? We're here to help you get started.
          </p>
        </div>

        <div className="grid lg:grid-cols-3 gap-8 mb-12">
          {contactInfo.map((info, index) => (
            <ClientAnimatedContactInfo key={info.title} info={info} index={index} />
          ))}
        </div>

        <div className="bg-gray-800/30 backdrop-blur-lg rounded-xl p-8 border border-gray-700">
          <ContactForm />
        </div>
      </div>
    </div>
  );
};

export default ContactUs;

```

# app/(home)/_component/CustomButton.tsx

```tsx
"use client";
import { useSession } from "@/node_modules/next-auth/react";
import { ArrowRight, Loader2 } from "lucide-react";
import { useRouter } from "next/navigation";
import { useState } from "react";

type CustomButtonProps = {
  className?: string;
  text?: string;
};

export default function CustomButton({
  className = "",
  text = "Get Started",
}: CustomButtonProps) {
  const router = useRouter();
  const { data: session, status } = useSession();
  const [isLoading, setIsLoading] = useState(false);

  const handleClick = async () => {
    setIsLoading(true);

    console.log("session from the custom button", session);
    if (status === "authenticated" && session?.role) {
      router.push(`/dashboard/${session.role}`);
    } else {
      router.push("/signin");
    }
  };
  return (
    <button
      type="button"
      className={`flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 hover:shadow-lg hover:shadow-blue-500/30 ${className}`}
      onClick={handleClick}
      disabled={isLoading}
    >
      {isLoading ? (
        <Loader2 className="h-5 w-5 animate-spin" />
      ) : (
        <>
          {text}
          <ArrowRight className="h-5 w-5" />
        </>
      )}
    </button>
  );
}

```

# app/(home)/_component/Features.tsx

```tsx
import {
  CakeIcon,
  ChartBarIcon,
  ClipboardDocumentCheckIcon,
  QrCodeIcon,
  ServerIcon,
  UserGroupIcon,
} from '@heroicons/react/24/outline';
import { m } from 'framer-motion';

const features = [
  {
    title: 'Smart QR Attendance',
    description:
      'Revolutionary QR-based attendance system. Generate daily unique codes for seamless check-ins and automated tracking.',
    icon: <QrCodeIcon className="w-8 h-8" />,
    color: 'from-blue-500 to-cyan-500',
  },
  {
    title: 'Personalized Diet',
    description:
      'Custom nutrition plans tailored to individual goals. Track meals and get real-time recommendations for optimal results.',
    icon: <CakeIcon className="w-8 h-8" />,
    color: 'from-purple-500 to-pink-500',
  },
  {
    title: 'Trainer Assignment Hub',
    description:
      'Effortlessly manage trainer-member relationships. Streamline communications and track progress in real-time.',
    icon: <UserGroupIcon className="w-8 h-8" />,
    color: 'from-green-500 to-emerald-500',
  },
  {
    title: 'Personalized Fitness Journey',
    description:
      'Custom workout plans and diet charts tailored to each member. Track progress and adjust goals dynamically.',
    icon: <ClipboardDocumentCheckIcon className="w-8 h-8" />,
    color: 'from-orange-500 to-amber-500',
  },
  {
    title: 'Advanced Analytics',
    description:
      'Comprehensive insights into attendance patterns, member engagement, and business performance metrics.',
    icon: <ChartBarIcon className="w-8 h-8" />,
    color: 'from-red-500 to-rose-500',
  },
  {
    title: 'Member Portal',
    description:
      'Empower members with easy access to workouts, diet plans, and attendance history through a dedicated portal.',
    icon: <ServerIcon className="w-8 h-8" />,
    color: 'from-indigo-500 to-violet-500',
  },
];

const Features = () => {
  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 pt-20">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
        <m.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center mb-16"
        >
          <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
            Powerful Features for Modern Gyms
          </h1>
          <p className="text-gray-300 text-lg max-w-3xl mx-auto">
            Transform your gym management with our comprehensive suite of digital tools designed to
            streamline operations and enhance member experience.
          </p>
        </m.div>

        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {features.map((feature, index) => (
            <m.div
              key={index as number}
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.1 }}
              className="bg-gray-800/50 backdrop-blur-lg rounded-xl p-6 border border-gray-700 
                        hover:border-blue-500/50 transition-all duration-300"
            >
              <div className={`bg-gradient-to-r ${feature.color} p-3 rounded-lg w-fit mb-4`}>
                {feature.icon}
              </div>
              <h3 className="text-xl font-semibold text-white mb-3">{feature.title}</h3>
              <p className="text-gray-400 leading-relaxed">{feature.description}</p>
            </m.div>
          ))}
        </div>
      </div>
    </div>
  );
};

export default Features;

```

# app/(home)/_component/Hero-section/Dumbbell.tsx

```tsx
"use client";
import { Cylinder } from "@react-three/drei";
// components/Dumbbell.tsx
import { useFrame } from "@react-three/fiber";
import type React from "react";
import { useRef } from "react";
import * as THREE from "three";

// --- Define Initial Orientation ---
const INITIAL_TILT_X_DEGREES = 30; // Downward tilt
const INITIAL_ROTATION_Y_DEGREES = -35; // Left side back, right side forward
// --- ADDED Z-AXIS ROLL ---
const INITIAL_ROLL_Z_DEGREES = 10; // Slight roll (positive makes right side lower) - Adjust as needed (e.g., 3 to 8)

// --- Define Movement Sensitivity (Higher numbers = LESS movement) ---
const BASE_ANIM_AMP_X = 180; // Further reduced movement
const BASE_ANIM_AMP_Y = 150; // Further reduced movement
const BASE_ANIM_AMP_Z = 350; // Make Z wobble very minimal
const MOUSE_SENSITIVITY_X = 100; // Further reduced movement
const MOUSE_SENSITIVITY_Y = 90; // Further reduced movement
const MOUSE_SENSITIVITY_Z = 300; // Make mouse effect on Z very minimal
const LERP_FACTOR = 0.025; // Slightly smoother lerp
const VERTICAL_BOB_SPEED = 3.5;
const VERTICAL_BOB_AMP = 0.015; // Reduced bobbing

// Convert degrees to radians for initial setup
const INITIAL_TILT_X_RAD = THREE.MathUtils.degToRad(INITIAL_TILT_X_DEGREES);
const INITIAL_ROTATION_Y_RAD = THREE.MathUtils.degToRad(
  INITIAL_ROTATION_Y_DEGREES
);
const INITIAL_ROLL_Z_RAD = THREE.MathUtils.degToRad(INITIAL_ROLL_Z_DEGREES); // Radian for Z

interface DumbbellProps {
  mousePos: React.MutableRefObject<{ x: number; y: number }>;
}

// Export Dumbbell Scene directly without a Canvas wrapper
export function DumbbellScene({ mousePos }: { mousePos?: React.MutableRefObject<{ x: number; y: number }> }) {
  // Create a default mousePos ref if none is provided
  const defaultMousePos = useRef({ x: 0, y: 0 });
  const safeMousePos = mousePos || defaultMousePos;

  return <Dumbbell mousePos={safeMousePos} />;
}

// The actual Dumbbell component that uses Three.js hooks
function Dumbbell({ mousePos }: DumbbellProps) {
  const group = useRef<THREE.Group>(null);

  // Theme colors (remain the same)
  const purpleAccent = "#a855f7";
  const purpleDark = "#581c87";
  const handleColor = "#404040";
  const plateColor = "#1f1f1f";
  const detailColor = "#525252";

  useFrame((state) => {
    if (!group.current) return;
    const t = state.clock.getElapsedTime();

    // Calculate Subtle Deviations including Z
    const baseRotX = Math.cos(t / (BASE_ANIM_AMP_X / 25)) / BASE_ANIM_AMP_X;
    const baseRotY = Math.sin(t / (BASE_ANIM_AMP_Y / 20)) / BASE_ANIM_AMP_Y;
    const baseRotZ = Math.cos(t / (BASE_ANIM_AMP_Z / 15)) / BASE_ANIM_AMP_Z; // Z wobble
    const mouseRotX = (-mousePos.current.y * Math.PI) / MOUSE_SENSITIVITY_X;
    const mouseRotY = (mousePos.current.x * Math.PI) / MOUSE_SENSITIVITY_Y;
    // Optional: Minimal mouse effect on Z roll (can be removed if distracting)
    const mouseRotZ = (mousePos.current.x * Math.PI) / MOUSE_SENSITIVITY_Z;

    // Target Rotation: Start from initial pose and add small deviations
    const targetX = INITIAL_TILT_X_RAD + baseRotX + mouseRotX;
    const targetY = INITIAL_ROTATION_Y_RAD + baseRotY + mouseRotY;
    const targetZ = INITIAL_ROLL_Z_RAD + baseRotZ + mouseRotZ; // Target Z including initial roll

    // Apply smooth interpolation (Lerp) towards the target rotation for all axes
    group.current.rotation.x = THREE.MathUtils.lerp(
      group.current.rotation.x,
      targetX,
      LERP_FACTOR
    );
    group.current.rotation.y = THREE.MathUtils.lerp(
      group.current.rotation.y,
      targetY,
      LERP_FACTOR
    );
    group.current.rotation.z = THREE.MathUtils.lerp(
      group.current.rotation.z,
      targetZ,
      LERP_FACTOR
    ); // Lerp Z rotation

    // Subtle Vertical Bobbing
    const targetYPos =
      0.3 + Math.sin(t / VERTICAL_BOB_SPEED) * VERTICAL_BOB_AMP;
    group.current.position.y = THREE.MathUtils.lerp(
      group.current.position.y,
      targetYPos,
      LERP_FACTOR
    );
  });

  // Geometry and Material definitions remain the same...
  const numDetails = 6;
  const detailPositions = Array.from({ length: numDetails }, (_, i) => {
    const angle = (i / numDetails) * Math.PI * 2;
    const radius = 1.1;
    return {
      id: `detail-${i}`,
      position: [0, Math.cos(angle) * radius, Math.sin(angle) * radius] as [
        number,
        number,
        number
      ],
    };
  });
  const numGrips = 12;
  const gripLength = 0.25;
  const handleLength = 4.5;
  const totalGripSpan = numGrips * gripLength;
  const gripStart = -totalGripSpan / 2 + gripLength / 2;
  const gripDetails = Array.from({ length: numGrips }, (_, i) => ({
    id: `grip-${i}`,
    position: [gripStart + i * gripLength, 0, 0] as [number, number, number],
    isCenter:
      i === Math.floor(numGrips / 2) || i === Math.floor(numGrips / 2) - 1,
  }));
  const plateArgs: [number, number, number, number] = [1.4, 1.4, 0.65, 64];
  const handleArgs: [number, number, number, number] = [
    0.25,
    0.25,
    handleLength,
    32,
  ];
  const gripArgs: [number, number, number, number] = [
    0.26,
    0.26,
    gripLength * 0.8,
    16,
  ];
  const detailArgs: [number, number, number, number] = [0.05, 0.05, 0.68, 8];
  const labelPlateArgs: [number, number, number, number] = [0.5, 0.5, 0.67, 32];
  const physicalMaterialProps = {
    roughness: 0.4,
    metalness: 0.8,
    clearcoat: 0.3,
    clearcoatRoughness: 0.3,
    reflectivity: 0.6,
  };
  const plateDetailMaterial = (
    <meshPhysicalMaterial color={detailColor} roughness={0.5} metalness={0.6} />
  );
  const labelPlateMaterialLeft = (
    <meshPhysicalMaterial
      color="#333333"
      roughness={0.3}
      metalness={0.7}
      clearcoat={0.2}
      emissive={purpleDark}
      emissiveIntensity={0.1}
    />
  );
  const labelPlateMaterialRight = (
    <meshPhysicalMaterial
      color="#333333"
      roughness={0.3}
      metalness={0.7}
      clearcoat={0.2}
      emissive={"#000000"}
      emissiveIntensity={0}
    />
  );

  return (
    // Apply the combined initial rotation (X, Y, and Z) directly to the group
    <group
      ref={group}
      scale={1.5}
      position={[0, 0.3, 0]}
      // --- Use all three initial rotation radian values ---
      rotation={[
        INITIAL_TILT_X_RAD,
        INITIAL_ROTATION_Y_RAD,
        INITIAL_ROLL_Z_RAD,
      ]}
    >
      {/* Handle */}
      <Cylinder
        args={handleArgs}
        rotation={[0, 0, Math.PI / 2]}
        castShadow
        receiveShadow
      >
        {" "}
        <meshPhysicalMaterial
          color={handleColor}
          {...physicalMaterialProps}
          metalness={0.9}
        />{" "}
      </Cylinder>
      {/* Handle grip texture */}
      {gripDetails.map((grip) => (
        <Cylinder
          key={grip.id}
          args={gripArgs}
          position={grip.position}
          rotation={[0, 0, Math.PI / 2]}
          castShadow
        >
          {" "}
          <meshPhysicalMaterial
            color={grip.isCenter ? purpleAccent : "#333333"}
            roughness={0.8}
            metalness={0.5}
            emissive={grip.isCenter ? purpleDark : "#000000"}
            emissiveIntensity={grip.isCenter ? 0.5 : 0}
          />{" "}
        </Cylinder>
      ))}
      {/* Left Weight */}
      <group position={[-handleLength / 2 - 0.1, 0, 0]}>
        <Cylinder
          args={plateArgs}
          rotation={[0, 0, Math.PI / 2]}
          castShadow
          receiveShadow
        >
          {" "}
          <meshPhysicalMaterial
            color={plateColor}
            {...physicalMaterialProps}
          />{" "}
        </Cylinder>
        {detailPositions.map((detail) => (
          <Cylinder
            key={`left-${detail.id}`}
            args={detailArgs}
            position={detail.position}
            rotation={[0, 0, Math.PI / 2]}
            castShadow
          >
            {" "}
            {plateDetailMaterial}{" "}
          </Cylinder>
        ))}
        <Cylinder
          args={labelPlateArgs}
          rotation={[0, 0, Math.PI / 2]}
          castShadow
        >
          {" "}
          {labelPlateMaterialLeft}{" "}
        </Cylinder>
      </group>
      {/* Right Weight */}
      <group position={[handleLength / 2 + 0.1, 0, 0]}>
        <Cylinder
          args={plateArgs}
          rotation={[0, 0, Math.PI / 2]}
          castShadow
          receiveShadow
        >
          {" "}
          <meshPhysicalMaterial
            color={plateColor}
            {...physicalMaterialProps}
          />{" "}
        </Cylinder>
        {detailPositions.map((detail) => (
          <Cylinder
            key={`right-${detail.id}`}
            args={detailArgs}
            position={detail.position}
            rotation={[0, 0, Math.PI / 2]}
            castShadow
          >
            {" "}
            {plateDetailMaterial}{" "}
          </Cylinder>
        ))}
        <Cylinder
          args={labelPlateArgs}
          rotation={[0, 0, Math.PI / 2]}
          castShadow
        >
          {" "}
          {labelPlateMaterialRight}{" "}
        </Cylinder>
      </group>
    </group>
  );
}

```

# app/(home)/_component/Hero-section/DumbbellWrapper.tsx

```tsx
"use client";

import {
	ContactShadows,
	Environment,
	OrbitControls,
	PerspectiveCamera,
	SpotLight,
	useHelper,
} from "@react-three/drei";
import { Canvas } from "@react-three/fiber";
import { Suspense, useEffect, useRef, useState } from "react";
import type * as THREE from "three";
import { DumbbellScene } from "./Dumbbell";

// Theme colors from theme.ts
const themeBlue = {
	light: "#66a9ff", // primary.300
	medium: "#3390ff", // primary.400
	main: "#0077ff", // primary.500
	dark: "#004eac", // primary.700
};

// Cinematic lighting component for better visual control
function CinematicLighting() {
	// Main top spotlight - dramatic effect
	const spotLightRef = useRef<THREE.SpotLight>(null);
	const spotLightTarget = useRef<THREE.Object3D>(null);

	return (
		<>
			{/* Ambient lighting for base brightness */}
			<ambientLight intensity={0.25} color="#e6f1ff" />

			{/* Primary spotlight from top-front */}
			<SpotLight
				position={[0, 10, 5]}
				angle={0.3}
				penumbra={0.9}
				intensity={3.0}
				distance={20}
				color="#ffffff"
				castShadow
				shadow-mapSize={1024}
				attenuation={5}
				anglePower={5} // Sharper spotlight edge
			/>

			{/* Dramatic blue accent light from top-right - matching grip color */}
			<SpotLight
				position={[8, 10, 5]}
				angle={0.4}
				penumbra={0.8}
				intensity={1.8}
				distance={25}
				color={themeBlue.medium}
				castShadow
				shadow-mapSize={1024}
				attenuation={7}
			/>

			{/* Rim light from back to create definition */}
			<pointLight
				position={[-5, 3, -10]}
				intensity={0.8}
				color={themeBlue.light}
				castShadow
			/>

			{/* Subtle fill light from left */}
			<pointLight position={[-8, 0, 5]} intensity={0.3} color="#ffffff" />

			{/* Subtle light from bottom for under-lighting */}
			<pointLight position={[0, -3, 8]} intensity={0.15} color="#fed6e3" />
		</>
	);
}

export default function DumbbellWrapper() {
	const [isLoading, setIsLoading] = useState(true);
	const mousePos = useRef({ x: 0, y: 0 });

	// Track mouse position with properly inverted Y axis for 3D space
	useEffect(() => {
		const timer = setTimeout(() => {
			setIsLoading(false);
		}, 300);
		const handleMouseMove = (event: MouseEvent) => {
			mousePos.current = {
				x: (event.clientX / window.innerWidth) * 2 - 1,
				y: -(event.clientY / window.innerHeight) * 2 + 1,
			};
		};
		window.addEventListener("mousemove", handleMouseMove);
		return () => {
			clearTimeout(timer);
			window.removeEventListener("mousemove", handleMouseMove);
		};
	}, []);

	return (
		<div
			className="h-[500px] w-full rounded-lg transition-opacity duration-500 ease-in-out"
			style={{ opacity: isLoading ? 0 : 1 }}
		>
			<Canvas
				shadows
				dpr={[1, 1.5]}
				gl={{
					alpha: true,
					antialias: true,
					powerPreference: "high-performance",
				}}
				style={{ background: "transparent" }}
				camera={{ position: [0, 1.5, 11], fov: 45 }}
			>
				<Suspense fallback={null}>
					{/* Main camera */}
					<PerspectiveCamera makeDefault position={[0, 1.5, 11]} fov={45} />

					{/* Controls */}
					<OrbitControls
						enableZoom={false}
						enablePan={false}
						minPolarAngle={Math.PI / 2.8}
						maxPolarAngle={Math.PI / 1.8}
						minAzimuthAngle={-Math.PI / 10}
						maxAzimuthAngle={Math.PI / 10}
						target={[0, 0.5, 0]}
					/>

					{/* Enhanced Cinematic Lighting Setup */}
					<CinematicLighting />

					{/* Dumbbell Component */}
					<DumbbellScene mousePos={mousePos} />

					{/* Enhanced Shadows */}
					<ContactShadows
						opacity={0.7}
						scale={15}
						blur={2.5}
						far={10}
						resolution={512}
						color="#000000"
						position={[0, -1.8, 0]}
					/>

					{/* Environment map for reflections */}
					<Environment preset="city" blur={0.6} />
				</Suspense>
			</Canvas>
		</div>
	);
}

```

# app/(home)/_component/Pricing.tsx

```tsx
'use client';
import { CheckCircleIcon } from '@heroicons/react/24/outline';
import { m } from 'framer-motion';

const plans = [
  {
    name: 'Basic',
    price: '₹999',
    period: '/month',
    description: 'Perfect for small gyms',
    features: [
      'Up to 100 members',
      'Basic analytics',
      'QR attendance system',
      'Email support',
      '1 Admin account',
    ],
  },
  {
    name: 'Pro',
    price: '₹1,999',
    period: '/month',
    description: 'Great for growing gyms',
    popular: true,
    features: [
      'Up to 500 members',
      'Advanced analytics',
      'Custom branding',
      'Priority support',
      '5 Admin accounts',
      'Member app access',
    ],
  },
  {
    name: 'Enterprise',
    price: 'Custom',
    period: '',
    description: 'For large fitness chains',
    features: [
      'Unlimited members',
      'Custom solutions',
      'Dedicated support',
      'API access',
      'Multiple locations',
      'Custom integrations',
    ],
  },
];

const Pricing = () => {
  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 py-24">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <m.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center mb-16"
        >
          <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
            Simple, Transparent Pricing
          </h1>
          <p className="text-gray-300 text-lg max-w-2xl mx-auto">
            Choose the perfect plan for your gym. All plans include our core features.
          </p>
        </m.div>

        <div className="grid md:grid-cols-3 gap-8">
          {plans.map((plan, index) => (
            <m.div
              key={index as number}
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.2 }}
              className={`
                relative bg-gray-800/50 backdrop-blur-lg rounded-xl p-8 border 
                ${plan.popular ? 'border-blue-500 shadow-lg shadow-blue-500/20' : 'border-gray-700'}
              `}
            >
              {plan.popular && (
                <div className="absolute -top-4 left-1/2 transform -translate-x-1/2">
                  <span className="bg-blue-500 text-white text-sm px-3 py-1 rounded-full">
                    Most Popular
                  </span>
                </div>
              )}

              <div className="text-center mb-8">
                <h3 className="text-xl font-semibold text-white mb-2">{plan.name}</h3>
                <p className="text-gray-400 mb-4">{plan.description}</p>
                <div className="text-3xl font-bold text-white">
                  {plan.price}
                  <span className="text-sm text-gray-400">{plan.period}</span>
                </div>
              </div>

              <ul className="space-y-4 mb-8">
                {plan.features.map((feature, i) => (
                  <li key={i as number} className="flex items-center text-gray-300">
                    <CheckCircleIcon className="w-5 h-5 text-blue-400 mr-2" />
                    {feature}
                  </li>
                ))}
              </ul>

              <button
                type="button"
                className={`
                w-full py-3 px-4 rounded-lg font-medium transition-all duration-200
                ${
                  plan.popular
                    ? 'bg-blue-500 hover:bg-blue-600 text-white'
                    : 'border border-gray-600 hover:border-blue-500 text-white'
                }
              `}
              >
                Get Started
              </button>
            </m.div>
          ))}
        </div>
      </div>
    </div>
  );
};

export default Pricing;

```

# app/(home)/_component/Pricing/ClientAnimatedPricingCard.tsx

```tsx
'use client';

import { CheckCircleIcon } from '@heroicons/react/24/outline';
import { m } from 'framer-motion';
import React from 'react';

type PricingCardProps = {
  plan: {
    name: string;
    price: string;
    period: string;
    description: string;
    popular?: boolean;
    features: string[];
  };
  index: number;
};

export const ClientAnimatedPricingCard = ({ plan, index }: PricingCardProps) => {
  return (
    <m.div
      initial={{ opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      transition={{ delay: index * 0.2 }}
      className={`
        relative bg-gray-800/50 backdrop-blur-lg rounded-xl p-8 border 
        ${plan.popular ? 'border-blue-500 shadow-lg shadow-blue-500/20' : 'border-gray-700'}
      `}
    >
      {plan.popular && (
        <div className="absolute -top-4 left-1/2 transform -translate-x-1/2">
          <span className="bg-blue-500 text-white text-sm px-3 py-1 rounded-full">
            Most Popular
          </span>
        </div>
      )}

      <div className="text-center mb-8">
        <h3 className="text-xl font-semibold text-white mb-2">{plan.name}</h3>
        <p className="text-gray-400 mb-4">{plan.description}</p>
        <div className="text-3xl font-bold text-white">
          {plan.price}
          <span className="text-sm text-gray-400">{plan.period}</span>
        </div>
      </div>

      <ul className="space-y-4 mb-8">
        {plan.features.map((feature, i) => (
          <li key={i as number} className="flex items-center text-gray-300">
            <CheckCircleIcon className="w-5 h-5 text-blue-400 mr-2" />
            {feature}
          </li>
        ))}
      </ul>

      <button
        type="button"
        className={`
          w-full py-3 px-4 rounded-lg font-medium transition-all duration-200
          ${
            plan.popular
              ? 'bg-blue-500 hover:bg-blue-600 text-white'
              : 'border border-gray-600 hover:border-blue-500 text-white'
          }
        `}
      >
        Get Started
      </button>
    </m.div>
  );
};

```

# app/(home)/_component/Pricing/Pricing.tsx

```tsx
import { CheckCircleIcon } from '@heroicons/react/24/outline';
import { ClientAnimatedPricingCard } from './ClientAnimatedPricingCard';

const plans = [
  {
    name: 'Basic',
    price: '₹999',
    period: '/month',
    description: 'Perfect for small gyms',
    features: [
      'Up to 100 members',
      'Basic analytics',
      'QR attendance system',
      'Email support',
      '1 Admin account',
    ],
  },
  {
    name: 'Pro',
    price: '₹1,999',
    period: '/month',
    description: 'Great for growing gyms',
    popular: true,
    features: [
      'Up to 500 members',
      'Advanced analytics',
      'Custom branding',
      'Priority support',
      '5 Admin accounts',
      'Member app access',
    ],
  },
  {
    name: 'Enterprise',
    price: 'Custom',
    period: '',
    description: 'For large fitness chains',
    features: [
      'Unlimited members',
      'Custom solutions',
      'Dedicated support',
      'API access',
      'Multiple locations',
      'Custom integrations',
    ],
  },
];

const Pricing = () => {
  return (
    <div className="min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 py-24">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center mb-16">
          <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-6">
            Simple, Transparent Pricing
          </h1>
          <p className="text-gray-300 text-lg max-w-2xl mx-auto">
            Choose the perfect plan for your gym. All plans include our core features.
          </p>
        </div>

        <div className="grid md:grid-cols-3 gap-8">
          {plans.map((plan, index) => (
            <ClientAnimatedPricingCard key={plan.name} plan={plan} index={index} />
          ))}
        </div>
      </div>
    </div>
  );
};

export default Pricing;

```

# app/(home)/_sections/cta/CtaSection.tsx

```tsx
'use client';
import { m } from 'framer-motion';
import { ArrowRight, Clock, Shield, Zap } from 'lucide-react';
import Link from 'next/link';
import CustomButton from '../../_component/CustomButton';

const CtaSection = () => {
  return (
    <section className="relative py-20 overflow-hidden">
      {/* Background gradient */}
      <div className="absolute inset-0 bg-gradient-to-b from-gray-900 via-blue-900/10 to-gray-900" />

      {/* Content */}
      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <m.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ duration: 0.8 }}
          className="text-center mb-12"
        >
          <h2 className="text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-blue-600 bg-clip-text text-transparent">
            Transform Your Gym Today
          </h2>
          <p className="text-gray-400 text-lg max-w-2xl mx-auto">
            Join thousands of successful gym owners who have revolutionized their business with
            GymDominator
          </p>
        </m.div>

        {/* Features grid */}
        <div className="grid md:grid-cols-3 gap-8 mb-12">
          {[
            {
              icon: Zap,
              title: 'Quick Setup',
              description: 'Get started in less than 5 minutes',
            },
            {
              icon: Shield,
              title: 'Secure Platform',
              description: 'Enterprise-grade security for your data',
            },
            {
              icon: Clock,
              title: '24/7 Support',
              description: 'Round-the-clock expert assistance',
            },
          ].map((feature, index) => (
            <m.div
              key={index as number}
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true }}
              transition={{ delay: index * 0.2 }}
              className="bg-gray-800/30 backdrop-blur-sm rounded-xl p-6 border border-gray-700"
            >
              <feature.icon className="w-12 h-12 text-blue-400 mb-4" />
              <h3 className="text-xl font-semibold text-white mb-2">{feature.title}</h3>
              <p className="text-gray-400">{feature.description}</p>
            </m.div>
          ))}
        </div>

        {/* CTA Buttons */}
        <m.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ delay: 0.6 }}
          className="flex flex-col sm:flex-row items-center justify-center gap-4"
        >
          <CustomButton className="w-full sm:w-auto" />
          <Link
            href="/contact"
            className="text-gray-300 hover:text-white px-8 py-3 rounded-full border border-gray-700 
                     hover:border-blue-500 transition-all duration-300 flex items-center"
          >
            Schedule Demo
            <ArrowRight className="w-5 h-5 ml-2" />
          </Link>
        </m.div>
      </div>
    </section>
  );
};

export default CtaSection;

```

# app/(home)/_sections/faq/FaqSection.tsx

```tsx
'use client';
import { m } from 'framer-motion';
import { Minus, Plus } from 'lucide-react';
import { useState } from 'react';

const faqs = [
  {
    question: 'How can I create a gym?',
    answer:
      "Log in as an owner, then create a gym using the gym creation form. This will set up your gym's profile and management dashboard.",
  },
  {
    question: 'How do I onboard users?',
    answer:
      "Users sign in to the clients portal. As an owner, you'll display your gym's onboarding QR code. Users scan this code and appear in your onboarding users section. You'll then need to set their active period, after which they can access their client portal.",
  },
  {
    question: 'How will users mark attendance?',
    answer:
      "Display the attendance QR code at your gym. Users can scan this through their client portal's QR scanner in the attendance section, which automatically marks their attendance for the day.",
  },
  {
    question: 'How do I assign trainers to users?',
    answer:
      "In the trainer section, use the 'Assign Trainer' component to pair users with their designated trainers. This creates the trainer-client relationship in the system.",
  },
  {
    question: 'How can I assign personalized workouts and diets?',
    answer:
      'Once trainers are assigned to users, they can access their clients through the trainer portal. Trainers can then create and assign personalized workout plans and diet schedules, which will be visible to clients in their portal.',
  },
];

export default function FaqSection() {
  const [activeIndex, setActiveIndex] = useState<number | null>(null);

  return (
    <section className="py-24 bg-gradient-to-b from-black to-gray-900">
      <div className="container mx-auto px-4">
        <m.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
          className="text-center mb-16"
        >
          <h2 className="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent">
            Frequently Asked Questions
          </h2>
          <p className="text-gray-400 text-lg">
            Everything you need to know about managing your gym
          </p>
        </m.div>

        <div className="max-w-3xl mx-auto">
          {faqs.map((faq, index) => (
            <m.div
              key={index as number}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.1 }}
              className="mb-4"
            >
              <button
                type="button"
                onClick={() => setActiveIndex(activeIndex === index ? null : index)}
                className="w-full bg-gradient-to-r from-gray-900 to-gray-800 p-6 rounded-lg border border-gray-700 hover:border-blue-500 transition-all duration-300 flex items-center justify-between group"
              >
                <span className="text-lg font-semibold text-left text-white group-hover:text-blue-400">
                  {faq.question}
                </span>
                <m.div
                  animate={{ rotate: activeIndex === index ? 180 : 0 }}
                  transition={{ duration: 0.3 }}
                  className="text-blue-500"
                >
                  {activeIndex === index ? (
                    <Minus className="w-5 h-5" />
                  ) : (
                    <Plus className="w-5 h-5" />
                  )}
                </m.div>
              </button>
              <m.div
                initial={{ height: 0, opacity: 0 }}
                animate={{
                  height: activeIndex === index ? 'auto' : 0,
                  opacity: activeIndex === index ? 1 : 0,
                }}
                transition={{ duration: 0.3 }}
                className="overflow-hidden"
              >
                <div className="p-6 bg-gray-800/50 rounded-b-lg border-x border-b border-gray-700">
                  <p className="text-gray-300 leading-relaxed">{faq.answer}</p>
                </div>
              </m.div>
            </m.div>
          ))}
        </div>
      </div>
    </section>
  );
}

```

# app/(home)/_sections/features/FeatureCard.tsx

```tsx
import type { LucideProps } from 'lucide-react';

export default function FeatureCard({
  Icon,
  title,
  description,
}: {
  Icon: React.ComponentType<LucideProps>;
  title: string;
  description: string;
}) {
  return (
    <div className="flex flex-col items-center p-6 bg-gray-800 bg-opacity-50 rounded-lg backdrop-filter backdrop-blur-lg transition-all duration-200 ease-in-out hover:bg-opacity-75">
      <Icon className="h-12 w-12 text-blue-400 mb-4" />
      <h3 className="text-xl font-semibold text-center mb-2">{title}</h3>
      <p className="text-gray-400 text-center">{description}</p>
    </div>
  );
}

```

# app/(home)/_sections/features/FeaturesSection.tsx

```tsx
import { FlipCard } from './FlipCard';

const features = [
  {
    title: 'Smart QR Attendance',
    description:
      'Revolutionary QR-based attendance system. Generate daily unique codes for seamless check-ins and automated tracking.',
  },
  {
    title: 'Personalized Diet',
    description:
      'Custom nutrition plans tailored to individual goals. Track meals and get real-time recommendations for optimal results.',
  },
  {
    title: 'Trainer Assignment Hub',
    description:
      'Effortlessly manage trainer-member relationships. Streamline communications and track progress in real-time.',
  },
  {
    title: 'Personalized Fitness Journey',
    description:
      'Custom workout plans and diet charts tailored to each member. Track progress and adjust goals dynamically.',
  },
  {
    title: 'Advanced Analytics',
    description:
      'Comprehensive insights into attendance patterns, member engagement, and business performance metrics.',
  },
  {
    title: 'Member Portal',
    description:
      'Empower members with easy access to workouts, diet plans, and attendance history through a dedicated portal.',
  },
];

export default function FeaturesSection() {
  return (
    <section className="py-24 bg-gradient-to-b from-gray-950 to-black relative overflow-hidden">
      <div className="absolute inset-0 bg-grid-white/[0.02] bg-[size:50px]" />
      <div className="container mx-auto px-4 relative z-10">
        <div className="text-center mb-20">
          <h2 className="text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-violet-500 to-fuchsia-500 mb-6">
            Powerful Features
          </h2>
          <p className="text-lg text-zinc-400 max-w-2xl mx-auto">
            Experience the future of gym management with our comprehensive suite of features
          </p>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {features.map((feature, idx) => (
            <FlipCard key={idx as number} title={feature.title} description={feature.description} />
          ))}
        </div>
      </div>

      <div className="absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent pointer-events-none" />
    </section>
  );
}

```

# app/(home)/_sections/features/FlipCard.tsx

```tsx
'use client';
import { m } from 'framer-motion';
import {
  BarChart3,
  Bell,
  Calendar,
  ClipboardList,
  Dumbbell,
  LayoutDashboard,
  LineChart,
  QrCode,
  Shield,
  Smartphone,
  Target,
  Users,
} from 'lucide-react';
import { useState } from 'react';

// Extended icon map to include both front and back features
const iconMap = {
  // Front card icons
  'Smart QR Attendance': QrCode,
  'Personalized Diet': LayoutDashboard,
  'Trainer Assignment Hub': Users,
  'Personalized Fitness Journey': Dumbbell,
  'Advanced Analytics': BarChart3,
  'Member Portal': Smartphone,
  // Back card icons
  'Real-Time Notifications': Bell,
  'Workout Plan Management': ClipboardList,
  'Schedule Management': Calendar,
  'Progress Analytics': LineChart,
  'Multi-Role Access': Shield,
  'Goal Tracking': Target,
};

// Added back side content for each card
const backFeatures = {
  'Smart QR Attendance': {
    title: 'Real-Time Notifications',
    description:
      'Instant updates on new plans, schedule changes, and gym announcements delivered directly to members.',
  },
  'Personalized Diet': {
    title: 'Workout Plan Management',
    description:
      'Complete system for creating, updating, and tracking personalized workout routines for each member.',
  },
  'Trainer Assignment Hub': {
    title: 'Schedule Management',
    description: 'Efficient scheduling system for trainer assignments and member sessions.',
  },
  'Personalized Fitness Journey': {
    title: 'Progress Analytics',
    description: 'Detailed tracking and visualization of member progress over time.',
  },
  'Advanced Analytics': {
    title: 'Multi-Role Access',
    description: 'Secure, role-based access control for owners, trainers, and members.',
  },
  'Member Portal': {
    title: 'Goal Tracking',
    description: 'Comprehensive goal setting and achievement tracking for members.',
  },
};

interface FlipCardProps {
  title: string;
  description: string;
}

export const FlipCard = ({ title, description }: FlipCardProps) => {
  const [isFlipped, setIsFlipped] = useState(false);
  const FrontIcon = iconMap[title as keyof typeof iconMap];
  const backFeature = backFeatures[title as keyof typeof backFeatures];
  const BackIcon = iconMap[backFeature.title as keyof typeof iconMap];

  return (
    <m.div
      className="flip-card cursor-pointer h-[400px] w-full [perspective:1000px]"
      initial={{ opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
      viewport={{ once: true }}
      onClick={() => setIsFlipped(!isFlipped)}
    >
      <div
        className="relative w-full h-full transition-all duration-700 [transform-style:preserve-3d]"
        style={{ transform: isFlipped ? 'rotateY(180deg)' : '' }}
      >
        {/* Front Card */}
        <div className="absolute inset-0 [backface-visibility:hidden]">
          <div className="h-full p-8 rounded-xl bg-gradient-to-br from-zinc-900 via-zinc-900/90 to-zinc-800 border border-zinc-700/50 shadow-lg backdrop-blur-sm">
            <div className="relative z-10 h-full flex flex-col">
              <div className="mb-6">
                <div className="w-12 h-12 rounded-full bg-gradient-to-br from-violet-500 to-fuchsia-500 flex items-center justify-center">
                  {FrontIcon && <FrontIcon className="w-6 h-6 text-white" />}
                </div>
              </div>
              <h3 className="text-2xl font-bold bg-gradient-to-br from-white to-zinc-300 bg-clip-text text-transparent mb-4">
                {title}
              </h3>
              <p className="text-zinc-400 flex-grow">{description}</p>
              <div className="mt-6 text-sm text-zinc-500 flex items-center gap-2">
                Click to see feature <span className="animate-pulse">→</span>
              </div>
            </div>
            <div className="absolute inset-0 bg-gradient-to-br from-violet-500/10 to-fuchsia-500/10 rounded-xl" />
          </div>
        </div>

        {/* Back Card */}
        <div
          className="absolute inset-0 [backface-visibility:hidden] [transform:rotateY(180deg)]"
          style={{ transform: 'rotateY(180deg)' }}
        >
          <div className="h-full p-8 rounded-xl bg-gradient-to-br from-zinc-900 via-zinc-900/90 to-zinc-800 border border-zinc-700/50 shadow-lg">
            <div className="relative z-10 h-full flex flex-col">
              <div className="mb-6">
                <div className="w-12 h-12 rounded-full bg-gradient-to-br from-violet-500 to-fuchsia-500 flex items-center justify-center">
                  {BackIcon && <BackIcon className="w-6 h-6 text-white" />}
                </div>
              </div>
              <h3 className="text-2xl font-bold bg-gradient-to-br from-white to-zinc-300 bg-clip-text text-transparent mb-4">
                {backFeature.title}
              </h3>
              <p className="text-zinc-400 flex-grow">{backFeature.description}</p>
              <div className="mt-6 text-sm text-zinc-500 flex items-center gap-2">
                Click to flip back <span className="animate-pulse">←</span>
              </div>
            </div>
            <div className="absolute inset-0 bg-gradient-to-br from-violet-500/10 to-fuchsia-500/10 rounded-xl" />
          </div>
        </div>
      </div>
    </m.div>
  );
};

```

# app/(home)/_sections/Footer/Footer.tsx

```tsx
export default function Footer() {
  return (
    <>
      <footer className="bg-gray-900/80 backdrop-blur-sm py-16 border-t border-gray-800">
        <div className="container mx-auto px-6 lg:px-8">
          <div className="grid grid-cols-2 md:grid-cols-4 gap-12">
            <div className="space-y-6">
              <h3 className="text-lg font-semibold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent">
                Product
              </h3>
              <ul className="space-y-2">
                <li>
                  <a href="/featueres" className="text-gray-400 hover:text-white transition-colors">
                    Features
                  </a>
                </li>
                <li>
                  <a href="/pricing" className="text-gray-400 hover:text-white transition-colors">
                    Pricing
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Integrations
                  </a>
                </li>
              </ul>
            </div>
            <div>
              <h3 className="text-lg font-semibold mb-4">Company</h3>
              <ul className="space-y-2">
                <li>
                  <a href="about" className="text-gray-400 hover:text-white transition-colors">
                    About Us
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Careers
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Contact
                  </a>
                </li>
              </ul>
            </div>
            <div>
              <h3 className="text-lg font-semibold mb-4">Resources</h3>
              <ul className="space-y-2">
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Blog
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Help Center
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Webinars
                  </a>
                </li>
              </ul>
            </div>
            <div>
              <h3 className="text-lg font-semibold mb-4">Legal</h3>
              <ul className="space-y-2">
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Privacy Policy
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Terms of Service
                  </a>
                </li>
                <li>
                  <a href="/" className="text-gray-400 hover:text-white transition-colors">
                    Cookie Policy
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <div className="mt-12 pt-8 border-t border-gray-700 flex flex-col sm:flex-row justify-between items-center">
            <p className="text-gray-400">&copy; 2024 GymNavigator. All rights reserved.</p>
            <div className="flex space-x-4 mt-4 sm:mt-0">
              <a href="/" className="text-gray-400 hover:text-white transition-colors">
                <span className="sr-only">Facebook</span>
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    fillRule="evenodd"
                    d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"
                    clipRule="evenodd"
                  />
                </svg>
              </a>
              <a href="/" className="text-gray-400 hover:text-white transition-colors">
                <span className="sr-only">Twitter</span>
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
                </svg>
              </a>
              <a href="/" className="text-gray-400 hover:text-white transition-colors">
                <span className="sr-only">GitHub</span>
                <svg className="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    fillRule="evenodd"
                    d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
                    clipRule="evenodd"
                  />
                </svg>
              </a>
            </div>
          </div>
        </div>
      </footer>
    </>
  );
}

```

# app/(home)/_sections/Herosection/_components/DashboardStats.tsx

```tsx
"use client";

import { GradientCard } from "@/components/theme/GradientCard";
import { gymTheme } from "@/styles/theme";
import { m } from "framer-motion";
import { Activity, Dumbbell, UserCheck, UserCog, Users } from "lucide-react";
import { useEffect, useState } from "react";

export default function DashboardStats() {
  const [isClient, setIsClient] = useState(false);

  useEffect(() => {
    setIsClient(true);
  }, []);

  if (!isClient) {
    return <div className="w-[600px] h-[600px]" />; // Loading state
  }

  const dashboardCards = [
    {
      icon: Users,
      title: "Onboarded Users",
      value: "1,847",
      color: gymTheme.colors.gradients.primaryBlue,
      growth: "+22%",
    },
    {
      icon: UserCheck,
      title: "Today's Attendance",
      value: "234",
      color: gymTheme.colors.gradients.greenCard,
      growth: "+18%",
    },
    {
      icon: UserCog,
      title: "Trainer Dashboard",
      value: "16",
      color: gymTheme.colors.gradients.purpleCard,
      growth: "+5%",
    },
    {
      icon: Activity,
      title: "Active Users",
      value: "1,392",
      color: gymTheme.colors.gradients.orangeCard,
      growth: "+15%",
    },
  ];

  return (
    <m.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      className="relative w-[600px] h-[600px] perspective-1000"
    >
      {/* Dashboard Cards */}
      <div className="grid grid-cols-2 gap-6">
        {dashboardCards.map((card, i) => (
          <GradientCard
            key={card.title}
            icon={card.icon}
            title={card.title}
            value={card.value}
            growth={card.growth}
            color={card.color}
            index={i}
          />
        ))}
      </div>

      {/* Single floating badge for minimal animation */}
      <div className="absolute inset-0 pointer-events-none">
        <m.div
          className="absolute top-1/2 left-1/2"
          initial={{ opacity: 0 }}
          animate={{
            opacity: [0, 1, 0],
            scale: [0.5, 1, 0.5],
          }}
          transition={{
            duration: 3,
            repeat: Number.POSITIVE_INFINITY,
            repeatType: "reverse",
          }}
        >
          <div className="w-8 h-8 rounded-full bg-gradient-to-r from-blue-400 to-purple-500 flex items-center justify-center">
            <Dumbbell className="w-4 h-4 text-white" />
          </div>
        </m.div>
      </div>
    </m.div>
  );
} 
```

# app/(home)/_sections/Herosection/_components/MobileStats.tsx

```tsx
"use client";

import { m } from "framer-motion";
import { Sparkles, UserCheck, Users } from "lucide-react";
import { useEffect, useState } from "react";

export default function MobileStats() {
  const [isClient, setIsClient] = useState(false);

  useEffect(() => {
    setIsClient(true);
  }, []);

  if (!isClient) {
    return <div className="h-[200px]" />; // Loading state
  }

  const mobileStats = [
    { label: "Partner Gyms", value: "10+", icon: Users },
    { label: "Active Members", value: "100+", icon: UserCheck },
  ];

  const features = ["Easy Setup", "24/7 Support", "Secure"];

  return (
    <>
      {/* Mobile Stats */}
      <div className="grid grid-cols-2 gap-3 my-8">
        {mobileStats.map((stat) => (
          <div
            key={stat.label}
            className="bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10"
          >
            <stat.icon className="w-6 h-6 text-blue-400 mb-2" />
            <p className="text-2xl font-bold text-white">{stat.value}</p>
            <p className="text-sm text-gray-400">{stat.label}</p>
          </div>
        ))}
      </div>

      {/* Mobile Feature Highlights */}
      <m.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        className="flex flex-wrap gap-2 justify-center my-6"
      >
        {features.map((feature) => (
          <span
            key={feature}
            className="bg-blue-500/10 text-blue-300 text-sm px-3 py-1 rounded-full border border-blue-500/20 flex items-center gap-1"
          >
            <Sparkles className="w-3 h-3" />
            {feature}
          </span>
        ))}
      </m.div>
    </>
  );
} 
```

# app/(home)/_sections/Herosection/Herosection.tsx

```tsx
import CustomButton from "@/app/(home)/_component/CustomButton";
import DumbbellWrapper from "@/app/(home)/_component/Hero-section/DumbbellWrapper";
import { GradientBackground } from "@/components/theme/GradientBackground";
import { GradientText } from "@/components/theme/GradientText";
import { Button } from "@/components/ui/button";
import { ArrowRight } from "lucide-react";
import MobileStats from "./_components/MobileStats";

export default function Herosection() {
  return (
    <GradientBackground>
      <div className="container mx-auto px-4 sm:px-12 lg:px-16 relative">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-center">
          {/* Hero content */}
          <div className="space-y-6 lg:space-y-8 text-center lg:text-left relative z-10 py-8 lg:py-0">
            <div className="space-y-4 sm:space-y-6 max-w-2xl mx-auto lg:mx-0">
              <div>
                <h1 className="text-4xl sm:text-5xl lg:text-7xl font-bold leading-tight tracking-tight">
                  <span className="block mb-2 sm:mb-4 text-white/90">
                    Elevate Your
                  </span>
                  <GradientText>Gym Management</GradientText>
                </h1>
              </div>
              <p className="text-base sm:text-lg text-gray-300 leading-relaxed mt-4">
                Streamline operations, enhance member experience, and drive
                growth with our sophisticated management suite.
              </p>
            </div>

            {/* Mobile Stats Overview */}
            <div className="lg:hidden">
              <MobileStats />
            </div>

            <div className="flex flex-col sm:flex-row items-center justify-center lg:justify-start gap-4 sm:gap-6 mt-8">
              <CustomButton className="w-full sm:w-auto" />
              <Button
                variant="outline"
                className="w-full sm:w-auto hidden sm:flex items-center gap-2 bg-transparent border border-gray-700 text-gray-300 hover:bg-gray-800/50 hover:border-blue-500 hover:scale-105 font-medium px-6 py-3 rounded-lg transition-all duration-300"
              >
                <ArrowRight className="w-4 h-4 group-hover:translate-x-1 transition-transform" />
              </Button>
            </div>
          </div>

          <div className="hidden lg:flex justify-end">
            <DumbbellWrapper />
          </div>
        </div>
      </div>

      {/* Mobile-optimized scroll indicator */}
      <div className="absolute bottom-4 left-1/2 transform -translate-x-1/2 lg:bottom-8">
        <div className="text-blue-400 text-sm flex flex-col items-center gap-2">
          <span className="hidden sm:block text-xs text-gray-400">
            Scroll to explore
          </span>
          <ArrowRight className="w-4 h-4 rotate-90" />
        </div>
      </div>
    </GradientBackground>
  );
}

```

# app/(home)/_sections/Herosection/MobileHeroContent.tsx

```tsx
import { m } from 'framer-motion';
import { ArrowRight, Dumbbell, Sparkles, UserCheck, Users } from 'lucide-react';
import CustomButton from '../../_component/CustomButton';
import MobileHeroContent from './MobileHeroContent';

export default function Herosection() {
  const isMobile = window.innerWidth <= 768;

  return (
    <section className="relative overflow-hidden">
      {isMobile ? (
        <MobileHeroContent />
      ) : (
        <>
          {/* Desktop-specific background elements */}
          <div className="absolute inset-0 overflow-hidden">
            <div className="absolute w-[500px] h-[500px] rounded-full bg-blue-500/10 blur-3xl animate-pulse top-[-250px] left-[-250px]" />
            <div className="absolute w-[500px] h-[500px] rounded-full bg-indigo-500/10 blur-3xl animate-pulse bottom-[-250px] right-[-250px]" />
            <m.div
              initial={{ opacity: 0 }}
              animate={{ opacity: [0.1, 0.3, 0.1] }}
              transition={{ duration: 5, repeat: Number.POSITIVE_INFINITY }}
              className="absolute inset-0 bg-[url('/grid.svg')] bg-center [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black)]"
            />
          </div>

          <m.div className="space-y-6 text-center relative z-10 py-8">
            {/* Title and Description */}
            <div className="space-y-4 max-w-2xl mx-auto px-4">
              <m.div
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.3, duration: 0.8 }}
              >
                <h1 className="text-4xl sm:text-5xl font-bold leading-tight tracking-tight">
                  <span className="block mb-2 text-white/90">Elevate Your</span>
                  <span className="bg-gradient-to-r from-blue-400 via-blue-500 to-blue-600 bg-clip-text text-transparent inline-block animate-gradient">
                    Gym Management
                  </span>
                </h1>
              </m.div>
              <m.p
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                transition={{ delay: 0.6, duration: 0.8 }}
                className="text-base text-gray-300 leading-relaxed mt-4 px-4"
              >
                Streamline operations, enhance member experience, and drive growth with our
                sophisticated management suite.
              </m.p>
            </div>

            {/* Stats Cards */}
            <m.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.5 }}
              className="grid grid-cols-2 gap-3 mx-4"
            >
              {[
                { label: 'Partner Gyms', value: '10+', icon: Users },
                { label: 'Active Members', value: '100+', icon: UserCheck },
              ].map((stat, i) => (
                <m.div
                  key={stat.label}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ delay: i * 0.2 + 0.5 }}
                  className="bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10"
                >
                  <stat.icon className="w-6 h-6 text-blue-400 mb-2" />
                  <p className="text-2xl font-bold text-white">{stat.value}</p>
                  <p className="text-sm text-gray-400">{stat.label}</p>
                </m.div>
              ))}
            </m.div>

            {/* Feature Tags */}
            <m.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.7 }}
              className="flex flex-wrap gap-2 justify-center px-4"
            >
              {['Easy Setup', '24/7 Support', 'Secure'].map((feature, i) => (
                <m.span
                  key={feature}
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  transition={{ delay: i * 0.1 + 0.7 }}
                  className="bg-blue-500/10 text-blue-300 text-sm px-3 py-1 rounded-full border border-blue-500/20 flex items-center gap-1"
                >
                  <Sparkles className="w-3 h-3" />
                  {feature}
                </m.span>
              ))}
            </m.div>

            {/* CTA Buttons */}
            <div className="px-4">
              <CustomButton className="w-full text-lg py-3 mb-3" />
              <m.button
                whileTap={{ scale: 0.98 }}
                className="w-full px-6 py-3 rounded-full border border-gray-700 text-gray-300 flex items-center justify-center gap-2 hover:bg-white/5 transition-all"
              >
                Watch Demo
                <ArrowRight className="w-4 h-4" />
              </m.button>
            </div>
          </m.div>

          {/* Floating Elements */}
          <div className="absolute inset-0 pointer-events-none">
            {[...Array(3)].map((_, i) => (
              <m.div
                key={`desktop-float-${i as number}`}
                className="absolute"
                initial={{ opacity: 0, scale: 0 }}
                animate={{
                  opacity: [0, 1, 0],
                  scale: [0.5, 1, 0.5],
                  x: Math.sin(i * 45) * 100,
                  y: Math.cos(i * 45) * 100,
                }}
                transition={{
                  duration: 3,
                  delay: i * 0.5,
                  repeat: Number.POSITIVE_INFINITY,
                  repeatType: 'reverse',
                }}
              >
                <div className="w-6 h-6 rounded-full bg-gradient-to-r from-blue-400 to-purple-500 flex items-center justify-center">
                  <Dumbbell className="w-3 h-3 text-white" />
                </div>
              </m.div>
            ))}
          </div>
        </>
      )}
    </section>
  );
}

```

# app/(home)/_sections/Navbar/About/About.tsx

```tsx
const About = () => {
  return (
    <section id="about" className="py-20 bg-gray-900">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center">
          <h2 className="text-3xl font-extrabold text-white sm:text-4xl">About GymDominator</h2>
          <p className="mt-4 text-lg text-gray-400">
            Your ultimate gym management solution for better fitness tracking and member management.
          </p>
        </div>
      </div>
    </section>
  );
};

export default About;

```

# app/(home)/_sections/Navbar/Navbar.tsx

```tsx
'use client';
import { useSession } from '@/node_modules/next-auth/react';
import { AnimatePresence, m } from 'framer-motion';
import Image from 'next/image';
import Link from 'next/link';
import { useEffect, useState } from 'react';
import { BiChevronDown } from 'react-icons/bi';
import { HiMenu, HiX } from 'react-icons/hi';
import CustomButton from '../../_component/CustomButton';

// Add type definition
type MenuItem = {
  label: string;
  href: string;
  dropdownItems?: Array<{
    label: string;
    href: string;
  }>;
};

const Navbar = () => {
  const { data: session } = useSession();
  const [isOpen, setIsOpen] = useState(false);
  const [activeDropdown, setActiveDropdown] = useState<string | null>(null);
  const [isScrolled, setIsScrolled] = useState(false);

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 10);
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const menuItems: MenuItem[] = [
    {
      label: 'Contact Us',
      href: '/contact',
    },
    {
      label: 'About',
      href: '/about',
    },
    {
      label: 'Pricing',
      href: '/pricing',
    },
  ];

  return (
    <nav
      className={`fixed w-full z-50 transition-all duration-300 ${
        isScrolled ? 'bg-gradient-to-r from-gray-900 to-blue-900/95 shadow-lg' : 'bg-transparent'
      }`}
    >
      <div className="container mx-auto px-8 sm:px-12 lg:px-16">
        <div className="flex items-center justify-between h-16">
          <div className="flex-shrink-0">
            <Link href="/" className="flex items-center gap-2 hover:scale-105 transition-transform">
              <Image
                src="/favicon.ico"
                alt="Logo"
                width={32}
                height={32}
                className="rounded-full"
              />
              <span className="font-bold text-xl bg-gradient-to-r from-blue-400 via-blue-500 to-blue-600 bg-clip-text text-transparent">
                GymNavigator
              </span>
            </Link>
          </div>

          {/* Desktop Menu */}
          <div className="hidden md:flex items-center space-x-4">
            <div className="flex items-center space-x-4">
              {menuItems.map((item) => (
                <div
                  key={item.label}
                  className="relative group"
                  onMouseEnter={() => setActiveDropdown(item.label)}
                  onMouseLeave={() => setActiveDropdown(null)}
                >
                  <Link
                    href={item.href}
                    className="flex items-center text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors"
                  >
                    {item.label}
                    {item.dropdownItems && <BiChevronDown className="ml-1 h-4 w-4" />}
                  </Link>

                  {item.dropdownItems && activeDropdown === item.label && (
                    <div className="absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-gray-800 ring-1 ring-black ring-opacity-5">
                      <div className="py-1">
                        {item.dropdownItems.map((dropdownItem) => (
                          <Link
                            key={dropdownItem.label}
                            href={dropdownItem.href}
                            className="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white"
                          >
                            {dropdownItem.label}
                          </Link>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>

            <CustomButton text={session ? 'Dashboard' : 'Login'} />
          </div>

          {/* Mobile menu button */}
          <div className="md:hidden">
            <button
              type="button"
              onClick={() => setIsOpen(!isOpen)}
              className="text-gray-400 hover:text-white focus:outline-none"
            >
              {isOpen ? <HiX className="h-6 w-6" /> : <HiMenu className="h-6 w-6" />}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile Menu Overlay */}
      <AnimatePresence>
        {isOpen && (
          <>
            <m.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              transition={{ duration: 0.3 }}
              className="fixed inset-0 bg-black/70 backdrop-blur-md md:hidden"
              onClick={() => setIsOpen(false)}
            />
            <m.div
              initial={{ x: '100%', opacity: 0 }}
              animate={{ x: 0, opacity: 1 }}
              exit={{ x: '100%', opacity: 0 }}
              transition={{
                type: 'spring',
                damping: 30,
                stiffness: 300,
                duration: 0.3,
              }}
              className="fixed right-0 top-0 bottom-0 w-[80%] max-w-sm bg-gradient-to-b from-gray-900 to-gray-800 md:hidden shadow-2xl border-l border-gray-700/50"
            >
              <div className="flex flex-col h-full">
                <div className="flex items-center justify-between p-5 border-b border-gray-700/50">
                  <span className="text-lg font-semibold text-white bg-gradient-to-r from-blue-400 to-blue-600 bg-clip-text text-transparent">
                    Menu
                  </span>
                  <m.button
                    whileTap={{ scale: 0.9 }}
                    onClick={() => setIsOpen(false)}
                    className="p-2 rounded-full hover:bg-gray-800/80 transition-colors"
                  >
                    <HiX className="h-6 w-6 text-gray-400" />
                  </m.button>
                </div>

                <div className="flex-1 overflow-y-auto py-4 space-y-1">
                  {menuItems.map((item, index) => (
                    <m.div
                      key={item.label}
                      initial={{ opacity: 0, x: 20 }}
                      animate={{ opacity: 1, x: 0 }}
                      transition={{ delay: index * 0.1 }}
                    >
                      <Link
                        href={item.href}
                        className="flex items-center space-x-2 text-gray-300 hover:bg-blue-500/10 hover:text-blue-400 px-5 py-3 transition-all rounded-lg mx-2"
                        onClick={() => setIsOpen(false)}
                      >
                        <span className="text-base font-medium">{item.label}</span>
                        {item.dropdownItems && <BiChevronDown className="h-5 w-5" />}
                      </Link>
                      {item.dropdownItems && (
                        <div className="pl-4 bg-gray-800/30 rounded-lg mx-2 my-1">
                          {item.dropdownItems.map((dropdownItem) => (
                            <Link
                              key={dropdownItem.label}
                              href={dropdownItem.href}
                              className="block text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 px-4 py-2.5 text-sm rounded-lg transition-colors"
                              onClick={() => setIsOpen(false)}
                            >
                              {dropdownItem.label}
                            </Link>
                          ))}
                        </div>
                      )}
                    </m.div>
                  ))}
                </div>

                <m.div
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ delay: 0.3 }}
                  className="p-5 border-t border-gray-700/50"
                >
                  <CustomButton
                    className="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700"
                    text={session ? 'Dashboard' : 'Login'}
                  />
                </m.div>
              </div>
            </m.div>
          </>
        )}
      </AnimatePresence>
    </nav>
  );
};

export default Navbar;

```

# app/(home)/_sections/testimonials/InfiniteMovingCards.tsx

```tsx
'use client';
import { m } from 'framer-motion';
import Image from 'next/image';
import { useEffect, useRef, useState } from 'react';

export type TestimonialItem = {
  image: string;
  quote: string;
  author: string;
  role: string;
  location: string;
  rating: number;
  growth: string;
};

export const InfiniteMovingCards = ({
  items,
  direction = 'left',
  speed = 'fast',
  pauseOnHover = true,
}: {
  items: TestimonialItem[];
  direction?: 'left' | 'right';
  speed?: 'fast' | 'normal' | 'slow';
  pauseOnHover?: boolean;
}) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const [start, setStart] = useState(false);
  const [isHovered, setIsHovered] = useState(false);

  useEffect(() => {
    setTimeout(() => setStart(true), 100);
  }, []);

  const speeds = {
    fast: 20,
    normal: 35,
    slow: 50,
  };

  return (
    <div
      className="relative overflow-hidden"
      ref={containerRef}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      <m.div
        className="flex gap-6 w-max"
        animate={
          start
            ? {
                x: direction === 'left' ? ['0%', '-50%'] : ['-50%', '0%'],
              }
            : {}
        }
        transition={{
          duration: speeds[speed],
          ease: 'linear',
          repeat: Number.POSITIVE_INFINITY,
          paused: pauseOnHover && isHovered,
        }}
      >
        {[...items, ...items].map((item, idx) => (
          <div
            key={idx as number}
            className="relative group w-[280px] sm:w-[350px] md:w-[450px] h-[350px] sm:h-[400px] md:h-[450px] bg-gradient-to-br from-gray-900 to-gray-800 rounded-xl sm:rounded-2xl border border-gray-800 overflow-hidden"
          >
            <div className="absolute inset-0 bg-gradient-to-br from-blue-500/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
            <div className="p-4 sm:p-6 md:p-8 relative z-10 h-full flex flex-col">
              {/* Rating Stars and Growth */}
              <div className="flex justify-between items-center mb-4 sm:mb-6">
                <div className="flex gap-0.5 sm:gap-1">
                  {[...Array(item.rating)].map((_, i) => (
                    <span key={i as number} className="text-yellow-500 text-sm sm:text-base">
                      ★
                    </span>
                  ))}
                </div>
                <div className="px-2 py-0.5 sm:px-3 sm:py-1 bg-green-500/20 rounded-full">
                  <span className="text-green-400 text-xs sm:text-sm font-medium">
                    ↑ {item.growth}
                  </span>
                </div>
              </div>

              {/* Quote */}
              <div className="mb-4 sm:mb-6">
                <blockquote className="text-sm sm:text-base md:text-lg text-zinc-300">
                  &ldquo;{item.quote}&rdquo;
                </blockquote>
              </div>

              {/* Profile */}
              <div className="mt-auto flex items-center gap-3 sm:gap-4">
                <div className="w-10 h-10 sm:w-12 sm:h-12 rounded-full overflow-hidden ring-2 ring-blue-500/20">
                  <Image
                    src={item.image}
                    alt={item.author}
                    width={48}
                    height={48}
                    className="w-full h-full object-cover"
                  />
                </div>
                <div>
                  <h4 className="text-base sm:text-lg font-semibold text-white">{item.author}</h4>
                  <p className="text-xs sm:text-sm text-zinc-400">{item.role}</p>
                  <p className="text-xs sm:text-sm text-blue-400">{item.location}</p>
                </div>
              </div>
            </div>
          </div>
        ))}
      </m.div>
    </div>
  );
};

```

# app/(home)/_sections/testimonials/profile-images/ProfileMale.tsx

```tsx

```

# app/(home)/_sections/testimonials/TestimonialsCard.tsx

```tsx
import { Card, CardContent } from '@/components/ui/card';
import { Star } from 'lucide-react';
export default function TestimonialCard({
  quote,
  author,
  role,
}: {
  quote: string;
  author: string;
  role: string;
}) {
  return (
    <Card className="bg-gray-800 border-none">
      <CardContent className="p-6">
        <div className="flex mb-4">
          {[1, 2, 3, 4, 5].map((star) => (
            <Star key={star} className="h-5 w-5 text-yellow-400 fill-current" />
          ))}
        </div>
        <p className="text-gray-300 mb-4">{quote}</p>
        <div>
          <p className="font-semibold">{author}</p>
          <p className="text-sm text-gray-400">{role}</p>
        </div>
      </CardContent>
    </Card>
  );
}

```

# app/(home)/_sections/testimonials/TestimonialsSection.tsx

```tsx
import { Sparkles } from 'lucide-react';
import { InfiniteMovingCards } from './InfiniteMovingCards';

const profileAvatarSrc =
  'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyMCIgY3k9IjIwIiByPSIyMCIgZmlsbD0iIzFFNDBBRiIvPjxjaXJjbGUgY3g9IjIwIiBjeT0iMTUiIHI9IjciIGZpbGw9IiM2MEE1RkEiLz48cGF0aCBkPSJNOCAzNS41QzggMzUuNSAxMSAyNSAyMCAyNUMyOSAyNSAzMiAzNS41IDMyIDM1LjUiIHN0cm9rZT0iIzYwQTVGQSIgc3Ryb2tlV2lkdGg9IjMiLz48L3N2Zz4=';

const testimonials = [
  {
    image: profileAvatarSrc,
    quote:
      "GymNavigator transformed our daily operations. From QR attendance to AI-powered diet plans, we've seen 200% membership growth in just 6 months!",
    author: 'Arjun Patel',
    role: 'Founder, Shakti Fitness Hub',
    location: 'Mumbai',
    rating: 5,
    growth: '200%',
  },
  {
    image: profileAvatarSrc,
    quote:
      'Perfect example of digital transformation. Our trainers now focus on members instead of paperwork. Member satisfaction is at an all-time high!',
    author: 'Priya Reddy',
    role: 'Director, FitIndia Studios',
    location: 'Bangalore',
    rating: 5,
    growth: '150%',
  },
  {
    image: profileAvatarSrc,
    quote:
      "AI-driven analytics took our gym's performance to new heights. Revenue increased by 80% within the first quarter of implementation.",
    author: 'Kabir Singh',
    role: 'CEO, PowerFlex Gyms',
    location: 'Delhi',
    rating: 5,
    growth: '80%',
  },
  {
    image: profileAvatarSrc,
    quote:
      'Personalized diet plans and workout tracking doubled our member success rate. The automated progress updates keep members motivated!',
    author: 'Meera Desai',
    role: 'Nutritionist & Owner',
    location: 'Pune',
    rating: 5,
    growth: '120%',
  },
  {
    image: profileAvatarSrc,
    quote:
      'Cloud-based management system helped unite our multi-branch gyms seamlessly. Managing multiple locations has never been easier.',
    author: 'Rajesh Malhotra',
    role: 'Chain Owner, StrongLife',
    location: 'Hyderabad',
    rating: 5,
    growth: '175%',
  },
];

export default function TestimonialsSection() {
  return (
    <section className="py-12 sm:py-24 bg-gradient-to-b from-black to-gray-950 relative overflow-hidden">
      <div className="absolute inset-0 bg-grid-white/[0.02] bg-[size:50px]" />
      <div className="container mx-auto px-4 relative z-10">
        <div className="text-center mb-10 sm:mb-20">
          <div className="inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full bg-blue-500/10 border border-blue-500/20 mb-4">
            <Sparkles className="w-3 h-3 sm:w-4 sm:h-4 text-blue-400" />
            <span className="text-xs sm:text-sm text-blue-400">Success Stories</span>
          </div>
          <h2 className="text-3xl sm:text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-blue-500 to-blue-600 mb-4 sm:mb-6">
            Transforming Fitness Business Across India
          </h2>
          <p className="text-base sm:text-lg text-zinc-400 max-w-2xl mx-auto px-4">
            Join the community of successful gym owners who revolutionized their business with
            GymNavigator
          </p>
        </div>

        <div className="relative h-[400px] sm:h-[500px] w-full overflow-hidden rounded-lg sm:rounded-xl">
          <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent z-20 pointer-events-none" />
          <InfiniteMovingCards items={testimonials} direction="right" speed="slow" />
        </div>
      </div>
    </section>
  );
}

```

# app/(home)/(pages)/_assests/logo.webp

This is a binary file of the type: Image

# app/(home)/(pages)/about/page.tsx

```tsx
import AboutUs from '../../_component/AboutUs';

export default async function About() {
  return <AboutUs />;
}

```

# app/(home)/(pages)/contact/page.tsx

```tsx
import ContactUs from '../../_component/ContactUs';

export default async function Contact() {
  return <ContactUs />;
}

```

# app/(home)/(pages)/layout.tsx

```tsx
import Navbar from '../_sections/Navbar/Navbar';

export default function PagesLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <main className="bg-gradient-to-b from-gray-950 via-gray-900 to-black text-white min-h-screen overflow-hidden">
      <Navbar />
      {children}
    </main>
  );
}

```

# app/(home)/(pages)/pricing/page.tsx

```tsx
import Pricing from '../../_component/Pricing/Pricing';

export default async function PricingPage() {
  return <Pricing />;
}

```

# app/(home)/Homepage.tsx

```tsx
import Footer from "@/app/(home)/_sections/Footer/Footer";
import Herosection from "@/app/(home)/_sections/Herosection/Herosection";
import Navbar from "@/app/(home)/_sections/Navbar/Navbar";
import CtaSection from "@/app/(home)/_sections/cta/CtaSection";
import FaqSection from "@/app/(home)/_sections/faq/FaqSection";
import FeaturesSection from "@/app/(home)/_sections/features/FeaturesSection";
import TestimonialsSection from "@/app/(home)/_sections/testimonials/TestimonialsSection";
export const dynamic = "force-dynamic";
export default async function Homepage() {
  return (
    <main className="bg-gradient-to-b from-gray-950 via-gray-900 to-black text-white min-h-screen overflow-hidden">
      <Navbar />
      <Herosection />
      <FeaturesSection />
      <TestimonialsSection />
      <FaqSection />
      <CtaSection />
      <Footer />
    </main>
  );
}

```

# app/(home)/page.tsx

```tsx
import Homepage from './Homepage';

export default async function page() {
  return (
    <>
      <Homepage />
    </>
  );
}

```

# app/(home)/testimonials/InfiniteMovingCards.tsx

```tsx
'use client';
import { m } from 'framer-motion';
import Image from 'next/image';
import { useEffect, useRef, useState } from 'react';

export type TestimonialItem = {
  image: string;
  quote: string;
  author: string;
  role: string;
  location: string;
  rating: number;
  growth: string;
};

export const InfiniteMovingCards = ({
  items,
  direction = 'left',
  speed = 'fast',
  pauseOnHover = true,
}: {
  items: TestimonialItem[];
  direction?: 'left' | 'right';
  speed?: 'fast' | 'normal' | 'slow';
  pauseOnHover?: boolean;
}) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const [start, setStart] = useState(false);
  const [isHovered, setIsHovered] = useState(false);

  useEffect(() => {
    setTimeout(() => setStart(true), 100);
  }, []);

  const speeds = {
    fast: 20,
    normal: 35,
    slow: 50,
  };

  return (
    <div
      className="relative overflow-hidden"
      ref={containerRef}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      <m.div
        className="flex gap-6 w-max"
        animate={
          start
            ? {
                x: direction === 'left' ? ['0%', '-50%'] : ['-50%', '0%'],
              }
            : {}
        }
        transition={{
          duration: speeds[speed],
          ease: 'linear',
          repeat: Number.POSITIVE_INFINITY,
          paused: pauseOnHover && isHovered,
        }}
      >
        {[...items, ...items].map((item, idx) => (
          <div
            key={idx as number}
            className="relative group w-[280px] sm:w-[350px] md:w-[450px] h-[350px] sm:h-[400px] md:h-[450px] bg-gradient-to-br from-gray-900 to-gray-800 rounded-xl sm:rounded-2xl border border-gray-800 overflow-hidden"
          >
            <div className="absolute inset-0 bg-gradient-to-br from-blue-500/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
            <div className="p-4 sm:p-6 md:p-8 relative z-10 h-full flex flex-col">
              {/* Rating Stars and Growth */}
              <div className="flex justify-between items-center mb-4 sm:mb-6">
                <div className="flex gap-0.5 sm:gap-1">
                  {[...Array(item.rating)].map((_, i) => (
                    <span key={i as number} className="text-yellow-500 text-sm sm:text-base">
                      ★
                    </span>
                  ))}
                </div>
                <div className="px-2 py-0.5 sm:px-3 sm:py-1 bg-green-500/20 rounded-full">
                  <span className="text-green-400 text-xs sm:text-sm font-medium">
                    ↑ {item.growth}
                  </span>
                </div>
              </div>

              {/* Quote */}
              <div className="mb-4 sm:mb-6">
                <blockquote className="text-sm sm:text-base md:text-lg text-zinc-300">
                  &ldquo;{item.quote}&rdquo;
                </blockquote>
              </div>

              {/* Profile */}
              <div className="mt-auto flex items-center gap-3 sm:gap-4">
                <div className="w-10 h-10 sm:w-12 sm:h-12 rounded-full overflow-hidden ring-2 ring-blue-500/20">
                  <Image
                    src={item.image}
                    alt={item.author}
                    width={48}
                    height={48}
                    className="w-full h-full object-cover"
                  />
                </div>
                <div>
                  <h4 className="text-base sm:text-lg font-semibold text-white">{item.author}</h4>
                  <p className="text-xs sm:text-sm text-zinc-400">{item.role}</p>
                  <p className="text-xs sm:text-sm text-blue-400">{item.location}</p>
                </div>
              </div>
            </div>
          </div>
        ))}
      </m.div>
    </div>
  );
};

```

# app/(home)/testimonials/profile-images/ProfileMale.tsx

```tsx

```

# app/(home)/testimonials/TestimonialsCard.tsx

```tsx
import { Card, CardContent } from '@/components/ui/card';
import { Star } from 'lucide-react';
export default function TestimonialCard({
  quote,
  author,
  role,
}: {
  quote: string;
  author: string;
  role: string;
}) {
  return (
    <Card className="bg-gray-800 border-none">
      <CardContent className="p-6">
        <div className="flex mb-4">
          {[1, 2, 3, 4, 5].map((star) => (
            <Star key={star} className="h-5 w-5 text-yellow-400 fill-current" />
          ))}
        </div>
        <p className="text-gray-300 mb-4">{quote}</p>
        <div>
          <p className="font-semibold">{author}</p>
          <p className="text-sm text-gray-400">{role}</p>
        </div>
      </CardContent>
    </Card>
  );
}

```

# app/(home)/testimonials/TestimonialsSection.tsx

```tsx
import { Sparkles } from 'lucide-react';
import { InfiniteMovingCards } from './InfiniteMovingCards';

const profileAvatarSrc =
  'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyMCIgY3k9IjIwIiByPSIyMCIgZmlsbD0iIzFFNDBBRiIvPjxjaXJjbGUgY3g9IjIwIiBjeT0iMTUiIHI9IjciIGZpbGw9IiM2MEE1RkEiLz48cGF0aCBkPSJNOCAzNS41QzggMzUuNSAxMSAyNSAyMCAyNUMyOSAyNSAzMiAzNS41IDMyIDM1LjUiIHN0cm9rZT0iIzYwQTVGQSIgc3Ryb2tlV2lkdGg9IjMiLz48L3N2Zz4=';

const testimonials = [
  {
    image: profileAvatarSrc,
    quote:
      "GymNavigator transformed our daily operations. From QR attendance to AI-powered diet plans, we've seen 200% membership growth in just 6 months!",
    author: 'Arjun Patel',
    role: 'Founder, Shakti Fitness Hub',
    location: 'Mumbai',
    rating: 5,
    growth: '200%',
  },
  {
    image: profileAvatarSrc,
    quote:
      'Perfect example of digital transformation. Our trainers now focus on members instead of paperwork. Member satisfaction is at an all-time high!',
    author: 'Priya Reddy',
    role: 'Director, FitIndia Studios',
    location: 'Bangalore',
    rating: 5,
    growth: '150%',
  },
  {
    image: profileAvatarSrc,
    quote:
      "AI-driven analytics took our gym's performance to new heights. Revenue increased by 80% within the first quarter of implementation.",
    author: 'Kabir Singh',
    role: 'CEO, PowerFlex Gyms',
    location: 'Delhi',
    rating: 5,
    growth: '80%',
  },
  {
    image: profileAvatarSrc,
    quote:
      'Personalized diet plans and workout tracking doubled our member success rate. The automated progress updates keep members motivated!',
    author: 'Meera Desai',
    role: 'Nutritionist & Owner',
    location: 'Pune',
    rating: 5,
    growth: '120%',
  },
  {
    image: profileAvatarSrc,
    quote:
      'Cloud-based management system helped unite our multi-branch gyms seamlessly. Managing multiple locations has never been easier.',
    author: 'Rajesh Malhotra',
    role: 'Chain Owner, StrongLife',
    location: 'Hyderabad',
    rating: 5,
    growth: '175%',
  },
];

export default function TestimonialsSection() {
  return (
    <section className="py-12 sm:py-24 bg-gradient-to-b from-black to-gray-950 relative overflow-hidden">
      <div className="absolute inset-0 bg-grid-white/[0.02] bg-[size:50px]" />
      <div className="container mx-auto px-4 relative z-10">
        <div className="text-center mb-10 sm:mb-20">
          <div className="inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full bg-blue-500/10 border border-blue-500/20 mb-4">
            <Sparkles className="w-3 h-3 sm:w-4 sm:h-4 text-blue-400" />
            <span className="text-xs sm:text-sm text-blue-400">Success Stories</span>
          </div>
          <h2 className="text-3xl sm:text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-blue-500 to-blue-600 mb-4 sm:mb-6">
            Transforming Fitness Business Across India
          </h2>
          <p className="text-base sm:text-lg text-zinc-400 max-w-2xl mx-auto px-4">
            Join the community of successful gym owners who revolutionized their business with
            GymNavigator
          </p>
        </div>

        <div className="relative h-[400px] sm:h-[500px] w-full overflow-hidden rounded-lg sm:rounded-xl">
          <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent z-20 pointer-events-none" />
          <InfiniteMovingCards items={testimonials} direction="right" speed="slow" />
        </div>
      </div>
    </section>
  );
}

```

# app/api/auth/[...nextauth]/route.ts

```ts
import { handlers } from '@/app/(auth)/auth';
export const { GET, POST } = handlers;

```

# app/api/owner/onboarding/onbordingusers/route.ts

```ts
import { getOnboardingUsersServer } from '@/app/dashboard/owner/onboarding/onboardedusers/actions/GetOnBoardingUser';
import { NextResponse } from 'next/server';

export async function GET() {
  try {
    const data = await getOnboardingUsersServer();
    return NextResponse.json(data);
  } catch (error) {
    console.error('API Route Error:', error);
    return NextResponse.json({ message: 'Failed to fetch onboarding users' }, { status: 500 });
  }
}

```

# app/api/route.ts

```ts
import { handlers } from '@/app/(auth)/auth';
export const { GET, POST } = handlers;

```

# app/api/uploadimage/route.ts

```ts
import uploadImage from '@/app/(common)/_actions/clouldnary/UploadImageSA';
// app/api/upload/route.ts
import { type NextRequest, NextResponse } from 'next/server';

export async function POST(req: NextRequest) {
  try {
    const { image } = await req.json();
    console.log('Received image:', image);

    if (!image) {
      return NextResponse.json({ error: 'No image provided' }, { status: 400 });
    }

    const url = await uploadImage(image);
    return NextResponse.json({ msg: 'success', url });
  } catch (error) {
    console.error('Error in upload route:', error);
    return NextResponse.json({ msg: 'failed', error: error }, { status: 500 });
  }
}

// export const config = {
//   api: {
//     bodyParser: {
//       sizeLimit: '10mb', // Adjust the size limit as needed
//     },
//   },

// }

```

# app/assests/features/1.png

This is a binary file of the type: Image

# app/assests/features/2.png

This is a binary file of the type: Image

# app/assests/features/3.png

This is a binary file of the type: Image

# app/assests/features/5.png

This is a binary file of the type: Image

# app/assests/features/6.png

This is a binary file of the type: Image

# app/assests/features/attendnace.png

This is a binary file of the type: Image

# app/assests/features/createworkouts.png

This is a binary file of the type: Image

# app/assests/features/gymdetails.png

This is a binary file of the type: Image

# app/assests/features/Todaysattenadance.png

This is a binary file of the type: Image

# app/assests/features/workoutassignment.png

This is a binary file of the type: Image

# app/assests/gemini-thinking-icon.webp

This is a binary file of the type: Image

# app/assests/gym-manager.webp

This is a binary file of the type: Image

# app/assests/gymd.webp

This is a binary file of the type: Image

# app/assests/gymheroImg.webp

This is a binary file of the type: Image

# app/assests/owner-1.png

This is a binary file of the type: Image

# app/assests/owner-2.png

This is a binary file of the type: Image

# app/assests/trainer-1.png

This is a binary file of the type: Image

# app/assests/trainer-2.png

This is a binary file of the type: Image

# app/dashboard/_components/ClientSideProvider.tsx

```tsx
'use client';

import { useSession } from 'next-auth/react';
import { usePathname, useRouter } from 'next/navigation';
import { useEffect } from 'react';

interface ClientSideProviderProps {
  children: React.ReactNode;
}

export default function ClientSideProvider({ children }: ClientSideProviderProps) {
  const { data: session } = useSession();
  const router = useRouter();
  const pathname = usePathname();

  useEffect(() => {
    if (session?.user) {
      const { role } = session.user;
      // Get the base path parts to check permissions
      const pathParts = pathname.split('/');
      if (pathParts.length >= 3 && pathParts[2] !== role) {
        // Redirect if user tries to access a dashboard they don't have permission for
        router.push(`/dashboard/${role}`);
      }
    }
  }, [session, pathname, router]);

  return <>{children}</>;
}

```

# app/dashboard/_components/DashboardBottomNav.tsx

```tsx
'use client';

import BottomNavigation from '@/components/common/Bottomnavigation/bottomnavigation';
import { useSession } from 'next-auth/react';
import {
  ClientDashboardMenuItems,
  type MenuItem,
  OwnerDashboardMenuItems,
  TrainerDashboardMenuItems,
} from './menuItems';

export default function DashboardBottomNav() {
  const { data: session } = useSession();

  // Determine which menu items to show based on user role
  let menuItems: MenuItem[] = ClientDashboardMenuItems; // Default

  if (session?.role === 'owner') {
    menuItems = OwnerDashboardMenuItems;
  } else if (session?.role === 'trainer') {
    menuItems = TrainerDashboardMenuItems;
  }

  return <BottomNavigation menuItems={menuItems} />;
}

```

# app/dashboard/_components/DashboardStats.tsx

```tsx
import { Card } from '@/components/ui/card';
import { Calendar, Dumbbell, TrendingUp, Users } from 'lucide-react';
import React from 'react';

interface DashboardStatsProps {
  data: {
    stats: {
      totalMembers: number;
      activeTrainers: number;
      todayAttendance: number;
      revenue: number;
    };
    recentActivities: Array<{
      name: string;
      Validperiod?: {
        startDate: string;
        shift: string;
      };
    }>;
  };
}

export default function DashboardStats({ data }: DashboardStatsProps) {
  const { stats, recentActivities } = data;

  const statCards = [
    {
      label: 'Total Members',
      value: stats.totalMembers.toString(),
      icon: Users,
      color: 'text-blue-500',
    },
    {
      label: 'Active Trainers',
      value: stats.activeTrainers.toString(),
      icon: Dumbbell,
      color: 'text-green-500',
    },
    {
      label: "Today's Attendance",
      value: stats.todayAttendance.toString(),
      icon: Calendar,
      color: 'text-purple-500',
    },
    {
      label: 'Active Gyms',
      value: '1',
      icon: TrendingUp,
      color: 'text-orange-500',
    },
  ];

  return (
    <div className="p-8 max-w-7xl mx-auto">
      <div className="space-y-8">
        {/* Welcome Header */}
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tight">Welcome back, Owner</h1>
          <p className="text-gray-500">
            Here&apos;s what&apos;s happening across your fitness empire today.
          </p>
        </div>

        {/* Quick Stats */}
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
          {statCards.map((stat, index) => (
            <Card key={index as number} className="p-6 hover:shadow-lg transition-shadow">
              <div className="flex items-center space-x-4">
                <div className={`p-3 rounded-full bg-gray-100 ${stat.color}`}>
                  <stat.icon className="w-6 h-6" />
                </div>
                <div>
                  <p className="text-sm font-medium text-gray-500">{stat.label}</p>
                  <h3 className="text-2xl font-bold">{stat.value}</h3>
                </div>
              </div>
            </Card>
          ))}
        </div>

        {/* Recent Activity Preview */}
        <Card className="p-6">
          <h2 className="text-xl font-semibold mb-4">Recent Activities</h2>
          <div className="space-y-4">
            {recentActivities.map((activity, index) => (
              <div key={index as number} className="flex items-center space-x-3 text-gray-600">
                <Calendar className="w-4 h-4" />
                <span>
                  {activity.name} -{' '}
                  {activity.Validperiod
                    ? `Joined ${new Date(activity.Validperiod.startDate).toLocaleDateString()} (${
                        activity.Validperiod.shift
                      } shift)`
                    : 'New member added'}
                </span>
              </div>
            ))}
          </div>
        </Card>
      </div>
    </div>
  );
}

```

# app/dashboard/_components/DashboardTopBar.tsx

```tsx
'use client';

import { useSession } from 'next-auth/react';
import { usePathname } from 'next/navigation';
import { Suspense } from 'react';
import { Skeleton } from '../../../components/ui/skeleton';
import TopBar from './TopBar';
import {
  ClientDashboardMenuItems,
  type MenuItem,
  OwnerDashboardMenuItems,
  TrainerDashboardMenuItems,
} from './menuItems';

export default function DashboardTopBar() {
  const { data: session, status } = useSession();

  // Determine which menu items to show based on user role
  let menuItems: MenuItem[] = ClientDashboardMenuItems; // Default

  if (session?.role === 'owner') {
    menuItems = OwnerDashboardMenuItems;
  } else if (session?.role === 'trainer') {
    menuItems = TrainerDashboardMenuItems;
  }

  return (
    <Suspense fallback={<Skeleton className="h-10 w-64 mx-auto" />}>
      <TopBar menuItems={menuItems} userRole={session?.role} status={status} />
    </Suspense>
  );
}

```

# app/dashboard/_components/ErrorScreen.tsx

```tsx
'use client';
import { Card } from '@/components/ui/card';
import { ArrowRight, Building2 } from 'lucide-react';

interface ErrorScreenProps {
  error?: string;
}

export default function ErrorScreen({ error }: ErrorScreenProps) {
  return (
    <div className="min-h-[80vh] flex items-center justify-center p-4">
      <Card className="max-w-md w-full p-8 text-center space-y-4">
        <div className="mx-auto w-16 h-16 bg-red-50 rounded-full flex items-center justify-center">
          <Building2 className="w-8 h-8 text-red-500" />
        </div>

        <h2 className="text-xl font-semibold text-gray-800">Unable to Load Dashboard</h2>
        <p className="text-gray-600">
          {error || 'There was an error loading your dashboard data. Please try again later.'}
        </p>

        <button
          onClick={() => window.location.reload()}
          className="inline-flex items-center gap-2 px-4 py-2 text-sm text-blue-600 hover:text-blue-700"
          type="button"
        >
          <span>Refresh Page</span>
          <ArrowRight className="w-4 h-4" />
        </button>
      </Card>
    </div>
  );
}

```

# app/dashboard/_components/GetDashboardData.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import { AxiosError, type AxiosResponse } from 'axios';

interface DashboardStats {
  totalMembers: number;
  activeTrainers: number;
  todayAttendance: number;
  revenue: number;
}

interface RecentActivity {
  name: string;
  createdAt: string;
  Validperiod: {
    startDate: string;
    shift: string;
  } | null;
}

interface DashboardData {
  stats: DashboardStats;
  recentActivities: RecentActivity[];
}

interface DashboardResponse {
  msg: string;
  data: DashboardData;
}

interface DashboardError {
  error: string;
  msg?: string;
}

type DashboardResult = DashboardData | DashboardError;

export async function GetDashboardData(): Promise<DashboardResult> {
  try {
    const ownerAxios = await OwnerReqConfig();
    const response: AxiosResponse<DashboardResponse> = await ownerAxios.get('/getdashboarddata');

    if (response.data.data) {
      return response.data.data;
    }

    return {
      error: 'Failed to fetch dashboard data',
    };
  } catch (err) {
    if (err instanceof AxiosError) {
      // Handle specific API errors
      if (err.response?.status === 404) {
        return {
          error: 'NO_GYM_FOUND',
          msg: 'No gym profile found. Please create your gym profile to continue.',
        };
      }

      return {
        error: err.response?.data?.msg || 'An error occurred while fetching dashboard data',
      };
    }

    return {
      error: 'An unexpected error occurred',
    };
  }
}

```

# app/dashboard/_components/menuItems.ts

```ts
import {
  Building2,
  CalendarCheck,
  ClipboardCheck,
  ClipboardList,
  Dumbbell,
  Eye,
  UtensilsCrossed as ForkKnife,
  Home,
  ListChecks,
  MapPin,
  Plus,
  QrCode,
  ShoppingBasket,
  UserCheck,
  UserPlus,
  Users,
  UtensilsCrossed,
} from 'lucide-react';

export interface SubItem {
  name: string;
  link: string;
  label: string;
  iconName: string; // Added iconName property
}

export interface MenuItem {
  name: string;
  iconName: string;
  label: string;
  subItems?: SubItem[];
  link?: string;
}

export const OwnerDashboardMenuItems: MenuItem[] = [
  {
    name: 'Gym',
    iconName: 'Building2',
    label: 'gymDetails',
    subItems: [
      {
        name: 'View Details',
        link: '/dashboard/owner/gymdetails/viewgymdetails',
        label: 'viewGymDetails',
        iconName: 'Eye',
      },
    ],
  },
  {
    name: 'Trainers',
    iconName: 'UserCheck',
    label: 'trainers',
    subItems: [
      {
        name: 'View Trainers',
        link: '/dashboard/owner/trainers/viewtrainers',
        label: 'viewTrainers',
        iconName: 'Eye',
      },
      {
        name: 'Assign Trainers',
        link: '/dashboard/owner/trainers/userstrainersassignment',
        label: 'userstrainersassignment',
        iconName: 'UserPlus',
      },
    ],
  },
  {
    name: 'On-boarding',
    label: 'Onboarding',
    iconName: 'ClipboardList',
    link: '/dashboard/owner/onboarding/onboarding',
    subItems: [
      {
        name: 'Onboarding Users',
        label: 'onboarded users',
        link: '/dashboard/owner/onboarding/onboardedusers',
        iconName: 'Users',
      },
      {
        name: 'Onboarding QR',
        label: 'onboarding QR',
        link: '/dashboard/owner/onboarding/onboardingqr',
        iconName: 'QrCode',
      },
    ],
  },
  {
    name: 'Attendance',
    iconName: 'CalendarCheck',
    label: 'attendance',
    subItems: [
      {
        name: "Today's Attendance",
        link: '/dashboard/owner/attendance/todaysattendance',
        label: 'todaysAttendance',
        iconName: 'ListChecks',
      },
      {
        name: 'Show QR',
        link: '/dashboard/owner/attendance/showqr',
        label: 'showQR',
        iconName: 'QrCode',
      },
    ],
  },
];

export const TrainerDashboardMenuItems: MenuItem[] = [
  {
    name: 'Assigned Users',
    label: 'assignedusers',
    iconName: 'Users',
    link: '/dashboard/trainer/assignedusers',
  },
  {
    name: 'Workouts',
    label: 'workouts',
    iconName: 'Dumbbell',
    link: '/dashboard/trainer/workouts',
    subItems: [
      {
        name: 'Create Workouts',
        label: 'createworkout',
        link: '/dashboard/trainer/workouts/createworkout',
        iconName: 'Plus',
      },
      {
        name: 'Assign Workout',
        label: 'assignworkout',
        link: '/dashboard/trainer/workouts/assignworkout',
        iconName: 'UserPlus',
      },
    ],
  },
  {
    name: 'Diet',
    label: 'diet',
    iconName: 'UtensilsCrossed',
    link: '/dashboard/trainer/diet',
    subItems: [
      {
        name: 'Create Diet plan',
        label: 'createdietplan',
        link: '/dashboard/trainer/diet/createdietplan',
        iconName: 'Plus',
      },
      {
        name: 'Assign Diet plan',
        label: 'assigndietplan',
        link: '/dashboard/trainer/diet/assigndietplan',
        iconName: 'UserPlus',
      },
    ],
  },
  {
    name: 'Attendance',
    iconName: 'CalendarCheck',
    label: 'attendance',
    link: '/dashboard/trainer/attendance',
    subItems: [
      {
        name: "Today's Attendance",
        label: 'todaysattendance',
        link: '/dashboard/trainer/attendance/todaysattendance',
        iconName: 'ListChecks',
      },
      {
        name: 'Show QR',
        label: 'showqr',
        link: '/dashboard/trainer/attendance/showqr',
        iconName: 'QrCode',
      },
    ],
  },
];

export const ClientDashboardMenuItems: MenuItem[] = [
  {
    name: 'Home',
    label: 'home',
    iconName: 'Home',
    subItems: [
      {
        name: 'Gym',
        label: 'gym',
        link: '/dashboard/client/home/gym',
        iconName: 'Building2',
      },
      {
        name: 'Dashboard',
        label: 'dashboard',
        link: '/dashboard/client/home/dashboard',
        iconName: 'Home',
      },
    ],
  },
  {
    name: 'Workouts',
    label: 'workouts',
    iconName: 'Dumbbell',
    link: '/dashboard/client/workouts',
    subItems: [
      {
        name: 'My Workouts',
        label: 'myworkouts',
        link: '/dashboard/client/workouts/myworkouts',
        iconName: 'Eye',
      },
      {
        name: 'All Workouts',
        label: 'allworkouts',
        link: '/dashboard/client/workouts/allworkouts',
        iconName: 'Dumbbell',
      },
    ],
  },
  {
    name: 'Diet',
    label: 'diet',
    iconName: 'UtensilsCrossed',
    link: '/dashboard/client/diet',
    subItems: [
      {
        name: 'View Diet',
        label: 'viewdiet',
        link: '/dashboard/client/diet/viewdiet',
        iconName: 'Eye',
      },
      {
        name: 'Grocery List',
        label: 'grocerylist',
        link: '/dashboard/client/diet/grocerylist',
        iconName: 'ShoppingBasket',
      },
      {
        name: 'Eating Out Guide',
        label: 'eatingoutguide',
        link: '/dashboard/client/diet/eatingoutguide',
        iconName: 'MapPin',
      },
    ],
  },
  {
    name: 'Attendance',
    iconName: 'CalendarCheck',
    label: 'attendance',
    link: '/dashboard/client/attendance',
    subItems: [
      {
        name: 'View Attendance',
        label: 'viewattendance',
        link: '/dashboard/client/attendance/viewattendance',
        iconName: 'Eye',
      },
      {
        name: 'Mark Attendance',
        label: 'markattendance',
        link: '/dashboard/client/attendance/markattendance',
        iconName: 'ClipboardCheck',
      },
    ],
  },
];

```

# app/dashboard/_components/SetupScreen.tsx

```tsx
'use client';
import { Card } from '@/components/ui/card';
import { ArrowRight, Building2, Plus } from 'lucide-react';
import Link from 'next/link';

export default function SetupScreen() {
  return (
    <div className="min-h-[80vh] flex items-center justify-center p-4">
      <Card className="max-w-md w-full p-8 text-center space-y-6">
        <div className="mx-auto w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center">
          <Building2 className="w-8 h-8 text-blue-500" />
        </div>

        <div className="space-y-2">
          <h1 className="text-2xl font-bold text-gray-900">Welcome to GymDominator</h1>
          <p className="text-gray-500">
            Let&apos;s get started by setting up your gym&apos;s profile.
          </p>
        </div>

        <Link
          href="/ownerdashboard/gymdetails/creategym"
          className="inline-flex items-center justify-center w-full gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
        >
          <Plus className="w-4 h-4" />
          <span>Create Your Gym Profile</span>
          <ArrowRight className="w-4 h-4" />
        </Link>
      </Card>
    </div>
  );
}

```

# app/dashboard/_components/sidebar.tsx

```tsx
'use client';
import IconImage from '@/app/assests/gym-manager.webp';
import { signOut } from '@/node_modules/next-auth/react';
import * as LucideIcons from 'lucide-react';
import type { LucideIcon } from 'lucide-react';
import { ChevronDown, ChevronRight, LogOut } from 'lucide-react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import Swal from 'sweetalert2';
import type { MenuItem as BaseMenuItem, SubItem } from './menuItems';

// Extend the MenuItem type to use iconName instead of icon
interface MenuItem extends Omit<BaseMenuItem, 'icon'> {
  iconName: string;
}

interface SidebarProps {
  menuItems: MenuItem[];
}

export default function Sidebar({ menuItems }: SidebarProps) {
  const [activePage, setActivePage] = useState<string>('viewGymDetails');
  const [openMenus, setOpenMenus] = useState<{ [key: string]: boolean }>({});
  const router = useRouter();

  // Function to get the icon component from its name
  const getIconComponent = (iconName: string): LucideIcon => {
    return (
      (LucideIcons as unknown as Record<string, LucideIcon>)[iconName] || LucideIcons.HelpCircle
    );
  };

  const handleItemClick = (item: MenuItem) => {
    if (item.subItems) {
      setOpenMenus((prev) => ({ ...prev, [item.label]: !prev[item.label] }));
      if (!openMenus[item.label]) {
        setActivePage(item.label);
      }
    } else if (item.link) {
      setActivePage(item.label);
      router.push(`/${item.link}`);
    }
  };

  const handleSubItemClick = (subItem: SubItem, parentLabel: string) => {
    setActivePage(subItem.label);
    setOpenMenus((prev) => ({ ...prev, [parentLabel]: true }));
    router.push(`${subItem.link}`);
  };

  const isActiveParent = (item: MenuItem) => {
    return item.subItems
      ? item.subItems.some((subItem) => subItem.label === activePage) ||
          (!openMenus[item.label] && activePage === item.label)
      : activePage === item.label;
  };

  const handleLogout = async () => {
    const result = await Swal.fire({
      title: 'Ready to leave?',
      html: `
        <div class="bg-white/90 p-6 rounded-xl border border-gray-700">
          <div class="text-center">
            <div class="text-red-400 mb-4">
              <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
              </svg>
            </div>
            <p class="text-red-400 text-lg">
              You will be logged out of your account and redirected to the login page.
            </p>
          </div>
        </div>
      `,
      showCancelButton: true,
      confirmButtonText: 'Yes, Logout',
      cancelButtonText: 'Cancel',
      customClass: {
        confirmButton:
          'bg-gradient-to-r from-red-500 to-red-600 px-6 py-2 rounded-lg text-white font-medium',
        cancelButton: 'bg-gray-600 px-6 py-2 rounded-lg text-white font-medium',
        title: 'text-white text-xl font-semibold',
      },
    });

    if (result.isConfirmed) {
      try {
        await signOut({
          callbackUrl: '/signin',
          redirect: false,
        });
        localStorage.clear();
        sessionStorage.clear();
        window.location.href = '/signin';
      } catch (error) {
        Swal.fire({
          title: 'Error!',
          text: 'Logout failed',
          icon: 'error',
          color: '#fff',
        });
        console.error('Logout failed:', error);
      }
    }
  };

  return (
    <div className="flex flex-col bg-gray-900 text-white w-64 h-screen">
      <div className="px-4 w-full flex items-center justify-center">
        <Image src={IconImage} alt="Gym Manager Icon" className="rounded-full" />
      </div>

      <nav className="flex-grow px-4 py-2">
        <ul className="space-y-2">
          {menuItems.map((item) => {
            const Icon = getIconComponent(item.iconName);
            return (
              <li key={item.name} className="whitespace-nowrap">
                <button
                  type="button"
                  onClick={() => handleItemClick(item)}
                  className={`flex items-center w-full px-4 py-2 rounded-lg transition-colors duration-200 
                    ${
                      isActiveParent(item)
                        ? 'bg-blue-700 text-white'
                        : 'text-gray-300 hover:bg-gray-800'
                    }`}
                >
                  <Icon className="w-6 h-6 mr-3" />
                  <span>{item.name}</span>
                  {item.subItems &&
                    (openMenus[item.label] ? (
                      <ChevronDown className="w-6 h-6 ml-auto" />
                    ) : (
                      <ChevronRight className="w-6 h-6 ml-auto" />
                    ))}
                </button>
                {item.subItems && openMenus[item.label] && (
                  <ul className="ml-6 mt-2 space-y-2">
                    {item.subItems.map((subItem) => (
                      <li key={subItem.name}>
                        <button
                          type="button"
                          onClick={() => handleSubItemClick(subItem, item.label)}
                          className={`flex items-center w-full px-4 py-2 rounded-lg transition-colors duration-200 
                            ${
                              activePage === subItem.label
                                ? 'bg-blue-600 text-white'
                                : 'text-gray-300 hover:bg-gray-800'
                            }`}
                        >
                          <span>{subItem.name}</span>
                        </button>
                      </li>
                    ))}
                  </ul>
                )}
              </li>
            );
          })}
        </ul>
      </nav>
      <div className="p-4">
        <button
          type="button"
          className="flex items-center w-full px-4 py-2 text-red-400 hover:bg-gray-800 rounded-lg transition-colors duration-200"
          onClick={handleLogout}
        >
          <LogOut className="w-6 h-6 mr-3" />
          <span>Logout</span>
        </button>
      </div>
    </div>
  );
}

```

# app/dashboard/_components/TopBar.tsx

```tsx
import Topbar from './TopBar/Topbar';

export default Topbar;

```

# app/dashboard/_components/TopBar/index.ts

```ts
export { default } from './Topbar';

```

# app/dashboard/_components/TopBar/NotificationButton.tsx

```tsx
'use client';

import { AnimatePresence, motion } from 'framer-motion';
import { Bell } from 'lucide-react';
import { type FC, useState } from 'react';

interface Notification {
  id: string;
  message: string;
  time: string;
  read: boolean;
}

// Mock notifications for testing UI
const mockNotifications: Notification[] = [
  {
    id: '1',
    message: 'New booking request from Alex',
    time: '2 min ago',
    read: false,
  },
  {
    id: '2',
    message: 'Your schedule has been updated for tomorrow',
    time: '1 hour ago',
    read: false,
  },
  {
    id: '3',
    message: 'Payment received from client #1204',
    time: 'Yesterday',
    read: true,
  },
];

const NotificationButton: FC = () => {
  const [showNotifications, setShowNotifications] = useState(false);
  const [notifications, setNotifications] = useState<Notification[]>(mockNotifications);

  const unreadCount = notifications.filter((n) => !n.read).length;

  const toggleNotifications = () => {
    setShowNotifications(!showNotifications);
  };

  const markAsRead = (id: string) => {
    setNotifications(notifications.map((n) => (n.id === id ? { ...n, read: true } : n)));
  };

  const markAllAsRead = () => {
    setNotifications(notifications.map((n) => ({ ...n, read: true })));
  };

  return (
    <div className="relative">
      <button
        type="button"
        onClick={toggleNotifications}
        className="relative p-2 rounded-full hover:bg-gray-100 transition flex items-center justify-center"
        aria-label="Notifications"
      >
        <Bell className="h-5 w-5" />
        <AnimatePresence>
          {unreadCount > 0 && (
            <motion.span
              initial={{ scale: 0 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0 }}
              className="absolute -top-1 -right-1 bg-red-500 text-white rounded-full h-4 w-4 flex items-center justify-center text-xs font-medium"
            >
              {unreadCount}
            </motion.span>
          )}
        </AnimatePresence>
      </button>

      <AnimatePresence>
        {showNotifications && (
          <>
            {/* Backdrop for mobile */}
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-black/20 z-10 md:hidden"
              onClick={() => setShowNotifications(false)}
            />

            {/* Notification panel */}
            <motion.div
              initial={{ opacity: 0, y: 10, scale: 0.95 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: 10, scale: 0.95 }}
              transition={{ type: 'spring', duration: 0.3 }}
              className="absolute right-0 mt-2 w-80 md:max-w-sm bg-white rounded-lg shadow-lg z-20 border overflow-hidden"
              style={{ maxHeight: 'calc(100vh - 180px)' }}
            >
              <div className="p-3 border-b flex justify-between items-center">
                <h3 className="font-medium">Notifications</h3>
                {unreadCount > 0 && (
                  <button
                    type="button"
                    onClick={markAllAsRead}
                    className="text-xs text-blue-600 hover:text-blue-800"
                  >
                    Mark all as read
                  </button>
                )}
              </div>
              <div className="max-h-[70vh] md:max-h-80 overflow-y-auto">
                {notifications.length === 0 ? (
                  <div className="p-8 text-center">
                    <div className="mx-auto h-12 w-12 rounded-full bg-gray-100 flex items-center justify-center mb-4">
                      <Bell className="h-6 w-6 text-gray-400" />
                    </div>
                    <p className="text-gray-500">No notifications</p>
                  </div>
                ) : (
                  notifications.map((notification) => (
                    <motion.div
                      key={notification.id}
                      initial={{
                        backgroundColor: notification.read ? 'white' : '#eff6ff',
                      }}
                      animate={{
                        backgroundColor: notification.read ? 'white' : '#eff6ff',
                      }}
                      whileTap={{ scale: 0.98 }}
                      className={'p-3 border-b hover:bg-gray-50 cursor-pointer transition-all'}
                      onClick={() => markAsRead(notification.id)}
                    >
                      <div className="flex items-start">
                        <div className="flex-1">
                          <div className="text-sm">{notification.message}</div>
                          <div className="text-xs text-gray-500 mt-1">{notification.time}</div>
                        </div>
                        {!notification.read && (
                          <div className="h-2 w-2 rounded-full bg-blue-500 mt-1.5" />
                        )}
                      </div>
                    </motion.div>
                  ))
                )}
              </div>
            </motion.div>
          </>
        )}
      </AnimatePresence>
    </div>
  );
};

export default NotificationButton;

```

# app/dashboard/_components/TopBar/QRCodeButton.tsx

```tsx
'use client';

import { AnimatePresence, motion } from 'framer-motion';
import { QrCode } from 'lucide-react';
import Image from 'next/image';
import { type FC, useState } from 'react';

interface QRCodeButtonProps {
  gymId?: string;
}

const QRCodeButton: FC<QRCodeButtonProps> = () => {
  const [showQR, setShowQR] = useState(false);

  const toggleQR = () => {
    setShowQR(!showQR);
  };

  return (
    <div className="relative">
      <button
        type="button"
        onClick={toggleQR}
        className="p-2 rounded-full hover:bg-gray-100 transition flex items-center justify-center"
        aria-label="QR Code"
      >
        <QrCode className="h-5 w-5" />
      </button>

      <AnimatePresence>
        {showQR && (
          <>
            {/* Backdrop for mobile */}
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-black/20 z-10 md:hidden"
              onClick={() => setShowQR(false)}
            />

            {/* QR Code modal */}
            <motion.div
              initial={{ opacity: 0, y: 10, scale: 0.95 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: 10, scale: 0.95 }}
              transition={{ type: 'spring', duration: 0.3 }}
              className="absolute right-0 mt-2 p-5 bg-white rounded-lg shadow-lg z-20 border"
            >
              <div className="text-center mb-3">
                <h3 className="font-medium text-lg">Gym QR Code</h3>
                <p className="text-xs text-gray-500 mt-1">Scan to check in at the gym</p>
              </div>

              <div className="relative h-48 w-48 bg-white p-2 rounded border">
                <div className="absolute inset-0 flex items-center justify-center">
                  <QrCode className="h-32 w-32 text-gray-800" strokeWidth={1} />
                </div>

                <div className="absolute inset-0 flex items-center justify-center">
                  <div className="h-12 w-12 bg-white rounded-full p-1.5">
                    <div className="relative h-full w-full rounded-full overflow-hidden">
                      <Image
                        src="/apple-touch-icon.png"
                        alt="Gym Logo"
                        fill
                        className="object-cover"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <div className="mt-3 text-center">
                <button
                  type="button"
                  onClick={() => setShowQR(false)}
                  className="text-sm text-blue-600 font-medium hover:text-blue-800 transition"
                >
                  Close
                </button>
              </div>
            </motion.div>
          </>
        )}
      </AnimatePresence>
    </div>
  );
};

export default QRCodeButton;

```

# app/dashboard/_components/TopBar/SubrouteNav.tsx

```tsx
'use client';

import { AnimatePresence, m } from 'framer-motion';
import {
  Building2,
  CalendarCheck,
  ClipboardCheck,
  ClipboardList,
  Dumbbell,
  Eye,
  Home,
  ListChecks,
  type LucideIcon,
  MapPin,
  Plus,
  QrCode,
  ShoppingBasket,
  UserCheck,
  UserPlus,
  Users,
  UtensilsCrossed,
} from 'lucide-react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { useEffect, useState } from 'react';
import { Skeleton } from '../../../../components/ui/skeleton';

// Map of icon names to Lucide React components
const iconComponents: Record<string, LucideIcon> = {
  building2: Building2,
  calendarcheck: CalendarCheck,
  clipboardcheck: ClipboardCheck,
  clipboardlist: ClipboardList,
  dumbbell: Dumbbell,
  eye: Eye,
  utensilscrossed: UtensilsCrossed,
  home: Home,
  listchecks: ListChecks,
  mappin: MapPin,
  plus: Plus,
  qrcode: QrCode,
  shoppingbasket: ShoppingBasket,
  usercheck: UserCheck,
  userplus: UserPlus,
  users: Users,
};

interface SubrouteNavProps {
  subroutes: {
    name: string;
    href: string;
    icon: string;
  }[];
  status: 'loading' | 'unauthenticated' | 'authenticated';
}

const SubrouteNav: React.FC<SubrouteNavProps> = ({ subroutes, status }) => {
  const pathname = usePathname();
  const [, setIsScrolled] = useState(false);
  const [showLabels, setShowLabels] = useState(true);

  if (status === 'loading')
    return (
      <div className="flex items-center justify-center h-14">
        <Skeleton className="h-10 w-64 mx-auto" />
        <Skeleton className="h-10 w-64 mx-auto" />
        <Skeleton className="h-10 w-64 mx-auto" />
      </div>
    );

  // Listen for scroll events to hide text labels when scrolling down
  useEffect(() => {
    const handleScroll = () => {
      if (window.scrollY > 20) {
        setIsScrolled(true);
        if (showLabels) setShowLabels(false);
      } else {
        setIsScrolled(false);
        if (!showLabels) setShowLabels(true);
      }
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, [showLabels]);

  if (subroutes.length === 0) return null;

  return (
    <nav className="overflow-x-auto scrollbar-hide bg-gradient-to-r from-blue-100 via-blue-50 to-blue-100">
      <div className="h-14 flex items-center justify-around md:justify-center md:gap-8 px-1">
        {subroutes.map((route) => {
          const isActive = pathname === route.href;
          // Ensure icon name is properly formatted for lookup
          const iconKey = route.icon.toLowerCase();
          const IconComponent = iconComponents[iconKey] || Home;

          return (
            <Link
              key={route.href}
              href={route.href}
              className={`relative flex flex-col items-center justify-center h-full px-3 transition-all ${
                isActive ? 'text-blue-700' : 'text-gray-600 hover:text-blue-600'
              }`}
            >
              <div className="flex flex-col items-center">
                {/* Dynamic icon component */}
                <IconComponent className="w-5 h-5" />

                {/* Text label with smooth animation */}
                <AnimatePresence mode="wait">
                  {showLabels && (
                    <m.span
                      initial={{ opacity: 0, y: -5, height: 0 }}
                      animate={{ opacity: 1, y: 0, height: 'auto' }}
                      exit={{ opacity: 0, y: -5, height: 0 }}
                      transition={{ duration: 0.2 }}
                      className="text-xs mt-1 whitespace-nowrap"
                    >
                      {route.name}
                    </m.span>
                  )}
                </AnimatePresence>
              </div>

              {/* Active indicator dot */}
              {isActive && (
                <m.div
                  layoutId="activeRoute"
                  className="absolute bottom-0 w-1.5 h-1.5 bg-blue-700 rounded-full"
                  transition={{ type: 'spring', stiffness: 300, damping: 30 }}
                />
              )}
            </Link>
          );
        })}
      </div>
    </nav>
  );
};

export default SubrouteNav;

```

# app/dashboard/_components/TopBar/Topbar.tsx

```tsx
import Image from 'next/image';
import { usePathname } from 'next/navigation';
import type { FC } from 'react';
import { Skeleton } from '../../../../components/ui/skeleton';
import type { MenuItem, SubItem } from '../menuItems';
import NotificationButton from './NotificationButton';
import QRCodeButton from './QRCodeButton';
import SubrouteNav from './SubrouteNav';
import UserMenuButton from './UserMenuButton';

interface TopbarProps {
  gymName?: string;
  userRole?: string;
  menuItems: MenuItem[];
  status: 'loading' | 'unauthenticated' | 'authenticated';
}

const Topbar: FC<TopbarProps> = ({ gymName = 'GymNavigator', userRole, menuItems, status }) => {
  const pathname = usePathname();

  // First, extract the main route segment from the pathname
  // For example, from "/dashboard/owner/onboarding/onboardingqr" we want to extract "onboarding"
  const pathSegments = pathname.split('/').filter(Boolean);
  const mainRouteSegment = pathSegments.length >= 3 ? pathSegments[2] : '';

  // Find the active menu item by matching the main route segment with menu items
  const activeMenuItem = menuItems.find((item) => {
    // Extract the main route segment from the menu item link
    const itemLinkSegments = (item.link || '').split('/').filter(Boolean);
    const itemMainSegment = itemLinkSegments.length >= 3 ? itemLinkSegments[2] : '';

    // Check if the main route segment matches
    return (
      mainRouteSegment === itemMainSegment ||
      // Also check if any of the subitems match the current path
      (item.subItems?.some((subItem) => pathname.includes(subItem.link)) ?? false)
    );
  });

  // Get subroutes from the active menu item
  const subroutes =
    activeMenuItem?.subItems?.map((subItem) => ({
      name: subItem.name,
      href: subItem.link,
      // Ensure iconName is passed correctly
      icon: subItem.iconName ? subItem.iconName.toLowerCase() : 'home',
    })) || [];

  return (
    <>
      <div className="w-full flex flex-col sticky top-0 z-10 shadow-md bg-gradient-to-r from-blue-100 via-blue-50 to-blue-100 pt-2">
        {/* Top section with logo, name, and buttons */}
        <div className="h-12 md:h-16 flex items-center justify-between px-4 border-b border-blue-100">
          <div className="flex items-center space-x-3">
            <div className="relative h-9 w-9 rounded-md overflow-hidden shadow-sm">
              <Image
                src="/apple-touch-icon.png"
                alt="Gym Logo"
                fill
                className="object-cover"
                priority
              />
            </div>
            <div>
              <h1 className="font-bold text-lg tracking-tight text-blue-900">{gymName}</h1>
              {userRole ? (
                <div className="flex items-center">
                  <span className="h-2 w-2 rounded-full bg-green-500 mr-1.5" />
                  <p className="text-xs text-blue-700 capitalize">{userRole}</p>
                </div>
              ) : (
                <Skeleton className="h-2 w-24 mx-auto bg-transparent" />
              )}
            </div>
          </div>

          <div className="flex items-center space-x-2">
            <NotificationButton />
            <QRCodeButton />
            <UserMenuButton />
          </div>
        </div>

        {/* Subroute navigation with smooth animations */}
        {status === 'loading' ? (
          <Skeleton className="h-10 w-64 mx-auto bg-transparent" />
        ) : (
          <SubrouteNav subroutes={subroutes} status={status} />
        )}
      </div>
    </>
  );
};

export default Topbar;

```

# app/dashboard/_components/TopBar/UserMenuButton.tsx

```tsx
'use client';

import { AnimatePresence, motion } from 'framer-motion';
import { ChevronRight, LogOut, Settings, User, UserCircle } from 'lucide-react';
import { signOut } from 'next-auth/react';
import Image from 'next/image';
import { type FC, useState } from 'react';

interface MenuItem {
  label: string;
  icon: React.ReactNode;
  onClick: () => void;
  description?: string;
}

const UserMenuButton: FC = () => {
  const [showMenu, setShowMenu] = useState(false);

  const toggleMenu = () => {
    setShowMenu(!showMenu);
  };

  const handleSignOut = () => {
    signOut({ callbackUrl: '/login' });
  };

  const menuItems: MenuItem[] = [
    {
      label: 'Profile',
      description: 'View and edit your details',
      icon: <User className="h-4 w-4" />,
      onClick: () => console.log('Profile clicked'),
    },
    {
      label: 'Settings',
      description: 'App preferences and configuration',
      icon: <Settings className="h-4 w-4" />,
      onClick: () => console.log('Settings clicked'),
    },
    {
      label: 'Sign Out',
      icon: <LogOut className="h-4 w-4" />,
      onClick: handleSignOut,
    },
  ];

  return (
    <div className="relative">
      <button
        type="button" // Add explicit type
        onClick={toggleMenu}
        className="flex items-center justify-center rounded-full overflow-hidden hover:ring-2 hover:ring-gray-200 transition h-8 w-8"
        aria-label="User menu"
      >
        <div className="relative h-full w-full">
          <Image src="/apple-touch-icon.png" alt="User avatar" fill className="object-cover" />
        </div>
      </button>

      <AnimatePresence>
        {showMenu && (
          <>
            {/* Backdrop for mobile */}
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-black/20 z-10 md:hidden"
              onClick={() => setShowMenu(false)}
            />

            {/* Menu panel */}
            <motion.div
              initial={{ opacity: 0, y: 10, scale: 0.95 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: 10, scale: 0.95 }}
              transition={{ type: 'spring', duration: 0.3 }}
              className="absolute right-0 mt-2 w-60 bg-white rounded-lg shadow-lg z-20 border overflow-hidden"
            >
              <div className="p-4 border-b bg-gray-50">
                <div className="flex items-center space-x-3">
                  <div className="h-10 w-10 rounded-full overflow-hidden relative">
                    <Image
                      src="/apple-touch-icon.png"
                      alt="User avatar"
                      fill
                      className="object-cover"
                    />
                  </div>
                  <div>
                    <h3 className="font-medium text-sm">John Doe</h3>
                    <p className="text-xs text-gray-500">john.doe@example.com</p>
                  </div>
                </div>
              </div>

              <div className="py-1">
                {menuItems.map((item) => (
                  <motion.button
                    key={`user-menu-${item.label}`} // Use a more unique key instead of index
                    whileHover={{ backgroundColor: 'rgba(0,0,0,0.03)' }}
                    whileTap={{ scale: 0.98 }}
                    className="w-full text-left px-4 py-2.5 flex items-start gap-3"
                    onClick={() => {
                      item.onClick();
                      setShowMenu(false);
                    }}
                  >
                    <div
                      className={`mt-0.5 p-1.5 rounded-full ${
                        item.label === 'Sign Out' ? 'bg-red-100' : 'bg-blue-50'
                      }`}
                    >
                      {item.icon}
                    </div>
                    <div className="flex-1">
                      <div
                        className={`text-sm ${
                          item.label === 'Sign Out' ? 'text-red-600' : 'text-gray-700'
                        }`}
                      >
                        {item.label}
                      </div>
                      {item.description && (
                        <p className="text-xs text-gray-500 mt-0.5">{item.description}</p>
                      )}
                    </div>
                    <ChevronRight className="h-4 w-4 text-gray-400 mt-1" />
                  </motion.button>
                ))}
              </div>
            </motion.div>
          </>
        )}
      </AnimatePresence>
    </div>
  );
};

export default UserMenuButton;

```

# app/dashboard/client/attendance/layout.tsx

```tsx
import type React from 'react';

export default function AttendanceLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <div className="container mx-auto px-4">{children}</div>;
}

```

# app/dashboard/client/attendance/markattendance/_actions/check-attedance.ts

```ts
'use server';

import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';

export interface AttendanceData {
  isMarked: boolean;
  attendance?: {
    id: number;
    userId: number;
    validPeriodId: number;
    date: string;
    scanTime: string;
    attended: boolean;
  };
}

export interface AttendanceResponse {
  success: boolean;
  data?: AttendanceData;
  error?: string;
}

export async function checkUserAttendance(): Promise<AttendanceResponse> {
  try {
    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.get('/attendance/check-attendance');

    return {
      success: true,
      data: response.data.data,
    };
  } catch (error) {
    console.error('Error checking attendance:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to check attendance',
    };
  }
}

```

# app/dashboard/client/attendance/markattendance/_actions/CheckUserAttendance.ts

```ts
'use server';

import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';

export interface AttendanceData {
  isMarked: boolean;
  attendance?: {
    id: number;
    userId: number;
    validPeriodId: number;
    date: string;
    scanTime: string;
    attended: boolean;
  };
}

export interface AttendanceResponse {
  success: boolean;
  data?: AttendanceData;
  error?: string;
}

export async function checkUserAttendance(): Promise<AttendanceResponse> {
  try {
    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.get('/check-attendance');

    return {
      success: true,
      data: response.data.data,
    };
  } catch (error) {
    console.error('Error checking attendance:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to check attendance',
    };
  }
}

```

# app/dashboard/client/attendance/markattendance/_actions/mark-attendance.ts

```ts
'use server';

import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';

interface AttendanceResponse {
  success: boolean;
  data?: {
    id: number;
    userId: number;
    validPeriodId: number;
    date: string;
    scanTime: string;
    attended: boolean;
  };
  error?: string;
  details?: string;
}

export async function markAttendance(): Promise<AttendanceResponse> {
  try {
    const now = new Date();
    const clientUTC = Date.UTC(
      now.getUTCFullYear(),
      now.getUTCMonth(),
      now.getUTCDate(),
      now.getUTCHours(),
    );
    const truncatedUtcDate = new Date(clientUTC);

    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.post('/attendance/smark-attendance', {
      clientDate: truncatedUtcDate.toISOString(),
    });

    return {
      success: true,
      data: response.data.data,
    };
  } catch (error) {
    console.error('Error marking attendance:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to mark attendance',
    };
  }
}

```

# app/dashboard/client/attendance/markattendance/_actions/MarkAttendance.ts

```ts
'use server';

import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';

interface AttendanceResponse {
  success: boolean;
  data?: {
    id: number;
    userId: number;
    validPeriodId: number;
    date: string;
    scanTime: string;
    attended: boolean;
  };
  error?: string;
  details?: string;
}

export async function markAttendance(): Promise<AttendanceResponse> {
  try {
    const now = new Date();
    const clientUTC = Date.UTC(
      now.getUTCFullYear(),
      now.getUTCMonth(),
      now.getUTCDate(),
      now.getUTCHours(),
    );
    const truncatedUtcDate = new Date(clientUTC);

    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.post('/mark-attendance', {
      clientDate: truncatedUtcDate.toISOString(),
    });

    return {
      success: true,
      data: response.data.data,
    };
  } catch (error) {
    console.error('Error marking attendance:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to mark attendance',
    };
  }
}

```

# app/dashboard/client/attendance/markattendance/_components/AttendanceFailure.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { ArrowLeft, RefreshCcw, XCircle } from 'lucide-react';
import { useRouter } from 'next/navigation';

export default function AttendanceFailure() {
  const router = useRouter();

  return (
    <div className="fixed inset-0 flex items-center justify-center bg-gradient-to-b from-red-50 to-white dark:from-red-900/20 dark:to-gray-900 p-4 sm:p-6">
      <div className="w-full max-w-sm animate-in fade-in slide-in-from-bottom-4 duration-700">
        <div className="text-center">
          <div className="mb-8">
            <div className="relative w-24 h-24 mx-auto">
              <Skeleton className="absolute inset-0 rounded-full bg-red-100 dark:bg-red-900/30" />
              <XCircle className="relative w-full h-full text-red-500 dark:text-red-400 animate-in zoom-in duration-700 delay-300" />
            </div>
          </div>

          <h1 className="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-3">
            Attendance Failed
          </h1>
          <p className="text-base text-gray-600 dark:text-gray-300 mb-8">
            Unable to mark your attendance. Please try again.
          </p>

          <div className="space-y-3 px-4 sm:px-0">
            <Button
              onClick={() => router.replace('/dashboard/client/attendance/markattendance')}
              className="w-full h-12 text-base bg-red-500 hover:bg-red-600 text-white"
            >
              <RefreshCcw className="w-5 h-5 mr-2" />
              Try Again
            </Button>
            <Button
              variant="outline"
              onClick={() => router.replace('/dashboard')}
              className="w-full h-12 text-base"
            >
              <ArrowLeft className="w-5 h-5 mr-2" />
              Back to Dashboard
            </Button>
          </div>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/client/attendance/markattendance/_components/AttendanceSuccess.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { ArrowLeft, CheckCircle, Clock } from 'lucide-react';
import { useRouter, useSearchParams } from 'next/navigation';
import { useEffect } from 'react';

export default function AttendanceSuccess() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const scanTime = searchParams.get('scanTime');

  // Parse the ISO string to a Date object only if we have a scanTime
  const attendanceTime = scanTime ? new Date(scanTime) : null;

  // useEffect(() => {
  //   const timer = setTimeout(() => {
  //     router.replace("/dashboard/myprogress/month");
  //   }, 30000);

  //   return () => clearTimeout(timer);
  // }, [router]);

  return (
    <div className="fixed inset-0 flex items-center justify-center bg-gradient-to-b from-green-50 to-white dark:from-green-900/20 dark:to-gray-900 p-4 sm:p-6">
      <div className="w-full max-w-sm animate-in fade-in slide-in-from-bottom-4 duration-700">
        <div className="text-center">
          <div className="mb-8">
            <div className="relative w-24 h-24 mx-auto">
              <div className="absolute inset-0 rounded-full bg-green-100 dark:bg-green-900/30 animate-pulse" />
              <CheckCircle className="relative w-full h-full text-green-500 dark:text-green-400 animate-in zoom-in duration-700 delay-300" />
            </div>
          </div>

          <h1 className="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-3">
            Attendance Marked!
          </h1>
          <p className="text-base text-gray-600 dark:text-gray-300 mb-6">
            Your attendance has been successfully recorded
          </p>

          {attendanceTime && (
            <div className="inline-flex items-center justify-center space-x-2 px-4 py-2 bg-gray-50 dark:bg-gray-800 rounded-full mb-8">
              <Clock className="w-5 h-5 text-gray-500" />
              <time
                dateTime={attendanceTime.toISOString()}
                className="text-base text-gray-600 dark:text-gray-300"
              >
                {attendanceTime.toLocaleTimeString('en-US', {
                  hour: '2-digit',
                  minute: '2-digit',
                  hour12: true,
                })}
              </time>
            </div>
          )}

          <div className="space-y-3 px-4 sm:px-0">
            <Button
              onClick={() => router.replace('/dashboard/myprogress/month')}
              className="w-full h-12 text-base bg-green-500 hover:bg-green-600 text-white"
            >
              View Monthly Progress
            </Button>
            <Button
              variant="outline"
              onClick={() => router.replace('/dashboard')}
              className="w-full h-12 text-base"
            >
              <ArrowLeft className="w-5 h-5 mr-2" />
              Back to Dashboard
            </Button>
          </div>

          {/* <p className="text-sm text-gray-500 mt-6">
            Redirecting in 30 seconds...
          </p> */}
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/client/attendance/markattendance/_components/ClientQRWrapper.tsx

```tsx
'use client';

import dynamic from 'next/dynamic';

// Dynamically import QRScanner with no SSR since it uses browser APIs
const AttendanceQRScanner = dynamic(() => import('./QRScanner'), {
  ssr: false,
  loading: () => (
    <div className="flex items-center justify-center h-full">
      <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary" />
    </div>
  ),
});

export default function ClientQRWrapper() {
  return <AttendanceQRScanner />;
}

```

# app/dashboard/client/attendance/markattendance/_components/QRScanner.tsx

```tsx
'use client';
import { Skeleton } from '@/components/ui/skeleton';
import { QueryClient, useMutation, useQuery } from '@tanstack/react-query';
import { Html5QrcodeScanType, Html5QrcodeScanner, Html5QrcodeSupportedFormats } from 'html5-qrcode';
import { CheckCircle2, QrCode } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useEffect, useRef, useState } from 'react';
import { toast } from 'sonner';
import { checkUserAttendance } from '../_actions/check-attedance';
import { markAttendance } from '../_actions/mark-attendance';

interface QrValueType {
  AttendanceAction: {
    gymname: string;
    gymid: number;
    timestamp: number;
  };
}

export default function AttendanceQRScanner() {
  const router = useRouter();
  const queryClient = new QueryClient();
  const [isScanning, setIsScanning] = useState(true);
  const scannerRef = useRef<Html5QrcodeScanner | null>(null);

  // Prefetch attendance status
  const { data: attendanceStatus, isLoading: isCheckingAttendance } = useQuery({
    queryKey: ['attendance-status'],
    queryFn: async () => {
      const result = await checkUserAttendance();
      if (!result.success) {
        throw new Error(result.error || 'Failed to check attendance');
      }
      return result.data;
    },
  });

  // If attendance is already marked, redirect to success page
  useEffect(() => {
    if (attendanceStatus?.isMarked) {
      router.replace('/dashboard/client/attendance/success');
    }
  }, [attendanceStatus, router]);

  const markAttendanceMutation = useMutation({
    mutationFn: async () => {
      return await markAttendance();
    },
    onSuccess: (_response) => {
      toast.dismiss();
      toast.success('Attendance marked successfully!');
      queryClient.invalidateQueries({ queryKey: ['attendanceDays'] });
      router.refresh();
    },
    onError: (error) => {
      toast.dismiss();
      console.error('Error marking attendance:', error);
      toast.error('Failed to mark attendance', {
        description: error instanceof Error ? error.message : 'Unknown error occurred',
      });
      router.push('/dashboard/client/attendance/failure');
    },
  });

  useEffect(() => {
    if (typeof window !== 'undefined' && isScanning && !isCheckingAttendance) {
      scannerRef.current = new Html5QrcodeScanner(
        'qr-reader',
        {
          fps: 10,
          qrbox: { width: 300, height: 300 },
          aspectRatio: 1.0,
          supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA],
          rememberLastUsedCamera: true,
          showTorchButtonIfSupported: false,
          formatsToSupport: [Html5QrcodeSupportedFormats.QR_CODE],
          videoConstraints: {
            facingMode: 'environment',
          },
        },
        /* verbose= */ false,
      );

      scannerRef.current.render(
        async (decodedText: string) => {
          try {
            setIsScanning(false);
            const parsedData: QrValueType = JSON.parse(decodedText);
            const now = new Date();
            const currentUTC = Date.UTC(
              now.getUTCFullYear(),
              now.getUTCMonth(),
              now.getUTCDate(),
              now.getUTCHours(),
            );

            const scannedTime = new Date(parsedData.AttendanceAction.timestamp);
            const scannedUTC = Date.UTC(
              scannedTime.getUTCFullYear(),
              scannedTime.getUTCMonth(),
              scannedTime.getUTCDate(),
              scannedTime.getUTCHours(),
            );

            const toleranceInHours = 1;
            const timeDiff = Math.abs(currentUTC - scannedUTC) / (1000 * 60 * 60);

            if (timeDiff <= toleranceInHours) {
              toast.loading('Marking attendance...');
              await markAttendanceMutation.mutateAsync();
              if (scannerRef.current) {
                scannerRef.current.clear();
              }
            } else {
              throw new Error('QR code has expired');
            }
          } catch (error) {
            console.error('Error processing QR code:', error);
            toast.error('Failed to process QR code', {
              description: error instanceof Error ? error.message : 'Unknown error occurred',
            });
            setIsScanning(true);
          }
        },
        (error: string) => {
          if (!error.includes('NotFoundException')) {
            console.error('QR scan error:', error);
          }
        },
      );
    }

    return () => {
      if (scannerRef.current) {
        scannerRef.current.clear();
      }
    };
  }, [isScanning, markAttendanceMutation, isCheckingAttendance]);

  if (isCheckingAttendance) {
    return (
      <div className="flex items-center justify-center bg-background/95 backdrop-blur-sm p-4">
        <div className="w-full max-w-sm mx-auto">
          <div className="space-y-4">
            <div className="flex items-center justify-center space-x-2 mb-4">
              <Skeleton className="w-6 h-6 rounded" />
              <Skeleton className="h-6 w-32" />
            </div>
            <div className="relative rounded-lg overflow-hidden bg-white dark:bg-gray-900">
              <div className="aspect-square w-full max-w-xs mx-auto">
                <Skeleton className="h-full w-full" />
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="flex items-center justify-center bg-background/95 backdrop-blur-sm p-4">
      <div className="w-full max-w-sm mx-auto">
        <div className="space-y-4">
          <div className="flex items-center justify-center space-x-2 mb-4">
            <QrCode className="w-6 h-6 text-primary" />
            <h2 className="text-xl font-semibold">Scan QR Code</h2>
          </div>

          <div className="relative rounded-lg overflow-hidden bg-white dark:bg-gray-900">
            {isScanning && !markAttendanceMutation.isPending && (
              <div id="qr-reader" className="mx-auto" />
            )}

            {markAttendanceMutation.isPending && (
              <div className="flex flex-col items-center justify-center p-8 space-y-4">
                <div className="w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin" />
                <p className="text-sm text-muted-foreground">Processing your attendance...</p>
              </div>
            )}

            {!isScanning && markAttendanceMutation.isSuccess && (
              <div className="flex items-center justify-center space-x-2 p-8">
                <CheckCircle2 className="w-8 h-8 text-green-500" />
                <p className="text-base font-medium">Attendance Marked!</p>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/client/attendance/markattendance/error.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { useEffect } from 'react';

// biome-ignore lint/suspicious/noShadowRestrictedNames: <explanation>
export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    // Log the error to an error reporting service
    console.error('Attendance page error:', error);
  }, [error]);

  return (
    <div className="flex flex-col items-center justify-center min-h-[calc(100vh-4rem)]">
      <div className="max-w-md w-full p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg">
        <h2 className="text-2xl font-bold text-red-600 dark:text-red-400 mb-4 text-center">
          Something went wrong
        </h2>
        <p className="text-gray-600 dark:text-gray-300 mb-6 text-center">
          {error.message || 'An error occurred while loading the attendance page'}
        </p>
        <div className="flex justify-center gap-4">
          <Button
            onClick={reset}
            variant="default"
            className="bg-blue-600 hover:bg-blue-700 text-white"
          >
            Try again
          </Button>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/client/attendance/markattendance/loading.tsx

```tsx
import { Card, CardContent, CardFooter, CardHeader } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';

export default function MarkAttendanceLoading() {
  return (
    <main className="min-h-[calc(100vh-4rem)] bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        <h1 className="text-3xl font-bold text-center mb-8">
          <Skeleton className="h-9 w-48 mx-auto" />
        </h1>
        <section className="max-w-md mx-auto">
          <Card className="w-full max-w-sm mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
            <CardHeader className="bg-primary/20 space-y-1 p-6">
              <div className="flex items-center justify-center gap-2">
                <Skeleton className="h-6 w-6 rounded-full" />
                <Skeleton className="h-7 w-32" />
              </div>
              <Skeleton className="h-4 w-48 mx-auto mt-2" />
            </CardHeader>

            <CardContent className="p-6">
              <div className="aspect-square w-full max-w-xs mx-auto">
                <Skeleton className="h-full w-full rounded-lg" />
              </div>
            </CardContent>

            <CardFooter className="bg-muted/10 p-4">
              <Skeleton className="h-4 w-36 mx-auto" />
            </CardFooter>
          </Card>
        </section>
      </div>
    </main>
  );
}

```

# app/dashboard/client/attendance/markattendance/page.tsx

```tsx
import AttendanceFailure from '@/app/dashboard/client/attendance/markattendance/_components/AttendanceFailure';
import AttendanceSuccess from '@/app/dashboard/client/attendance/markattendance/_components/AttendanceSuccess';
import { notFound } from 'next/navigation';
import { Suspense } from 'react';
import { checkUserAttendance } from './_actions/check-attedance';
import ClientQRWrapper from './_components/ClientQRWrapper';
import MarkAttendanceLoading from './loading';

export default async function MarkAttendancePage() {
  const result = await checkUserAttendance();

  if (!result.success) {
    if (result.error?.includes('not found')) {
      notFound();
    }
    return <AttendanceFailure />;
  }

  if (result.data?.isMarked) {
    return <AttendanceSuccess />;
  }

  return (
    <main className="min-h-[calc(100vh-4rem)] bg-gray-50 dark:bg-gray-900">
      <div className="container mx-auto px-4 py-8">
        <h1 className="text-3xl font-bold text-center mb-8 text-gray-900 dark:text-gray-100">
          Mark Your Attendance
        </h1>
        <Suspense fallback={<MarkAttendanceLoading />}>
          <ClientQRWrapper />
        </Suspense>
      </div>
    </main>
  );
}

```

# app/dashboard/client/attendance/page.tsx

```tsx
export default function AttendancePage() {
  return (
    <div className="py-8">
      <h1 className="text-3xl font-bold">Attendance</h1>
      <div className="mt-6">{/* Add attendance overview here */}</div>
    </div>
  );
}

```

# app/dashboard/client/attendance/viewattendance/_actions/get-attendance.ts

```ts
'use server';
import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';

interface AttendanceDaysResponse {
  success: boolean;
  data?: string[]; // API returns date strings
  error?: string;
  details?: string;
}

export interface AttendanceData {
  attendanceDays: Date[];
}

export const fetchAttendanceData = async (): Promise<AttendanceData> => {
  try {
    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.post<AttendanceDaysResponse>(
      '/attendance/monthlyattendance',
    );

    if (!response.data.success || !response.data.data) {
      console.error('Failed to fetch attendance days:', response.data.error);
      return { attendanceDays: [] };
    }

    // Convert string dates to Date objects
    const attendanceDays = response.data.data.map((dateStr) => new Date(dateStr));
    return { attendanceDays };
  } catch (error) {
    console.error('Error fetching attendance days:', error);
    return { attendanceDays: [] };
  }
};

```

# app/dashboard/client/attendance/viewattendance/_actions/GetAttendandedDays.ts

```ts
'use server';
import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';
import { unstable_cache } from 'next/cache';

interface AttendanceDaysResponse {
  success: boolean;
  data?: string[]; // API returns date strings
  error?: string;
  details?: string;
}

// Base function to fetch attendance data
export const fetchAttendanceData = async (): Promise<Date[]> => {
  try {
    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.post<AttendanceDaysResponse>('/userprogress');

    if (!response.data.success || !response.data.data) {
      console.error('Failed to fetch attendance days:', response.data.error);
      return [];
    }

    // Convert string dates to Date objects
    return response.data.data.map((dateStr) => new Date(dateStr));
  } catch (error) {
    console.error('Error fetching attendance days:', error);
    return [];
  }
};

```

# app/dashboard/client/attendance/viewattendance/_components/CalendarSkeleton.tsx

```tsx
'use client';

import { Skeleton } from '@/components/ui/skeleton';

export default function CalendarSkeleton() {
  // Generate unique keys for skeleton items
  const generateKey = (prefix: string, index: number) => `${prefix}-${index}`;

  return (
    <div className="w-full max-w-4xl mx-auto space-y-6">
      {/* Header Section */}
      <div className="flex flex-col items-center space-y-4">
        <div className="w-full flex items-center justify-between px-4 sm:justify-center sm:space-x-8">
          <Skeleton className="h-10 w-10 rounded-full" />
          <div className="flex flex-col items-center space-y-2">
            <Skeleton className="h-8 w-36 sm:w-48" />
          </div>
          <Skeleton className="h-10 w-10 rounded-full" />
        </div>
      </div>

      {/* Calendar Grid */}
      <div className="px-2 sm:px-4">
        {/* Days of week */}
        <div className="grid grid-cols-7 gap-2 sm:gap-4 mb-4">
          {Array(7)
            .fill(0)
            .map((_, i) => (
              <Skeleton key={generateKey('day', i)} className="h-6 w-full" />
            ))}
        </div>

        {/* Calendar grid */}
        <div className="grid grid-cols-7 gap-1 sm:gap-3">
          {Array(35)
            .fill(0)
            .map((_, i) => (
              <Skeleton key={generateKey('cell', i)} className="w-full aspect-square rounded-xl" />
            ))}
        </div>
      </div>

      {/* Legend and Progress */}
      <div className="mt-8 flex flex-col space-y-6 sm:flex-row sm:space-y-0 justify-between items-center p-4 rounded-xl bg-gray-50/50 dark:bg-gray-800/50">
        <div className="grid grid-cols-2 sm:flex sm:flex-wrap gap-4 sm:gap-6">
          {Array(4)
            .fill(0)
            .map((_, i) => (
              <div key={generateKey('legend', i)} className="flex items-center space-x-3">
                <Skeleton className="w-5 h-5 rounded-lg" />
                <Skeleton className="w-16 sm:w-20 h-5" />
              </div>
            ))}
        </div>
        <Skeleton className="w-24 h-24 sm:w-32 sm:h-32 rounded-full" />
      </div>
    </div>
  );
}

```

# app/dashboard/client/attendance/viewattendance/_components/MonthAttendance.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { useQuery } from '@tanstack/react-query';
import { ChevronLeft, ChevronRight, Dumbbell, X } from 'lucide-react';
import { useEffect, useState } from 'react';
import { fetchAttendanceData } from '../_actions/get-attendance';
import CalendarSkeleton from './CalendarSkeleton';

const DAYS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
const MONTHS = [
  'January',
  'February',
  'March',
  'April',
  'May',
  'June',
  'July',
  'August',
  'September',
  'October',
  'November',
  'December',
];

interface MonthAttendanceProps {
  initialData?: Date[];
}

export default function MonthAttendance({ initialData }: MonthAttendanceProps) {
  const [currentDate, setCurrentDate] = useState(new Date());
  const [progress, setProgress] = useState(0);

  const { data: attendanceData, isLoading } = useQuery({
    queryKey: ['attendanceDays'],
    queryFn: fetchAttendanceData,
    staleTime: 24 * 60 * 60 * 1000, // 24 hours
    gcTime: 24 * 60 * 60 * 1000, // 24 hours
    initialData: initialData ? { attendanceDays: initialData } : undefined,
  });

  if (isLoading) {
    return (
      <>
        <CalendarSkeleton />
      </>
    );
  }

  // Explicitly type and initialize gymAttendanceDays as an array
  const gymAttendanceDays: Date[] = attendanceData?.attendanceDays || [];

  useEffect(() => {
    // Progress calculation logic
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    // Count non-Sunday days (available workout days)
    let availableWorkoutDays = 0;
    for (let day = 1; day <= daysInMonth; day++) {
      const date = new Date(year, month, day);
      if (date.getDay() !== 0) {
        // Skip Sundays
        availableWorkoutDays++;
      }
    }

    // Count attended days (excluding Sundays)
    const attendedDays = gymAttendanceDays.filter(
      (date) =>
        date.getMonth() === currentDate.getMonth() &&
        date.getFullYear() === currentDate.getFullYear() &&
        date.getDay() !== 0, // Exclude Sundays
    ).length;

    // Calculate progress percentage
    const calculatedProgress =
      availableWorkoutDays > 0 ? Math.round((attendedDays / availableWorkoutDays) * 100) : 0;

    // Only update progress if it has changed
    if (calculatedProgress !== progress) {
      setProgress(calculatedProgress);
    }
  }, [currentDate, gymAttendanceDays, progress]);

  const isToday = (date: Date) => {
    const today = new Date();
    return (
      date.getDate() === today.getDate() &&
      date.getMonth() === today.getMonth() &&
      date.getFullYear() === today.getFullYear()
    );
  };

  const isGymDay = (date: Date) => {
    return gymAttendanceDays.some(
      (gymDate) =>
        gymDate.getDate() === date.getDate() &&
        gymDate.getMonth() === date.getMonth() &&
        gymDate.getFullYear() === date.getFullYear(),
    );
  };

  const isMissedDay = (date: Date) => {
    const today = new Date();
    return date < today && !isGymDay(date) && date.getDay() !== 0 && date <= today;
  };

  const getDaysInMonth = (date: Date) => {
    const year = date.getFullYear();
    const month = date.getMonth();
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    const days = [];
    for (let i = 0; i < firstDay; i++) {
      days.push(null);
    }
    for (let i = 1; i <= daysInMonth; i++) {
      days.push(new Date(year, month, i));
    }
    return days;
  };

  const addMonths = (date: Date, months: number) => {
    const newDate = new Date(date);
    newDate.setMonth(newDate.getMonth() + months);
    return newDate;
  };

  const getDayClasses = (date: Date) => {
    const isSunday = date.getDay() === 0;
    const isGymAttendance = isGymDay(date);

    return `
      flex flex-col items-center justify-center
      w-12 h-12 md:w-14 md:h-14 rounded-xl
      text-center relative
      transition-all duration-300 ease-in-out
      backdrop-blur-sm
      hover:scale-105 hover:shadow-lg
      cursor-default
      ${
        isGymAttendance
          ? 'bg-gradient-to-br from-green-400 to-green-500 text-white shadow-lg shadow-green-200/50 dark:shadow-green-900/50'
          : ''
      }
      ${
        isToday(date) && !isGymAttendance
          ? 'bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-200/50 dark:shadow-blue-900/50'
          : ''
      }
      ${
        isMissedDay(date)
          ? 'bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900/50 dark:to-red-800/50'
          : ''
      }
      ${
        isSunday
          ? 'bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800/50 dark:to-gray-700/50 text-gray-400 dark:text-gray-600'
          : ''
      }
    `;
  };

  const renderDay = (date: Date | null) => {
    if (!date) return <div className="w-12 h-12 md:w-14 md:h-14" />;

    return (
      <div key={date.toString()} className={getDayClasses(date)}>
        <span className="text-base md:text-lg font-semibold">{date.getDate()}</span>
        {isGymDay(date) && date.getDay() !== 0 && (
          <Dumbbell className="w-4 h-4 md:w-5 md:h-5 animate-pulse" />
        )}
        {isMissedDay(date) && <X className="w-4 h-4 md:w-5 md:h-5 text-red-500" />}
      </div>
    );
  };

  return (
    <div className="w-full max-w-4xl mx-auto space-y-6">
      {/* Header Section */}
      <div className="flex flex-col items-center space-y-4">
        <div className="w-full flex items-center justify-between px-4 sm:justify-center sm:space-x-8">
          <Button
            variant="outline"
            size="icon"
            className="rounded-full hover:bg-gray-100/80 dark:hover:bg-gray-800/80 transition-all duration-300"
            onClick={() => setCurrentDate(addMonths(currentDate, -1))}
          >
            <ChevronLeft className="h-5 w-5" />
          </Button>
          <div className="flex flex-col items-center">
            <span className="text-2xl sm:text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-gray-100 dark:to-gray-400 bg-clip-text text-transparent">
              {MONTHS[currentDate.getMonth()]} {currentDate.getFullYear()}
            </span>
          </div>
          <Button
            variant="outline"
            size="icon"
            className="rounded-full hover:bg-gray-100/80 dark:hover:bg-gray-800/80 transition-all duration-300"
            onClick={() => setCurrentDate(addMonths(currentDate, 1))}
          >
            <ChevronRight className="h-5 w-5" />
          </Button>
        </div>
      </div>

      {/* Calendar Grid */}
      <div className="px-2 sm:px-4">
        <div className="grid grid-cols-7 gap-2 sm:gap-4 mb-4">
          {DAYS.map((day) => (
            <div
              key={day}
              className="text-center font-semibold text-sm sm:text-base text-gray-600 dark:text-gray-400"
            >
              {day}
            </div>
          ))}
        </div>
        <div className="grid grid-cols-7 gap-3 sm:gap-3">
          {getDaysInMonth(currentDate).map((date, index) => (
            <div
              className="inline-flex justify-center animate-fadeIn"
              key={index as number}
              style={{ animationDelay: `${index * 20}ms` }}
            >
              {renderDay(date)}
            </div>
          ))}
        </div>
      </div>

      {/* Legend and Progress */}
      <div className="mt-8 flex flex-col space-y-6 sm:flex-row sm:space-y-0 justify-between items-center p-4 rounded-xl bg-gray-50/50 dark:bg-gray-800/50 backdrop-blur-sm">
        <div className="grid grid-cols-2 sm:flex sm:flex-wrap gap-4 sm:gap-6">
          <div className="flex items-center space-x-3 transition-transform hover:scale-105">
            <div className="w-5 h-5 rounded-lg bg-gradient-to-br from-green-400 to-green-500 shadow-lg shadow-green-200/50 dark:shadow-green-900/50" />
            <span className="text-sm font-medium text-gray-700 dark:text-gray-300">Gym Day</span>
          </div>
          <div className="flex items-center space-x-3 transition-transform hover:scale-105">
            <div className="w-5 h-5 rounded-md bg-blue-500 shadow-lg shadow-blue-200 dark:shadow-blue-900" />
            <span className="text-sm font-medium text-gray-700 dark:text-gray-300">Today</span>
          </div>
          <div className="flex items-center space-x-3 transition-transform hover:scale-105">
            <div className="w-5 h-5 rounded-md bg-red-100 dark:bg-red-900/50 shadow-lg shadow-red-200 dark:shadow-red-900" />
            <span className="text-sm font-medium text-gray-700 dark:text-gray-300">Missed</span>
          </div>
          <div className="flex items-center space-x-3 transition-transform hover:scale-105">
            <div className="w-5 h-5 rounded-md bg-gray-100 dark:bg-gray-800/50 shadow-lg shadow-gray-200 dark:shadow-gray-900" />
            <span className="text-sm font-medium text-gray-700 dark:text-gray-300">Off Day</span>
          </div>
        </div>

        {/* Progress Circle */}
        <div className="relative w-24 h-24 sm:w-32 sm:h-32 transform hover:scale-105 transition-transform">
          {/* Progress circle with gradient */}
          {/* biome-ignore lint/a11y/noSvgWithoutTitle: <explanation> */}
          <svg className="w-full h-full transform -rotate-90">
            <defs>
              <linearGradient id="progress-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stopColor="#4ade80" />
                <stop offset="100%" stopColor="#22c55e" />
              </linearGradient>
            </defs>
            <circle
              cx="50%"
              cy="50%"
              r="45%"
              fill="none"
              stroke="currentColor"
              strokeWidth="8"
              className="text-gray-200 dark:text-gray-800"
            />
            <circle
              cx="50%"
              cy="50%"
              r="45%"
              fill="none"
              stroke="url(#progress-gradient)"
              strokeWidth="8"
              strokeLinecap="round"
              strokeDasharray={`${progress * 2.827}, 282.743`}
              className="transition-all duration-1000 ease-in-out"
            />
          </svg>
          <div className="absolute inset-0 flex items-center justify-center">
            <span className="text-xl sm:text-2xl font-bold bg-gradient-to-r from-green-500 to-green-700 bg-clip-text text-transparent">
              {progress}%
            </span>
          </div>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/client/attendance/viewattendance/_components/types.ts

```ts
export type AttendanceData = {
  dates: string[]; // ISO string format for dates
};

```

# app/dashboard/client/attendance/viewattendance/page.tsx

```tsx
import { queryClient } from '@/lib/getQueryClient';
import { HydrationBoundary, dehydrate } from '@tanstack/react-query';
import type { Metadata } from 'next';
import { Suspense } from 'react';
import { type AttendanceData, fetchAttendanceData } from './_actions/get-attendance';
import CalendarSkeleton from './_components/CalendarSkeleton';
import MonthAttendance from './_components/MonthAttendance';

export const metadata: Metadata = {
  title: 'Attendance History | GymNavigator',
  description:
    'View and track your gym attendance history with detailed calendar view and progress statistics.',
};

export default async function ViewAttendancePage() {
  // Get cached data if available
  const cachedData = queryClient.getQueryData<AttendanceData>(['attendanceDays']);

  // If no cached data, prefetch it
  if (!cachedData) {
    await queryClient.prefetchQuery({
      queryKey: ['attendanceDays'],
      queryFn: fetchAttendanceData,
      staleTime: 1000 * 60 * 60 * 24, // 24 hours
    });
  }

  // Get the data after prefetching (if it was needed)
  const initialData = queryClient.getQueryData<AttendanceData>(['attendanceDays']);
  const dehydratedState = dehydrate(queryClient);

  return (
    <main className="py-4">
      {/* <header className="mb-8">
        <h1 className="text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-gray-100 dark:to-gray-400 bg-clip-text text-transparent text-center">
          Gym Attendance
        </h1>
      </header> */}

      <section className="">
        <Suspense fallback={<CalendarSkeleton />}>
          <HydrationBoundary state={dehydratedState}>
            <MonthAttendance initialData={initialData?.attendanceDays} />
          </HydrationBoundary>
        </Suspense>
      </section>
    </main>
  );
}

```

# app/dashboard/client/diet/eatingoutguide/_actions/get-restaurant-guides.ts

```ts
'use server';

interface RestaurantGuide {
  type: string;
  recommendations: string[];
}

export async function getRestaurantGuides(): Promise<RestaurantGuide[]> {
  // This would typically fetch from a database
  return [
    {
      type: 'Fast Food',
      recommendations: [
        'Choose grilled over fried options',
        'Skip sugary drinks for water',
        'Ask for dressings and sauces on the side',
      ],
    },
    {
      type: 'Fine Dining',
      recommendations: [
        'Choose lean proteins like fish or chicken',
        'Ask about cooking methods',
        'Control portion sizes by sharing or taking leftovers',
      ],
    },
  ];
}

```

# app/dashboard/client/diet/eatingoutguide/_components/restaurant-guide.tsx

```tsx
interface RestaurantGuideProps {
  restaurantType: string;
  recommendations: string[];
}

export function RestaurantGuide({ restaurantType, recommendations }: RestaurantGuideProps) {
  return (
    <div className="p-4 border rounded-lg mb-4">
      <h2 className="text-xl font-semibold mb-3">{restaurantType}</h2>
      <ul className="space-y-2">
        {recommendations.map((item) => (
          <li key={item} className="list-disc ml-4">
            {item}
          </li>
        ))}
      </ul>
    </div>
  );
}

```

# app/dashboard/client/diet/eatingoutguide/loading.tsx

```tsx
export default function EatingOutGuideLoading() {
  return (
    <div className="py-8">
      <div className="h-10 w-48 bg-gray-200 animate-pulse rounded" />
      <div className="mt-6 space-y-4">
        <div className="h-4 w-full bg-gray-200 animate-pulse rounded" />
        <div className="h-4 w-3/4 bg-gray-200 animate-pulse rounded" />
        <div className="h-32 w-full bg-gray-200 animate-pulse rounded" />
      </div>
    </div>
  );
}

```

# app/dashboard/client/diet/eatingoutguide/page.tsx

```tsx
import { getRestaurantGuides } from './_actions/get-restaurant-guides';
import { RestaurantGuide } from './_components/restaurant-guide';

export default async function EatingOutGuidePage() {
  const guides = await getRestaurantGuides();

  return (
    <div className="py-8">
      <h1 className="text-3xl font-bold">Eating Out Guide</h1>
      <div className="mt-6">
        {guides.map((guide) => (
          <RestaurantGuide
            key={guide.type}
            restaurantType={guide.type}
            recommendations={guide.recommendations}
          />
        ))}
      </div>
    </div>
  );
}

```

# app/dashboard/client/diet/grocerylist/_actions/fetch-grocery-list.ts

```ts
'use server';

import { z } from 'zod';

// Type for grocery items
export type GroceryItem = {
  id: string;
  name: string;
  quantity: number;
  unit: string;
  isPurchased: boolean;
  categoryId: string;
};

// Schema for validating parameters
const FetchParamsSchema = z.object({
  userId: z.string(),
  weekId: z.string().optional(),
});

export async function fetchGroceryList(_params: z.infer<typeof FetchParamsSchema>) {
  try {
    // Validate input parameters

    // This would be replaced with actual database fetch
    // Mock data for demonstration
    const groceryItems: GroceryItem[] = [
      {
        id: '1',
        name: 'Chicken Breast',
        quantity: 500,
        unit: 'g',
        isPurchased: false,
        categoryId: 'proteins',
      },
      {
        id: '2',
        name: 'Brown Rice',
        quantity: 1,
        unit: 'kg',
        isPurchased: false,
        categoryId: 'carbs',
      },
      {
        id: '3',
        name: 'Broccoli',
        quantity: 2,
        unit: 'bunches',
        isPurchased: false,
        categoryId: 'vegetables',
      },
    ];

    return { success: true, data: groceryItems };
  } catch (error) {
    console.error('Error fetching grocery list:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to fetch grocery list',
    };
  }
}

```

# app/dashboard/client/diet/grocerylist/_components/grocery-list-items.tsx

```tsx
import { useState } from 'react';

type GroceryItemProps = {
  id: string;
  name: string;
  quantity: number;
  unit: string;
  isPurchased: boolean;
  onToggle: (id: string) => void;
};

export function GroceryListItem({
  id,
  name,
  quantity,
  unit,
  isPurchased,
  onToggle,
}: GroceryItemProps) {
  return (
    <div className="flex items-center justify-between p-3 border-b border-gray-200">
      <div className="flex items-center space-x-3">
        <input
          type="checkbox"
          checked={isPurchased}
          onChange={() => onToggle(id)}
          className="h-5 w-5 text-blue-600 rounded focus:ring-blue-500"
          id={`item-${id}`}
        />
        <label
          htmlFor={`item-${id}`}
          className={`text-lg ${isPurchased ? 'line-through text-gray-500' : 'text-gray-900'}`}
        >
          {name} ({quantity} {unit})
        </label>
      </div>
    </div>
  );
}

```

# app/dashboard/client/diet/grocerylist/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function GroceryListLoading() {
  return (
    <div className="py-8">
      <Skeleton className="h-9 w-60 mb-6" />

      <div className="space-y-4 mt-6">
        {[...Array(5)].map((_, i) => (
          <div key={`grocery-skeleton-${i as number}`} className="flex items-center space-x-3">
            <Skeleton className="h-5 w-5 rounded" />
            <Skeleton className="h-6 w-full max-w-md" />
          </div>
        ))}
      </div>
    </div>
  );
}

```

# app/dashboard/client/diet/grocerylist/page.tsx

```tsx
export default function GroceryListPage() {
  return (
    <div className="py-8">
      <h1 className="text-3xl font-bold">Grocery List</h1>
      <div className="mt-6">{/* Add grocery list here */}</div>
    </div>
  );
}

```

# app/dashboard/client/diet/layout.tsx

```tsx
import type React from 'react';

export default function DietLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <div className="container mx-auto px-4">{children}</div>;
}

```

# app/dashboard/client/diet/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function DietLoading() {
  return (
    <div className="p-4 bg-white rounded-lg shadow">
      <Skeleton className="h-6 w-48 mb-4" />
      {[1, 2, 3].map((item) => (
        <div key={item} className="mb-4 space-y-3">
          <Skeleton className="h-5 w-32" />
          <div className="space-y-2">
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-3/4" />
          </div>
        </div>
      ))}
    </div>
  );
}

```

# app/dashboard/client/diet/page.tsx

```tsx
export default function DietPage() {
  return (
    <div className="py-8">
      <h1 className="text-3xl font-bold">Diet Plans</h1>
      <div className="mt-6">{/* Add diet overview here */}</div>
    </div>
  );
}

```

# app/dashboard/client/diet/viewdiet/_actions/get-todays-diet.ts

```ts
'use server';
import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';

// Align with the backend response structure
export interface Ingredient {
  name: string;
  quantity: string | null;
}

export interface Meal {
  id: number;
  name: string;
  timeOfDay: string;
  calories: number;
  protein: number;
  carbs: number;
  fats: number;
  instructions: string;
  ingredients: Ingredient[];
}

export interface DietPlan {
  id: number;
  name: string;
  description: string | null;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  meals: Meal[];
  createdAt: string;
  updatedAt: string;
}

export interface DietResponse {
  success: boolean;
  data?: {
    dietPlan: DietPlan;
  };
  error?: string;
}

export interface TodaysDiet {
  dietPlan: DietPlan | null;
}

export const fetchTodaysDiet = async (): Promise<TodaysDiet> => {
  try {
    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.get<DietResponse>('/diet/today');

    if (!response.data.success || !response.data.data) {
      console.error("Failed to fetch today's diet:", response.data.error);
      return { dietPlan: null };
    }

    // Return the direct response from the backend without transformation
    return { dietPlan: response.data.data.dietPlan };
  } catch (error) {
    console.error("Error fetching today's diet:", error);
    return { dietPlan: null };
  }
};

// Helper function to format meal type display
// biome-ignore lint/correctness/noUnusedVariables: Will be used in future component updates
function getMealTypeDisplay(name: string, timeOfDay: string): string {
  if (timeOfDay.includes('7:00 AM')) return 'Breakfast';
  if (timeOfDay.includes('1:00 PM')) return 'Lunch';
  if (timeOfDay.includes('4:00 PM')) return 'Snack';
  if (timeOfDay.includes('7:00 PM')) return 'Dinner';
  // If can't determine from timeOfDay, use the name
  return name;
}

```

# app/dashboard/client/diet/viewdiet/_components/MealIcons.tsx

```tsx
import React from 'react';

interface IconProps {
  size?: number;
  className?: string;
}

export function BreakfastIcon({ size = 24, className = '' }: IconProps) {
  return (
    <svg
      width={size}
      height={size}
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.75"
      strokeLinecap="round"
      strokeLinejoin="round"
      className={className}
      aria-hidden="true"
      role="img"
    >
      <title>Breakfast</title>
      {/* Coffee cup icon */}
      <path d="M18 8h1a4 4 0 0 1 0 8h-1" />
      <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z" />
      <line x1="6" y1="1" x2="6" y2="4" />
      <line x1="10" y1="1" x2="10" y2="4" />
      <line x1="14" y1="1" x2="14" y2="4" />
    </svg>
  );
}

export function LunchIcon({ size = 24, className = '' }: IconProps) {
  return (
    <svg
      width={size}
      height={size}
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.75"
      strokeLinecap="round"
      strokeLinejoin="round"
      className={className}
      aria-hidden="true"
      role="img"
    >
      <title>Lunch</title>
      {/* Utensils icon */}
      <path d="M3 6l5 5" />
      <path d="M3 10l5-5" />
      <path d="M7 3v10" />
      <path d="M21 3v18" />
      <path d="M18 12c0-5 3-9 0-9-2 0-3 2-3 9v3l3 3 3-3v-3c0-7-1-9-3-9-3 0 0 4 0 9" />
    </svg>
  );
}

export function SnackIcon({ size = 24, className = '' }: IconProps) {
  return (
    <svg
      width={size}
      height={size}
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.75"
      strokeLinecap="round"
      strokeLinejoin="round"
      className={className}
      aria-hidden="true"
      role="img"
    >
      <title>Snack</title>
      {/* Apple icon */}
      <path d="M12 2a4 4 0 0 0-4 4v2H7a5 5 0 0 0-5 5c0 2 1 4 5 5l.5-2.5.5 2.5c4 0 5-3 5-5s-1-3-1-5 1-2 1-4a3 3 0 0 0-3-3" />
      <path d="M12 2a4 4 0 0 1 4 4v2h1a5 5 0 0 1 5 5c0 2-1 4-5 5l-.5-2.5-.5 2.5c-4 0-5-3-5-5s1-3 1-5-1-2-1-4a3 3 0 0 1 3-3" />
      <path d="M12 2v4" />
    </svg>
  );
}

export function DinnerIcon({ size = 24, className = '' }: IconProps) {
  return (
    <svg
      width={size}
      height={size}
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.75"
      strokeLinecap="round"
      strokeLinejoin="round"
      className={className}
      aria-hidden="true"
      role="img"
    >
      <title>Dinner</title>
      {/* Plate with utensils icon */}
      <circle cx="12" cy="12" r="9" />
      <path d="M8 9v3c0 .55.45 1 1 1h.17" />
      <path d="M16 9c-.72 0-1.3.58-1.3 1.3 0 .72.58 1.7 1.3 1.7s1.3-.98 1.3-1.7c0-.72-.58-1.3-1.3-1.3z" />
      <path d="M10 13v5" />
      <path d="M14 13v5" />
    </svg>
  );
}

export function DefaultMealIcon({ size = 24, className = '' }: IconProps) {
  return (
    <svg
      width={size}
      height={size}
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.75"
      strokeLinecap="round"
      strokeLinejoin="round"
      className={className}
      aria-hidden="true"
      role="img"
    >
      <title>Meal</title>
      {/* Bowl icon */}
      <path d="M19 11H5a3 3 0 0 0-3 3v0.86c0 .62.18 1.22.52 1.73l.62 1.03c.69 1.15 1.94 1.86 3.29 1.86h11.14c1.35 0 2.6-.7 3.29-1.86l.62-1.03c.34-.51.52-1.11.52-1.73V14a3 3 0 0 0-3-3Z" />
      <path d="M8 11V7c0-2.2 1.8-4 4-4h0c2.2 0 4 1.8 4 4v4" />
    </svg>
  );
}

```

# app/dashboard/client/diet/viewdiet/_components/todays-diet.tsx

```tsx
'use client';

import { useQuery } from '@tanstack/react-query';
import { Clock, UtensilsCrossed } from 'lucide-react';
import { fetchTodaysDiet } from '../_actions/get-todays-diet';
import { BreakfastIcon, DefaultMealIcon, DinnerIcon, LunchIcon, SnackIcon } from './MealIcons';

// Helper function to determine icon based on meal time
const getMealIcon = (timeOfDay: string) => {
  if (timeOfDay.includes('7:00 AM')) return BreakfastIcon;
  if (timeOfDay.includes('1:00 PM')) return LunchIcon;
  if (timeOfDay.includes('4:00 PM')) return SnackIcon;
  if (timeOfDay.includes('7:00 PM')) return DinnerIcon;
  return DefaultMealIcon;
};

// Helper function to determine color based on meal time
const getMealColor = (timeOfDay: string) => {
  if (timeOfDay.includes('7:00 AM')) return 'from-blue-100 to-blue-50 border-blue-200';
  if (timeOfDay.includes('1:00 PM')) return 'from-amber-100 to-amber-50 border-amber-200';
  if (timeOfDay.includes('7:00 PM')) return 'from-purple-100 to-purple-50 border-purple-200';
  if (timeOfDay.includes('4:00 PM')) return 'from-green-100 to-green-50 border-green-200';
  return 'from-gray-100 to-gray-50 border-gray-200';
};

// Helper function to determine meal type priority for sorting
const getMealTypePriority = (timeOfDay: string): number => {
  if (timeOfDay.includes('7:00 AM')) return 1; // Breakfast
  if (timeOfDay.includes('1:00 PM')) return 2; // Lunch
  if (timeOfDay.includes('4:00 PM')) return 3; // Snack
  if (timeOfDay.includes('7:00 PM')) return 4; // Dinner
  return 5; // Other
};

// Helper function to get meal type label
const getMealTypeLabel = (timeOfDay: string): string => {
  if (timeOfDay.includes('7:00 AM')) return 'Breakfast';
  if (timeOfDay.includes('1:00 PM')) return 'Lunch';
  if (timeOfDay.includes('4:00 PM')) return 'Snack';
  if (timeOfDay.includes('7:00 PM')) return 'Dinner';
  return 'Meal';
};

export default function TodaysDiet() {
  const { data, error } = useQuery({
    queryKey: ['todaysDiet'],
    queryFn: fetchTodaysDiet,
  });

  if (error) {
    return (
      <div className="bg-red-50 text-red-700 p-4 rounded-lg text-center">
        <p>Failed to load diet information. Please try again later.</p>
      </div>
    );
  }

  // If no diet plan or no meals
  if (!data?.dietPlan || data.dietPlan.meals.length === 0) {
    return (
      <div className="text-center py-10">
        <div className="mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4">
          <UtensilsCrossed size={24} className="text-gray-500" />
        </div>
        <p className="text-gray-500">No diet plan available for today.</p>
      </div>
    );
  }

  // Sort meals by time of day
  const sortedMeals = [...data.dietPlan.meals].sort((a, b) => {
    const priorityA = getMealTypePriority(a.timeOfDay);
    const priorityB = getMealTypePriority(b.timeOfDay);
    return priorityA - priorityB;
  });

  return (
    <div className="max-w-2xl mx-auto">
      <div className="space-y-8">
        {sortedMeals.map((meal, index) => {
          const Icon = getMealIcon(meal.timeOfDay);
          const colorClasses = getMealColor(meal.timeOfDay);
          const mealTypeLabel = getMealTypeLabel(meal.timeOfDay);

          // Parse instructions into items for display
          const instructionItems = meal.instructions
            ? meal.instructions
                .split(/[.;]/)
                .map((item) => item.trim())
                .filter((item) => item.length > 0)
            : [];

          // If splitting didn't work, use the full instructions
          const items =
            instructionItems.length > 0
              ? instructionItems
              : meal.instructions
                ? [meal.instructions]
                : ['No specific instructions provided'];

          return (
            <div key={`meal-${meal.id}`} className="relative">
              <div className="flex items-center mb-2">
                <div
                  className={`h-12 w-12 rounded-full bg-gradient-to-br ${colorClasses} border flex items-center justify-center z-10 shadow-sm`}
                >
                  <Icon size={20} className="text-gray-700" />
                </div>
                <div className="ml-4">
                  <h3 className="text-lg font-medium text-gray-800">
                    {mealTypeLabel}: {meal.name}
                  </h3>
                  <div className="flex items-center text-sm text-gray-600">
                    <Clock size={14} className="mr-1" />
                    {meal.timeOfDay}
                  </div>
                </div>
              </div>

              <div
                className={`ml-6 pl-8 border-l-2 ${
                  index === sortedMeals.length - 1 ? '' : 'pb-10'
                } border-gray-300 dark:border-gray-600 relative`}
              >
                {/* Timeline connector dot */}
                <div className="absolute -left-[5px] top-0 h-3 w-3 rounded-full bg-gray-300 dark:bg-gray-600" />

                <div
                  className={`bg-gradient-to-br ${colorClasses} rounded-lg p-4 border shadow-sm`}
                >
                  <ul className="space-y-3">
                    {items.map((item, itemIndex) => (
                      <li
                        key={`instruction-${meal.id}-${itemIndex}`}
                        className="text-gray-700 flex items-start"
                      >
                        <span className="inline-block w-1.5 h-1.5 rounded-full bg-gray-500 mr-2 mt-2" />
                        <span>{item}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

```

# app/dashboard/client/diet/viewdiet/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function ViewDietLoading() {
  const skeletonMealTypes = ['Breakfast', 'Lunch', 'Snack', 'Dinner'];

  return (
    <div className="max-w-2xl mx-auto px-4 py-6">
      <h1 className="text-2xl font-bold mb-6 text-gray-900 text-center">Today's Diet Plan</h1>
      <div className="space-y-8">
        {skeletonMealTypes.map((type) => (
          <div key={`skeleton-${type}`} className="relative">
            <div className="flex items-center mb-2">
              <Skeleton className="h-12 w-12 rounded-full" />
              <div className="ml-4">
                <Skeleton className="h-5 w-32 mb-2" />
                <Skeleton className="h-4 w-16" />
              </div>
            </div>
            <div className="ml-6 pl-8 border-l-2 border-dashed border-gray-200 pb-8">
              <div className="bg-gray-100 rounded-lg p-4 border">
                <div className="space-y-2">
                  <Skeleton className="h-4 w-full" />
                  <Skeleton className="h-4 w-4/5" />
                  <Skeleton className="h-4 w-2/3" />
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

```

# app/dashboard/client/diet/viewdiet/page.tsx

```tsx
import { HydrationBoundary, QueryClient, dehydrate } from '@tanstack/react-query';
import { fetchTodaysDiet } from './_actions/get-todays-diet';
import TodaysDiet from './_components/todays-diet';

export default async function ViewDietPage() {
  const queryClient = new QueryClient();

  // Prefetch the data on the server
  await queryClient.prefetchQuery({
    queryKey: ['todaysDiet'],
    queryFn: fetchTodaysDiet,
  });

  return (
    <div className="max-w-2xl mx-auto px-4 py-6">
      <h1 className="text-2xl font-bold mb-6 text-gray-900 text-center">Today's Diet Plan</h1>
      <HydrationBoundary state={dehydrate(queryClient)}>
        <TodaysDiet />
      </HydrationBoundary>
    </div>
  );
}

```

# app/dashboard/client/home/dashboard/page.tsx

```tsx
export default function DashboardPage() {
  return (
    <div className="py-8">
      <h1 className="text-3xl font-bold">Dashboard</h1>
      <div className="mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {/* Add dashboard metrics and stats here */}
      </div>
    </div>
  );
}

```

# app/dashboard/client/home/gym/page.tsx

```tsx
export default function GymPage() {
  return (
    <div className="h-screen w-screen flex justify-center items-center">
      <h1 className="text-3xl font-bold">My Gym</h1>
      <div className="mt-6">{/* Add gym details and features here */}</div>
    </div>
  );
}

```

# app/dashboard/client/home/layout.tsx

```tsx
import type React from 'react';

export default function HomeLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <div className="container mx-auto px-4">{children}</div>;
}

```

# app/dashboard/client/home/page.tsx

```tsx
export default function HomePage() {
  return (
    <div className="py-12">
      <h1 className="text-3xl font-bold">Home Dashboard</h1>
      <div className="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {/* Add your dashboard cards/widgets here */}
      </div>
    </div>
  );
}

```

# app/dashboard/client/layout.tsx

```tsx
import type React from 'react';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <div className="min-h-screen">{children}</div>;
}

```

# app/dashboard/client/page.tsx

```tsx
export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-between p-24">
      <h1 className="text-4xl font-bold">Welcome to GymNavigator</h1>
    </main>
  );
}

```

# app/dashboard/client/workouts/allworkouts/_actions/get-muscles.ts

```ts
'use server';

import axios from 'axios';
import { ClientReqConfig } from '../../../../../../lib/AxiosInstance/clientAxios';

export interface MuscleGroup {
  img: string;
  id: number;
  name: string;
  image_url: string | null;
  exercises: Exercise[];
}

export interface Exercise {
  id: number;
  name: string;
  image_url: string | null;
  type: string | null;
  equipment: string | null;
  mechanics: string | null;
  experience_level: string | null;
  detail_url: string | null;
  video_url: string | null;
  muscle_image: string | null;
  instructions: string;
  muscle_group: string;
}

export const fetchMuscles = async () => {
  try {
    const clientAxios = await ClientReqConfig();
    const response = await clientAxios.get('/workout/allmuscles');
    console.log('data fetched from the server by the FetchMuscles is', response.data);

    // Access the nested muscleGroups inside the data property
    if (!response.data.data || !response.data.data.muscleGroups) {
      console.error('Unexpected response structure:', response.data);
      throw new Error('Invalid response structure from API');
    }

    return { muscles: response.data.data.muscleGroups };
  } catch (error) {
    console.error('Error in getAllMuscles:', error);
    if (axios.isAxiosError(error)) {
      console.error('Axios error details:', {
        status: error.response?.status,
        data: error.response?.data,
        config: {
          url: error.config?.url,
          method: error.config?.method,
        },
      });
    }
    throw error;
  }
};

```

# app/dashboard/client/workouts/allworkouts/_actions/getAllMuscles.ts

```ts
'use server';

import axios, { type AxiosResponse } from 'axios';
import { unstable_cache } from 'next/cache';
import { ClientReqConfig } from '../../../../../../lib/AxiosInstance/clientAxios';

interface FetchedMusclesResponse {
  msg: string;
  muscleGroups: MuscleGroup[];
}

export interface MuscleGroup {
  img: string;
  id: number;
  name: string;
  image_url: string | null;
  exercises: Exercise[];
}

export interface Exercise {
  id: number;
  name: string;
  image_url: string | null;
  type: string | null;
  equipment: string | null;
  mechanics: string | null;
  experience_level: string | null;
  detail_url: string | null;
  video_url: string | null;
  muscle_image: string | null;
  instructions: string;
  muscle_group: string;
}

export const fetchMuscles = async () => {
  try {
    const response: AxiosResponse<FetchedMusclesResponse> = await axios.get(
      `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/workouts/`,
    );
    return { muscles: response.data.muscleGroups };
  } catch (error) {
    console.error('Error in getAllMuscles:', error);
    if (axios.isAxiosError(error)) {
      console.error('Axios error details:', {
        status: error.response?.status,
        data: error.response?.data,
        config: {
          url: error.config?.url,
          method: error.config?.method,
        },
      });
    }
    throw error;
  }
};

// export default async function getAllMuscles(): Promise<{
//   muscles: MuscleGroup[];
// }> {
//   return unstable_cache(
//     fetchMuscles,
//     ["all-muscles-cache"],
//     {
//       revalidate: 3600, // Cache for 1 hour
//       tags: ["muscles"]
//     }
//   )();
// }

```

# app/dashboard/client/workouts/allworkouts/_components/allworkouts.tsx

```tsx
'use client';

import { Input } from '@/components/ui/input';
import { Skeleton } from '@/components/ui/skeleton';
import { queryClient } from '@/lib//getQueryClient';
import { cn } from '@/lib/utils';
import { useQuery } from '@tanstack/react-query';
import { m } from 'framer-motion';
import { Activity, ArrowRight, Dumbbell, Search } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import { type MuscleGroup, fetchMuscles } from '../_actions/get-muscles';

// Simplified animations for better mobile performance
const _fadeIn = {
  initial: { opacity: 0 },
  animate: { opacity: 1 },
  exit: { opacity: 0 },
};

const categories = [
  { name: 'All', icon: Activity },
  { name: 'Upper Body', icon: Dumbbell },
  { name: 'Lower Body', icon: Dumbbell },
  { name: 'Core', icon: Dumbbell },
];

const upperBodyMuscles = ['Chest', 'Back', 'Shoulders', 'Biceps', 'Triceps', 'Traps', 'Forearms'];
const lowerBodyMuscles = ['Quads', 'Hamstrings', 'Calves', 'Glutes'];
const coreMuscles = ['Abs', 'Obliques', 'Lower Back'];

const MuscleCardSkeleton = () => (
  <div className="rounded-lg overflow-hidden bg-white border border-gray-200 shadow-sm">
    <Skeleton className="aspect-video w-full" />
    <div className="p-4 space-y-3">
      <Skeleton className="h-7 w-1/3" />
      <Skeleton className="h-4 w-full" />
      <Skeleton className="h-5 w-1/4 mt-4" />
    </div>
  </div>
);

interface AllworkoutsProps {
  initialData?: MuscleGroup[];
}

export const Allworkouts = ({ initialData }: AllworkoutsProps) => {
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('All');
  const [filteredMuscles, setFilteredMuscles] = useState<MuscleGroup[]>([]);
  const Router = useRouter();

  const { data, isLoading, error } = useQuery({
    queryKey: ['muscles'],
    queryFn: fetchMuscles,
    staleTime: 1000 * 60 * 60 * 24, // 24 hours
    gcTime: 1000 * 60 * 60 * 24 * 7, // 7 days
    initialData: initialData ? { muscles: initialData } : undefined,
  });

  const muscles = data?.muscles || []; // Provide a default empty array

  useEffect(() => {
    if (!muscles || muscles.length === 0) return;
    let filtered = [...muscles];

    if (selectedCategory === 'Upper Body') {
      filtered = filtered.filter((m) => upperBodyMuscles.includes(m.name));
    } else if (selectedCategory === 'Lower Body') {
      filtered = filtered.filter((m) => lowerBodyMuscles.includes(m.name));
    } else if (selectedCategory === 'Core') {
      filtered = filtered.filter((m) => coreMuscles.includes(m.name));
    }

    filtered = filtered.filter((muscle) =>
      muscle.name.toLowerCase().includes(searchTerm.toLowerCase()),
    );

    setFilteredMuscles(filtered);
  }, [searchTerm, muscles, selectedCategory]);

  const handleMuscleClick = (muscleName: string) => {
    Router.push(`/dashboard/client/workouts/allworkouts/${muscleName.toLowerCase()}`);
  };

  console.log('filteredMuscles', filteredMuscles);

  return (
    <section className="space-y-8">
      {/* Search and Filters */}
      <div className=" z-10 p-4">
        <nav aria-label="Workout categories" className="mb-4">
          <div className="grid grid-cols-2 md:flex md:flex-row gap-2">
            {categories.map((category) => (
              <button
                key={category.name}
                onClick={() => setSelectedCategory(category.name)}
                className={cn(
                  'px-4 py-2 rounded-full flex items-center justify-center gap-2 transition-colors',
                  'w-full md:w-auto',
                  selectedCategory === category.name
                    ? 'bg-blue-500 text-white'
                    : 'bg-white text-gray-700 hover:bg-gray-50 border border-gray-200',
                )}
                type="button"
              >
                <category.icon className="w-4 h-4" />
                <span>{category.name}</span>
              </button>
            ))}
          </div>
        </nav>

        <div className="relative">
          <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
          <Input
            type="search"
            placeholder="Search muscle groups..."
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="w-full pl-10 pr-4 py-2"
            aria-label="Search muscle groups"
          />
        </div>
      </div>

      {/* Error State */}
      {error && (
        <div role="alert" className="p-4 text-center text-red-500">
          <p className="text-xl font-semibold">Error loading workouts</p>
          <p className="text-sm">{error instanceof Error ? error.message : error}</p>
        </div>
      )}

      {/* Loading State */}
      {isLoading ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 px-4">
          {Array.from({ length: 6 }).map((_, index) => (
            <MuscleCardSkeleton key={index as number} />
          ))}
        </div>
      ) : (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 px-4">
          {filteredMuscles.length === 0 ? (
            <p className="col-span-full text-center py-8 text-gray-500">
              No workouts found matching your criteria
            </p>
          ) : (
            filteredMuscles.map((muscle) => (
              <article
                key={muscle.name}
                onClick={() => handleMuscleClick(muscle.name)}
                className="group cursor-pointer rounded-lg overflow-hidden bg-white border border-gray-200 hover:border-blue-500 transition-colors shadow-sm hover:shadow-md"
                onKeyDown={(e) => {
                  if (e.key === 'Enter' || e.key === ' ') {
                    handleMuscleClick(muscle.name);
                  }
                }}
              >
                <div className="aspect-video relative overflow-hidden">
                  <img
                    src={muscle.image_url as string}
                    alt={`${muscle.name} exercises`}
                    className="w-full h-full object-cover transition-transform group-hover:scale-105"
                    loading="lazy"
                  />
                  <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent" />
                  <div className="absolute bottom-4 left-4 right-4 flex justify-between items-center flex-wrap gap-2">
                    <span className="px-3 py-1 bg-blue-500/90 rounded-full text-sm text-white">
                      {selectedCategory}
                    </span>
                    <span className="px-3 py-1 bg-purple-500/90 rounded-full text-sm text-white">
                      {muscle.exercises?.length || 0} Exercises
                    </span>
                  </div>
                </div>

                <div className="p-4 flex flex-col min-h-[160px]">
                  <h2 className="text-xl font-bold text-gray-800 group-hover:text-blue-500 transition-colors break-words line-clamp-2">
                    {muscle.name.charAt(0).toUpperCase() + muscle.name.slice(1).toLowerCase()}
                  </h2>
                  <p className="text-gray-600 mt-2 mb-4 line-clamp-2 flex-grow">
                    Master your {muscle.name.toLowerCase()} with our curated exercises
                  </p>
                  <div className="flex items-center text-blue-500 group-hover:text-blue-600 mt-auto">
                    Explore Workouts
                    <ArrowRight className="w-4 h-4 ml-2 transition-transform group-hover:translate-x-1" />
                  </div>
                </div>
              </article>
            ))
          )}
        </div>
      )}
    </section>
  );
};

```

# app/dashboard/client/workouts/allworkouts/[musclename]/_components/hooks/useExercises.ts

```ts
import { useQuery } from '@tanstack/react-query';
import axios from 'axios';
import type { Excercisetype } from '../../actions/getSIngleMuscle';

// Define interface for the API response exercise structure
interface ExerciseApiResponse {
  name: string;
  image_url?: string;
  instructions?: string;
  video_url?: string;
  MuscleGroup?: {
    id?: number;
    name?: string;
    image_url?: string;
  };
  muscle_image?: string;
}

async function fetchExercises(muscleName: string): Promise<Excercisetype[]> {
  try {
    const response = await axios.get(
      `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/workouts/${muscleName}`,
    );

    // Log the raw response for debugging
    console.log(`Client-side API response for ${muscleName}:`, response.data);

    // Check basic response structure
    if (!response.data || !response.data.success) {
      console.error('API returned error response:', response.data);
      return [];
    }

    // Check for nested data structure
    if (!response.data.data || !response.data.data.exercises) {
      console.error('Missing exercises in API response:', response.data);
      return [];
    }

    const exercises = response.data.data.exercises;
    console.log(`Found ${exercises.length} exercises for ${muscleName}`);

    // Transform data with robust error handling
    return exercises.map((exercise: ExerciseApiResponse) => ({
      name: exercise.name || 'Unknown Exercise',
      img: exercise.image_url || '',
      instructions: exercise.instructions || 'No instructions available',
      videolink: exercise.video_url || '',
      MuscleGroup: {
        id: exercise.MuscleGroup?.id || 0,
        name: exercise.MuscleGroup?.name || muscleName,
        img: exercise.MuscleGroup?.image_url || '',
        fullimage: exercise.muscle_image || '',
      },
    }));
  } catch (error) {
    console.error(`Error fetching exercises for ${muscleName}:`, error);
    return [];
  }
}

export function useExercises(muscleName: string) {
  return useQuery({
    queryKey: ['exercises', muscleName],
    queryFn: () => fetchExercises(muscleName),
    staleTime: 5 * 60 * 1000, // Data stays fresh for 5 minutes
    gcTime: 10 * 60 * 1000, // Keep unused data in cache for 10 minutes
    initialData: [], // Start with empty array to prevent undefined errors
  });
}

```

# app/dashboard/client/workouts/allworkouts/[musclename]/_components/singleMuscle.tsx

```tsx
'use client';

import { m } from 'framer-motion';
import { ArrowRight, Dumbbell, Search } from 'lucide-react';
import { usePathname, useRouter } from 'next/navigation';
import { useState } from 'react';
import type { Excercisetype } from '../actions/getSIngleMuscle';
import { useExercises } from './hooks/useExercises';

const containerVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.5,
      staggerChildren: 0.1,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
  },
};

interface SingleMusclesProps {
  initialExercises: Excercisetype[];
  muscleName: string;
}

export const SingleMuscles = ({ initialExercises, muscleName }: SingleMusclesProps) => {
  const { data: exercises = initialExercises } = useExercises(muscleName);

  const filteredExercises = exercises.filter(
    (exercise) => exercise?.MuscleGroup?.name?.toLowerCase() === muscleName?.toLowerCase(),
  );

  return (
    <m.div
      initial="hidden"
      animate="visible"
      variants={containerVariants}
      className="min-h-screen bg-gray-50/50"
    >
      {/* Header Section */}
      <div className="relative overflow-hidden bg-white border-b border-gray-100">
        <div className="absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50/50" />
        <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-20">
          <m.div
            variants={itemVariants}
            className="flex flex-col items-center text-center space-y-6"
          >
            <div className="inline-flex items-center px-4 py-1.5 bg-blue-50 text-blue-700 rounded-full text-sm font-medium">
              <Dumbbell className="w-4 h-4 mr-2" />
              Workout Guide
            </div>
            <h1 className="text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 tracking-tight max-w-4xl">
              <span className="bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent break-words whitespace-normal">
                {muscleName?.charAt(0)?.toUpperCase() + muscleName?.slice(1)} Exercises
              </span>
            </h1>
            <p className="text-gray-600 text-lg sm:text-xl max-w-2xl">
              Discover professional-grade exercises designed to target and strengthen your{' '}
              {muscleName?.toLowerCase()} muscles effectively.
            </p>
          </m.div>
        </div>
      </div>

      {/* Content Section */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <RecommenedExcercise Excercises={filteredExercises} />
      </div>
    </m.div>
  );
};

const RecommenedExcercise = ({
  Excercises,
}: {
  Excercises: Excercisetype[];
}) => {
  const [searchQuery, setSearchQuery] = useState('');
  const [difficultyFilter, setDifficultyFilter] = useState<string>('');

  const difficultyOptions = [
    { value: 'Beginner', icon: '🟢', color: 'emerald' },
    { value: 'Intermediate', icon: '🟡', color: 'yellow' },
    { value: 'Advanced', icon: '🔴', color: 'red' },
  ];

  const filteredExercises = Excercises.filter((exercise) => {
    const matchesSearch = exercise.name.toLowerCase().includes(searchQuery.toLowerCase());
    const matchesDifficulty =
      !difficultyFilter ||
      (exercise.instructions.length > 500 && difficultyFilter === 'Advanced') ||
      (exercise.instructions.length > 200 && difficultyFilter === 'Intermediate') ||
      (exercise.instructions.length <= 200 && difficultyFilter === 'Beginner');

    return matchesSearch && matchesDifficulty;
  });

  return (
    <m.div variants={containerVariants} className="space-y-8">
      {/* Search and Filter Section */}
      <div className="bg-white rounded-2xl shadow-sm border border-gray-100">
        <div className="p-6">
          <div className="flex flex-col sm:flex-row gap-4">
            {/* Search Input */}
            <div className="relative flex-1">
              <Search className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
              <input
                type="text"
                placeholder="Search exercises..."
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className="w-full pl-12 pr-4 py-3 text-base border border-gray-200 rounded-xl 
                         focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"
              />
            </div>

            {/* Difficulty Filter */}
            <div className="flex items-center gap-4">
              <span className="text-sm text-gray-600 font-medium whitespace-nowrap">
                Difficulty:
              </span>
              <div className="flex gap-2">
                {difficultyOptions.map((option) => (
                  <button
                    key={option.value}
                    onClick={() =>
                      setDifficultyFilter(difficultyFilter === option.value ? '' : option.value)
                    }
                    type="button"
                    className={`inline-flex items-center gap-2 px-4 py-3 rounded-xl text-sm font-medium
                      transition-all duration-200 border
                      ${
                        difficultyFilter === option.value
                          ? 'bg-blue-50 border-blue-200 text-blue-700'
                          : 'bg-white border-gray-200 text-gray-700 hover:bg-gray-50'
                      }`}
                  >
                    <span>{option.icon}</span>
                    <span className="hidden sm:inline">{option.value}</span>
                  </button>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* Exercise Grid */}
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {filteredExercises.map((exercise) => (
          <m.div
            key={`${exercise.name}-${exercise.MuscleGroup.id}`}
            variants={itemVariants}
            className="h-full"
          >
            <ExcerciseCard
              name={exercise.name}
              img={exercise.img}
              instructions={exercise.instructions}
            />
          </m.div>
        ))}
      </div>
    </m.div>
  );
};

const ExcerciseCard = ({
  name,
  img,
  instructions,
}: {
  name: string;
  img: string;
  instructions: string;
}) => {
  const pathname = usePathname();
  const router = useRouter();
  const difficulty =
    instructions.length > 500
      ? 'Advanced'
      : instructions.length > 200
        ? 'Intermediate'
        : 'Beginner';

  const difficultyColors = {
    Beginner: 'bg-emerald-50 text-emerald-700',
    Intermediate: 'bg-yellow-50 text-yellow-700',
    Advanced: 'bg-red-50 text-red-700',
  };

  return (
    <div
      className="group bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md 
                 transition-all duration-300 border border-gray-100 h-full flex flex-col"
    >
      <div className="relative aspect-[4/3] overflow-hidden bg-gray-100">
        <img
          src={img}
          alt={`${name} exercise`}
          className="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
        <div
          className={`absolute bottom-3 right-3 px-3 py-1.5 text-sm font-medium rounded-full 
                        ${difficultyColors[difficulty as keyof typeof difficultyColors]}`}
        >
          {difficulty}
        </div>
      </div>
      <div className="p-5 flex flex-col flex-1 justify-between">
        <h3 className="text-lg font-semibold text-gray-900 mb-4 line-clamp-1">{name}</h3>
        <button
          type="button"
          onClick={() => router.push(`${pathname}/${name}`)}
          className="inline-flex items-center justify-between px-4 py-2.5 text-sm font-medium
                   text-white bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl
                   hover:from-blue-700 hover:to-indigo-700 transition-all duration-300
                   shadow-sm hover:shadow group"
        >
          <span>View Details</span>
          <ArrowRight className="w-4 h-4 ml-2 transition-transform duration-300 group-hover:translate-x-1" />
        </button>
      </div>
    </div>
  );
};

```

# app/dashboard/client/workouts/allworkouts/[musclename]/[excercisename]/_components/excercise.tsx

```tsx
'use client';

import { useQuery } from '@tanstack/react-query';
import { BookMarked, Heart, Share2, Target } from 'lucide-react';
import Image from 'next/image';
import { useParams } from 'next/navigation';
import { useEffect, useRef, useState } from 'react';
import { type Exercise, GetExcerciseDetails } from '../actions/get-excercise-details';

export const SingleWorkout = () => {
  const { excercisename = '', musclename = '' } = useParams<{
    excercisename: string;
    musclename: string;
  }>();

  const [isLiked, setIsLiked] = useState(false);

  const { data: exercise, error } = useQuery<Exercise, Error>({
    queryKey: ['exercise', musclename, excercisename],
    queryFn: () => GetExcerciseDetails(musclename, excercisename),
    enabled: !!musclename && !!excercisename,
  });

  if (error) {
    return (
      <div className="flex items-center justify-center min-h-[60vh] bg-red-50 mx-4 rounded-2xl animate-fade-in">
        <div className="text-center space-y-4 p-8">
          <div className="w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center">
            <span className="text-2xl" role="img" aria-label="warning">
              ⚠️
            </span>
          </div>
          <h2 className="text-2xl font-bold text-red-500">Exercise Not Found</h2>
          <p className="text-gray-600 max-w-md">
            We couldn't load this exercise. Please try again or choose a different one.
          </p>
        </div>
      </div>
    );
  }

  if (!exercise) {
    return null;
  }

  const videoId = exercise.video_url?.split('/').pop() || '';

  return (
    <article className="max-w-7xl mx-auto px-4 py-8">
      <div className="space-y-6 lg:space-y-12 animate-fade-in">
        {/* Exercise Header */}
        <header className="space-y-6 mb-8 lg:mb-12">
          <h1 className="text-3xl sm:text-4xl lg:text-6xl font-extrabold text-center bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent">
            {exercise.name}
          </h1>

          <div className="flex flex-wrap justify-center items-center gap-4">
            <div className="flex items-center gap-2 px-4 py-2 bg-blue-50 rounded-full">
              <Target className="w-4 h-4 text-blue-500" />
              <span className="text-blue-700 font-medium">{musclename}</span>
            </div>
            <div className="flex gap-3">
              <button
                type="button"
                aria-label="Share exercise"
                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
              >
                <Share2 className="w-5 h-5 text-gray-600" />
              </button>
              <button
                type="button"
                aria-label="Bookmark exercise"
                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
              >
                <BookMarked className="w-5 h-5 text-gray-600" />
              </button>
              <button
                type="button"
                aria-label={isLiked ? 'Unlike exercise' : 'Like exercise'}
                onClick={() => setIsLiked(!isLiked)}
                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
              >
                <Heart
                  className={`w-5 h-5 ${isLiked ? 'text-red-500 fill-red-500' : 'text-gray-600'}`}
                />
              </button>
            </div>
          </div>
        </header>

        {/* Video Section */}
        <section className="relative rounded-2xl overflow-hidden shadow-2xl bg-gray-900">
          <LazyVideo videoId={videoId} />
        </section>

        {/* Exercise Details */}
        <section className="mt-8 lg:mt-16">
          <ExerciseDescription
            img={exercise.muscle_image}
            instruction={exercise.instructions}
            muscleName={exercise.muscle_group}
          />
        </section>
      </div>
    </article>
  );
};

const LazyVideo = ({ videoId }: { videoId: string }) => {
  const [isIntersecting, setIsIntersecting] = useState(false);
  const [isLoading, setIsLoading] = useState(true);
  const videoRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        setIsIntersecting(entry.isIntersecting);
      },
      { threshold: 0.1 },
    );

    if (videoRef.current) {
      observer.observe(videoRef.current);
    }

    return () => {
      if (videoRef.current) {
        observer.unobserve(videoRef.current);
      }
    };
  }, []);

  return (
    <div ref={videoRef} className="aspect-video w-full relative">
      {isLoading && isIntersecting && (
        <div className="absolute inset-0 bg-gray-100 animate-pulse rounded-2xl" />
      )}
      {isIntersecting && (
        <iframe
          className="w-full h-full rounded-2xl"
          src={`https://www.youtube-nocookie.com/embed/${videoId}?start=0&rel=0&modestbranding=1`}
          title="Exercise demonstration video"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          loading="lazy"
          onLoad={() => setIsLoading(false)}
          allowFullScreen
        />
      )}
    </div>
  );
};

const ExerciseDescription = ({
  instruction,
  muscleName,
  img,
}: {
  instruction: string;
  muscleName: string;
  img: string;
}) => {
  const instructions = instruction
    .split('.')
    .map((line) =>
      line
        .replace(/^\d+\.?\s*/, '')
        .replace(/\\n/g, ' ')
        .replace(/\s+/g, ' ')
        .trim(),
    )
    .filter((line) => line.length > 0);

  return (
    <div className="space-y-8 lg:space-y-12">
      {/* Muscle Group Header */}
      <div className="bg-gradient-to-r from-blue-50 to-blue-100 p-6 lg:p-8 rounded-2xl">
        <div className="flex items-center justify-center gap-4">
          <Target className="w-6 lg:w-8 h-6 lg:h-8 text-blue-600" />
          <h2 className="text-2xl lg:text-3xl font-bold text-blue-900">
            {muscleName.toUpperCase()}
          </h2>
        </div>
      </div>

      <div className="lg:grid lg:grid-cols-2 gap-8 lg:gap-12">
        {/* Muscle Image */}
        <figure className="relative group mb-8 lg:mb-0">
          <div className="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-2xl" />
          <div className="relative aspect-[4/3] w-full">
            <Image
              src={img}
              alt={`Diagram showing ${muscleName} muscle group`}
              fill
              className="rounded-2xl object-cover shadow-lg"
              sizes="(max-width: 768px) 100vw, 50vw"
              priority={false}
            />
          </div>
        </figure>

        {/* Instructions */}
        <div className="space-y-6">
          <h3 className="text-xl lg:text-2xl font-bold text-gray-900 mb-6 lg:mb-8">
            Step-by-Step Guide
          </h3>
          <ol className="space-y-4">
            {instructions.map((line, index) => (
              <li
                key={`instruction-${line.substring(0, 20)}-${index}`}
                className="flex gap-4 p-4 rounded-xl hover:bg-gray-50 transition-colors"
              >
                <span className="flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold">
                  {index + 1}
                </span>
                <p className="text-gray-700 leading-relaxed">{line}</p>
              </li>
            ))}
          </ol>
        </div>
      </div>

      {/* Footer */}
      <footer className="text-center py-8 lg:py-12">
        <div className="inline-flex items-center gap-2 px-6 py-3 bg-blue-50 rounded-full text-blue-600 font-medium">
          <Heart className="w-4 h-4" />
          <span>Subscribe to GymNavigator for more content</span>
        </div>
      </footer>
    </div>
  );
};

```

# app/dashboard/client/workouts/allworkouts/[musclename]/[excercisename]/actions/get-excercise-details.tsx

```tsx
import type { AxiosResponse } from 'axios';
import { ClientReqConfig } from '../../../../../../../../lib/AxiosInstance/clientAxios';

export interface Exercise {
  name: string;
  video_url: string;
  muscle_image: string;
  instructions: string;
  muscle_group: string;
}

interface SingleExerciseResponse {
  success: boolean;
  msg: string;
  data: {
    exercise: Exercise;
  };
}

export const GetExcerciseDetails = async (
  _muscleName: string,
  excerciseName: string,
): Promise<Exercise> => {
  const clientAxios = await ClientReqConfig();
  try {
    const response: AxiosResponse<SingleExerciseResponse> = await clientAxios.get(
      `/workout/singleworkout/${excerciseName}`,
    );

    // Check for the nested data structure
    if (!response.data.data || !response.data.data.exercise) {
      throw new Error('Exercise not found or invalid response structure');
    }

    return response.data.data.exercise;
  } catch (error) {
    console.error('Error fetching exercise:', error);
    throw error;
  }
};

```

# app/dashboard/client/workouts/allworkouts/[musclename]/[excercisename]/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function Loading() {
  return (
    <main className="min-h-screen bg-gray-50">
      <article className="max-w-7xl mx-auto px-4 py-8">
        <div className="space-y-6 lg:space-y-12">
          {/* Exercise Header Skeleton */}
          <header className="space-y-6 mb-8 lg:mb-12">
            <Skeleton className="h-12 sm:h-14 lg:h-16 w-3/4 mx-auto rounded-lg" />
            <div className="flex flex-wrap justify-center items-center gap-4">
              <Skeleton className="h-10 w-32 rounded-full" />
              <div className="flex gap-3">
                {[...Array(3)].map((_, i) => (
                  <Skeleton key={`action-${i as number}`} className="h-9 w-9 rounded-full" />
                ))}
              </div>
            </div>
          </header>

          {/* Video Section Skeleton */}
          <section>
            <Skeleton className="w-full aspect-video rounded-2xl" />
          </section>

          {/* Exercise Details Skeleton */}
          <section className="mt-8 lg:mt-16 space-y-8">
            <Skeleton className="h-16 w-full rounded-2xl" />

            <div className="lg:grid lg:grid-cols-2 gap-8 lg:gap-12">
              {/* Muscle Image Skeleton */}
              <Skeleton className="h-[300px] w-full rounded-2xl" />

              {/* Instructions Skeleton */}
              <div className="space-y-6">
                <Skeleton className="h-8 w-48" />
                <div className="space-y-4">
                  {[...Array(5)].map((_, i) => (
                    <div key={`instruction-${i as number}`} className="flex gap-4">
                      <Skeleton className="h-8 w-8 rounded-full flex-shrink-0" />
                      <Skeleton className="h-8 w-full rounded-lg" />
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </section>
        </div>
      </article>
    </main>
  );
}

```

# app/dashboard/client/workouts/allworkouts/[musclename]/[excercisename]/page.tsx

```tsx
import { queryClient } from '@/lib/getQueryClient';
import { HydrationBoundary, dehydrate } from '@tanstack/react-query';
import { Suspense } from 'react';
import { SingleWorkout } from './_components/excercise';
import { GetExcerciseDetails } from './actions/get-excercise-details';

// Proper Next.js 15 page params type

// in next 15 params are return promise
export default async function Page({
  params,
}: {
  params: Promise<{ musclename: string; excercisename: string }>;
}) {
  // Direct access without await

  const { musclename, excercisename } = await params;

  await queryClient.prefetchQuery({
    queryKey: ['exercise', musclename, excercisename],
    queryFn: () => GetExcerciseDetails(musclename, excercisename),
  });

  const dehydratedState = dehydrate(queryClient);

  return (
    <main className="min-h-screen bg-gray-50">
      <HydrationBoundary state={dehydratedState}>
        <Suspense fallback={<LoadingSkeleton />}>
          <SingleWorkout />
        </Suspense>
      </HydrationBoundary>
    </main>
  );
}

// Moved loading UI to separate component
function LoadingSkeleton() {
  return (
    <div className="flex items-center justify-center min-h-[60vh]">
      <div className="relative">
        <div className="w-16 h-16 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin" />
        <div className="mt-4 text-blue-600 font-medium">Loading exercise...</div>
      </div>
    </div>
  );
}

```

# app/dashboard/client/workouts/allworkouts/[musclename]/actions/getSIngleMuscle.ts

```ts
'use server';
import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';
import type { AxiosResponse } from 'axios';

export interface MuscleGroupType {
  id: number;
  name: string;
  img: string;
  fullimage: string;
  image_url?: string;
}

export interface Exercise {
  id: number;
  name: string;
  muscleGroupId: number;
  image_url?: string;
  video_url?: string;
  instructions: string;
  muscle_group: string;
  muscle_image?: string;
}

export interface ExerciseWithMuscle extends Exercise {
  MuscleGroup: MuscleGroupType & {
    exercises: Exercise[];
  };
}

// Update the interface to match the backend response structure
export interface SingleMuscleResponse {
  success: boolean;
  msg: string;
  data: {
    exercises: ExerciseWithMuscle[];
  };
}

export interface Excercisetype {
  name: string;
  img: string;
  instructions: string;
  videolink: string;
  MuscleGroup: {
    id: number;
    name: string;
    img: string;
    fullimage: string;
  };
}

export const getSingleMuscle = async (muscle: string): Promise<Excercisetype[]> => {
  try {
    const clientAxios = await ClientReqConfig();

    // Log the request URL for debugging
    console.log(`Fetching exercises for muscle: ${muscle}`);

    const response: AxiosResponse<SingleMuscleResponse> = await clientAxios.get(
      `/workout/${muscle}`,
    );

    // Log the raw response to see its structure
    console.log('Raw API response:', JSON.stringify(response.data, null, 2));

    // Check for response structure
    if (!response.data || !response.data.success) {
      console.error('API returned error or invalid response:', response.data);
      return [];
    }

    // Check if data and exercises exist
    if (!response.data.data || !response.data.data.exercises) {
      console.error('Missing exercises in response:', response.data);
      return [];
    }

    const exercises = response.data.data.exercises;
    console.log(`Found ${exercises.length} exercises for ${muscle}`);

    // Transform and return the exercises with more robust error handling
    return exercises.map((exercise: ExerciseWithMuscle) => {
      if (!exercise.MuscleGroup) {
        console.warn(`Exercise ${exercise.name} missing MuscleGroup data`);
      }

      return {
        name: exercise.name || 'Unknown',
        img: exercise.image_url || '',
        instructions: exercise.instructions || 'No instructions available',
        videolink: exercise.video_url || '',
        MuscleGroup: {
          id: exercise.MuscleGroup?.id || 0,
          name: exercise.MuscleGroup?.name || muscle,
          img: exercise.MuscleGroup?.image_url || '',
          fullimage: exercise.muscle_image || '',
        },
      };
    });
  } catch (error) {
    console.error('Error fetching single muscle exercises:', error);
    return [];
  }
};

```

# app/dashboard/client/workouts/allworkouts/[musclename]/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function Loading() {
  return (
    <main className="min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-gray-50">
      {/* Header Section Skeleton */}
      <header className="bg-gradient-to-r from-blue-600 to-blue-700 text-white mt-4 mx-4 rounded-2xl shadow-lg">
        <div className="max-w-7xl mx-auto px-8 py-16 lg:py-20 relative overflow-hidden">
          <div className="relative flex flex-col items-center">
            <Skeleton className="w-32 h-8 mb-6 rounded-full  bg-transparent" />
            <div className="space-y-4 text-center">
              <Skeleton
                className="w-64 h-16 mx-auto rounded-lg bg-transparent"
                aria-label="Exercise title loading"
              />
              <Skeleton
                className="w-96 h-12 mx-auto rounded-lg bg-transparent"
                aria-label="Exercise description loading"
              />
            </div>
          </div>
        </div>
      </header>

      {/* Content Section Skeleton */}
      <section className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        {/* Search and Filter Bar Skeleton */}
        <div className="z-40 bg-white shadow-sm rounded-2xl border border-gray-100 mb-8">
          <div className="p-4">
            <div className="flex items-center gap-4">
              <Skeleton className="flex-1 h-12 rounded-xl" aria-label="Search bar loading" />
              <fieldset className="hidden md:flex gap-2" aria-label="Filter options loading">
                <Skeleton className="w-28 h-12 rounded-xl" />
                <Skeleton className="w-28 h-12 rounded-xl" />
                <Skeleton className="w-28 h-12 rounded-xl" />
              </fieldset>
            </div>
          </div>
        </div>

        {/* Exercise Grid Skeleton */}
        <ul
          className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 list-none p-0"
          aria-label="Loading exercise cards"
        >
          {[...Array(6)].map((_, i) => (
            <li
              key={i as number}
              className="bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100"
              aria-label="Exercise card loading"
            >
              <Skeleton className="w-full aspect-[4/3]" aria-label="Exercise image loading" />
              <div className="p-6 space-y-4">
                <Skeleton className="w-3/4 h-6 rounded-lg" aria-label="Exercise name loading" />
                <Skeleton
                  className="w-full h-12 rounded-xl"
                  aria-label="View exercise button loading"
                />
              </div>
            </li>
          ))}
        </ul>
      </section>
    </main>
  );
}

```

# app/dashboard/client/workouts/allworkouts/[musclename]/page.tsx

```tsx
import { queryClient } from '@/lib/getQueryClient';
import { HydrationBoundary, dehydrate } from '@tanstack/react-query';
import { Suspense } from 'react';
import { SingleMuscles } from './_components/singleMuscle';
import { getSingleMuscle } from './actions/getSIngleMuscle';
import Loading from './loading';
export default async function Page({
  params,
}: {
  params: Promise<{ musclename: string }>;
}) {
  // Decode the URL parameter and remove any potential encoding artifacts
  const { musclename } = await params;
  const muscleName = musclename
    .split(' ')
    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
    .join(' ');

  // Initialize QueryClient

  // Prefetch the data
  await queryClient.prefetchQuery({
    queryKey: ['exercises', muscleName],
    queryFn: () => getSingleMuscle(muscleName),
  });

  return (
    <main aria-labelledby="page-title">
      <header className="sr-only border-4 border-red-400">
        <h1 id="page-title">{muscleName}</h1>
      </header>

      <Suspense fallback={<Loading />}>
        <HydrationBoundary state={dehydrate(queryClient)}>
          <SingleMuscles
            initialExercises={[]} // Initial data will come from query client
            muscleName={muscleName}
          />
        </HydrationBoundary>
      </Suspense>
    </main>
  );
}

```

# app/dashboard/client/workouts/allworkouts/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

const LoadingSkeleton = () => (
  <div className="rounded-lg overflow-hidden bg-white border border-gray-200 shadow-sm">
    <Skeleton className="aspect-video w-full" />
    <div className="p-4 space-y-3">
      <Skeleton className="h-7 w-1/3" />
      <Skeleton className="h-4 w-full" />
      <Skeleton className="h-5 w-1/4 mt-4" />
    </div>
  </div>
);

export default function Loading() {
  return (
    <main className="min-h-screen bg-gradient-to-br from-gray-50 via-gray-100 to-gray-50">
      <div className="max-w-7xl mx-auto py-8">
        <header className="mb-8 text-center space-y-4">
          <Skeleton className="h-10 w-48 mx-auto" />
          <Skeleton className="h-6 w-96 mx-auto" />
        </header>

        {/* Category Skeleton */}
        <div className="p-4">
          <nav className="mb-4">
            <div className="grid grid-cols-2 md:flex md:flex-row gap-2">
              {Array.from({ length: 4 }).map((_, i) => (
                <Skeleton key={i as number} className="h-10 w-full md:w-32" />
              ))}
            </div>
          </nav>

          {/* Search Bar Skeleton */}
          <Skeleton className="h-10 w-full mt-4" />
        </div>

        {/* Muscle Cards Grid Skeleton */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 px-4 mt-8">
          {Array.from({ length: 6 }).map((_, index) => (
            <LoadingSkeleton key={index as number} />
          ))}
        </div>
      </div>
    </main>
  );
}

```

# app/dashboard/client/workouts/allworkouts/page.tsx

```tsx
import { queryClient } from '@/lib/getQueryClient';
import { HydrationBoundary, dehydrate } from '@tanstack/react-query';
import type { Metadata } from 'next';
import { type MuscleGroup, fetchMuscles } from './_actions/get-muscles';
import { Allworkouts } from './_components/allworkouts';

export const metadata: Metadata = {
  title: 'All Workouts | Gym Navigator',
  description:
    'Explore our comprehensive collection of workouts organized by muscle groups. Find exercises tailored to your fitness goals.',
};

export default async function AllWorkoutsPage() {
  // Get cached data if available
  const cachedData = queryClient.getQueryData<{ muscles: MuscleGroup[] }>(['muscles']);

  console.log('cached data is this ', cachedData);
  // If no cached data, prefetch it
  if (!cachedData || !cachedData.muscles) {
    await queryClient.prefetchQuery({
      queryKey: ['muscles'],
      queryFn: fetchMuscles,
      staleTime: 1000 * 60 * 60 * 24, // 24 hours
    });
  }

  // Get the data after prefetching (if it was needed)
  const initialData = queryClient.getQueryData<{ muscles: MuscleGroup[] }>(['muscles']);
  console.log('fetched data is this', initialData);
  const dehydratedState = dehydrate(queryClient);

  return (
    <main className="min-h-screen">
      <div className="max-w-7xl mx-auto py-8">
        <header className="mb-8 text-center">
          <h1 className="text-3xl font-bold text-gray-900">All Workouts</h1>
          <p className="mt-2 text-gray-600">Discover exercises tailored to your fitness journey</p>
        </header>
        <HydrationBoundary state={dehydratedState}>
          <Allworkouts initialData={initialData?.muscles} />
        </HydrationBoundary>
      </div>
    </main>
  );
}

```

# app/dashboard/client/workouts/layout.tsx

```tsx
import type React from 'react';

export default function WorkoutsLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <div className="container mx-auto px-4">{children}</div>;
}

```

# app/dashboard/client/workouts/myworkouts/_actions/get-todays-diet.ts

```ts
'use server';

import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';
import type { AxiosResponse } from 'axios';

// Types that match backend data structure
export interface Ingredient {
  name: string;
  quantity: string | null;
}

export interface Meal {
  id: number;
  name: string;
  timeOfDay: string;
  calories: number;
  protein: number;
  carbs: number;
  fats: number;
  instructions: string;
  ingredients: Ingredient[];
}

export interface DietPlan {
  id: number;
  name: string;
  description: string | null;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  meals: Meal[];
  createdAt: string;
  updatedAt: string;
}

// Backend API Response type
interface ApiResponse {
  success: boolean;
  msg: string;
  data?: {
    dietPlan: DietPlan;
  };
  error?: string;
}

export const getTodaysDiet = async (): Promise<DietPlan | null> => {
  try {
    const clientAxios = await ClientReqConfig();

    // Fetch the diet plan from the backend
    const response: AxiosResponse<ApiResponse> = await clientAxios.get('/diet/today');

    if (!response.data?.success || !response.data?.data?.dietPlan) {
      return null;
    }

    // The backend now returns the complete diet plan structure
    return response.data.data.dietPlan;
  } catch (error) {
    console.error("Error fetching today's diet:", error);
    throw error;
  }
};

```

# app/dashboard/client/workouts/myworkouts/_actions/get-todays-workout.ts

```ts
'use server';

import { ClientReqConfig } from '@/lib/AxiosInstance/clientAxios';
import type { AxiosResponse } from 'axios';

// Types that match backend exactly
export interface Exercise {
  id: number;
  name: string;
  image_url: string | null;
  type: string | null;
  equipment: string | null;
  mechanics: string | null;
  experience_level: string | null;
  detail_url: string | null;
  video_url: string | null;
  muscle_image: string | null;
  instructions: string;
  muscle_group: string;
  MuscleGroup: {
    id: number;
    name: string;
    image_url: string | null;
  };
}

export interface WorkoutExercise {
  id: string;
  workoutId: string;
  exerciseId: number;
  sets: number;
  reps: number;
  rest: number;
  notes: string | null;
  exercise: Exercise;
}

export interface MuscleGroup {
  muscle: string;
  exercises: WorkoutExercise[];
}

export interface TodaysWorkout {
  id: string;
  name: string;
  description: string;
  day: string;
  muscleGroups: MuscleGroup[];
}

// Backend API Response type
interface ApiResponse {
  success: boolean;
  msg: string;
  data?: {
    workout: TodaysWorkout;
  };
  error?: string;
}

export const getTodaysWorkout = async (): Promise<TodaysWorkout | null> => {
  try {
    const clientAxios = await ClientReqConfig();

    const response: AxiosResponse<ApiResponse> = await clientAxios.get(
      '/workout/myworkouts/get-todays-workout',
    );

    if (!response.data?.data?.workout) {
      return null;
    }

    return response.data.data.workout;
  } catch (error) {
    console.error("Error fetching today's workouts:", error);
    throw error;
  }
};

```

# app/dashboard/client/workouts/myworkouts/_assests/no-workout-assigned-2.webp

This is a binary file of the type: Image

# app/dashboard/client/workouts/myworkouts/_component/diet-not-assigned.tsx

```tsx
import { Utensils } from 'lucide-react';

export const DietNotAssigned = () => {
  return (
    <div className="w-full">
      <div className="relative mb-6 rounded-2xl overflow-hidden">
        <div className="bg-gradient-to-r from-yellow-500 to-amber-600 p-6">
          <div className="flex items-center gap-3 mb-2">
            <div className="bg-white/20 p-2 rounded-full">
              <Utensils className="w-5 h-5 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-white">Diet Plan Missing</h2>
          </div>
          <p className="text-yellow-100">You don't have a diet plan assigned yet</p>
        </div>

        {/* Decorative wave */}
        <div className="absolute bottom-0 left-0 right-0">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 80"
            className="w-full h-6"
            aria-hidden="true"
            role="img"
          >
            <title>Decorative wave pattern</title>
            <path
              fill="#ffffff"
              fillOpacity="1"
              d="M0,32L80,42.7C160,53,320,75,480,74.7C640,75,800,53,960,42.7C1120,32,1280,32,1360,32L1440,32L1440,80L1360,80C1280,80,1120,80,960,80C800,80,640,80,480,80C320,80,160,80,80,80L0,80Z"
            />
          </svg>
        </div>
      </div>

      <div className="bg-white rounded-xl border border-gray-100 p-6">
        <div className="text-center">
          <div className="w-16 h-16 bg-yellow-100 mx-auto mb-4 rounded-full flex items-center justify-center">
            <Utensils className="w-8 h-8 text-yellow-600" />
          </div>
          <h3 className="text-xl font-medium text-gray-900 mb-2">No Diet Plan Assigned</h3>
          <p className="text-gray-600 mb-6">
            You don't have a diet plan assigned yet. Your trainer needs to assign a diet plan for
            you to see your meals here.
          </p>
          <p className="text-sm text-gray-500">
            Contact your trainer to get a personalized diet plan assigned to your profile.
          </p>
        </div>
      </div>
    </div>
  );
};

```

# app/dashboard/client/workouts/myworkouts/_component/error-display.tsx

```tsx
'use client';

import { AlertTriangle } from 'lucide-react';

interface ErrorDisplayProps {
  errorMessage: string;
}

export const ErrorDisplay = ({ errorMessage }: ErrorDisplayProps) => {
  return (
    <div className="w-full">
      <div className="relative mb-6 rounded-2xl overflow-hidden">
        <div className="bg-gradient-to-r from-red-500 to-orange-600 p-6">
          <div className="flex items-center gap-3 mb-2">
            <div className="bg-white/20 p-2 rounded-full">
              <AlertTriangle className="w-5 h-5 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-white">Error Loading Data</h2>
          </div>
          <p className="text-red-100">{errorMessage}</p>
        </div>
      </div>

      <div className="bg-white rounded-xl border border-gray-100 p-6">
        <div className="text-center">
          <p className="text-gray-600 mb-4">
            We encountered an error while trying to load your data. Please try again later.
          </p>
          <button
            type="button"
            onClick={() => window.location.reload()}
            className="inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
          >
            Try Again
          </button>
        </div>
      </div>
    </div>
  );
}; 
```

# app/dashboard/client/workouts/myworkouts/_component/rest-day.tsx

```tsx
import { Moon, Sparkles } from 'lucide-react';

export const RestDay = () => {
  return (
    <div className="w-full">
      {/* Header Section with Gradient Background */}
      <div className="relative mb-6 rounded-2xl overflow-hidden">
        <div className="bg-gradient-to-r from-purple-500 to-indigo-600 p-6">
          <div className="flex items-center gap-3 mb-2">
            <div className="bg-white/20 p-2 rounded-full">
              <Moon className="w-5 h-5 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-white">Rest Day</h2>
          </div>
          <p className="text-purple-100">Take time to recover and recharge for your next workout</p>

          {/* Rest Day Benefits */}
          <div className="flex flex-wrap gap-4 mt-4">
            <div className="bg-white/10 rounded-lg px-3 py-2 text-white flex items-center gap-2">
              <Sparkles className="w-4 h-4" />
              <span>Muscle Recovery</span>
            </div>
            <div className="bg-white/10 rounded-lg px-3 py-2 text-white flex items-center gap-2">
              <Sparkles className="w-4 h-4" />
              <span>Energy Replenishment</span>
            </div>
          </div>
        </div>

        {/* Decorative wave */}
        <div className="absolute bottom-0 left-0 right-0">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 80"
            className="w-full h-6"
            aria-hidden="true"
            role="img"
          >
            <title>Decorative wave pattern</title>
            <path
              fill="#ffffff"
              fillOpacity="1"
              d="M0,32L80,42.7C160,53,320,75,480,74.7C640,75,800,53,960,42.7C1120,32,1280,32,1360,32L1440,32L1440,80L1360,80C1280,80,1120,80,960,80C800,80,640,80,480,80C320,80,160,80,80,80L0,80Z"
            />
          </svg>
        </div>
      </div>

      {/* Rest Day Content */}
      <div className="bg-white rounded-xl border border-gray-100 p-6">
        <div className="text-center">
          <div className="bg-purple-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
            <Moon className="w-8 h-8 text-purple-600" />
          </div>
          <h3 className="text-xl font-semibold text-gray-900 mb-2">Enjoy Your Rest Day</h3>
          <p className="text-gray-600 mb-4">
            Rest days are essential for muscle recovery and overall fitness progress. Use this time
            to focus on:
          </p>
          <ul className="text-left space-y-2 text-gray-600 mb-6">
            <li className="flex items-center gap-2">
              <span className="w-2 h-2 bg-purple-500 rounded-full" />
              Proper nutrition and hydration
            </li>
            <li className="flex items-center gap-2">
              <span className="w-2 h-2 bg-purple-500 rounded-full" />
              Quality sleep (7-9 hours)
            </li>
            <li className="flex items-center gap-2">
              <span className="w-2 h-2 bg-purple-500 rounded-full" />
              Light stretching or mobility work
            </li>
            <li className="flex items-center gap-2">
              <span className="w-2 h-2 bg-purple-500 rounded-full" />
              Stress management and relaxation
            </li>
          </ul>
          <p className="text-sm text-gray-500">
            Your next workout will be even more effective after proper rest!
          </p>
        </div>
      </div>
    </div>
  );
};

```

# app/dashboard/client/workouts/myworkouts/_component/todays-diet.tsx

```tsx
'use client';

import {
  Apple,
  ChevronDown,
  ChevronUp,
  Clock,
  Droplets,
  Flame,
  Utensils,
  Wheat,
} from 'lucide-react';
import { useState } from 'react';
import type { DietPlan } from '../_actions/get-todays-diet';

interface TodaysDietProps {
  dietPlan: DietPlan;
}

export const TodaysDiet = ({ dietPlan }: TodaysDietProps) => {
  const [expandedMeal, setExpandedMeal] = useState<number | null>(
    dietPlan.meals.length > 0 ? dietPlan.meals[0].id : null,
  );

  const toggleExpand = (mealId: number) => {
    setExpandedMeal(expandedMeal === mealId ? null : mealId);
  };

  // If no diet plan, show a message
  if (dietPlan.meals.length === 0) {
    return (
      <div className="w-full bg-white rounded-xl border border-gray-100 p-6 text-center">
        <div className="mb-4 flex justify-center">
          <div className="bg-blue-100 p-3 rounded-full">
            <Utensils className="w-6 h-6 text-blue-600" />
          </div>
        </div>
        <h3 className="text-xl font-medium text-gray-900 mb-2">No meals scheduled for today</h3>
        <p className="text-gray-600">
          You don't have any meals scheduled for today. Check with your trainer for your diet plan.
        </p>
      </div>
    );
  }

  return (
    <div className="w-full">
      {/* Header Section with Gradient Background */}
      <div className="relative mb-6 rounded-2xl overflow-hidden">
        <div className="bg-gradient-to-r from-green-500 to-teal-600 p-6">
          <div className="flex items-center gap-3 mb-2">
            <div className="bg-white/20 p-2 rounded-full">
              <Utensils className="w-5 h-5 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-white">Today's Diet Plan</h2>
          </div>
          <p className="text-green-100">Track your meals and nutrition for today</p>

          {/* Diet Plan Stats Summary */}
          <div className="flex flex-wrap gap-4 mt-4">
            <div className="bg-white/10 rounded-lg px-3 py-2 text-white flex items-center gap-2">
              <Flame className="w-4 h-4" />
              <span>{dietPlan.targetCalories} calories</span>
            </div>
            <div className="bg-white/10 rounded-lg px-3 py-2 text-white flex items-center gap-2">
              <Apple className="w-4 h-4" />
              <span>{dietPlan.meals.length} meals</span>
            </div>
          </div>

          {/* Macro Breakdown */}
          <div className="grid grid-cols-3 gap-2 mt-4">
            <div className="bg-white/10 rounded-lg p-2 text-white text-center">
              <div className="text-xs opacity-80">Protein</div>
              <div className="font-semibold">{dietPlan.proteinRatio}%</div>
            </div>
            <div className="bg-white/10 rounded-lg p-2 text-white text-center">
              <div className="text-xs opacity-80">Carbs</div>
              <div className="font-semibold">{dietPlan.carbsRatio}%</div>
            </div>
            <div className="bg-white/10 rounded-lg p-2 text-white text-center">
              <div className="text-xs opacity-80">Fats</div>
              <div className="font-semibold">{dietPlan.fatsRatio}%</div>
            </div>
          </div>
        </div>

        {/* Decorative wave */}
        <div className="absolute bottom-0 left-0 right-0">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 80"
            className="w-full h-6"
            aria-hidden="true"
            role="img"
          >
            <title>Decorative wave pattern</title>
            <path
              fill="#ffffff"
              fillOpacity="1"
              d="M0,32L80,42.7C160,53,320,75,480,74.7C640,75,800,53,960,42.7C1120,32,1280,32,1360,32L1440,32L1440,80L1360,80C1280,80,1120,80,960,80C800,80,640,80,480,80C320,80,160,80,80,80L0,80Z"
            />
          </svg>
        </div>
      </div>

      <div className="space-y-6">
        {dietPlan.meals.map((meal) => (
          <div key={meal.id} className="bg-white rounded-xl border border-gray-100 overflow-hidden">
            {/* Meal Header - Always visible */}
            <button
              type="button"
              className={`w-full text-left p-5 border-b border-gray-100 transition-colors ${
                expandedMeal === meal.id ? 'bg-green-50' : ''
              }`}
              onClick={() => toggleExpand(meal.id)}
              onKeyDown={(e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                  toggleExpand(meal.id);
                }
              }}
              aria-expanded={expandedMeal === meal.id}
            >
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <h3 className="text-xl font-semibold text-gray-900 mb-1">{meal.name}</h3>
                  <div className="flex items-center text-gray-600 text-base">
                    <Clock className="w-4 h-4 mr-1" />
                    <span>{meal.timeOfDay}</span>
                  </div>
                </div>
                <div className="flex flex-col items-end gap-2 ml-2">
                  {expandedMeal === meal.id ? (
                    <ChevronUp className="w-5 h-5 text-gray-500" />
                  ) : (
                    <ChevronDown className="w-5 h-5 text-gray-500" />
                  )}
                </div>
              </div>
            </button>

            {/* Meal Details - Expandable */}
            {expandedMeal === meal.id && (
              <div className="p-5">
                {/* Nutrition Information */}
                <div className="mb-5">
                  <h4 className="font-medium text-gray-900 mb-3">Nutrition</h4>
                  <div className="grid grid-cols-2 gap-3 text-base">
                    <div className="flex items-center gap-2 bg-green-50 p-3 rounded">
                      <Flame className="w-5 h-5 text-green-600" />
                      <span>{meal.calories} calories</span>
                    </div>
                    <div className="flex items-center gap-2 bg-green-50 p-3 rounded">
                      <Droplets className="w-5 h-5 text-green-600" />
                      <span>{meal.protein}g protein</span>
                    </div>
                    <div className="flex items-center gap-2 bg-green-50 p-3 rounded">
                      <Wheat className="w-5 h-5 text-green-600" />
                      <span>{meal.carbs}g carbs</span>
                    </div>
                    <div className="flex items-center gap-2 bg-green-50 p-3 rounded">
                      <Droplets className="w-5 h-5 text-green-600" />
                      <span>{meal.fats}g fats</span>
                    </div>
                  </div>
                </div>

                {/* Ingredients */}
                <div className="mb-5">
                  <h4 className="font-medium text-gray-900 mb-3">Ingredients</h4>
                  <ul className="bg-gray-50 rounded-lg p-4 space-y-2">
                    {meal.ingredients.map((ingredient) => (
                      <li
                        key={`${meal.id}-${ingredient.name}`}
                        className="flex justify-between text-gray-700"
                      >
                        <span>{ingredient.name}</span>
                        {ingredient.quantity && (
                          <span className="text-gray-500">{ingredient.quantity}</span>
                        )}
                      </li>
                    ))}
                  </ul>
                </div>

                {/* Instructions */}
                {meal.instructions && (
                  <div>
                    <h4 className="font-medium text-gray-900 mb-3">Instructions</h4>
                    <div className="bg-gray-50 rounded-lg p-4 text-gray-700">
                      <p>{meal.instructions}</p>
                    </div>
                  </div>
                )}
              </div>
            )}
          </div>
        ))}
      </div>
    </div>
  );
};

```

# app/dashboard/client/workouts/myworkouts/_component/todays-workouts.tsx

```tsx
'use client';

import {
  Activity,
  CheckCircle2,
  ChevronDown,
  ChevronUp,
  Dumbbell,
  Flame,
  Target,
  Timer,
} from 'lucide-react';
import { useState } from 'react';
import type { TodaysWorkout } from '../_actions/get-todays-workout';
import { RestDay } from './rest-day';

interface TodaysWorkoutsProps {
  workout: TodaysWorkout;
}

export const TodaysWorkouts = ({ workout }: TodaysWorkoutsProps) => {
  const [expandedMuscle, setExpandedMuscle] = useState<string | null>(
    workout.muscleGroups.length > 0 ? workout.muscleGroups[0].muscle : null,
  );

  const toggleExpand = (muscle: string) => {
    setExpandedMuscle(expandedMuscle === muscle ? null : muscle);
  };

  // Calculate total exercises across all muscle groups
  const totalExercises = workout.muscleGroups.reduce(
    (total, group) => total + group.exercises.length,
    0,
  );

  // If no workouts, show rest day component
  if (workout.muscleGroups.length === 0) {
    return <RestDay />;
  }

  return (
    <div className="w-full">
      {/* Header Section with Gradient Background */}
      <div className="relative mb-6 rounded-2xl overflow-hidden">
        <div className="bg-gradient-to-r from-blue-500 to-indigo-600 p-6">
          <div className="flex items-center gap-3 mb-2">
            <div className="bg-white/20 p-2 rounded-full">
              <Activity className="w-5 h-5 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-white">{workout.day}'s Workout</h2>
          </div>
          <p className="text-blue-100">Track your muscle groups and exercises</p>

          {/* Stats Summary */}
          <div className="flex flex-wrap gap-4 mt-4">
            <div className="bg-white/10 rounded-lg px-3 py-2 text-white flex items-center gap-2">
              <Target className="w-4 h-4" />
              <span>{workout.muscleGroups.length} Muscle Groups</span>
            </div>
            <div className="bg-white/10 rounded-lg px-3 py-2 text-white flex items-center gap-2">
              <Flame className="w-4 h-4" />
              <span>
                {totalExercises} {totalExercises === 1 ? 'Exercise' : 'Exercises'}
              </span>
            </div>
          </div>
        </div>

        {/* Decorative wave */}
        <div className="absolute bottom-0 left-0 right-0">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 80"
            className="w-full h-6"
            aria-hidden="true"
            role="img"
          >
            <title>Decorative wave pattern</title>
            <path
              fill="#ffffff"
              fillOpacity="1"
              d="M0,32L80,42.7C160,53,320,75,480,74.7C640,75,800,53,960,42.7C1120,32,1280,32,1360,32L1440,32L1440,80L1360,80C1280,80,1120,80,960,80C800,80,640,80,480,80C320,80,160,80,80,80L0,80Z"
            />
          </svg>
        </div>
      </div>

      <div className="space-y-6">
        {workout.muscleGroups.map((muscleGroup) => (
          <div
            key={muscleGroup.muscle}
            className="bg-white rounded-xl border border-gray-100 overflow-hidden"
          >
            {/* Muscle Group Header - Always visible */}
            <button
              type="button"
              className={`w-full text-left p-5 border-b border-gray-100 transition-colors ${
                expandedMuscle === muscleGroup.muscle ? 'bg-blue-50' : ''
              }`}
              onClick={() => toggleExpand(muscleGroup.muscle)}
              onKeyDown={(e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                  toggleExpand(muscleGroup.muscle);
                }
              }}
              aria-expanded={expandedMuscle === muscleGroup.muscle}
            >
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <h3 className="text-xl font-semibold text-gray-900 mb-1">{muscleGroup.muscle}</h3>
                  <p className="text-gray-600 text-base">
                    {muscleGroup.exercises.length}{' '}
                    {muscleGroup.exercises.length === 1 ? 'Exercise' : 'Exercises'}
                  </p>
                </div>
                <div className="flex flex-col items-end gap-2 ml-2">
                  {expandedMuscle === muscleGroup.muscle ? (
                    <ChevronUp className="w-5 h-5 text-gray-500" />
                  ) : (
                    <ChevronDown className="w-5 h-5 text-gray-500" />
                  )}
                </div>
              </div>
            </button>

            {/* Exercises List - Expandable */}
            {expandedMuscle === muscleGroup.muscle && (
              <div className="p-5">
                <div className="space-y-5">
                  {muscleGroup.exercises.map((exercise, index) => (
                    <div
                      key={exercise.id}
                      className={`overflow-hidden rounded-lg transition-all ${
                        index % 2 === 0 ? 'bg-blue-50' : 'bg-gray-50'
                      }`}
                    >
                      {/* Exercise number badge */}
                      <div className="flex items-center px-3 py-1 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-xs font-medium">
                        Exercise {index + 1} of {muscleGroup.exercises.length}
                      </div>

                      <div className="p-4">
                        {/* Mobile-optimized layout */}
                        <div className="flex flex-col gap-4">
                          {exercise.exercise.image_url ? (
                            <img
                              src={exercise.exercise.image_url}
                              alt={exercise.exercise.name}
                              className="w-full h-48 rounded-lg object-cover"
                            />
                          ) : (
                            <div className="flex items-center justify-center w-full h-48 bg-gray-200 rounded-lg">
                              <Dumbbell className="w-10 h-10 text-gray-400" />
                            </div>
                          )}

                          <div className="flex-1">
                            <div className="flex flex-col justify-between gap-2 mb-3">
                              <h5 className="font-medium text-gray-900 text-lg">
                                {exercise.exercise.name}
                              </h5>
                            </div>

                            {/* Exercise details */}
                            <div className="grid grid-cols-2 gap-3 text-base text-gray-600 mb-3">
                              <div className="flex items-center gap-2 bg-white/50 p-3 rounded">
                                <Dumbbell className="w-5 h-5 text-blue-600" />
                                <span>
                                  {exercise.sets} × {exercise.reps}
                                </span>
                              </div>
                              <div className="flex items-center gap-2 bg-white/50 p-3 rounded">
                                <Timer className="w-5 h-5 text-blue-600" />
                                <span>{exercise.rest}s rest</span>
                              </div>
                            </div>

                            {exercise.notes && (
                              <p className="text-base text-gray-600 mt-3 italic bg-white/70 p-3 rounded">
                                "{exercise.notes}"
                              </p>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        ))}
      </div>
    </div>
  );
};

```

# app/dashboard/client/workouts/myworkouts/_component/workout-not-assigned.tsx

```tsx
import { AlertTriangle, Dumbbell } from 'lucide-react';
import Image from 'next/image';
import NoWorkoutAssignedImage from '../_assests/no-workout-assigned-2.webp';

export const WorkoutNotAssigned = () => {
  return (
    <div className="w-full">
      {/* Header Section with Gradient Background */}
      <div className="relative mb-6 rounded-2xl overflow-hidden">
        <div className="bg-gradient-to-r from-blue-500 to-indigo-600 p-6">
          <div className="flex items-center gap-3 mb-2">
            <div className="bg-white/20 p-2 rounded-full">
              <Dumbbell className="w-5 h-5 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-white">Today's Workout</h2>
          </div>
          <p className="text-blue-100">Complete your assigned exercises to track your progress</p>
        </div>

        {/* Decorative wave */}
        <div className="absolute bottom-0 left-0 right-0">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 1440 80"
            className="w-full h-6"
            aria-hidden="true"
            role="img"
          >
            <title>Decorative wave pattern</title>
            <path
              fill="#ffffff"
              fillOpacity="1"
              d="M0,32L80,42.7C160,53,320,75,480,74.7C640,75,800,53,960,42.7C1120,32,1280,32,1360,32L1440,32L1440,80L1360,80C1280,80,1120,80,960,80C800,80,640,80,480,80C320,80,160,80,80,80L0,80Z"
            />
          </svg>
        </div>
      </div>

      <div className="bg-white rounded-xl border border-gray-100 overflow-hidden">
        <div className="p-6 text-center">
          <div className="mx-auto relative w-full aspect-square mb-6" style={{ maxWidth: '280px' }}>
            <Image
              src={NoWorkoutAssignedImage}
              alt="No workouts assigned"
              fill
              className="object-contain mix-blend-multiply"
              style={{
                filter: 'contrast(1.1) brightness(1.05)',
                transform: 'scale(1.2)',
              }}
              priority
            />
          </div>

          <div className="flex items-center justify-center gap-2 mb-4">
            <div className="bg-amber-50 p-2 rounded-full">
              <AlertTriangle className="h-5 w-5 text-amber-500" />
            </div>
            <h3 className="text-xl font-semibold text-gray-900">No Workouts Assigned</h3>
          </div>

          <p className="text-gray-600 mx-auto text-base">
            Your trainer hasn't assigned any workouts to you yet. Check back later or contact your
            trainer for more information.
          </p>
        </div>
      </div>
    </div>
  );
};

```

# app/dashboard/client/workouts/myworkouts/page.tsx

```tsx
import { Suspense } from 'react';
import { getTodaysDiet } from './_actions/get-todays-diet';
import { getTodaysWorkout } from './_actions/get-todays-workout';
import { DietNotAssigned } from './_component/diet-not-assigned';
import { ErrorDisplay } from './_component/error-display';
import { RestDay } from './_component/rest-day';
import { TodaysDiet } from './_component/todays-diet';
import { TodaysWorkouts } from './_component/todays-workouts';
import { WorkoutNotAssigned } from './_component/workout-not-assigned';

export default async function MyWorkoutsPage() {
  try {
    // Fetch both workout and diet data concurrently
    const [workout, dietPlan] = await Promise.all([getTodaysWorkout(), getTodaysDiet()]);

    return (
      <div className="space-y-10">
        <Suspense fallback={<div>Loading workout data...</div>}>
          <section>
            {!workout ? (
              <WorkoutNotAssigned />
            ) : workout.muscleGroups.length === 0 ? (
              <RestDay />
            ) : (
              <TodaysWorkouts workout={workout} />
            )}
          </section>
        </Suspense>

        <Suspense fallback={<div>Loading diet data...</div>}>
          <section>{!dietPlan ? <DietNotAssigned /> : <TodaysDiet dietPlan={dietPlan} />}</section>
        </Suspense>
      </div>
    );
  } catch (error) {
    console.error('Error in MyWorkoutsPage:', error);
    const errorMessage = error instanceof Error ? error.message : 'Failed to load your data';
    return <ErrorDisplay errorMessage={errorMessage} />;
  }
}

```

# app/dashboard/client/workouts/page.tsx

```tsx
export default function WorkoutsPage() {
  return (
    <div className="py-8">
      <h1 className="text-3xl font-bold">Workouts</h1>
      <div className="mt-6">{/* Add workouts overview here */}</div>
    </div>
  );
}

```

# app/dashboard/layout.tsx

```tsx
import { SessionProvider } from 'next-auth/react';
import { redirect } from 'next/navigation';
import type React from 'react';
import { auth } from '../(auth)/auth';
import QueryClientProvider from '../providers/QueryClientProvider';
import ClientSideProvider from './_components/ClientSideProvider';
import DashboardBottomNav from './_components/DashboardBottomNav';
import DashboardTopBar from './_components/DashboardTopBar';
import {
  ClientDashboardMenuItems,
  type MenuItem,
  OwnerDashboardMenuItems,
  TrainerDashboardMenuItems,
} from './_components/menuItems';
import Sidebar from './_components/sidebar';

export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  const session = await auth();

  const role = session?.user?.role || session?.role;

  const getMenuItems = (): MenuItem[] => {
    switch (role) {
      case 'owner':
        return OwnerDashboardMenuItems;
      case 'trainer':
        return TrainerDashboardMenuItems;
      case 'client':
        return ClientDashboardMenuItems;
      default:
        return [];
    }
  };

  return (
    <div className="flex h-screen bg-gray-50">
      {/* Server-rendered sidebar - visible only on desktop */}
      <div className="hidden md:block h-screen">
        <Sidebar menuItems={getMenuItems()} />
      </div>

      <div className="w-full flex flex-col overflow-hidden">
        {/* Topbar with logo and subroute navigation - visible only on mobile */}
        <div className="md:hidden">
          <DashboardTopBar />
        </div>

        {/* Main content area with proper height calculations */}
        <div className="flex-1 overflow-y-auto scroll-container relative pb-16 md:pb-0">
          <div className="container mx-auto px-4 py-4 md:py-6 max-w-7xl">{children}</div>
        </div>
      </div>

      {/* Bottom navigation - visible only on mobile */}
      <div className="md:hidden">
        <DashboardBottomNav />
      </div>
    </div>
  );
}

```

# app/dashboard/owner/(common)/components/DashboardStats.tsx

```tsx
import { Card } from '@/components/ui/card';
import { Calendar, Dumbbell, TrendingUp, Users } from 'lucide-react';
import React from 'react';

interface DashboardStatsProps {
  data: {
    stats: {
      totalMembers: number;
      activeTrainers: number;
      todayAttendance: number;
      revenue: number;
    };
    recentActivities: Array<{
      name: string;
      Validperiod?: {
        startDate: string;
        shift: string;
      };
    }>;
  };
}

export default function DashboardStats({ data }: DashboardStatsProps) {
  const { stats, recentActivities } = data;

  const statCards = [
    {
      label: 'Total Members',
      value: stats.totalMembers.toString(),
      icon: Users,
      color: 'text-blue-500',
    },
    {
      label: 'Active Trainers',
      value: stats.activeTrainers.toString(),
      icon: Dumbbell,
      color: 'text-green-500',
    },
    {
      label: "Today's Attendance",
      value: stats.todayAttendance.toString(),
      icon: Calendar,
      color: 'text-purple-500',
    },
    {
      label: 'Active Gyms',
      value: '1',
      icon: TrendingUp,
      color: 'text-orange-500',
    },
  ];

  return (
    <div className="p-8 max-w-7xl mx-auto">
      <div className="space-y-8">
        {/* Welcome Header */}
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tight">Welcome back, Owner</h1>
          <p className="text-gray-500">
            Here&apos;s what&apos;s happening across your fitness empire today.
          </p>
        </div>

        {/* Quick Stats */}
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
          {statCards.map((stat, index) => (
            <Card key={index as number} className="p-6 hover:shadow-lg transition-shadow">
              <div className="flex items-center space-x-4">
                <div className={`p-3 rounded-full bg-gray-100 ${stat.color}`}>
                  <stat.icon className="w-6 h-6" />
                </div>
                <div>
                  <p className="text-sm font-medium text-gray-500">{stat.label}</p>
                  <h3 className="text-2xl font-bold">{stat.value}</h3>
                </div>
              </div>
            </Card>
          ))}
        </div>

        {/* Recent Activity Preview */}
        <Card className="p-6">
          <h2 className="text-xl font-semibold mb-4">Recent Activities</h2>
          <div className="space-y-4">
            {recentActivities.map((activity, index) => (
              <div key={index as number} className="flex items-center space-x-3 text-gray-600">
                <Calendar className="w-4 h-4" />
                <span>
                  {activity.name} -{' '}
                  {activity.Validperiod
                    ? `Joined ${new Date(activity.Validperiod.startDate).toLocaleDateString()} (${
                        activity.Validperiod.shift
                      } shift)`
                    : 'New member added'}
                </span>
              </div>
            ))}
          </div>
        </Card>
      </div>
    </div>
  );
}

```

# app/dashboard/owner/(common)/components/ErrorScreen.tsx

```tsx
'use client';
import { Card } from '@/components/ui/card';
import { ArrowRight, Building2 } from 'lucide-react';

interface ErrorScreenProps {
  error?: string;
}

export default function ErrorScreen({ error }: ErrorScreenProps) {
  return (
    <div className="min-h-[80vh] flex items-center justify-center p-4">
      <Card className="max-w-md w-full p-8 text-center space-y-4">
        <div className="mx-auto w-16 h-16 bg-red-50 rounded-full flex items-center justify-center">
          <Building2 className="w-8 h-8 text-red-500" />
        </div>

        <h2 className="text-xl font-semibold text-gray-800">Unable to Load Dashboard</h2>
        <p className="text-gray-600">
          {error || 'There was an error loading your dashboard data. Please try again later.'}
        </p>

        <button
          onClick={() => window.location.reload()}
          className="inline-flex items-center gap-2 px-4 py-2 text-sm text-blue-600 hover:text-blue-700"
          type="button"
        >
          <span>Refresh Page</span>
          <ArrowRight className="w-4 h-4" />
        </button>
      </Card>
    </div>
  );
}

```

# app/dashboard/owner/(common)/components/GetDashboardData.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import { AxiosError, type AxiosResponse } from 'axios';

interface DashboardStats {
  totalMembers: number;
  activeTrainers: number;
  todayAttendance: number;
  revenue: number;
}

interface RecentActivity {
  name: string;
  createdAt: string;
  Validperiod: {
    startDate: string;
    shift: string;
  } | null;
}

interface DashboardData {
  stats: DashboardStats;
  recentActivities: RecentActivity[];
}

interface DashboardResponse {
  msg: string;
  data: DashboardData;
}

interface DashboardError {
  error: string;
  msg?: string;
}

type DashboardResult = DashboardData | DashboardError;

export async function GetDashboardData(): Promise<DashboardResult> {
  try {
    const ownerAxios = await OwnerReqConfig();
    const response: AxiosResponse<DashboardResponse> = await ownerAxios.get('/getdashboarddata');

    if (response.data.data) {
      return response.data.data;
    }

    return {
      error: 'Failed to fetch dashboard data',
    };
  } catch (err) {
    if (err instanceof AxiosError) {
      // Handle specific API errors
      if (err.response?.status === 404) {
        return {
          error: 'NO_GYM_FOUND',
          msg: 'No gym profile found. Please create your gym profile to continue.',
        };
      }

      return {
        error: err.response?.data?.msg || 'An error occurred while fetching dashboard data',
      };
    }

    return {
      error: 'An unexpected error occurred',
    };
  }
}

```

# app/dashboard/owner/(common)/components/SetupScreen.tsx

```tsx
'use client';
import { Card } from '@/components/ui/card';
import { ArrowRight, Building2, Plus } from 'lucide-react';
import Link from 'next/link';

export default function SetupScreen() {
  return (
    <div className="min-h-[80vh] flex items-center justify-center p-4">
      <Card className="max-w-md w-full p-8 text-center space-y-6">
        <div className="mx-auto w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center">
          <Building2 className="w-8 h-8 text-blue-500" />
        </div>

        <div className="space-y-2">
          <h1 className="text-2xl font-bold text-gray-900">Welcome to GymDominator</h1>
          <p className="text-gray-500">
            Let&apos;s get started by setting up your gym&apos;s profile.
          </p>
        </div>

        <Link
          href="/ownerdashboard/gymdetails/creategym"
          className="inline-flex items-center justify-center w-full gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
        >
          <Plus className="w-4 h-4" />
          <span>Create Your Gym Profile</span>
          <ArrowRight className="w-4 h-4" />
        </Link>
      </Card>
    </div>
  );
}

```

# app/dashboard/owner/(common)/GetGymDetails.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

export interface sessionType {
  role: string;
  user: {
    name: string;
    email: string;
    picture?: string | null;
  };
}

export default async function FetchGymDetailsSA() {
  interface responseType {
    msg: string;
    gym: {
      gym_name: string;
      gym_logo: string;
      address: string;
      phone_number: string;
      Email: string;
      gymauthtoken: string;
    };
  }

  try {
    // Initialize Axios instance with Authorization header
    const ownerAxios = await OwnerReqConfig();
    const response: AxiosResponse<responseType> = await ownerAxios.get('/gym/gymdetails');

    console.log('Gym details fetched successfully:', response.data.gym);
    return response.data.gym;
  } catch (err: unknown) {
    console.error('Error fetching gym details:', err);
    return null; // Return null or handle the error as needed
  }
}

```

# app/dashboard/owner/(common)/types/types.ts

```ts
export interface DashboardStats {
  totalMembers: number;
  activeTrainers: number;
  todayAttendance: number;
  revenue: number;
}

export interface ValidPeriod {
  startDate: string;
  shift: string;
}

export interface RecentActivity {
  name: string;
  Validperiod: ValidPeriod | null;
}

export interface DashboardData {
  stats: DashboardStats;
  recentActivities: RecentActivity[];
}

export interface DashboardError {
  error: string;
}

export type DashboardResult = DashboardData | DashboardError;

```

# app/dashboard/owner/attendance/onboarding/page.tsx

```tsx
import React from 'react';
import { OnBoadingQrData } from '../../onboarding/onboardingqr/GetOnBordingQrData';

import GymQRCodeOnboarding from '@/components/gym-owner/QrCode';
export default async function page() {
  const { hash, gymname } = await OnBoadingQrData();
  const QrData = {
    hash,
    gymname,
  };
  return (
    <div className="h-screen bg-[#f0f0f0] flex justify-center items-center w-full">
      <GymQRCodeOnboarding qrdata={JSON.stringify(QrData) as string} title="" subtitle="" />
    </div>
  );
}

```

# app/dashboard/owner/attendance/showqr/DateComponent.tsx

```tsx
'use client';
import React from 'react';
import { useState } from 'react';
export default function DateComponent() {
  const [currentDate] = useState(
    new Date().toLocaleDateString('en-GB', {
      day: '2-digit',
      month: 'short',
      year: 'numeric',
    }),
  );

  return (
    <>
      <div className="text-xl font-semibold text-primary bg-primary-foreground px-4 py-2 rounded-full">
        {currentDate}
      </div>
    </>
  );
}

```

# app/dashboard/owner/attendance/showqr/GetAttendanceQrData.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

interface responseType {
  gymname: string;
  gymid: number;
}

export const GetAttendanceQrData = async () => {
  const ownerAxios = await OwnerReqConfig();
  try {
    const response: AxiosResponse<responseType> = await ownerAxios.get(
      '/attendance/attendanceqrdata',
    );
    console.log('response from the attendance', response.data);
    return {
      gymname: response.data.gymname,
      gymid: response.data.gymid,
    };
  } catch (error) {
    console.log('Error:', error);
  }
};

```

# app/dashboard/owner/attendance/showqr/page.tsx

```tsx
import FetchGymDetailsSA from '@/app/dashboard/owner/gymdetails/viewgymdetails/GetGymDetails';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { GetAttendanceQrData } from './GetAttendanceQrData';
import GymQRCode from './QrCode';

export const dynamic = 'force-dynamic';

export default async function AttendanceComponent() {
  // First check if gym exists
  const gymDetails = await FetchGymDetailsSA();

  if (!gymDetails) {
    return (
      <div className="h-screen flex flex-col justify-center items-center gap-6 p-4">
        <div className="text-center space-y-4">
          <h2 className="text-2xl font-bold text-gray-900">No Gym Found</h2>
          <p className="text-gray-600">Please create your gym profile first</p>
        </div>
        <Link href="/ownerdashboard/gymdetails/viewgymdetails">
          <Button variant="default" className="bg-blue-600 hover:bg-blue-700 text-white">
            Create Gym Profile
          </Button>
        </Link>
      </div>
    );
  }

  // If gym exists, proceed with attendance QR
  const gymData = await GetAttendanceQrData();

  if (!gymData) {
    return <div>Unable to load attendance data</div>;
  }

  const qrValue = JSON.stringify({
    AttendanceAction: {
      gymname: gymData.gymname,
      gymid: gymData.gymid,
      timestamp: new Date().setMinutes(0, 0, 0),
    },
  });

  return (
    <div className="container mx-auto py-6">
      <GymQRCode
        qrdata={qrValue}
        title={gymData.gymname}
        subtitle="Scan this QR code to mark your attendance"
      />
    </div>
  );
}

```

# app/dashboard/owner/attendance/showqr/QrCode.tsx

```tsx
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { QRCodeSVG } from 'qrcode.react';
import type React from 'react';

interface GymQRCodeOnboardingProps {
  qrdata: string;
  title: string;
  subtitle: string; // Add subtitle prop
}

const GymQRCode: React.FC<GymQRCodeOnboardingProps> = ({ qrdata, title, subtitle }) => {
  return (
    <Card className="w-full max-w-md mx-auto bg-white shadow-lg rounded-lg overflow-hidden min-h-[90vh] md:min-h-0">
      <CardHeader className="bg-gradient-to-r from-blue-600 to-blue-800 text-white text-center py-8">
        <CardTitle className="text-3xl font-bold">{title}</CardTitle>
        <CardDescription className="text-blue-100 mt-3 text-xl font-semibold tracking-[0.5px]">
          Welcome to your fitness journey
        </CardDescription>
      </CardHeader>

      <CardContent className="flex flex-col items-center justify-center p-8 md:p-12">
        <QRCodeSVG
          value={qrdata}
          size={300}
          bgColor={'#ffffff'}
          fgColor={'#000000'}
          level={'M'}
          includeMargin={true}
        />

        <div className="space-y-4 w-full max-w-sm text-center">
          <p className="text-lg text-gray-700 font-medium px-4">
            {subtitle} {/* Use the passed subtitle */}
          </p>

          <div className="pt-4 border-t border-gray-200">
            <p className="text-sm text-gray-500">Having trouble? Contact our support team</p>
          </div>
        </div>
      </CardContent>
    </Card>
  );
};

export default GymQRCode;

```

# app/dashboard/owner/attendance/todaysattendance/getTodayAttendance.ts

```ts
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';

interface AttendanceUser {
  id: number;
  name: string;
  isPresent: boolean;
  trainerid: number | null;
  shift: 'Morning' | 'Evening';
  attendanceTime: string | null;
}

interface TodayAttendanceResponse {
  msg: string;
  users: AttendanceUser[];
}

const TodayAttendance = async (): Promise<TodayAttendanceResponse> => {
  try {
    const owneraxios = await OwnerReqConfig();
    const response = await owneraxios.get<TodayAttendanceResponse>('/attendance/todaysattendance');
    console.log("Today's attendance data:", response.data);
    return response.data;
  } catch (error) {
    console.error("Error fetching today's attendance:", error);
    return {
      msg: 'Failed to fetch attendance data',
      users: [],
    };
  }
};

export { TodayAttendance, type AttendanceUser };

```

# app/dashboard/owner/attendance/todaysattendance/page.tsx

```tsx
import React from 'react';
import UserAttendance from './UserAttendance';
import { TodayAttendance } from './getTodayAttendance';
export const dynamic = 'force-dynamic';
export default async function Page() {
  const attendanceData = await TodayAttendance();

  if (!attendanceData.users) {
    return <div>Failed to load attendance data</div>;
  }

  const formattedUsers = attendanceData.users.map((user) => ({
    id: user.id,
    name: user.name,
    shift: user.shift,
    todaysAttendance: user.isPresent,
    attendanceTime: user.attendanceTime,
  }));

  return <UserAttendance initialUsers={formattedUsers} />;
}

```

# app/dashboard/owner/attendance/todaysattendance/UserAttendance.tsx

```tsx
'use client';

import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, UserCheck, UserX, Users } from 'lucide-react';
import { useEffect, useState } from 'react';

interface AttendanceUser {
  id: number;
  name: string;
  shift: 'Morning' | 'Evening';
  todaysAttendance: boolean;
  attendanceTime: string | null;
}

interface UserAttendanceProps {
  initialUsers: AttendanceUser[];
}

const columns: ColumnDef<AttendanceUser>[] = [
  {
    accessorKey: 'name',
    header: ({ column }) => (
      <Button variant="ghost" onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}>
        User Name
        <ArrowUpDown className="ml-2 h-4 w-4" />
      </Button>
    ),
    cell: ({ row }) => {
      return <div className="ml-4">{row.getValue('name')}</div>;
    },
  },
  {
    accessorKey: 'attendanceTime',
    header: ({ column }) => (
      <Button variant="ghost" onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}>
        Time
        <ArrowUpDown className="ml-2 h-4 w-4" />
      </Button>
    ),
    cell: ({ row }) => {
      const time = row.getValue('attendanceTime') as string | null;
      if (!time) return <div className="flex ml-4">- -</div>;
      try {
        // Parse the UTC time and convert to IST
        const utcDate = new Date(time);
        if (Number.isNaN(utcDate.getTime())) return '-';

        // Using explicit IST timezone for conversion
        return (
          <div className="ml-4 ">
            {utcDate
              .toLocaleTimeString('en-IN', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true,
                timeZone: 'Asia/Kolkata',
              })
              .toUpperCase()}
          </div>
        );
      } catch (error) {
        console.error('Error formatting time:', error);
        return <div className="">-</div>;
      }
    },
  },
  {
    accessorKey: 'shift',
    header: 'Shift',
    cell: ({ row }) => {
      const shift = row.getValue('shift') as string;
      return <div className="">{shift}</div>;
    },
  },
  {
    accessorKey: 'todaysAttendance',
    header: 'Attendance',
    cell: ({ row }) => {
      const attendance = row.getValue('todaysAttendance') as boolean;
      return (
        <div className={`font-medium ${attendance ? 'text-green-600' : 'text-red-600'}`}>
          {attendance ? 'Present' : 'Absent'}
        </div>
      );
    },
  },
];

export default function UserAttendance({ initialUsers }: UserAttendanceProps) {
  const [users] = useState<AttendanceUser[]>(initialUsers);
  const [searchTerm, setSearchTerm] = useState('');
  const [shiftFilter, setShiftFilter] = useState<'Morning' | 'Evening' | 'All'>('All');
  const [filteredUsers, setFilteredUsers] = useState<AttendanceUser[]>(initialUsers);

  // Calculate stats
  const totalUsers = users.length;
  const presentUsers = users.filter((user) => user.todaysAttendance).length;
  const absentUsers = totalUsers - presentUsers;

  const statusCards = [
    {
      title: 'Total Users',
      value: totalUsers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Present Today',
      value: presentUsers,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Absent Today',
      value: absentUsers,
      icon: UserX,
      gradient: 'red',
    },
  ] as const;

  useEffect(() => {
    const filtered = users.filter(
      (user) =>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) &&
        (shiftFilter === 'All' || user.shift === shiftFilter),
    );
    setFilteredUsers(filtered);
  }, [searchTerm, shiftFilter, users]);

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-3xl font-bold text-center">Today&apos;s Attendance</h1>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      {/* Filters */}
      <div className="flex flex-col md:flex-row gap-4 mb-6">
        <Input
          placeholder="Search users..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
        <Select
          value={shiftFilter}
          onValueChange={(value: 'Morning' | 'Evening' | 'All') => setShiftFilter(value)}
        >
          <SelectTrigger className="w-[180px]">
            <SelectValue placeholder="Select shift" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="All">All Shifts</SelectItem>
            <SelectItem value="Morning">Morning</SelectItem>
            <SelectItem value="Evening">Evening</SelectItem>
          </SelectContent>
        </Select>
      </div>

      {/* Desktop View */}
      <div className="hidden md:block">
        <DataTable data={filteredUsers} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile View */}
      <div className="md:hidden">
        <DataCard
          data={filteredUsers}
          renderCard={(user) => (
            <div className="p-4 space-y-1">
              <h3 className="font-medium">{user.name}</h3>
              <p className="text-sm text-gray-500">Shift: {user.shift}</p>
              <p
                className={`text-sm font-medium ${
                  user.todaysAttendance ? 'text-green-600' : 'text-red-600'
                }`}
              >
                Status: {user.todaysAttendance ? 'Present' : 'Absent'}
              </p>
            </div>
          )}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/authtoken/createTokenButton.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { useState } from 'react';

// biome-ignore lint/correctness/noEmptyPattern: <explanation>
export default function CreateTokenButton({}: {
  existingToken: string | null;
}) {
  const [isLoading, setIsLoading] = useState(false);

  const handleClick = async () => {
    try {
      setIsLoading(true);
      window.location.reload();
    } catch (error) {
      console.error('Failed to create token:', error);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <Button onClick={handleClick} disabled={isLoading}>
      {isLoading ? 'Creating...' : 'Generate Token'}
    </Button>
  );
}

```

# app/dashboard/owner/gymdetails/authtoken/loading.tsx

```tsx
'use client';
import GymImage from '@/app/assests/gymd.webp';
import Image from 'next/image';
import React from 'react';
interface LoaderProps {
  size?: number;
  glowColor?: string;
  glowWidth?: number;
  animationDuration?: number;
}

export default function Loader({
  size = 200,
  glowColor = '#3b82f6',
  glowWidth = 6,
  animationDuration = 1,
}: LoaderProps) {
  return (
    <div className="flex items-center justify-center w-full h-full">
      <div
        className="relative"
        style={{
          width: size,
          height: size,
        }}
      >
        {/* Circular container for the logo */}
        <div className="absolute inset-0 rounded-full shadow-lg overflow-hidden  z-10">
          <Image
            src={GymImage}
            alt="GymNavigator Logo"
            width={size}
            height={size}
            className="object-contain "
          />
        </div>

        {/* Rotating border light effect */}
        <div
          className="absolute inset-0 rounded-full"
          style={{
            border: `${glowWidth}px solid transparent`,
            background: `linear-gradient(white, white) padding-box, 
                         conic-gradient(
                           from 0deg,
                           ${glowColor} 0deg 20deg,
                           transparent 20deg 340deg,
                           ${glowColor} 340deg 360deg
                         ) border-box`,
            animation: `spin ${animationDuration}s linear infinite`,
          }}
        />
      </div>

      {/* CSS Animations */}
      <style jsx>{`
        @keyframes spin {
          from {
            transform: rotate(0deg);
          }
          to {
            transform: rotate(360deg);
          }
        }
      `}</style>
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/authtoken/page.tsx

```tsx
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import { CheckCircle2 } from 'lucide-react';
import CreateTokenButton from './createTokenButton';

async function getExistingToken() {
  'use server';
  const ownerAxios = await OwnerReqConfig();
  const response = await ownerAxios.get('/getauthtoken');
  return response.data.token;
}

export default async function AuthTokenPage() {
  const existingToken = await getExistingToken();
  console.log('existingToken', existingToken);
  return (
    <div className="container mx-auto p-6">
      <Card>
        <CardHeader>
          <CardTitle>Authentication Token</CardTitle>
        </CardHeader>
        <CardContent>
          {existingToken ? (
            <div className="space-y-4">
              <div className="flex items-center gap-2 text-green-600">
                <CheckCircle2 className="w-5 h-5" />
                <span>Active Token</span>
              </div>
              <div className="p-4 bg-gray-50 rounded-md font-mono">{existingToken}</div>
            </div>
          ) : (
            <div className="space-y-4">
              <p className="text-gray-600">
                No active token found. Generate a new authentication token for your gym.
              </p>
              <CreateTokenButton existingToken={existingToken} />
            </div>
          )}
        </CardContent>
      </Card>
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/creategym/CreateGymDetails.tsx

```tsx
'use client';
import Loader from '@/app/dashboard/owner/gymdetails/editgymdetails/loading';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import { useForm } from 'react-hook-form';

import { zodResolver } from '@hookform/resolvers/zod';
import { Building2, Image as ImageIcon, Mail, MapPin, Phone } from 'lucide-react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import Swal from 'sweetalert2';
import { z } from 'zod';
import PostGymDetails from './PostGymDetailsSA';

const formSchema = z.object({
  gym_name: z.string().nonempty('Gym name is required'),
  gym_logo: z.string().nonempty('Gym logo is required'),
  address: z.string().nonempty('Address is required'),
  phone_number: z.string().nonempty('Phone number is required'),
  Email: z.string().nonempty('Email is required').email('Invalid email address'),
});

export default function CreateGymDetails() {
  const router = useRouter();
  const [Loading, setLoading] = useState<boolean>(false);
  const [logoPreview, setLogoPreview] = useState<string | null>(null);

  const form = useForm<z.infer<typeof formSchema>>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      gym_name: '',
      gym_logo: '',
      address: '',
      phone_number: '',
      Email: '',
    },
  });

  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (file) {
      form.setValue('gym_logo', file.name);
      const reader = new FileReader();
      reader.onloadend = () => {
        setLogoPreview(reader.result as string);
      };
      reader.readAsDataURL(file);
    }
  };

  const onSubmit = async (data: z.infer<typeof formSchema>) => {
    const result = await Swal.fire({
      title: 'Review Your Gym Details',
      html: `
        <div class="bg-white p-6 rounded-xl shadow-sm">
          <div class="space-y-3">
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Gym Name:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.gym_name}</span>
            </div>
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Address:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.address}</span>
            </div>
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Phone:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.phone_number}</span>
            </div>
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Email:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.Email}</span>
            </div>
            ${
              logoPreview
                ? `
              <div class="mt-4">
                <p class="text-gray-600 font-medium mb-2 text-left">Gym Logo</p>
                <img src="${logoPreview}" alt="Gym Logo" class="max-w-[150px] rounded-lg border border-gray-200">
              </div>
            `
                : ''
            }
          </div>
        </div>
      `,
      showCancelButton: true,
      confirmButtonText: 'Create Gym',
      cancelButtonText: 'Edit Again',
      customClass: {
        popup: 'rounded-xl',
        confirmButton:
          'bg-blue-600 hover:bg-blue-700 px-6 py-2.5 rounded-lg text-white font-medium',
        cancelButton: 'bg-gray-500 hover:bg-gray-600 px-6 py-2.5 rounded-lg text-white font-medium',
        title: 'text-gray-900 text-xl font-semibold',
      },
    });

    if (result.isConfirmed) {
      setLoading(true);
      try {
        let finalImageUrl = '';

        if (logoPreview) {
          const response = await fetch('/api/uploadimage', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ image: logoPreview }),
          });
          console.log('response from the image upload', response);
          const responseData = await response.json();
          if (response.ok) {
            finalImageUrl = responseData.url;
          } else {
            throw new Error(`Image upload failed: ${responseData.error}`);
          }
        }
        console.log('finalImageUrl', finalImageUrl);
        const response = await PostGymDetails(JSON.stringify(data), finalImageUrl);
        if (response) {
          await Swal.fire({
            title: 'Success!',
            text: 'Gym created successfully',
            icon: 'success',
            timer: 2000,
            showConfirmButton: false,
          });
          router.push('/ownerdashboard/gymdetails/viewgymdetails');
        } else {
          throw new Error('Failed to create gym');
        }
      } catch (error) {
        Swal.fire({
          title: 'Error!',
          text: `An error occurred: ${(error as Error).message}`,
          icon: 'error',
          confirmButtonColor: '#3085d6',
        });
      } finally {
        setLoading(false);
      }
    }
  };

  if (Loading) {
    return <Loader />;
  }

  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle className="text-4xl font-bold text-center">Create New Gym</CardTitle>
      </CardHeader>
      <CardContent>
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-8">
          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="gymName">Gym Name</Label>
            <div className="relative">
              <Building2 className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
              <Input
                id="gym_name"
                {...form.register('gym_name')}
                placeholder="Enter gym name"
                className="pl-10"
              />
            </div>
          </div>

          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="logo">Gym Logo</Label>
            <div className="flex items-center space-x-4">
              <div className="w-24 h-24 border-2 border-dashed rounded-lg flex items-center justify-center overflow-hidden">
                {logoPreview ? (
                  <Image
                    src={logoPreview}
                    alt="Logo preview"
                    width={96}
                    height={96}
                    className="w-full h-full object-cover"
                  />
                ) : (
                  <ImageIcon className="text-gray-400" />
                )}
              </div>
              <div className="flex-1">
                <Input
                  id="gym_logo"
                  type="file"
                  accept="image/*"
                  onChange={handleFileChange}
                  className="flex-1"
                />
              </div>
            </div>
          </div>

          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="address">Address</Label>
            <div className="relative">
              <MapPin className="absolute left-3 top-3 text-gray-400" />
              <Textarea
                id="address"
                {...form.register('address')}
                placeholder="Enter gym address"
                className="pl-10 min-h-[80px]"
              />
            </div>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div className="space-y-2">
              {/* @ts-ignore */}
              <Label htmlFor="phone">Phone Number</Label>
              <div className="relative">
                <Phone className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
                <Input
                  id="phone_number"
                  {...form.register('phone_number')}
                  type="tel"
                  placeholder="Enter phone number"
                  className="pl-10"
                />
              </div>
            </div>
            <div className="space-y-2">
              {/* @ts-ignore */}
              <Label htmlFor="email">Email</Label>
              <div className="relative">
                <Mail className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
                <Input
                  id="Email"
                  {...form.register('Email')}
                  type="email"
                  placeholder="Enter email address"
                  className="pl-10"
                />
              </div>
            </div>
          </div>

          <Button
            type="submit"
            className="w-full bg-gradient-to-r from-blue-400 to-indigo-600 text-white text-base"
          >
            Create Gym
          </Button>
        </form>
      </CardContent>
    </Card>
  );
}

```

# app/dashboard/owner/gymdetails/creategym/page.tsx

```tsx
import CreateGymDetails from './CreateGymDetails';

export default function CreateGymPage() {
  return (
    <div className="w-full h-screen overflow-auto flex justify-center items-center">
      <CreateGymDetails />
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/creategym/PostGymDetailsSA.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

interface GymResponse {
  msg: string;
  gym: {
    gym_name: string;
    gym_logo: string;
    address: string;
    phone_number: string;
    Email: string;
  };
}

interface FormData {
  gym_name: string;
  gym_logo: File | null;
  address: string;
  phone_number: string;
  Email: string;
}

export default async function PostGymDetails(formData: string, image: string) {
  console.log('received the request from the postgymdetails ', image, formData);
  try {
    const formdata: FormData = JSON.parse(formData);
    const ownerAxios = await OwnerReqConfig();
    const payload = {
      gym_name: formdata.gym_name,
      gym_logo: image, // Use the provided image URL directly
      address: formdata.address,
      phone_number: formdata.phone_number,
      Email: formdata.Email,
    };

    console.log('payload is ', payload);
    const response: AxiosResponse<GymResponse> = await ownerAxios.post('/gym/creategym', payload, {
      headers: {
        'Content-Type': 'application/json',
      },
    });

    if (response.status === 200) {
      console.log('Gym details submitted successfully:', response.data.gym);
      console.log('Gym details submitted successfully:', response.data.msg);
      return response.data.gym;
    }
    console.log('Failed to submit gym details:', response.data);
    return null;
  } catch (error) {
    console.error('Error submitting the gym details:', error);
    return null;
  }
}

```

# app/dashboard/owner/gymdetails/editgymdetails/EditGymDetails.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { useState } from 'react';
import Swal from 'sweetalert2';

import Loader from '@/app/dashboard/owner/gymdetails/editgymdetails/loading';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import { useForm } from 'react-hook-form';

import { zodResolver } from '@hookform/resolvers/zod';
import { Building2, Image as ImageIcon, Key, Mail, MapPin, Phone } from 'lucide-react';
import Image from 'next/image';
import { useRouter, useSearchParams } from 'next/navigation';
import { z } from 'zod';
import UpdateGymDetails from './UpdateGymDetails';
const formSchema = z.object({
  gym_name: z.string().nonempty('Gym name is required'),
  gym_logo: z.string().nonempty('Gym logo is required'),
  address: z.string().nonempty('Address is required'),
  phone_number: z.string().nonempty('Phone number is required'),
  Email: z.string().nonempty('Email is required').email('Invalid email address'),
});

export default function EditGymDetails() {
  const searchParams = useSearchParams();
  const router = useRouter();
  const [Loading, setLoading] = useState<boolean>(false);
  const [isNewImage, setIsNewImage] = useState<boolean>(false);

  // Initialize logoPreview with the existing logo URL from searchParams
  const [logoPreview, setLogoPreview] = useState<string | null>(searchParams.get('logo') || null);

  const form = useForm<z.infer<typeof formSchema>>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      gym_name: searchParams.get('name') || '',
      gym_logo: searchParams.get('logo') || '',
      address: searchParams.get('address') || '',
      phone_number: searchParams.get('phone') || '',
      Email: searchParams.get('email') || '',
    },
  });

  const authToken = searchParams.get('authToken');

  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (file) {
      setIsNewImage(true);
      form.setValue('gym_logo', file.name);
      const reader = new FileReader();
      reader.onloadend = () => {
        setLogoPreview(reader.result as string);
      };
      reader.readAsDataURL(file);
    }
  };

  const onSubmit = async (data: z.infer<typeof formSchema>) => {
    const result = await Swal.fire({
      title: 'Review Your Changes',
      html: `
        <div class="bg-white p-6 rounded-xl shadow-sm">
          <div class="space-y-3">
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Gym Name:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.gym_name}</span>
            </div>
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Address:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.address}</span>
            </div>
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Phone:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.phone_number}</span>
            </div>
            <div class="flex items-center border-b border-gray-100 py-3">
              <span class="text-gray-600 font-medium w-32 shrink-0">Email:</span>
              <span class="text-gray-900 ml-4 truncate text-left">${data.Email}</span>
            </div>
            ${
              logoPreview
                ? `
              <div class="mt-4">
                <p class="text-gray-600 font-medium mb-2 text-left">Gym Logo</p>
                <img src="${logoPreview}" alt="Gym Logo" class="max-w-[150px] rounded-lg border border-gray-200">
              </div>
            `
                : ''
            }
          </div>
        </div>
      `,
      background: '#ffffff',
      showCancelButton: true,
      confirmButtonText: 'Save Changes',
      cancelButtonText: 'Edit Again',
      customClass: {
        popup: 'rounded-xl',
        confirmButton:
          'bg-blue-600 hover:bg-blue-700 px-6 py-2.5 rounded-lg text-white font-medium',
        cancelButton: 'bg-gray-500 hover:bg-gray-600 px-6 py-2.5 rounded-lg text-white font-medium',
        title: 'text-gray-900 text-xl font-semibold',
      },
    });

    if (result.isConfirmed) {
      setLoading(true);
      try {
        let finalImageUrl = searchParams.get('logo') || '';

        if (isNewImage && logoPreview) {
          const response = await fetch('/api/uploadimage', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ image: logoPreview }),
          });

          const responseData = await response.json();
          if (response.ok) {
            finalImageUrl = responseData.url;
          } else {
            throw new Error(`Image upload failed: ${responseData.error}`);
          }
        }

        const response = await UpdateGymDetails(JSON.stringify(data), finalImageUrl);
        if (response) {
          await Swal.fire({
            title: 'Success!',
            text: 'Gym details updated successfully',
            icon: 'success',
            timer: 2000,
            showConfirmButton: false,
          });
          router.push('/ownerdashboard/gymdetails/viewgymdetails');
        } else {
          throw new Error('Failed to update gym details');
        }
      } catch (error) {
        Swal.fire({
          title: 'Error!',
          text: `An error occurred: ${(error as Error).message}`,
          icon: 'error',
          confirmButtonColor: '#3085d6',
        });
      } finally {
        setLoading(false);
      }
    }
  };

  if (Loading) {
    return (
      <>
        <Loader />
      </>
    );
  }
  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle className="text-4xl font-bold text-center">Edit Gym Details</CardTitle>
      </CardHeader>
      <CardContent>
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-8">
          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="gymName">Gym Name</Label>
            <div className="relative">
              <Building2 className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
              <Input
                id="gym_name"
                {...form.register('gym_name')}
                placeholder="Enter gym name"
                className="pl-10"
              />
            </div>
          </div>

          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="logo">Gym Logo</Label>
            <div className="flex items-center space-x-4">
              <div className="w-24 h-24 border-2 border-dashed rounded-lg flex items-center justify-center overflow-hidden">
                {logoPreview ? (
                  <Image
                    src={logoPreview}
                    alt="Logo preview"
                    width={96}
                    height={96}
                    className="w-full h-full object-cover"
                  />
                ) : (
                  <ImageIcon className="text-gray-400" />
                )}
              </div>
              <div className="flex-1 space-y-2">
                <Input
                  id="gym_logo"
                  type="file"
                  accept="image/*"
                  onChange={handleFileChange}
                  className="flex-1"
                />
                {logoPreview && (
                  <p className="text-sm text-gray-500">Click browse to change the logo</p>
                )}
              </div>
            </div>
          </div>

          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="address">Address</Label>
            <div className="relative">
              <MapPin className="absolute left-3 top-3 text-gray-400" />
              <Textarea
                id="address"
                {...form.register('address')}
                placeholder="Enter gym address"
                className="pl-10 min-h-[80px]"
              />
            </div>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div className="space-y-2">
              {/* @ts-ignore */}
              <Label htmlFor="phone">Phone Number</Label>
              <div className="relative">
                <Phone className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
                <Input
                  id="phone_number"
                  {...form.register('phone_number')}
                  type="tel"
                  placeholder="Enter phone number"
                  className="pl-10"
                />
              </div>
            </div>
            <div className="space-y-2">
              {/* @ts-ignore */}
              <Label htmlFor="email">Email</Label>
              <div className="relative">
                <Mail className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
                <Input
                  id="Email"
                  {...form.register('Email')}
                  type="email"
                  placeholder="Enter email address"
                  className="pl-10"
                />
              </div>
            </div>
          </div>

          <div className="space-y-2">
            {/* @ts-ignore */}
            <Label htmlFor="authToken">Auth Token (Non-editable)</Label>
            <div className="relative">
              <Key className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
              <Input
                id="authToken"
                value={authToken || 'Generated by system'}
                disabled
                className="pl-10 bg-gray-50 text-gray-500"
              />
            </div>
          </div>

          <Button
            type="submit"
            className="w-full bg-gradient-to-r from-blue-400 to-indigo-600  text-white text-base "
          >
            Save Gym Details
          </Button>
        </form>
      </CardContent>
    </Card>
  );
}

```

# app/dashboard/owner/gymdetails/editgymdetails/loading.tsx

```tsx
'use client';
import GymImage from '@/app/assests/gymd.webp';
import Image from 'next/image';
import React from 'react';
interface LoaderProps {
  size?: number;
  glowColor?: string;
  glowWidth?: number;
  animationDuration?: number;
}

export default function Loader({
  size = 200,
  glowColor = '#3b82f6',
  glowWidth = 6,
  animationDuration = 1,
}: LoaderProps) {
  return (
    <div className="flex items-center justify-center w-full h-full">
      <div
        className="relative"
        style={{
          width: size,
          height: size,
        }}
      >
        {/* Circular container for the logo */}
        <div className="absolute inset-0 rounded-full shadow-lg overflow-hidden  z-10">
          <Image
            src={GymImage}
            alt="GymNavigator Logo"
            width={size}
            height={size}
            className="object-contain "
          />
        </div>

        {/* Rotating border light effect */}
        <div
          className="absolute inset-0 rounded-full"
          style={{
            border: `${glowWidth}px solid transparent`,
            background: `linear-gradient(white, white) padding-box, 
                         conic-gradient(
                           from 0deg,
                           ${glowColor} 0deg 20deg,
                           transparent 20deg 340deg,
                           ${glowColor} 340deg 360deg
                         ) border-box`,
            animation: `spin ${animationDuration}s linear infinite`,
          }}
        />
      </div>

      {/* CSS Animations */}
      <style jsx>{`
        @keyframes spin {
          from {
            transform: rotate(0deg);
          }
          to {
            transform: rotate(360deg);
          }
        }
      `}</style>
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/editgymdetails/page.tsx

```tsx
import EditGymDetails from './EditGymDetails';

export default function EditGymDetailsPage() {
  return (
    <div className="w-full h-screen overflow-auto flex justify-center items-center">
      <EditGymDetails />
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/editgymdetails/UpdateGymDetails.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

interface GymResponse {
  msg: string;
  gym: {
    gym_name: string;
    gym_logo: string;
    address: string;
    phone_number: string;
    Email: string;
  };
}

export default async function UpdateGymDetails(formData: string, image: string) {
  try {
    const formdata = JSON.parse(formData);
    const ownerAxios = await OwnerReqConfig();
    const payload = {
      gym_name: formdata.gym_name,
      gym_logo: image,
      address: formdata.address,
      phone_number: formdata.phone_number,
      Email: formdata.Email,
    };

    const response: AxiosResponse<GymResponse> = await ownerAxios.put(
      '/gym/updategymdetails',
      payload,
      {
        headers: {
          'Content-Type': 'application/json',
        },
      },
    );

    if (response.status === 200) {
      return response.data.gym;
    }
    return null;
  } catch (error) {
    console.error('Error updating gym details:', error);
    return null;
  }
}

```

# app/dashboard/owner/gymdetails/users/enrollmentcard.tsx

```tsx
import { Badge } from '@/components/ui/badge';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import type { Enrollment } from './types';

const statusColors = {
  active: 'bg-green-100 text-green-800',
  pending: 'bg-yellow-100 text-yellow-800',
  inactive: 'bg-red-100 text-red-800',
};

export function EnrollmentCards({ enrollments }: { enrollments: Enrollment[] }) {
  return (
    <div className="space-y-4">
      {enrollments.map((enrollment: Enrollment) => (
        <Card key={enrollment.id}>
          <CardHeader>
            <CardTitle className="flex justify-between items-center">
              <span>{enrollment.userName}</span>
              <Badge className={statusColors[enrollment.status]}>
                {enrollment.status.charAt(0).toUpperCase() + enrollment.status.slice(1)}
              </Badge>
            </CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-sm text-gray-500">
              Start Date: {enrollment.startDate ? enrollment.startDate.toLocaleDateString() : '-'}
            </p>
            <p className="text-sm text-gray-500">
              End Date: {enrollment.endDate ? enrollment.endDate.toLocaleDateString() : '-'}
            </p>
          </CardContent>
        </Card>
      ))}
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/users/enrollmenttable.tsx

```tsx
'use client';
import {
  type ColumnDef,
  type ColumnFiltersState,
  type SortingState,
  flexRender,
  getCoreRowModel,
  getFilteredRowModel,
  getPaginationRowModel,
  getSortedRowModel,
  useReactTable,
} from '@tanstack/react-table';
import { ArrowUpDown, ChevronDown, MoreHorizontal } from 'lucide-react';
import { useState } from 'react';

import { Button } from '@/components/ui/button';
import {} from '@/components/ui/checkbox';
import {
  DropdownMenu,
  DropdownMenuCheckboxItem,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Input } from '@/components/ui/input';
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table';
import type { Enrollment, EnrollmentStatus, EnrollmentTableProps } from './types';

const statusStyles: Record<EnrollmentStatus, string> = {
  active: 'bg-green-100 text-green-800',
  pending: 'bg-yellow-100 text-yellow-800',
  inactive: 'bg-red-100 text-red-800',
};
export function EnrollmentTable({ enrollments }: EnrollmentTableProps) {
  const [sorting, setSorting] = useState<SortingState>([]);
  const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([]);
  const [columnVisibility, setColumnVisibility] = useState<Record<string, boolean>>({});
  const [rowSelection, setRowSelection] = useState<Record<string, boolean>>({});

  const columns: ColumnDef<Enrollment>[] = [
    {
      accessorKey: 'userName',
      header: ({ column }) => {
        return (
          <Button
            variant="ghost"
            onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
          >
            User Name
            <ArrowUpDown className="ml-2 h-4 w-4" />
          </Button>
        );
      },
      cell: ({ row }) => <div className="lowercase">{row.getValue('userName')}</div>,
    },
    {
      accessorKey: 'startDate',
      header: 'Start Date',
      cell: ({ row }) => {
        const date = new Date(row.getValue('startDate'));
        return <div>{date.toLocaleDateString()}</div>;
      },
    },
    {
      accessorKey: 'endDate',
      header: 'End Date',
      cell: ({ row }) => {
        const date = new Date(row.getValue('endDate'));
        return <div>{date.toLocaleDateString()}</div>;
      },
    },
    {
      accessorKey: 'status',
      header: 'Status',
      cell: ({ row }) => {
        const status = row.getValue('status') as EnrollmentStatus;
        return (
          <div
            className={`rounded-full px-2 py-1 text-xs font-semibold text-center w-1/2 ${statusStyles[status]}`}
          >
            {status.charAt(0).toUpperCase() + status.slice(1)}
          </div>
        );
      },
    },
    {
      id: 'actions',
      enableHiding: false,
      cell: ({ row }) => {
        const enrollment = row.original;

        return (
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <Button variant="ghost" className="h-8 w-8 p-0">
                <span className="sr-only">Open menu</span>
                <MoreHorizontal className="h-4 w-4" />
              </Button>
            </DropdownMenuTrigger>
            <DropdownMenuContent align="end">
              <DropdownMenuLabel>Actions</DropdownMenuLabel>
              <DropdownMenuItem
                onClick={() => navigator.clipboard.writeText(enrollment.id.toString())}
              >
                Copy user ID
              </DropdownMenuItem>
              <DropdownMenuSeparator />
              <DropdownMenuItem>View user details</DropdownMenuItem>
              <DropdownMenuItem>Update enrollment</DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        );
      },
    },
  ];

  const table = useReactTable({
    data: enrollments,
    columns,
    onSortingChange: setSorting,
    onColumnFiltersChange: setColumnFilters,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    getSortedRowModel: getSortedRowModel(),
    getFilteredRowModel: getFilteredRowModel(),
    onColumnVisibilityChange: setColumnVisibility,
    onRowSelectionChange: setRowSelection,
    state: {
      sorting,
      columnFilters,
      columnVisibility,
      rowSelection,
    },
  });

  return (
    <div className="w-full">
      <div className="flex items-center py-4">
        <Input
          placeholder="Filter users..."
          value={(table.getColumn('userName')?.getFilterValue() as string) ?? ''}
          onChange={(event) => table.getColumn('userName')?.setFilterValue(event.target.value)}
          className="max-w-sm"
        />
        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="outline" className="ml-auto">
              Columns <ChevronDown className="ml-2 h-4 w-4" />
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end">
            {table
              .getAllColumns()
              .filter((column) => column.getCanHide())
              .map((column) => {
                return (
                  <DropdownMenuCheckboxItem
                    key={column.id}
                    className="capitalize"
                    checked={column.getIsVisible()}
                    onCheckedChange={(value) => column.toggleVisibility(!!value)}
                  >
                    {column.id}
                  </DropdownMenuCheckboxItem>
                );
              })}
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
      <div className="rounded-md border">
        <Table>
          <TableHeader>
            {table.getHeaderGroups().map((headerGroup) => (
              <TableRow key={headerGroup.id}>
                {headerGroup.headers.map((header) => {
                  return (
                    <TableHead key={header.id}>
                      {header.isPlaceholder
                        ? null
                        : flexRender(header.column.columnDef.header, header.getContext())}
                    </TableHead>
                  );
                })}
              </TableRow>
            ))}
          </TableHeader>
          <TableBody>
            {table.getRowModel().rows?.length ? (
              table.getRowModel().rows.map((row) => (
                <TableRow key={row.id} data-state={row.getIsSelected() && 'selected'}>
                  {row.getVisibleCells().map((cell) => (
                    <TableCell key={cell.id}>
                      {flexRender(cell.column.columnDef.cell, cell.getContext())}
                    </TableCell>
                  ))}
                </TableRow>
              ))
            ) : (
              <TableRow>
                <TableCell colSpan={columns.length} className="h-24 text-center">
                  No results.
                </TableCell>
              </TableRow>
            )}
          </TableBody>
        </Table>
      </div>
      <div className="flex items-center justify-end space-x-2 py-4">
        <div className="flex-1 text-sm text-muted-foreground">
          {table.getFilteredSelectedRowModel().rows.length} of{' '}
          {table.getFilteredRowModel().rows.length} row(s) selected.
        </div>
        <div className="space-x-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => table.previousPage()}
            disabled={!table.getCanPreviousPage()}
          >
            Previous
          </Button>
          <Button
            variant="outline"
            size="sm"
            onClick={() => table.nextPage()}
            disabled={!table.getCanNextPage()}
          >
            Next
          </Button>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/users/page.tsx

```tsx
'use client';

import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { type LucideIcon, UserCheck, ClockIcon as UserClock, Users } from 'lucide-react';
import { useState } from 'react';
import { EnrollmentCards } from './enrollmentcard';
import { EnrollmentTable } from './enrollmenttable';
import type { Enrollment } from './types';

export default function GymManagement() {
  const [enrollments, setEnrollments] = useState<Enrollment[]>([
    {
      id: '1',
      userName: 'John Doe',
      startDate: new Date('2023-06-01'),
      endDate: new Date('2023-12-31'),
      status: 'active',
    },
    {
      id: '2',
      userName: 'Jane Smith',
      startDate: new Date('2023-06-15'),
      endDate: new Date('2023-12-31'),
      status: 'pending',
    },
    {
      id: '3',
      userName: 'Bob Johnson',
      startDate: new Date('2023-07-01'),
      endDate: new Date('2024-01-31'),
      status: 'inactive',
    },
  ]);

  const totalUsers = enrollments.length;
  const allowedUsers = enrollments.filter((e) => e.status === 'active').length;
  const pendingUsers = enrollments.filter((e) => e.status === 'pending').length;

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-3xl font-bold text-center mb-8">Gym Enrollment Management</h1>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        <StatCard
          title="Total Users"
          value={totalUsers}
          icon={Users}
          gradient="from-blue-500 to-blue-600"
        />
        <StatCard
          title="Allowed Users"
          value={allowedUsers}
          icon={UserCheck}
          gradient="from-green-500 to-green-600"
        />
        <StatCard
          title="Pending Users"
          value={pendingUsers}
          icon={UserClock}
          gradient="from-yellow-500 to-yellow-600"
        />
      </div>

      <div className="hidden md:block">
        <EnrollmentTable enrollments={enrollments} setEnrollments={setEnrollments} />
      </div>

      <div className="md:hidden">
        <EnrollmentCards enrollments={enrollments} />
      </div>
    </div>
  );
}

function StatCard({
  title,
  value,
  icon: Icon,
  gradient,
}: {
  title: string;
  value: number;
  icon: LucideIcon;
  gradient: string;
}) {
  return (
    <Card className={`bg-gradient-to-br ${gradient} text-white`}>
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
        <CardTitle className="text-sm font-medium">{title}</CardTitle>
        <Icon className="h-8 w-8 opacity-75 text-white" />
      </CardHeader>
      <CardContent>
        <div className="text-2xl font-bold">{value}</div>
      </CardContent>
    </Card>
  );
}

```

# app/dashboard/owner/gymdetails/users/types.ts

```ts
import type {
  ColumnDef,
  ColumnFiltersState,
  Row,
  SortingState,
  Table,
} from '@tanstack/react-table';
import type { LucideIcon } from 'lucide-react';

export type EnrollmentStatus = 'active' | 'pending' | 'inactive';

export interface Enrollment {
  id: string;
  userId?: string;
  userName?: string;
  planName?: string;
  startDate: Date;
  endDate: Date;
  status: EnrollmentStatus;
  amount?: number;
}

export interface EnrollmentTableProps {
  enrollments: Enrollment[];
  setEnrollments: (enrollments: Enrollment[]) => void;
}

export interface StatsCardProps {
  title: string;
  value: string | number;
  Icon: LucideIcon;
  gradient: string;
}

export interface TableProps {
  table: Table<Enrollment>;
  row: Row<Enrollment>;
}

export type EnrollmentColumn = ColumnDef<Enrollment>;

export interface TableState {
  sorting: SortingState;
  columnFilters: ColumnFiltersState;
  columnVisibility: Record<string, boolean>;
  rowSelection: Record<string, boolean>;
}

```

# app/dashboard/owner/gymdetails/viewgymdetails/GetGymDetails.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

export interface sessionType {
  role: string;
  user: {
    name: string;
    email: string;
    picture?: string | null;
  };
}

export default async function FetchGymDetailsSA() {
  interface responseType {
    msg: string;
    gym: {
      gym_name: string;
      gym_logo: string;
      address: string;
      phone_number: string;
      Email: string;
      gymauthtoken: string;
    };
  }

  try {
    // Initialize Axios instance with Authorization header
    const ownerAxios = await OwnerReqConfig();
    const response: AxiosResponse<responseType> = await ownerAxios.get('/gym/gymdetails');

    console.log('Gym details fetched successfully:', response.data.gym);
    return response.data.gym;
  } catch (err: unknown) {
    console.error('Error fetching gym details:', err);
    return null; // Return null or handle the error as needed
  }
}

```

# app/dashboard/owner/gymdetails/viewgymdetails/gym.png

This is a binary file of the type: Image

# app/dashboard/owner/gymdetails/viewgymdetails/NoGymDetails.tsx

```tsx
import { Button } from '@/components/ui/button';
import { m } from 'framer-motion';
import { Plus } from 'lucide-react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import GymImage from './gym.png';
export default function NoGymDetails() {
  const router = useRouter();

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-3xl font-bold text-gray-900 mb-6 w-full text-center">Gym Details</h1>
      <div className="relative h-[500px] w-full overflow-hidden rounded-lg bg-white shadow-lg">
        {/* Blurred Background Image */}
        <div className="absolute inset-0">
          <Image src={GymImage} alt="Gym Preview" fill className="object-cover blur-[2px]" />
          {/* Add dark overlay */}
          <div className="absolute inset-0 bg-black/50" />
        </div>

        {/* Content Overlay */}
        <m.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="relative z-10 h-full flex flex-col items-center justify-center text-white p-6"
        >
          <h2 className="text-3xl font-bold mb-4 text-center text-white">
            Your Gym Profile Awaits
          </h2>
          <p className="text-lg mb-8 text-center max-w-md text-white/90">
            Create your gym profile to manage members, track progress, and grow your business
          </p>
          <Button
            onClick={() => router.push('/ownerdashboard/gymdetails/creategym')}
            className="bg-white text-indigo-700 hover:bg-gray-100 font-semibold px-6 py-3 rounded-lg flex items-center gap-2"
          >
            <Plus className="w-5 h-5" />
            Create Gym Profile
          </Button>
        </m.div>

        {/* Bottom Gradient Overlay */}
        <div className="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-black/60 to-transparent" />
      </div>
    </div>
  );
}

```

# app/dashboard/owner/gymdetails/viewgymdetails/page.tsx

```tsx
export const dynamic = 'force-dynamic';
import FetchGymDetailsSA from './GetGymDetails';
import ViewGymDetails from './viewgymdetails';

export default async function Page() {
  const gymDetails = await FetchGymDetailsSA();
  return <ViewGymDetails gymDetails={gymDetails} />;
}

```

# app/dashboard/owner/gymdetails/viewgymdetails/viewgymdetails.tsx

```tsx
'use client';
export const dynamic = 'force-dynamic';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { m } from 'framer-motion';
import { Check, Copy, Key, Mail, MapIcon, MapPin, MoreVertical, Phone } from 'lucide-react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import NoGymDetails from './NoGymDetails';

interface GymDetails {
  gym_name: string;
  gym_logo: string;
  address: string;
  phone_number: string;
  Email: string;
  gymauthtoken: string; // Add auth token to interface
}

export default function ViewGymDetails({
  gymDetails,
}: {
  gymDetails: GymDetails | null;
}) {
  const router = useRouter();
  const [copied, setCopied] = useState(false);

  if (!gymDetails) {
    return <NoGymDetails />;
  }

  const handleEdit = () => {
    const params = new URLSearchParams({
      name: gymDetails.gym_name,
      logo: gymDetails.gym_logo,
      address: gymDetails.address,
      phone: gymDetails.phone_number,
      email: gymDetails.Email,
      authToken: gymDetails.gymauthtoken,
    });
    router.push(`/ownerdashboard/gymdetails/editgymdetails?${params.toString()}`);
  };

  const copyToClipboard = async (text: string) => {
    await navigator.clipboard.writeText(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div className="min-h-screen bg-gray-50   mx-auto">
      {/* Simplified Hero Section with Fixed Menu Position */}
      <div className="bg-white border-b">
        <div className="container mx-auto px-4 py-6">
          <div className="relative">
            {/* Three-dot menu - Now absolutely positioned */}
            <div className="absolute right-0 top-0">
              <DropdownMenu>
                <DropdownMenuTrigger asChild>
                  <Button variant="ghost" size="icon" className="rounded-full hover:bg-gray-100">
                    <MoreVertical className="h-5 w-5" />
                  </Button>
                </DropdownMenuTrigger>
                <DropdownMenuContent align="end">
                  <DropdownMenuItem onClick={handleEdit}>Edit Gym Details</DropdownMenuItem>
                </DropdownMenuContent>
              </DropdownMenu>
            </div>

            {/* Profile content */}
            <div className="flex flex-col sm:flex-row items-center gap-6 pt-2">
              <div className="w-20 h-20 sm:w-24 sm:h-24 rounded-full overflow-hidden border-4 border-gray-100 shadow-sm">
                <Image
                  src={gymDetails.gym_logo}
                  alt={`${gymDetails.gym_name} logo`}
                  width={96}
                  height={96}
                  className="w-full h-full object-cover"
                />
              </div>
              <div className="text-center sm:text-left flex-1">
                <h1 className="text-2xl sm:text-3xl font-bold text-gray-900">
                  {gymDetails.gym_name}
                </h1>
                <div className="flex items-center justify-center sm:justify-start text-gray-600 gap-2 mt-2">
                  <MapPin className="w-4 h-4" />
                  <span className="text-sm">{gymDetails.address}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* Main Content */}
      <div className="container mx-auto px-4 py-6 space-y-6">
        {/* Contact Cards */}
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          <m.div
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.1 }}
          >
            <Card className="hover:shadow transition-shadow duration-300">
              <CardContent className="p-4">
                <div className="flex items-center gap-3">
                  <div className="p-2 bg-indigo-50 rounded-full">
                    <Phone className="h-5 w-5 text-indigo-600" />
                  </div>
                  <div>
                    <p className="text-xs text-gray-500">Phone Number</p>
                    <p className="font-medium">{gymDetails.phone_number}</p>
                  </div>
                </div>
              </CardContent>
            </Card>
          </m.div>

          <m.div
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.2 }}
          >
            <Card className="hover:shadow transition-shadow duration-300">
              <CardContent className="p-4">
                <div className="flex items-center gap-3">
                  <div className="p-2 bg-purple-50 rounded-full">
                    <Mail className="h-5 w-5 text-purple-600" />
                  </div>
                  <div>
                    <p className="text-xs text-gray-500">Email Address</p>
                    <p className="font-medium">{gymDetails.Email}</p>
                  </div>
                </div>
              </CardContent>
            </Card>
          </m.div>

          <m.div
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.3 }}
            className="sm:col-span-2 lg:col-span-1"
          >
            <Card className="hover:shadow transition-shadow duration-300">
              <CardContent className="p-4">
                <div className="flex items-center gap-3">
                  <div className="p-2 bg-green-50 rounded-full">
                    <Key className="h-5 w-5 text-green-600" />
                  </div>
                  <div className="flex-1 min-w-0">
                    <p className="text-xs text-gray-500">Auth Token</p>
                    <div className="flex items-center gap-2">
                      <p className="font-mono text-sm truncate bg-gray-50 px-2 py-1 rounded-md border border-gray-200">
                        {gymDetails.gymauthtoken}
                      </p>
                      <Button
                        variant="ghost"
                        size="icon"
                        onClick={() => copyToClipboard(gymDetails.gymauthtoken)}
                        className="flex-shrink-0"
                      >
                        {copied ? (
                          <Check className="h-4 w-4 text-green-600" />
                        ) : (
                          <Copy className="h-4 w-4 text-gray-500" />
                        )}
                      </Button>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </m.div>
        </div>

        {/* Location Map */}
        <m.div
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4 }}
        >
          <Card>
            <CardContent className="p-4">
              <h2 className="text-lg font-semibold mb-4 flex items-center gap-2">
                <MapPin className="h-5 w-5 text-gray-500" />
                Location
              </h2>
              <div className="aspect-[16/9] sm:aspect-[21/9] rounded-lg overflow-hidden bg-gray-100 relative">
                <div className="absolute inset-0 flex items-center justify-center flex-col gap-2">
                  <MapPin className="h-8 w-8 text-gray-400" />
                  <p className="text-gray-500 font-medium">Location feature coming soon</p>
                </div>
              </div>
              <p className="text-sm text-gray-500 mt-4 flex items-start gap-2">
                <MapPin className="h-4 w-4 mt-1 flex-shrink-0" />
                <span>{gymDetails.address}</span>
              </p>
            </CardContent>
          </Card>
        </m.div>
      </div>
    </div>
  );
}

```

# app/dashboard/owner/layout.tsx

```tsx
import type React from 'react';

export default function layout({ children }: { children: React.ReactNode }) {
  return (
    <>
      <div className="">{children}</div>
    </>
  );
}

```

# app/dashboard/owner/onboarding/editactiveperiod/actions/typecheck.ts

```ts
'use server';

import { z } from 'zod';

const UserValiditySchema = z
  .object({
    userId: z.number().int().positive(),
    startDate: z.date(),
    endDate: z.date(),
    shift: z.enum(['morning', 'evening']),
  })
  .refine((data) => data.endDate > data.startDate, {
    message: 'End date must be after start date',
    path: ['endDate'],
  });

type UserValidityInput = z.infer<typeof UserValiditySchema>;

export const validateUserValidity = async (data: UserValidityInput) => {
  const result = UserValiditySchema.safeParse(data);
  if (!result.success) {
    return {
      success: false,
      errors: result.error.formErrors.fieldErrors,
    };
  }
  return {
    success: true,
    data: result.data,
  };
};

console.log(UserValiditySchema);

```

# app/dashboard/owner/onboarding/editactiveperiod/actions/updateActivePeriod.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

interface UpdateUserResponseType {
  msg: string;
  user: {
    id: number;
    name: string;
    isallowed: boolean;
    Validperiod: {
      id: number;
      shift: string;
      startDate: Date;
      endDate: Date;
    } | null;
  };
}

export const UpdateUserActivePeriod = async ({
  userId,
  startDate,
  endDate,
  shift,
}: {
  userId: number;
  startDate: Date;
  endDate: Date;
  shift: string;
}) => {
  const OwnerAxios = await OwnerReqConfig();
  try {
    const response: AxiosResponse<UpdateUserResponseType> = await OwnerAxios.post(
      '/updateuservalidity',
      {
        userId,
        startDate,
        endDate,
        shift,
      },
    );
    console.log(response.data);
    return response.data;
  } catch (error) {
    console.error(error);
    return { msg: 'Error', user: null };
  }
};

```

# app/dashboard/owner/onboarding/editactiveperiod/EditActivePeriodWrapper.tsx

```tsx
'use client';
import { useSearchParams } from 'next/navigation';
import { UserValidityPeriod } from './UserValidPeriod';

export default function EditActivePeriodWrapper() {
  const searchParams = useSearchParams();
  const userid = searchParams.get('userid') || '';
  const username = searchParams.get('username') || '';
  const startdate = searchParams.get('startdate');
  const enddate = searchParams.get('enddate');

  return (
    <UserValidityPeriod
      userId={userid}
      userName={username}
      userImage="https://randomuser.me/api/portraits"
      initialStartDate={startdate ? new Date(startdate) : undefined}
      initialEndDate={enddate ? new Date(enddate) : undefined}
    />
  );
}

```

# app/dashboard/owner/onboarding/editactiveperiod/page.tsx

```tsx
'use client';
import { Suspense } from 'react';
import EditActivePeriodWrapper from './EditActivePeriodWrapper';

export default function Page() {
  return (
    <div className="container flex justify-center lg:h-screen py-10">
      <Suspense fallback={<div>Loading...</div>}>
        <EditActivePeriodWrapper />
      </Suspense>
    </div>
  );
}

```

# app/dashboard/owner/onboarding/editactiveperiod/UserValidPeriod.tsx

```tsx
'use client';

import { UpdateUserActivePeriod } from '@/app/dashboard/owner/onboarding/editactiveperiod/actions/updateActivePeriod';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Button } from '@/components/ui/button';
import { Calendar } from '@/components/ui/calendar';
import { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { addMonths, format } from 'date-fns';
import { CalendarIcon } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useState, useTransition } from 'react';
import { Toaster, toast } from 'react-hot-toast';
import Swal from 'sweetalert2';
import { validateUserValidity } from './actions/typecheck';

interface UserValidityPeriodProps {
  userId: string;
  userName: string;
  userImage?: string;
  initialStartDate?: Date;
  initialEndDate?: Date;
}

export function UserValidityPeriod({
  userId,
  userName,
  userImage,
  initialStartDate,
  initialEndDate,
}: UserValidityPeriodProps) {
  const router = useRouter();
  const [isPending, startTransition] = useTransition();
  const [startDate, setStartDate] = useState<Date>(initialStartDate || new Date());
  const [endDate, setEndDate] = useState<Date>(initialEndDate || addMonths(new Date(), 1));
  const [shift, setShift] = useState<'morning' | 'evening'>('morning');
  const defaultImage = 'https://randomuser.me/api/portraits';
  const [startDateOpen, setStartDateOpen] = useState(false);
  const [endDateOpen, setEndDateOpen] = useState(false);

  const getDefaultEndMonth = () => {
    return addMonths(startDate, 1);
  };

  const handleSubmit = () => {
    startTransition(async () => {
      const userData = {
        userId: Number(userId),
        startDate,
        endDate,
        shift,
      };

      const formatDisplayDate = (date: Date) => {
        return format(date, 'dd-MM-yyyy');
      };

      const result = await Swal.fire({
        title: 'Update Gym Session Period',
        position: 'center',
        html: `
          <div class="text-left p-4">
        <div class="border-b pb-2 mb-4">
          <h3 class="font-medium text-gray-900">Session Details</h3>
        </div>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-gray-600">Start Date:</span>
            <span class="font-medium">${formatDisplayDate(startDate)}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">End Date:</span>
            <span class="font-medium">${formatDisplayDate(endDate)}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">Shift:</span>
            <span class="font-medium capitalize">${shift}</span>
          </div>
        </div>
          </div>
        `,
        icon: 'info',
        showCancelButton: true,
        confirmButtonColor: '#2563eb',
        cancelButtonColor: '#dc2626',
        confirmButtonText: 'Confirm Update',
        cancelButtonText: 'Cancel',
        customClass: {
          popup: 'rounded-lg',
          title: 'text-xl font-medium text-gray-900',
        },
      });

      if (!result.isConfirmed) {
        return;
      }

      const validationResult = await validateUserValidity(userData);

      if (validationResult.success) {
        const updateResult = await UpdateUserActivePeriod({
          userId: Number(userId),
          startDate,
          endDate,
          shift,
        });

        if (updateResult.user) {
          console.log('before toast');
          toast.success(`Validity period updated for ${userName}`, {
            duration: 3000,
            position: 'top-center',
          });

          // Add delay before navigation to show the success toast
          setTimeout(() => {
            router.push('/dashboard/owner/onboarding/onboardedusers');
          }, 1500);
        } else {
          toast.error(updateResult.msg || 'Failed to update validity period');
        }
      } else {
        const errorMessages = Object.entries(validationResult.errors || {})
          .map(([field, errors]) => `${field}: ${errors?.join(', ')}`)
          .join('\n');
        toast.error(errorMessages);
      }
    });
  };

  return (
    <div className="w-full max-w-2xl mx-auto p-4 sm:p-8 bg-white rounded-xl shadow-sm space-y-6 sm:space-y-8">
      <Toaster position="top-right" />

      {/* Header Section with Avatar - Made responsive */}
      <div className="flex flex-col sm:flex-row items-center sm:space-x-6 pb-4 sm:pb-6 border-b border-gray-100">
        <Avatar className="w-20 h-20 sm:w-24 sm:h-24 ring-2 ring-gray-100 mb-4 sm:mb-0">
          <AvatarImage src={userImage ? userImage : defaultImage} alt={userName} />
          <AvatarFallback className="bg-blue-50 text-blue-700 text-xl font-medium">
            {userName
              .split(' ')
              .map((n) => n[0])
              .join('')}
          </AvatarFallback>
        </Avatar>
        <div className="text-center sm:text-left">
          <h2 className="text-xl sm:text-2xl font-semibold text-gray-900">{userName}</h2>
          <p className="text-sm text-gray-500">Membership Details</p>
        </div>
      </div>

      {/* Form Section - Made mobile friendly */}
      <div className="space-y-4 sm:space-y-6">
        {/* Start Date - Modified for mobile */}
        <div className="flex flex-col sm:grid sm:grid-cols-3 items-start sm:items-center gap-2 sm:gap-4">
          <label htmlFor="startDate" className="text-sm font-medium text-gray-700">
            Start Date
          </label>
          <div className="w-full sm:col-span-2">
            <Popover open={startDateOpen} onOpenChange={setStartDateOpen}>
              <PopoverTrigger asChild>
                <Button
                  id="startDate"
                  variant="outline"
                  className="w-full h-12 sm:h-10 justify-start text-left font-normal hover:bg-gray-50 active:scale-[0.98] transition-transform"
                >
                  <CalendarIcon className="mr-2 h-5 w-5 sm:h-4 sm:w-4 text-gray-500" />
                  {format(startDate, 'PPP')}
                </Button>
              </PopoverTrigger>
              <PopoverContent className="w-[calc(100vw-2rem)] sm:w-auto p-0" align="center">
                <Calendar
                  mode="single"
                  selected={startDate}
                  onSelect={(date) => {
                    if (date) {
                      setStartDate(date);
                      setStartDateOpen(false); // Auto close after selection
                    }
                  }}
                  disabled={(date) => date < new Date() || date < new Date('1900-01-01')}
                  initialFocus
                  className="rounded-md border shadow-lg mx-auto"
                  classNames={{
                    months: 'space-y-4 sm:space-y-0',
                    month: 'space-y-4',
                    caption: 'flex justify-center pt-1 relative items-center',
                    caption_label: 'text-sm font-medium',
                    nav: 'space-x-1 flex items-center',
                    table: 'w-full border-collapse space-y-1',
                    head_row: 'flex justify-around',
                    head_cell: 'text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]',
                    row: 'flex w-full justify-around mt-2',
                    cell: 'text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20',
                    day: 'h-9 w-9 p-0 font-normal aria-selected:opacity-100',
                    day_selected:
                      'bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground',
                    day_today: 'bg-accent text-accent-foreground',
                    day_outside: 'text-muted-foreground opacity-50',
                    day_disabled: 'text-muted-foreground opacity-50',
                    day_range_middle:
                      'aria-selected:bg-accent aria-selected:text-accent-foreground',
                    day_hidden: 'invisible',
                  }}
                />
              </PopoverContent>
            </Popover>
          </div>
        </div>

        {/* End Date - Modified for mobile */}
        <div className="flex flex-col sm:grid sm:grid-cols-3 items-start sm:items-center gap-2 sm:gap-4">
          <label htmlFor="endDate" className="text-sm font-medium text-gray-700">
            End Date
          </label>
          <div className="w-full sm:col-span-2">
            <Popover open={endDateOpen} onOpenChange={setEndDateOpen}>
              <PopoverTrigger asChild>
                <Button
                  variant="outline"
                  className="w-full h-12 sm:h-10 justify-start text-left font-normal hover:bg-gray-50 active:scale-[0.98] transition-transform"
                >
                  <CalendarIcon className="mr-2 h-5 w-5 sm:h-4 sm:w-4 text-gray-500" />
                  {format(endDate, 'PPP')}
                </Button>
              </PopoverTrigger>
              <PopoverContent className="w-[calc(100vw-2rem)] sm:w-auto p-0" align="center">
                <Calendar
                  mode="single"
                  selected={endDate}
                  defaultMonth={getDefaultEndMonth()} // Add this line
                  onSelect={(date) => {
                    if (date) {
                      setEndDate(date);
                      setEndDateOpen(false); // Auto close after selection
                    }
                  }}
                  disabled={(date) => date <= startDate || date < new Date('1900-01-01')}
                  initialFocus
                  className="rounded-md border shadow-lg mx-auto"
                  classNames={{
                    months: 'space-y-4 sm:space-y-0',
                    month: 'space-y-4',
                    caption: 'flex justify-center pt-1 relative items-center',
                    caption_label: 'text-sm font-medium',
                    nav: 'space-x-1 flex items-center',
                    table: 'w-full border-collapse space-y-1',
                    head_row: 'flex justify-around',
                    head_cell: 'text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]',
                    row: 'flex w-full justify-around mt-2',
                    cell: 'text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20',
                    day: 'h-9 w-9 p-0 font-normal aria-selected:opacity-100',
                    day_selected:
                      'bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground',
                    day_today: 'bg-accent text-accent-foreground',
                    day_outside: 'text-muted-foreground opacity-50',
                    day_disabled: 'text-muted-foreground opacity-50',
                    day_range_middle:
                      'aria-selected:bg-accent aria-selected:text-accent-foreground',
                    day_hidden: 'invisible',
                  }}
                />
              </PopoverContent>
            </Popover>
          </div>
        </div>

        {/* Shift Selection - Modified for mobile */}
        <div className="flex flex-col sm:grid sm:grid-cols-3 items-start sm:items-center gap-2 sm:gap-4">
          <label htmlFor="shift" className="text-sm font-medium text-gray-700">
            Shift
          </label>
          <div className="w-full sm:col-span-2">
            <Select
              onValueChange={(value: 'morning' | 'evening') => setShift(value)}
              defaultValue={shift}
            >
              <SelectTrigger className="w-full h-12 sm:h-10 hover:bg-gray-50">
                <SelectValue placeholder="Select a shift" />
              </SelectTrigger>
              <SelectContent position="popper" className="w-full">
                <SelectItem value="morning">Morning</SelectItem>
                <SelectItem value="evening">Evening</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>
      </div>

      {/* Submit Button - Made touch-friendly */}
      <div className="pt-4 sm:pt-6">
        <Button
          className="w-full h-12 sm:h-10 bg-blue-600 hover:bg-blue-700 text-white font-medium text-lg sm:text-base 
                     active:scale-[0.98] transition-transform"
          onClick={handleSubmit}
          disabled={isPending}
        >
          {isPending ? (
            <span className="flex items-center justify-center">
              <svg
                aria-label="Loading spinner"
                className="animate-spin -ml-1 mr-3 h-5 w-5 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <title>Loading animation</title>
                <circle
                  className="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  strokeWidth="4"
                />
                <path
                  className="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                />
              </svg>
              Updating...
            </span>
          ) : (
            'Update Membership'
          )}
        </Button>
      </div>
    </div>
  );
}

```

# app/dashboard/owner/onboarding/onboardedusers/actions/api.ts

```ts
import axios from 'axios';

interface OnBordingUser {
  id: number;
  name: string;
  startDate: string | null;
  endDate: string | null;
}

interface OnBordingUserResponse {
  msg: string;
  users: OnBordingUser[];
}

export const fetchOnboardingUsers = async () => {
  try {
    console.log('Fetching onboarding users...');
    const response = await axios.get<OnBordingUserResponse>(
      '/api/owner/onboarding/onbordingusers',
      {
        headers: {
          'Content-Type': 'application/json',
        },
      },
    );

    const data = response.data;
    console.log('Onboarding users response:', data);

    if (!data.users || !Array.isArray(data.users)) {
      console.error('Invalid users data received:', data);
      return { users: [] };
    }

    return data;
  } catch (error) {
    console.error('Error fetching onboarding users:', error);
    throw error; // Let React Query handle the error
  }
};

```

# app/dashboard/owner/onboarding/onboardedusers/actions/GetOnBoardingUser.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

interface OnBordingUser {
  id: number;
  name: string;
  startDate: string | null;
  endDate: string | null;
}

interface OnBordingUserResponse {
  msg: string;
  users: OnBordingUser[];
}

// This is a server action, use it only in Server Components
export const getOnboardingUsersServer = async () => {
  const ownerAxios = await OwnerReqConfig();
  try {
    console.log('Fetching onboarding users (server)...');
    const response: AxiosResponse<OnBordingUserResponse> = await ownerAxios.get(
      '/onboarding/onbordingusers',
    );

    const data = response.data;
    console.log('Onboarding users response (server):', data);

    if (!data.users || !Array.isArray(data.users)) {
      console.error('Invalid users data received:', data);
      return { users: [] };
    }

    return data;
  } catch (error) {
    console.error('Error fetching onboarding users:', error);
    return { users: [] };
  }
};

```

# app/dashboard/owner/onboarding/onboardedusers/actions/mutations.ts

```ts
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
import type { AxiosResponse } from 'axios';

interface UpdateActivePeriodData {
  userId: number;
  startDate: string | null;
  endDate: string | null;
}

interface UpdateActivePeriodResponse {
  msg: string;
  user: {
    id: number;
    name: string;
    startDate: string | null;
    endDate: string | null;
  };
}

export const updateActivePeriod = async (data: UpdateActivePeriodData) => {
  const ownerAxios = await OwnerReqConfig();
  try {
    const response: AxiosResponse<UpdateActivePeriodResponse> = await ownerAxios.patch(
      `/onboarding/users/${data.userId}/activeperiod`,
      {
        startDate: data.startDate,
        endDate: data.endDate,
      },
    );

    return response.data;
  } catch (error) {
    console.error('Error updating active period:', error);
    throw error;
  }
};

```

# app/dashboard/owner/onboarding/onboardedusers/loading.tsx

```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function loading() {
  return (
    <div>
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 pt-6">
        <Skeleton className="h-32" />
        <Skeleton className="h-32" />
        <Skeleton className="h-32" />
      </div>
      <Skeleton className="h-[400px]" />
    </div>
  );
}

```

# app/dashboard/owner/onboarding/onboardedusers/OnbordedUsers.tsx

```tsx
'use client';

import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { useToast } from '@/hooks/use-toast';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, MoreVertical, User, UserCheck, Users } from 'lucide-react';
import { useRouter } from 'next/navigation';
import React from 'react';
import { updateActivePeriod } from './actions/mutations';

interface UserType {
  id: number;
  name: string;
  startDate: Date | null;
  endDate: Date | null;
  status: 'active' | 'pending' | 'inactive';
}

interface OnboardedUsersProps {
  initialUsers: {
    id: number;
    name: string;
    startDate: Date | null;
    endDate: Date | null;
  }[];
}

const calculateStatus = (startDate: Date | null, endDate: Date | null): UserType['status'] => {
  if (!startDate || !endDate) {
    return 'pending';
  }
  // Active status logic - other statuses will be added later
  return 'active';
};

const formatDate = (date: Date | null): string => {
  if (!date) return 'N/A';
  return date.toLocaleDateString('en-GB', {
    day: '2-digit',
    month: '2-digit',
    year: 'numeric',
  });
};

export default function OnboardedUsers({ initialUsers }: OnboardedUsersProps) {
  console.log('OnboardedUsers received initialUsers:', initialUsers);

  const users = initialUsers.map((user) => ({
    ...user,
    status: calculateStatus(user.startDate, user.endDate),
  }));

  const router = useRouter();
  const { toast } = useToast();
  const queryClient = useQueryClient();

  const _updateActivePeriodMutation = useMutation({
    mutationFn: updateActivePeriod,
    onMutate: async ({ userId, startDate, endDate }) => {
      // Cancel any outgoing refetches
      await queryClient.cancelQueries({ queryKey: ['onboardedUsers'] });

      // Snapshot the previous value
      const previousUsers = queryClient.getQueryData(['onboardedUsers']);

      // Optimistically update to the new value
      queryClient.setQueryData(['onboardedUsers'], (old: UserType[] | undefined) => {
        if (!old) return [];
        return old.map((user) => {
          if (user.id === userId) {
            return {
              ...user,
              startDate: startDate ? new Date(startDate) : null,
              endDate: endDate ? new Date(endDate) : null,
              status: calculateStatus(
                startDate ? new Date(startDate) : null,
                endDate ? new Date(endDate) : null,
              ),
            };
          }
          return user;
        });
      });

      // Return a context object with the snapshotted value
      return { previousUsers };
    },
    onError: (_err, _variables, context) => {
      // If the mutation fails, use the context returned from onMutate to roll back
      if (context?.previousUsers) {
        queryClient.setQueryData(['onboardedUsers'], context.previousUsers);
      }
      toast({
        title: 'Error',
        description: 'Failed to update active period. Please try again.',
        variant: 'destructive',
      });
    },
    onSuccess: () => {
      toast({
        title: 'Success',
        description: 'Active period updated successfully.',
      });
    },
    onSettled: () => {
      // Always refetch after error or success to ensure we're up to date
      queryClient.invalidateQueries({ queryKey: ['onboardedUsers'] });
    },
  });

  const handleRowClick = (user: UserType) => {
    const params = new URLSearchParams({
      userid: user.id.toString(),
      username: user.name,
      startdate: user.startDate?.toISOString() || '',
      enddate: user.endDate?.toISOString() || '',
    });
    router.push(`/dashboard/owner/onboarding/editactiveperiod?${params.toString()}`);
  };

  const totalUsers = users.length;
  const activeUsers = users.filter((u) => u.status === 'active').length;
  const pendingUsers = users.filter((u) => u.status === 'pending').length;

  const statusCards = [
    {
      title: 'Total Users',
      value: totalUsers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Active Users',
      value: activeUsers,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Pending Users',
      value: pendingUsers,
      icon: User,
      gradient: 'yellow',
    },
  ] as const;

  const columns: ColumnDef<UserType>[] = [
    {
      accessorKey: 'name',
      header: ({ column }) => (
        <Button
          variant="ghost"
          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
        >
          User Name
          <ArrowUpDown className="ml-2 h-4 w-4" />
        </Button>
      ),
    },
    {
      accessorKey: 'startDate',
      header: 'Start Date',
      cell: ({ row }) => {
        const date = row.getValue('startDate') as Date | null;
        return <div>{formatDate(date)}</div>;
      },
    },
    {
      accessorKey: 'endDate',
      header: 'End Date',
      cell: ({ row }) => {
        const date = row.getValue('endDate') as Date | null;
        return <div>{formatDate(date)}</div>;
      },
    },
    {
      accessorKey: 'status',
      header: 'Status',
      cell: ({ row }) => {
        const status = row.getValue('status') as string;
        return (
          <div
            className={`
            w-fit rounded-full px-4 py-1 text-xs font-semibold text-center
            ${
              status === 'active'
                ? 'bg-green-100 text-green-800'
                : status === 'pending'
                  ? 'bg-yellow-100 text-yellow-800'
                  : 'bg-red-100 text-red-800'
            }
          `}
          >
            {status.charAt(0).toUpperCase() + status.slice(1)}
          </div>
        );
      },
    },
    {
      id: 'actions',
      cell: ({ row }) => {
        return (
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <Button variant="ghost" className="h-8 w-8 p-0">
                <span className="sr-only">Open menu</span>
                <MoreVertical className="h-4 w-4" />
              </Button>
            </DropdownMenuTrigger>
            <DropdownMenuContent align="start" side="right">
              <DropdownMenuItem onClick={() => handleRowClick(row.original)}>
                Edit Active Period
              </DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        );
      },
    },
  ];

  if (users.length === 0) {
    return (
      <div className="container mx-auto p-6 space-y-8">
        <div className="text-center py-12">
          <Users className="mx-auto h-12 w-12 text-gray-400" />
          <h2 className="mt-4 text-lg font-semibold text-gray-900">No Users Found</h2>
          <p className="mt-2 text-sm text-gray-600">
            There are no onboarded users to display at the moment.
          </p>
        </div>
      </div>
    );
  }

  return (
    <div className="container mx-auto p-6 space-y-8 ">
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      <div className="hidden md:block">
        <DataTable data={users} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile UI with added actions */}
      <div className="md:hidden space-y-4">
        <DataCard
          data={users}
          renderCard={(user) => (
            <div className="p-4 space-y-3">
              <div className="flex justify-between items-start">
                <h3 className="font-medium">{user.name}</h3>
                <DropdownMenu>
                  <DropdownMenuTrigger asChild>
                    <Button variant="ghost" className="h-8 w-8 p-0">
                      <MoreVertical className="h-4 w-4" />
                    </Button>
                  </DropdownMenuTrigger>
                  <DropdownMenuContent align="end">
                    <DropdownMenuItem
                      className="cursor-pointer"
                      onClick={() => handleRowClick(user)}
                    >
                      Edit Active Period
                    </DropdownMenuItem>
                  </DropdownMenuContent>
                </DropdownMenu>
              </div>

              <div className="space-y-1">
                <p className="text-sm text-gray-500">
                  Start: {user.startDate ? formatDate(user.startDate) : 'N/A'}
                </p>
                <p className="text-sm text-gray-500">
                  End: {user.endDate ? formatDate(user.endDate) : 'N/A'}
                </p>
              </div>

              <div className="flex justify-between items-center">
                <div
                  className={`
                    rounded-full px-2 py-1 text-xs font-semibold 
                    ${
                      user.status === 'active'
                        ? 'bg-green-100 text-green-800'
                        : user.status === 'pending'
                          ? 'bg-yellow-100 text-yellow-800'
                          : 'bg-red-100 text-red-800'
                    }
                  `}
                >
                  {user.status.charAt(0).toUpperCase() + user.status.slice(1)}
                </div>
              </div>
            </div>
          )}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/owner/onboarding/onboardedusers/page.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { useQuery } from '@tanstack/react-query';
import { RefreshCw } from 'lucide-react';
import OnboardedUsers from './OnbordedUsers';
import { fetchOnboardingUsers } from './actions/api';
import Loading from './loading';

export default function Page() {
  const {
    data: response,
    isLoading,
    error,
    refetch,
  } = useQuery({
    queryKey: ['onboardedUsers'],
    queryFn: fetchOnboardingUsers,
    staleTime: 1000 * 60 * 5, // Consider data fresh for 5 minutes
    refetchOnWindowFocus: true,
    retry: 2, // Retry failed requests up to 2 times
  });

  if (error) {
    console.error('Error in onboarding users page:', error);
    return (
      <div className="container mx-auto p-6 text-center">
        <h2 className="text-2xl font-bold text-red-600">Error loading users</h2>
        <p className="text-gray-600 mt-2 mb-4">There was a problem loading the data</p>
        <Button onClick={() => refetch()} variant="outline" className="gap-2">
          <RefreshCw className="h-4 w-4" />
          Try Again
        </Button>
      </div>
    );
  }

  // Transform the data
  const transformedUsers =
    response?.users?.map((user) => ({
      id: user.id,
      name: user.name,
      startDate: user.startDate ? new Date(user.startDate) : null,
      endDate: user.endDate ? new Date(user.endDate) : null,
    })) ?? [];

  return (
    <>
      <h1 className="text-3xl font-bold text-center pt-4  ">Onboarding Users</h1>
      {isLoading ? <Loading /> : <OnboardedUsers initialUsers={transformedUsers} />}
    </>
  );
}

```

# app/dashboard/owner/onboarding/onboardedusers/types.ts

```ts
import type {
  ColumnDef,
  ColumnFiltersState,
  Row,
  SortingState,
  Table,
} from '@tanstack/react-table';
import type { LucideIcon } from 'lucide-react';

export type EnrollmentStatus = 'active' | 'pending' | 'inactive';

export interface Enrollment {
  id: string;
  userId?: string;
  userName?: string;
  planName?: string;
  startDate: Date;
  endDate: Date;
  status: EnrollmentStatus;
  amount?: number;
}

export interface EnrollmentTableProps {
  enrollments: Enrollment[];
  setEnrollments: (enrollments: Enrollment[]) => void;
}

export interface StatsCardProps {
  title: string;
  value: string | number;
  Icon: LucideIcon;
  gradient: string;
}

export interface TableProps {
  table: Table<Enrollment>;
  row: Row<Enrollment>;
}

export type EnrollmentColumn = ColumnDef<Enrollment>;

export interface TableState {
  sorting: SortingState;
  columnFilters: ColumnFiltersState;
  columnVisibility: Record<string, boolean>;
  rowSelection: Record<string, boolean>;
}

```

# app/dashboard/owner/onboarding/onboardingqr/GetOnBordingQrData.ts

```ts
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';

export async function OnBoadingQrData() {
  const ownerAxios = await OwnerReqConfig();
  try {
    const response = await ownerAxios.get('/onboarding/onboardingqrdata');
    const data = response.data;
    console.log('onboarding qr data is from the onboardingqrdata ', data);
    return data;
  } catch (error) {
    console.error('Error fetching gyms:', error);
    return null;
  }
}

```

# app/dashboard/owner/onboarding/onboardingqr/page.tsx

```tsx
import GymQRCodeOnboarding from '@/components/gym-owner/QrCode';
import { Button } from '@/components/ui/button';
import FetchGymDetailsSA from '../../(common)/GetGymDetails';
import { OnBoadingQrData } from './GetOnBordingQrData';

import Link from 'next/link';
export const dynamic = 'force-dynamic';
export default async function Page() {
  const gymDetails = await FetchGymDetailsSA();

  if (!gymDetails) {
    return (
      <div className="h-screen flex flex-col justify-center items-center gap-6 p-4">
        <div className="text-center space-y-4">
          <h2 className="text-2xl font-bold text-gray-900">No Gym Found</h2>
          <p className="text-gray-600">Please create your gym profile first</p>
        </div>
        <Link href="/ownerdashboard/gymdetails/viewgymdetails">
          <Button variant="default" className="bg-blue-600 hover:bg-blue-700 text-white">
            Create Gym Profile
          </Button>
        </Link>
      </div>
    );
  }

  const { hash, gymname, gymid } = await OnBoadingQrData();
  const QrData = {
    OnboardingAction: {
      hash: hash,
      gymname: gymname,
      gymid: gymid,
    },
  };

  return (
    <div className="h-screen flex justify-center items-center w-full p-4">
      <GymQRCodeOnboarding
        qrdata={JSON.stringify(QrData)}
        title=""
        subtitle="Please scan the QR code to complete your onboarding process"
      />
    </div>
  );
}

```

# app/dashboard/owner/page.tsx

```tsx
import React from 'react';
import DashboardStats from './(common)/components/DashboardStats';
import ErrorScreen from './(common)/components/ErrorScreen';
import { GetDashboardData } from './(common)/components/GetDashboardData';
import SetupScreen from './(common)/components/SetupScreen';
import type { DashboardData, DashboardError } from './(common)/types/types';

type DashboardResponse = DashboardData | DashboardError;

export default async function Page() {
  const dashboardData = await GetDashboardData();

  const isError = (data: DashboardResponse): data is DashboardError => {
    return 'error' in data;
  };

  if (isError(dashboardData) && dashboardData.error === 'NO_GYM_FOUND') {
    return <SetupScreen />;
  }

  if (isError(dashboardData)) {
    return <ErrorScreen error={dashboardData.error} />;
  }

  // Transform the data to match the expected type
  const transformedData = {
    ...dashboardData,
    recentActivities: dashboardData.recentActivities.map((activity) => ({
      ...activity,
      Validperiod: activity.Validperiod || undefined,
    })),
  };

  return <DashboardStats data={transformedData} />;
}

```

# app/dashboard/owner/trainers/userstrainersassignment/AssignTrainerToUsers.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';
interface AssignTrainerResponse {
  msg: string;
  trainer?: {
    name: string;
    id: number;
  };
}
export async function AssignTrainerToUsers(
  userid: string,
  trainerid: string,
): Promise<AssignTrainerResponse> {
  try {
    const ownerAxios = await OwnerReqConfig();
    const response = await ownerAxios.post('/trainer/assigntrainer', {
      userid: Number.parseInt(userid),
      trainerid: Number.parseInt(trainerid),
    });
    console.log('response is from the assign trainer', response.data);
    return response.data;
  } catch (error) {
    console.error('Error assigning trainer:', error);
    throw new Error('Failed to assign trainer');
  }
}

```

# app/dashboard/owner/trainers/userstrainersassignment/GetUserAssociatedwithGym.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';

export const getUsersAssociatedWithGym = async () => {
  const ownerAxios = await OwnerReqConfig();
  try {
    const response = await ownerAxios.get('/trainer/usersassociatiowithgym');
    const data: UserType[] = response.data.users;
    console.log('users  data is from the getUserassociatedWithGym ', data);
    return data;
  } catch (error) {
    console.error('Error fetching trainers:', error);
    return [];
  }
};

```

# app/dashboard/owner/trainers/userstrainersassignment/page.tsx

```tsx
import UserTrainerTable from '@/app/dashboard/owner/trainers/userstrainersassignment/UserTrainerAssignment';
import React from 'react';
import { getTrainerAssociatedWithGym } from '../viewtrainers/GetTrainerAssociatedWithGym';
import { getUsersAssociatedWithGym } from './GetUserAssociatedwithGym';

export default async function page() {
  const Trainers = await getTrainerAssociatedWithGym();
  const Users = await getUsersAssociatedWithGym();
  return (
    <>
      <UserTrainerTable trainers={Trainers} users={Users} />
    </>
  );
}

```

# app/dashboard/owner/trainers/userstrainersassignment/users/[userid]/page.tsx

```tsx
'use client';

import UserprofileImage from '@/app/assests/gymd.webp';
import { Button } from '@/components/ui/button';
import { Calendar as CalendarComponent } from '@/components/ui/calendar';
import { Card, CardContent, CardFooter, CardHeader } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';
import { cn } from '@/lib/utils';
import { format } from 'date-fns';
import { Award, Calendar, MapPin, Phone, TrendingUp } from 'lucide-react';
import Image from 'next/image';
import type React from 'react';
import { useState } from 'react';

// TOOD send data to the backend
export default function UserProfileCard() {
  const [userData, setUserData] = useState({
    name: 'John Doe',
    challengeName: '30-Day Fitness Challenge',
    joinedDate: undefined as Date | undefined,
    completionDate: undefined as Date | undefined,
    contact: '',
    address: '',
  });

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const { name, value } = e.target;
    setUserData((prevData) => ({ ...prevData, [name]: value }));
  };

  const handleDateChange = (date: Date | undefined, field: 'joinedDate' | 'completionDate') => {
    setUserData((prevData) => ({ ...prevData, [field]: date }));
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    console.log('Submitting user data:', userData);
    // Add logic to send data to backend here
    alert('the new alert is triggred after the form submission');
  };

  return (
    <div className="bg-slate-100 flex px-4 py-2 lg:w-full min-h-screen justify-center items-center lg:px-1 lg:py-1">
      <Card className="w-full max-w-md mx-auto">
        <CardHeader className="bg-gradient-to-tr from-blue-600 to-violet-600 text-white p-4">
          <div className="flex items-center">
            <div className="relative w-20 h-20 mr-4">
              <Image
                src={UserprofileImage}
                alt={`${userData.name}'s profile picture`}
                layout="fill"
                objectFit="cover"
                className="rounded-full border-2 border-white"
              />
            </div>
            <div>
              <h2 className="text-2xl font-bold">{userData.name}</h2>
              <p className="text-blue-200 flex items-center text-nowrap text-sm lg:text-base">
                <Award className="w-4 h-4 mr-1 text-yellow-400" />
                {userData.challengeName}
              </p>
            </div>
          </div>
        </CardHeader>
        <form onSubmit={handleSubmit}>
          <CardContent className="p-6 space-y-4">
            <div>
              <Label>Start Date</Label>
              <Popover>
                <PopoverTrigger asChild>
                  <Button
                    variant={'outline'}
                    className={cn(
                      'w-full justify-start text-left font-normal',
                      !userData.joinedDate && 'text-muted-foreground',
                    )}
                  >
                    <Calendar className="mr-2 h-4 w-4" />
                    {userData.joinedDate ? (
                      format(userData.joinedDate, 'PPP')
                    ) : (
                      <span>Pick a date</span>
                    )}
                  </Button>
                </PopoverTrigger>
                <PopoverContent className="w-auto p-0" align="start">
                  <CalendarComponent
                    mode="single"
                    selected={userData.joinedDate}
                    onSelect={(date) => handleDateChange(date, 'joinedDate')}
                    initialFocus
                  />
                </PopoverContent>
              </Popover>
            </div>
            <div>
              <Label>Completion Date</Label>
              <Popover>
                <PopoverTrigger asChild>
                  <Button
                    variant={'outline'}
                    className={cn(
                      'w-full justify-start text-left font-normal',
                      !userData.completionDate && 'text-muted-foreground',
                    )}
                  >
                    <Calendar className="mr-2 h-4 w-4" />
                    {userData.completionDate ? (
                      format(userData.completionDate, 'PPP')
                    ) : (
                      <span>Pick a date</span>
                    )}
                  </Button>
                </PopoverTrigger>
                <PopoverContent className="w-auto p-0" align="start">
                  <CalendarComponent
                    mode="single"
                    selected={userData.completionDate}
                    onSelect={(date) => handleDateChange(date, 'completionDate')}
                    initialFocus
                  />
                </PopoverContent>
              </Popover>
            </div>
            <div>
              <Label>Contact</Label>
              <div className="flex items-center">
                <Phone className="w-4 h-4 mr-2 text-purple-600" />
                <Input
                  id="contact"
                  name="contact"
                  type="tel"
                  value={userData.contact}
                  onChange={handleInputChange}
                  placeholder="Enter your phone number"
                  required
                />
              </div>
            </div>
            <div>
              <Label>Address</Label>
              <div className="flex items-center">
                <MapPin className="w-4 h-4 mr-2 text-red-600" />
                <Input
                  id="address"
                  name="address"
                  type="text"
                  value={userData.address}
                  onChange={handleInputChange}
                  placeholder="Enter your address (optional)"
                />
              </div>
            </div>
          </CardContent>
          <CardFooter>
            <Button type="submit" className="w-full bg-gradient-to-tr from-blue-600 to-violet-600 ">
              Save Profile
              <TrendingUp className="ml-2 w-5 h-5" />
            </Button>
          </CardFooter>
        </form>
      </Card>
    </div>
  );
}

```

# app/dashboard/owner/trainers/userstrainersassignment/UserTrainerAssignment.tsx

```tsx
'use client';

import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import type { ColumnDropdownConfig } from '@/components/Table/table.types';
import { StatusCard } from '@/components/common/StatusCard';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import type { ColumnDef } from '@tanstack/react-table';
import { UserCheck, UserX, Users } from 'lucide-react';
import { useMemo, useState } from 'react';
import { Toaster, toast } from 'react-hot-toast';
import { AssignTrainerToUsers } from './AssignTrainerToUsers';
interface UserTraienerAssignmentProps {
  users: UserType[];
  trainers: TrainerType[];
}

export default function TrainerAssignment({ users, trainers }: UserTraienerAssignmentProps) {
  const [assignedTrainers, setAssignedTrainers] = useState<Record<number, number>>(() => {
    const initialAssignments: Record<number, number> = {};
    for (const user of users) {
      if (user.trainerid) {
        initialAssignments[user.id] = user.trainerid;
      }
    }
    return initialAssignments;
  });

  const handleTrainerAssignment = async (rowId: number | string, trainerId: string) => {
    const userId = typeof rowId === 'string' ? Number.parseInt(rowId) : rowId;
    try {
      await AssignTrainerToUsers(userId.toString(), trainerId);
      setAssignedTrainers((prev) => ({
        ...prev,
        [userId]: Number(trainerId),
      }));
      toast.success('Trainer assigned successfully');
    } catch (error) {
      console.error('Error assigning trainer:', error);
      toast.error('Failed to assign trainer');
    }
  };

  const columns: ColumnDef<UserType>[] = [
    {
      accessorKey: 'name',
      header: 'User Name',
    },
    {
      accessorKey: 'HealthProfile.fullname',
      header: 'Full Name',
    },
    {
      accessorKey: 'HealthProfile.goal',
      header: 'Goal',
      cell: ({ row }) => {
        const goal = row.original.HealthProfile?.goal;
        return <div className="text-gray-600">{goal || 'Not given'}</div>;
      },
    },
    {
      accessorKey: 'trainerid',
      header: 'Assigned Trainer',
      cell: ({ row }) => {
        const currentTrainerId = row.getValue('trainerid') as number | null;
        const hasTrainer = currentTrainerId || assignedTrainers[row.original.id];

        return (
          <div
            className={`w-fit rounded-lg ${
              hasTrainer ? 'bg-green-50/80 border-green-200' : 'bg-red-50/80 border-red-200'
            } border`}
          >
            <Select
              value={
                assignedTrainers[row.original.id]?.toString() || currentTrainerId?.toString() || ''
              }
              onValueChange={(value) => handleTrainerAssignment(row.original.id, value)}
            >
              <SelectTrigger className=" border-none bg-transparent hover:bg-white/50 transition-colors">
                <SelectValue placeholder={hasTrainer ? 'Change Trainer' : 'Assign Trainer'} />
              </SelectTrigger>
              <SelectContent>
                {trainers.map((trainer) => (
                  <SelectItem key={trainer.id} value={trainer.id.toString()}>
                    {trainer.name}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>
        );
      },
    },
  ];

  // Update dropdownConfig to match column cell
  const dropdownConfig: ColumnDropdownConfig = {
    columnId: 'trainerid',
    options: trainers.map((trainer) => ({
      id: trainer.id,
      label: trainer.name,
      value: trainer.id.toString(),
    })),
    onSelect: handleTrainerAssignment,
  };
  const stats = {
    totalUsers: users.length,
    assignedUsers: users.filter((user) => user.trainerid || assignedTrainers[user.id]).length,
    unassignedUsers: users.filter((user) => !user.trainerid && !assignedTrainers[user.id]).length,
  };

  const statusCards = [
    {
      title: 'Total Users',
      value: stats.totalUsers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Assigned Users',
      value: stats.assignedUsers,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Unassigned Users',
      value: stats.unassignedUsers,
      icon: UserX,
      gradient: 'red',
    },
  ] as const;

  // Add new state
  const [searchTerm, setSearchTerm] = useState('');
  const [filterStatus, setFilterStatus] = useState<'all' | 'assigned' | 'unassigned'>('all');

  // Add filtered users logic
  const filteredUsers = useMemo(() => {
    return users.filter((user) => {
      const matchesSearch =
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        user.HealthProfile?.fullname?.toLowerCase().includes(searchTerm.toLowerCase());

      const isAssigned = user.trainerid || assignedTrainers[user.id];

      if (filterStatus === 'assigned') return matchesSearch && isAssigned;
      if (filterStatus === 'unassigned') return matchesSearch && !isAssigned;
      return matchesSearch;
    });
  }, [users, searchTerm, filterStatus, assignedTrainers]);

  // Update return JSX
  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-2xl font-bold text-center">User-Trainer Assignment</h1>

      <Toaster position="top-right" />
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      <div className="flex flex-col md:flex-row gap-4">
        <Input
          placeholder="Search users..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
        <Select
          value={filterStatus}
          onValueChange={(value: 'all' | 'assigned' | 'unassigned') => setFilterStatus(value)}
        >
          <SelectTrigger className="w-[180px]">
            <SelectValue placeholder="Filter by status" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="all">All Users</SelectItem>
            <SelectItem value="assigned">Assigned Users</SelectItem>
            <SelectItem value="unassigned">Unassigned Users</SelectItem>
          </SelectContent>
        </Select>
      </div>

      <div className="hidden md:block">
        <DataTable
          data={filteredUsers}
          columns={columns}
          filterColumn="name"
          dropdownConfig={dropdownConfig}
        />
      </div>

      <div className="md:hidden">
        <DataCard
          data={users}
          dropdownConfig={dropdownConfig}
          renderCard={(user) => {
            const hasTrainer = user.trainerid || assignedTrainers[user.id];

            return (
              <div className="p-4 space-y-3">
                <h3 className="font-medium">{user.name}</h3>
                <p className="text-sm text-gray-500">{user.HealthProfile?.fullname}</p>
                <div
                  className={`rounded-lg ${
                    hasTrainer ? 'bg-green-50/80 border-green-200' : 'bg-red-50/80 border-red-200'
                  } border`}
                >
                  <Select
                    value={assignedTrainers[user.id]?.toString() || user.trainerid?.toString()}
                    onValueChange={(value) => handleTrainerAssignment(user.id, value)}
                  >
                    <SelectTrigger className="w-full border-none bg-transparent hover:bg-white/50 transition-colors">
                      <SelectValue placeholder={hasTrainer ? 'Change Trainer' : 'Assign Trainer'} />
                    </SelectTrigger>
                    <SelectContent>
                      {trainers.map((trainer) => (
                        <SelectItem key={trainer.id} value={trainer.id.toString()}>
                          {trainer.name}
                        </SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                </div>
              </div>
            );
          }}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/owner/trainers/viewtrainers/GetTrainerAssociatedWithGym.ts

```ts
'use server';
import { OwnerReqConfig } from '@/lib/AxiosInstance/ownerAxios';

interface HealthProfile {
  id: number;
  height?: number;
  weight?: number;
  medical_conditions?: string;
  allergies?: string;
  current_medications?: string;
}

// Backend trainer data type
export interface TrainerFromBackend {
  id: number;
  name: string;
  email: string;
  HealthProfile: HealthProfile | null;
  trainer: boolean;
  trainerid: number | null;
  shift?: string;
  assignedUsers?: {
    id: number;
  }[];
}

// Frontend trainer data type (matching viewTrainers.tsx needs)
export interface TrainerForUI {
  id: number;
  name: string;
  assignedClients: number;
  shift: 'Morning' | 'Evening';
  image: string;
}

interface TrainerResponse {
  msg: string;
  trainers: TrainerForUI[];
}

export const getTrainerAssociatedWithGym = async (): Promise<TrainerForUI[]> => {
  const ownerAxios = await OwnerReqConfig();
  try {
    const response = await ownerAxios.get<TrainerResponse>('/trainer/fetchtrainers');
    console.log('response from fetchtrainers:', response.data);
    return response.data.trainers;
  } catch (error) {
    console.error('Error fetching trainers:', error);
    return [];
  }
};

```

# app/dashboard/owner/trainers/viewtrainers/page.tsx

```tsx
import ViewTrainersList from '@/app/dashboard/owner/trainers/viewtrainers/viewTrainers';
import { getTrainerAssociatedWithGym } from './GetTrainerAssociatedWithGym';
export default async function Page() {
  const trainers: TrainerType[] | [] = await getTrainerAssociatedWithGym();

  return (
    <>
      <ViewTrainersList Trainers={trainers} />
    </>
  );
}

```

# app/dashboard/owner/trainers/viewtrainers/viewTrainers.tsx

```tsx
'use client';
import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, Clock, UserCheck, Users } from 'lucide-react';
import React, { useState, useEffect } from 'react';

interface TrainerType {
  id: number;
  name: string;
  assignedClients: number;
  shift: 'Morning' | 'Evening';
  image: string;
}

interface ViewTrainersListProps {
  Trainers: TrainerType[];
}

const columns: ColumnDef<TrainerType>[] = [
  {
    accessorKey: 'name',
    header: ({ column }) => {
      return (
        <Button
          variant="ghost"
          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
        >
          Trainer Name
          <ArrowUpDown className="ml-2 h-4 w-4" />
        </Button>
      );
    },
  },
  {
    accessorKey: 'assignedClients',
    header: 'Assigned Clients',
  },
  {
    accessorKey: 'shift',
    header: 'Shift',
  },
];

export default function ViewTrainersList({ Trainers }: ViewTrainersListProps) {
  const [searchTerm, setSearchTerm] = useState('');
  const [shiftFilter, setShiftFilter] = useState<'Morning' | 'Evening' | 'All'>('All');
  const [filteredTrainers, setFilteredTrainers] = useState<TrainerType[]>(Trainers);

  // Calculate stats
  const totalTrainers = Trainers.length || 0;
  const morningShift = Trainers.filter((t) => t.shift === 'Morning').length;
  const eveningShift = Trainers.filter((t) => t.shift === 'Evening').length;

  const statusCards = [
    {
      title: 'Total Trainers',
      value: totalTrainers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Morning Shift',
      value: morningShift,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Evening Shift',
      value: eveningShift,
      icon: Clock,
      gradient: 'yellow',
    },
  ] as const;

  useEffect(() => {
    const filtered = Trainers.filter(
      (trainer) =>
        trainer.name.toLowerCase().includes(searchTerm.toLowerCase()) &&
        (shiftFilter === 'All' || trainer.shift === shiftFilter),
    );
    setFilteredTrainers(filtered);
  }, [searchTerm, shiftFilter, Trainers]);

  // const handleTrainerClick = (trainer: Trainer) => {
  //   router.push(
  //     `addtrainers?id=${trainer.id}&name=${encodeURIComponent(
  //       trainer.name
  //     )}&shift=${trainer.shift}&image=${trainer.image}`
  //   );
  // };

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-3xl font-bold text-center">Gym Trainers</h1>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      {/* Filters */}
      <div className="flex flex-col md:flex-row gap-4 mb-6">
        <Input
          placeholder="Search trainers..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
        <Select
          value={shiftFilter}
          onValueChange={(value: 'Morning' | 'Evening' | 'All') => setShiftFilter(value)}
        >
          <SelectTrigger className="w-[180px]">
            <SelectValue placeholder="Select shift" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="All">All Shifts</SelectItem>
            <SelectItem value="Morning">Morning</SelectItem>
            <SelectItem value="Evening">Evening</SelectItem>
          </SelectContent>
        </Select>
      </div>

      {/* Desktop View */}
      <div className="hidden md:block">
        <DataTable data={filteredTrainers} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile View */}
      <div className="md:hidden">
        <DataCard
          data={filteredTrainers}
          renderCard={(trainer) => (
            <div className="p-4">
              <h3 className="font-medium">{trainer.name}</h3>
              <p className="text-sm text-gray-500">Assigned Clients: {trainer.assignedClients}</p>
              <p className="text-sm text-gray-500">Shift: {trainer.shift}</p>
            </div>
          )}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/page.tsx

```tsx
import React from 'react';

export default function page() {
  return <div className="hidden">dashboard</div>;
}

```

# app/dashboard/trainer/_components/PageHeader.tsx

```tsx
import React from 'react';

interface PageHeaderProps {
  title: string;
  description?: string;
}

export default function PageHeader({ title, description }: PageHeaderProps) {
  return (
    <div className="space-y-2">
      <h1 className="text-2xl sm:text-3xl font-bold tracking-tight">{title}</h1>
      {description && <p className="text-muted-foreground">{description}</p>}
    </div>
  );
}

```

# app/dashboard/trainer/(common)/components/TrainerStats.tsx

```tsx
import { Card } from '@/components/ui/card';
import { AlertCircle, Building2, Calendar, Dumbbell, Users } from 'lucide-react';
import React from 'react';
import type { TrainerDashboardData } from './types';

interface TrainerStatsProps {
  data: TrainerDashboardData;
}

export default function TrainerStats({ data }: TrainerStatsProps) {
  const { stats, recentActivities } = data;

  // Fallback values for missing data
  const safeStats = {
    totalMembers: stats?.totalMembers ?? 0,
    activeWorkoutPlans: stats?.activeWorkoutPlans ?? 0,
    todayAttendance: stats?.todayAttendance ?? 0,
    gymName: stats?.gymName ?? 'Not Assigned',
  };

  const statCards = [
    {
      label: 'Total Members',
      value: safeStats.totalMembers.toString(),
      icon: Users,
      color: 'text-blue-500',
    },
    {
      label: 'Active Workout Plans',
      value: safeStats.activeWorkoutPlans.toString(),
      icon: Dumbbell,
      color: 'text-green-500',
    },
    {
      label: "Today's Attendance",
      value: safeStats.todayAttendance.toString(),
      icon: Calendar,
      color: 'text-purple-500',
    },
    {
      label: 'Assigned Gym',
      value: safeStats.gymName,
      icon: Building2,
      color: 'text-orange-500',
    },
  ];

  return (
    <div className="p-8 max-w-7xl mx-auto">
      <div className="space-y-8">
        {/* Welcome Header */}
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tight">Welcome back, Trainer</h1>
          <p className="text-gray-500">
            Here&apos;s an overview of your members and activities today.
          </p>
        </div>

        {/* Quick Stats */}
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
          {statCards.map((stat, index) => (
            <Card key={index as number} className="p-6 hover:shadow-lg transition-shadow">
              <div className="flex items-center space-x-4">
                <div className={`p-3 rounded-full bg-gray-100 ${stat.color}`}>
                  <stat.icon className="w-6 h-6" />
                </div>
                <div>
                  <p className="text-sm font-medium text-gray-500">{stat.label}</p>
                  <h3 className="text-2xl font-bold">{stat.value}</h3>
                </div>
              </div>
            </Card>
          ))}
        </div>

        {/* Recent Activity Preview */}
        <Card className="p-6">
          <h2 className="text-xl font-semibold mb-4">Recent Member Activities</h2>
          <div className="space-y-4">
            {recentActivities && recentActivities.length > 0 ? (
              recentActivities.map((activity, index) => (
                <div key={index as number} className="flex items-center space-x-3 text-gray-600">
                  <Users className="w-4 h-4" />
                  <span>
                    {activity.name} -{' '}
                    {activity.Validperiod
                      ? `${activity.Validperiod.shift} shift`
                      : 'New member assigned'}
                  </span>
                </div>
              ))
            ) : (
              <div className="flex items-center space-x-2 text-gray-500">
                <AlertCircle className="w-4 h-4" />
                <span>No recent activities to show</span>
              </div>
            )}
          </div>
        </Card>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/(common)/components/types.ts

```ts
export interface TrainerStats {
  totalMembers: number;
  activeWorkoutPlans: number;
  todayAttendance: number;
  gymName: string;
}

export interface RecentActivity {
  name: string;
  Validperiod: {
    startDate: string;
    shift: string;
  } | null;
}

export interface TrainerDashboardData {
  stats: TrainerStats;
  recentActivities: RecentActivity[];
}

export interface TrainerDashboardError {
  error: string;
  msg?: string;
}

export interface TrainerDashboardResponse {
  msg: string;
  data: TrainerDashboardData;
}

export type TrainerDashboardResult = TrainerDashboardData | TrainerDashboardError;

```

# app/dashboard/trainer/(common)/GetTrainerstats.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import { AxiosError, type AxiosResponse } from 'axios';
import type { TrainerDashboardResponse, TrainerDashboardResult } from './components/types';

export default async function GetTrainerStats(): Promise<TrainerDashboardResult> {
  try {
    const trainerAxios = await TrainerReqConfig();
    const response: AxiosResponse<TrainerDashboardResponse> = await trainerAxios.get(
      '/dashboard/getdashboardstats',
    );

    // Validate response data
    if (!response.data || !response.data.data) {
      return {
        error: 'Invalid response format',
      };
    }

    const { stats, recentActivities } = response.data.data;

    // Validate required fields
    if (
      !stats ||
      typeof stats.totalMembers !== 'number' ||
      typeof stats.activeWorkoutPlans !== 'number' ||
      typeof stats.todayAttendance !== 'number'
    ) {
      return {
        error: 'Missing or invalid stats data',
      };
    }

    // Return validated data with defaults for missing values
    return {
      stats: {
        totalMembers: stats.totalMembers,
        activeWorkoutPlans: stats.activeWorkoutPlans,
        todayAttendance: stats.todayAttendance,
        gymName: stats.gymName || 'Not Assigned',
      },
      recentActivities: Array.isArray(recentActivities)
        ? recentActivities.map((activity) => ({
            name: activity.name || 'Unknown Member',
            Validperiod: activity.Validperiod || null,
          }))
        : [],
    };
  } catch (err) {
    if (err instanceof AxiosError) {
      if (err.response?.status === 404) {
        return {
          error: 'NO_TRAINER_FOUND',
          msg: 'Trainer profile not found or not properly configured.',
        };
      }

      return {
        error: err.response?.data?.msg || 'An error occurred while fetching trainer dashboard data',
      };
    }

    return {
      error: 'An unexpected error occurred',
    };
  }
}

```

# app/dashboard/trainer/assignedusers/AssignedUserToTrainer.tsx

```tsx
'use client';
import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, Search, UserCheck, Users } from 'lucide-react';
import { useEffect, useState } from 'react';
import type { AssignedUser } from './GetuserassignedTotrainers';

interface AssignedUserToTrainerProps {
  users: AssignedUser[];
}

const columns: ColumnDef<AssignedUser>[] = [
  {
    accessorKey: 'name',
    header: ({ column }) => (
      <Button variant="ghost" onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}>
        User Name
        <ArrowUpDown className="ml-2 h-4 w-4" />
      </Button>
    ),
  },
  {
    accessorKey: 'HealthProfile.gender',
    header: 'Gender',
    cell: ({ row }) => {
      const gender = row.original.HealthProfile?.gender;
      return (
        <div className={`text-sm ${gender ? 'text-gray-900' : 'text-gray-500 '}`}>
          {gender || 'Not Updated'}
        </div>
      );
    },
  },
  {
    accessorKey: 'HealthProfile.goal',
    header: 'Goal',
    cell: ({ row }) => {
      const goal = row.original.HealthProfile?.goal;
      return (
        <div className={`text-sm ${goal ? 'text-gray-900' : 'text-gray-500 '}`}>
          {goal || 'Not Updated'}
        </div>
      );
    },
  },
  {
    accessorKey: 'HealthProfile.weight',
    header: 'Weight (kg)',
    cell: ({ row }) => {
      const weight = row.original.HealthProfile?.weight;
      return (
        <div className={`text-sm ${weight ? 'text-gray-900' : 'text-gray-500 '}`}>
          {weight ? `${weight} kg` : 'Not Updated'}
        </div>
      );
    },
  },
  {
    accessorKey: 'HealthProfile.height',
    header: 'Height (cm)',
    cell: ({ row }) => {
      const height = row.original.HealthProfile?.height;
      return (
        <div className={`text-sm ${height ? 'text-gray-900' : 'text-gray-500 '}`}>
          {height ? `${height} cm` : 'Not Updated'}
        </div>
      );
    },
  },
];

export default function AssignedUserToTrainer({ users }: AssignedUserToTrainerProps) {
  const [searchTerm, setSearchTerm] = useState('');
  const [filteredUsers, setFilteredUsers] = useState<AssignedUser[]>(users);

  // Calculate stats
  const totalUsers = users.length;
  const activeUsers = users.filter((u) => u.membershipStatus === 'active').length;
  const inactiveUsers = totalUsers - activeUsers;

  const statusCards = [
    {
      title: 'Total Assigned Users',
      value: totalUsers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Active Users',
      value: activeUsers,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Inactive Users',
      value: inactiveUsers,
      icon: Users,
      gradient: 'red',
    },
  ] as const;

  useEffect(() => {
    const filtered = users.filter(
      (user) =>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        user.email.toLowerCase().includes(searchTerm.toLowerCase()),
    );
    setFilteredUsers(filtered);
  }, [searchTerm, users]);

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-2xl font-bold text-center">Assigned Users</h1>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      {/* Search */}
      <div className="flex items-center space-x-2 mb-6">
        <Search className="w-5 h-5 text-gray-400" />
        <Input
          placeholder="Search users..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
      </div>

      {/* Desktop View */}
      <div className="hidden md:block">
        <DataTable data={filteredUsers} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile View */}
      <div className="md:hidden">
        <DataCard
          data={filteredUsers}
          renderCard={(user) => (
            <div className="p-4 space-y-2">
              <h3 className="font-medium">{user.name}</h3>
              <p className="text-sm text-gray-500">{user.email}</p>

              <div className="grid grid-cols-2 gap-2 mt-2">
                <p className="text-sm">
                  <span className="text-gray-600">Gender: </span>
                  <span className={user.HealthProfile?.gender ? 'text-gray-900' : 'text-gray-500 '}>
                    {user.HealthProfile?.gender || 'Not Updated'}
                  </span>
                </p>
                <p className="text-sm">
                  <span className="text-gray-600">Goal: </span>
                  <span className={user.HealthProfile?.goal ? 'text-gray-900' : 'text-gray-500 '}>
                    {user.HealthProfile?.goal || 'Not Updated'}
                  </span>
                </p>
                <p className="text-sm">
                  <span className="text-gray-600">Weight: </span>
                  <span className={user.HealthProfile?.weight ? 'text-gray-900' : 'text-gray-500 '}>
                    {user.HealthProfile?.weight ? `${user.HealthProfile.weight} kg` : 'Not Updated'}
                  </span>
                </p>
                <p className="text-sm">
                  <span className="text-gray-600">Height: </span>
                  <span className={user.HealthProfile?.height ? 'text-gray-900' : 'text-gray-500 '}>
                    {user.HealthProfile?.height ? `${user.HealthProfile.height} cm` : 'Not Updated'}
                  </span>
                </p>
              </div>

              <div
                className={`inline-block px-2 py-1 rounded-full text-sm ${
                  user.membershipStatus === 'active'
                    ? 'bg-green-100 text-green-800'
                    : 'bg-red-100 text-red-800'
                }`}
              >
                {user.membershipStatus}
              </div>
            </div>
          )}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/assignedusers/GetuserassignedTotrainers.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export interface AssignedUser {
  id: string;
  name: string;
  email: string;
  membershipStatus: 'active' | 'inactive';
  HealthProfile: {
    weight: number;
    height: number;
    goal: string | null;
    gender: string;
  } | null;
}

export const getUsersAssignedToTrainer = async (): Promise<AssignedUser[]> => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get('/client/assignedusers');
    console.log('response.data from the getUsersAssignedToTrainer', response.data); // Add this line
    if (response.data.msg === 'success' && Array.isArray(response.data.users)) {
      return response.data.users;
    }
    return [];
  } catch (error) {
    console.error('Error fetching assigned users:', error);
    return [];
  }
};

```

# app/dashboard/trainer/assignedusers/Getworkout.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export interface Exercise {
  id: number;
  name: string;
  sets: number;
  reps: string;
  description: string;
  order: number;
}

export interface WorkoutSchedule {
  id: number;
  dayOfWeek: string;
  muscleTarget: string;
  duration: number;
  calories: number;
  exercises: Exercise[];
}

export interface WorkoutPlan {
  id: number;
  name: string;
  description: string | null;
  schedules: WorkoutSchedule[];
}

export const getAllWorkoutPlans = async () => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get('/workouts/allworkoutplans');
    const data = response.data;

    if (data.msg === 'success') {
      return {
        success: true,
        workoutPlans: data.workoutPlans as WorkoutPlan[],
      };
    }
    return {
      success: false,
      workoutPlans: [],
    };
  } catch (error) {
    console.error('Error fetching workout plans:', error);
    return {
      success: false,
      workoutPlans: [],
      error: 'Failed to fetch workout plans',
    };
  }
};

```

# app/dashboard/trainer/assignedusers/page.tsx

```tsx
import { Suspense } from 'react';
import AssignedUserToTrainer from './AssignedUserToTrainer';
import { getUsersAssignedToTrainer } from './GetuserassignedTotrainers';

export default async function AssignedUsersPage() {
  const users = await getUsersAssignedToTrainer();

  return (
    <div className="min-h-screen bg-gray-50">
      <Suspense fallback={<div>Loading...</div>}>
        <AssignedUserToTrainer users={users} />
      </Suspense>
    </div>
  );
}

```

# app/dashboard/trainer/attendance/showqr/GetAttendanceQrData.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { AxiosResponse } from 'axios';

interface responseType {
  gymname: string;
  gymid: number;
}

export const GetAttendanceQrData = async () => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response: AxiosResponse<responseType> = await trainerAxios.get(
      '/attendance/attendanceqrdata',
    );
    console.log('response from the attendance', response.data);
    return {
      gymname: response.data.gymname,
      gymid: response.data.gymid,
    };
  } catch (error) {
    console.log('Error:', error);
    return null;
  }
};

```

# app/dashboard/trainer/attendance/showqr/page.tsx

```tsx
import GymQRCode from '@/app/dashboard/owner/attendance/showqr/QrCode';
import React from 'react';
import { GetAttendanceQrData } from './GetAttendanceQrData';

export default async function ShowQRPage() {
  const gymData = await GetAttendanceQrData();

  if (!gymData) {
    return <div>Unable to load gym data</div>;
  }

  const qrValue = JSON.stringify({
    AttendanceAction: {
      gymname: gymData.gymname,
      gymid: gymData.gymid,
      timestamp: new Date().setMinutes(0, 0, 0),
    },
  });

  return (
    <div className="min-h-screen flex flex-col items-center justify-center p-4">
      <GymQRCode
        qrdata={qrValue}
        title="Today's Attendance"
        subtitle="Scan this QR code to mark your attendance"
      />
    </div>
  );
}

```

# app/dashboard/trainer/attendance/todaysattendance/getTodayAttendance.ts

```ts
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

interface AttendanceUser {
  id: number;
  name: string;
  isPresent: boolean;
  trainerid: number | null;
  shift: 'MORNING' | 'EVENING';
  attendanceTime: string | null;
}

interface TodayAttendanceResponse {
  msg: string;
  users: AttendanceUser[];
}

const TodayAttendance = async (): Promise<TodayAttendanceResponse> => {
  try {
    const trainerAxios = await TrainerReqConfig();
    const response = await trainerAxios.get<TodayAttendanceResponse>(
      '/attendance/todaysattendance',
    );
    console.log("Today's attendance data:", response.data);
    return response.data;
  } catch (error) {
    console.error("Error fetching today's attendance:", error);
    return {
      msg: 'Failed to fetch attendance data',
      users: [],
    };
  }
};

export { TodayAttendance, type AttendanceUser };

```

# app/dashboard/trainer/attendance/todaysattendance/page.tsx

```tsx
export const dynamic = 'force-dynamic';
import React from 'react';
import UserAttendance from './UserAttendance';
import { TodayAttendance } from './getTodayAttendance';

const formatShift = (shift: 'MORNING' | 'EVENING'): 'Morning' | 'Evening' => {
  return shift === 'MORNING' ? 'Morning' : 'Evening';
};

export default async function AttendancePage() {
  const attendanceData = await TodayAttendance();

  if (!attendanceData.users) {
    return <div>Failed to load attendance data</div>;
  }

  const formattedUsers = attendanceData.users.map((user) => ({
    id: user.id,
    name: user.name,
    shift: formatShift(user.shift),
    todaysAttendance: user.isPresent,
    attendanceTime: user.attendanceTime,
  }));

  return <UserAttendance initialUsers={formattedUsers} />;
}

```

# app/dashboard/trainer/attendance/todaysattendance/UserAttendance.tsx

```tsx
'use client';

import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, UserCheck, UserX, Users } from 'lucide-react';
import { useEffect, useState } from 'react';

interface AttendanceUser {
  id: number;
  name: string;
  shift: 'Morning' | 'Evening';
  todaysAttendance: boolean;
  attendanceTime: string | null;
}

interface UserAttendanceProps {
  initialUsers: AttendanceUser[];
}

const columns: ColumnDef<AttendanceUser>[] = [
  {
    accessorKey: 'name',
    header: ({ column }) => (
      <Button variant="ghost" onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}>
        User Name
        <ArrowUpDown className="ml-2 h-4 w-4" />
      </Button>
    ),
    cell: ({ row }) => {
      return <div className="ml-4">{row.getValue('name')}</div>;
    },
  },
  {
    accessorKey: 'attendanceTime',
    header: ({ column }) => (
      <Button variant="ghost" onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}>
        Time
        <ArrowUpDown className="ml-2 h-4 w-4" />
      </Button>
    ),
    cell: ({ row }) => {
      const time = row.getValue('attendanceTime') as string | null;
      if (!time) return <div className="flex ml-4">- -</div>;
      try {
        // Parse the UTC time and convert to IST
        const utcDate = new Date(time);
        if (Number.isNaN(utcDate.getTime())) return '-';

        // Using explicit IST timezone for conversion
        return (
          <div className="ml-4 ">
            {utcDate
              .toLocaleTimeString('en-IN', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true,
                timeZone: 'Asia/Kolkata',
              })
              .toUpperCase()}
          </div>
        );
      } catch (error) {
        console.error('Error formatting time:', error);
        return <div className="">-</div>;
      }
    },
  },
  {
    accessorKey: 'shift',
    header: 'Shift',
    cell: ({ row }) => {
      const shift = row.getValue('shift') as string;
      return <div className="">{shift}</div>;
    },
  },
  {
    accessorKey: 'todaysAttendance',
    header: 'Attendance',
    cell: ({ row }) => {
      const attendance = row.getValue('todaysAttendance') as boolean;
      return (
        <div className={`font-medium ${attendance ? 'text-green-600' : 'text-red-600'}`}>
          {attendance ? 'Present' : 'Absent'}
        </div>
      );
    },
  },
];

export default function UserAttendance({ initialUsers }: UserAttendanceProps) {
  const [users] = useState<AttendanceUser[]>(initialUsers);
  const [searchTerm, setSearchTerm] = useState('');
  const [shiftFilter, setShiftFilter] = useState<'Morning' | 'Evening' | 'All'>('All');
  const [filteredUsers, setFilteredUsers] = useState<AttendanceUser[]>(initialUsers);

  // Calculate stats
  const totalUsers = users.length;
  const presentUsers = users.filter((user) => user.todaysAttendance).length;
  const absentUsers = totalUsers - presentUsers;

  const statusCards = [
    {
      title: 'Total Users',
      value: totalUsers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Present Today',
      value: presentUsers,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Absent Today',
      value: absentUsers,
      icon: UserX,
      gradient: 'red',
    },
  ] as const;

  useEffect(() => {
    const filtered = users.filter(
      (user) =>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) &&
        (shiftFilter === 'All' || user.shift === shiftFilter),
    );
    setFilteredUsers(filtered);
  }, [searchTerm, shiftFilter, users]);

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-2xl font-bold text-center">Today&apos;s Attendance</h1>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      {/* Filters */}
      <div className="flex flex-col md:flex-row gap-4 mb-6">
        <Input
          placeholder="Search users..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
        <Select
          value={shiftFilter}
          onValueChange={(value: 'Morning' | 'Evening' | 'All') => setShiftFilter(value)}
        >
          <SelectTrigger className="w-[180px]">
            <SelectValue placeholder="Select shift" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="All">All Shifts</SelectItem>
            <SelectItem value="Morning">Morning</SelectItem>
            <SelectItem value="Evening">Evening</SelectItem>
          </SelectContent>
        </Select>
      </div>

      {/* Desktop View */}
      <div className="hidden md:block">
        <DataTable data={filteredUsers} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile View */}
      <div className="md:hidden">
        <DataCard
          data={filteredUsers}
          renderCard={(user) => (
            <div className="p-4 space-y-1">
              <h3 className="font-medium">{user.name}</h3>
              <p className="text-sm text-gray-500">Shift: {user.shift}</p>
              <p
                className={`text-sm font-medium ${
                  user.todaysAttendance ? 'text-green-600' : 'text-red-600'
                }`}
              >
                Status: {user.todaysAttendance ? 'Present' : 'Absent'}
              </p>
            </div>
          )}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/_actions /AttachDietPlanToUser.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

interface DietPlanResponse {
  id: number;
  name: string;
  // Add other diet plan fields as needed
}

interface AttachDietPlanResponse {
  success: boolean;
  message: string;
  dietPlan?: DietPlanResponse;
}

export const attachDietPlanToUser = async (
  userId: string,
  dietPlanId: string,
): Promise<AttachDietPlanResponse> => {
  const trainerAxios = await TrainerReqConfig();
  console.log('dietplan id is , userid is recievd from the client', dietPlanId, userId);
  try {
    const response = await trainerAxios.post('/diet/upsertdietplan', {
      userId: Number.parseInt(userId),
      dietPlanId: Number.parseInt(dietPlanId),
    });

    return {
      success: response.data.msg === 'Diet plan assigned successfully',
      message: response.data.msg,
      dietPlan: response.data.dietPlan?.dietPlan,
    };
  } catch (error) {
    console.error('Error assigning diet plan:', error);
    return {
      success: false,
      message: 'Failed to assign diet plan',
    };
  }
};

```

# app/dashboard/trainer/diet/assigndietplan/_actions /GetallDiets.ts

```ts
import { TrainerReqConfig } from "@/lib/AxiosInstance/trainerAxios";

export interface DietPlan {
  id: number;
  name: string;
  description?: string;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  meals: {
    id: number;
    name: string;
    timeOfDay: string;
    calories: number;
    protein: number;
    carbs: number;
    fats: number;
    instructions: string;
  }[];
}

export const getAllDietPlans = async () => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get("/diet/alldietplans");
    console.log("response.data.dietPlans", response.data.dietPlans);
    const data = response.data;

    if (data.msg === "success") {
      return data.dietPlans as DietPlan[];
    }
    return [];
  } catch (error) {
    console.error("Error fetching diet plans:", error);
    return [];
  }
};

```

# app/dashboard/trainer/diet/assigndietplan/_actions /GetassignedUserDietInfo.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export interface AssignedUser {
  id: string;
  name: string;
  email: string;
  membershipStatus: string;
  HealthProfile?: {
    weight: number;
    height: number;
    goal: string | null;
    gender: string;
  } | null;
  dietPlanId?: number | null;
  dietPlanName?: string | null;
  dietPlanCompliance?: number;
  userDietPlanId?: number | null;
}

interface ApiUserResponse {
  id: string;
  name: string;
  email: string;
  HealthProfile?: {
    weight: number;
    height: number;
    goal: string | null;
    gender: string;
  } | null;
  dietPlanId?: number | null;
  dietPlanName?: string | null;
  dietPlanCompliance?: number;
  userDietPlanId?: number | null;
}

export const getUsersAssignedToTrainer = async (): Promise<AssignedUser[]> => {
  const trainerAxios = await TrainerReqConfig();
  try {
    console.log('getuserassignedwithtodietplans is called');
    const response = await trainerAxios.get('/client/assignedusers');
    if (response.data.msg === 'success') {
      console.log('response.data.users', response.data.users);
      // Transform the data to ensure all fields are present even if null
      console.log('user id of the user is ', response.data.users[0].id);
      return response.data.users.map((user: ApiUserResponse) => ({
        id: user.id,
        name: user.name,
        email: user.email,
        membershipStatus: 'active',
        HealthProfile: user.HealthProfile || null,
        dietPlanId: user.dietPlanId || null,
        dietPlanName: user.dietPlanName || null,
        dietPlanCompliance: user.dietPlanCompliance || 0,
        userDietPlanId: user.userDietPlanId || null,
      }));
    }
    return [];
  } catch (error) {
    console.error('Error fetching assigned users with diet plans:', error);
    return [];
  }
};

```

# app/dashboard/trainer/diet/assigndietplan/_components/AssignDietToUsers.tsx

```tsx
'use client';
import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, Search, UserCheck, Users, UtensilsCrossed } from 'lucide-react';
import Link from 'next/link';
import React, { useState, useEffect, useMemo, useCallback } from 'react';
import { toast } from 'sonner';
import { attachDietPlanToUser } from '../_actions /AttachDietPlanToUser';
import type { DietPlan } from '../_actions /GetallDiets';
import type { AssignedUser } from '../_actions /GetassignedUserDietInfo';
import { updateAssignedDietPlan } from './updateassigneddiet';
import type { UpdateDietPlanResponse } from './updateassigneddiet';

interface Props {
  users: AssignedUser[];
  dietPlans: DietPlan[];
}

// Add interface for the common result type
interface DietAssignmentResult {
  success: boolean;
  message: string;
  dietPlan?: {
    id: number;
    name: string;
  };
}

const createColumns = (
  dietPlans: DietPlan[],
  handleAssignment: (userId: string, dietPlanId: string, currentPlanId?: number) => Promise<void>,
): ColumnDef<AssignedUser>[] => [
  {
    accessorKey: 'name',
    header: ({ column }) => (
      <Button variant="ghost" onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}>
        User Name
        <ArrowUpDown className="ml-2 h-4 w-4" />
      </Button>
    ),
  },
  {
    accessorKey: 'email',
    header: 'Email',
  },
  {
    accessorKey: 'diet',
    header: 'Diet Plan Management',
    cell: ({ row }) => {
      const hasDiet = !!row.original.dietPlanId;
      const currentPlan = dietPlans.find((plan) => plan.id === row.original.dietPlanId);

      return (
        <div className="flex flex-col gap-2">
          <Select
            defaultValue={currentPlan ? currentPlan.id.toString() : undefined}
            onValueChange={(value) => {
              handleAssignment(row.original.id, value, row.original.dietPlanId || undefined);
            }}
          >
            <SelectTrigger
              className={`w-[200px] ${
                hasDiet ? 'bg-green-50 border-green-200 text-green-700' : 'bg-red-50 border-red-200'
              }`}
            >
              <SelectValue placeholder="Select a diet plan" />
            </SelectTrigger>
            <SelectContent>
              {dietPlans.map((plan) => (
                <SelectItem
                  key={plan.id}
                  value={plan.id.toString()}
                  className={currentPlan?.id === plan.id ? 'bg-green-50 text-green-700' : ''}
                >
                  {plan.name} ({plan.targetCalories} cal)
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
          <Link
            href={`/dashboard/trainer/diet/assigndietplan/assigndietplanwithai?userId=${row.original.id}`}
            className="flex items-center justify-center w-[200px] bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors text-sm font-medium"
          >
            Generate Diet Plan with AI
          </Link>
        </div>
      );
    },
  },
];

export default function AssignDietToUsers({ users, dietPlans }: Props) {
  const [searchTerm, setSearchTerm] = useState('');
  const [filteredUsers, setFilteredUsers] = useState(users);

  // Calculate stats
  const totalUsers = users.length;
  const usersWithDiet = users.filter((u) => u.dietPlanId).length;
  const usersWithoutDiet = totalUsers - usersWithDiet;

  const statusCards = [
    {
      title: 'Total Users',
      value: totalUsers,
      icon: Users,
      gradient: 'blue',
    },
    {
      title: 'Users with Diet Plan',
      value: usersWithDiet,
      icon: UserCheck,
      gradient: 'green',
    },
    {
      title: 'Users without Diet Plan',
      value: usersWithoutDiet,
      icon: UtensilsCrossed,
      gradient: 'red',
    },
  ] as const;

  const handleDietAssignment = useCallback(
    async (userId: string, dietPlanId: string, currentUserDietPlanId?: number) => {
      try {
        let result: DietAssignmentResult;

        if (currentUserDietPlanId) {
          const updateResult = await updateAssignedDietPlan({
            userDietPlanId: currentUserDietPlanId,
            newDietPlanId: Number.parseInt(dietPlanId),
            userId: Number.parseInt(userId),
          });
          result = {
            success: updateResult.success,
            message: updateResult.message,
            dietPlan: updateResult.dietPlan,
          };
        } else {
          const attachResult = await attachDietPlanToUser(userId, dietPlanId);
          result = {
            success: attachResult.success,
            message: attachResult.message,
            dietPlan: attachResult.dietPlan,
          };
        }

        if (result.success) {
          toast.success(result.message);
          setFilteredUsers((prev) =>
            prev.map((user) =>
              user.id === userId
                ? {
                    ...user,
                    dietPlanId: Number.parseInt(dietPlanId),
                    dietPlanName: dietPlans.find((p) => p.id === Number.parseInt(dietPlanId))?.name,
                    userDietPlanId: result.dietPlan?.id,
                  }
                : user,
            ),
          );
        } else {
          toast.error(result.message || 'Failed to update diet plan');
        }
      } catch (error) {
        console.error('Error managing diet plan:', error);
        toast.error('Error managing diet plan');
      }
    },
    [dietPlans],
  );

  const columns = useMemo(
    () => createColumns(dietPlans, handleDietAssignment),
    [dietPlans, handleDietAssignment],
  );

  useEffect(() => {
    const filtered = users.filter(
      (user) =>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        user.email.toLowerCase().includes(searchTerm.toLowerCase()),
    );
    setFilteredUsers(filtered);
  }, [searchTerm, users]);

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-2xl font-bold text-center">Diet Plan Assignment</h1>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        {statusCards.map((card) => (
          <StatusCard key={card.title} {...card} />
        ))}
      </div>

      {/* Search */}
      <div className="flex items-center space-x-2 mb-6">
        <Search className="w-5 h-5 text-gray-400" />
        <Input
          placeholder="Search users..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
      </div>

      {/* Desktop View */}
      <div className="hidden md:block">
        <DataTable data={filteredUsers} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile View */}
      <div className="md:hidden">
        <DataCard
          data={filteredUsers}
          renderCard={(user) => {
            const hasDiet = !!user.dietPlanId;
            const currentPlan = dietPlans.find((p) => p.id === user.dietPlanId);

            return (
              <div className="p-4 space-y-2">
                <h3 className="font-medium">{user.name}</h3>
                <p className="text-sm text-gray-500">{user.email}</p>
                <Select onValueChange={(value) => handleDietAssignment(user.id, value)}>
                  <SelectTrigger
                    className={`w-full mt-2 ${
                      hasDiet ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'
                    }`}
                  >
                    <SelectValue
                      placeholder={hasDiet ? 'Change Diet Plan' : 'No diet plan assigned'}
                    />
                  </SelectTrigger>
                  <SelectContent>
                    {dietPlans.map((plan) => (
                      <SelectItem key={plan.id} value={plan.id.toString()}>
                        {plan.name} ({plan.targetCalories} cal)
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
                <Link
                  href={`/dashboard/trainer/diet/assigndietplan/assigndietplanwithai?userId=${user.id}`}
                  className="flex items-center justify-center w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors text-sm font-medium"
                >
                  Generate Diet Plan with AI
                </Link>
                {hasDiet && (
                  <div className="mt-2 text-xs text-green-600">
                    Current Plan: {currentPlan?.name}
                  </div>
                )}
              </div>
            );
          }}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/_components/updateassigneddiet.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

interface UpdateDietPlanInput {
  userDietPlanId: number;
  newDietPlanId: number;
  userId: number; // Add userId to the interface
}

interface DietPlanResponse {
  id: number;
  name: string;
  // Add other diet plan fields as needed
}

export interface UpdateDietPlanResponse {
  success: boolean;
  message: string;
  dietPlan?: DietPlanResponse;
}

export const updateAssignedDietPlan = async (
  data: UpdateDietPlanInput,
): Promise<UpdateDietPlanResponse> => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.post('/updateassigneddietplan', data);

    return {
      success: response.data.msg === 'Diet plan updated successfully',
      message: response.data.msg,
      dietPlan: response.data.updatedPlan?.dietPlan,
    };
  } catch (error) {
    console.error('Error updating diet plan:', error);
    return {
      success: false,
      message: 'Failed to update diet plan',
    };
  }
};

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_actions/generate-ai-diet.ts

```ts
'use server';

import { generateStructuredContent, validateResponseWithSchema } from '@/lib/AI';
import { generateDietPrompt } from '@/lib/AI/prompts/diet-prompts';
import { DietPlanSchema } from '@/lib/AI/types/diet-types';
import type { z } from 'zod';
import type { DietPlan } from '../../_actions /GetallDiets';
import { type DietGenerationParams, dietGenerationSchema } from '../types/dietGenerationSchema';

/**
 * Custom validation function to ensure successful parsing of diet plans
 */
function validateDietPlanResponse(response: string) {
  try {
    // First, try to extract JSON from the response
    let jsonData: Record<string, unknown> | null = null;

    // Try parsing directly first
    try {
      jsonData = JSON.parse(response);
    } catch (_e) {
      // Try extracting from code blocks if direct parsing fails
      const codeBlockMatch = response.match(/\`\`\`(?:json)?\s*([\s\S]*?)\s*\`\`\`/);
      if (codeBlockMatch?.[1]) {
        jsonData = JSON.parse(codeBlockMatch[1]);
      } else {
        // Try finding a JSON object pattern
        const jsonMatch = response.match(/{[\s\S]*}/);
        if (jsonMatch) {
          jsonData = JSON.parse(jsonMatch[0]);
        }
      }
    }

    if (!jsonData) {
      return { valid: false, errors: 'No valid JSON found in response' };
    }

    // Now validate against the schema
    const result = DietPlanSchema.safeParse(jsonData);

    if (result.success) {
      return { valid: true, data: result.data };
    }

    return { valid: false, errors: result.error };
  } catch (error) {
    console.error('Diet plan validation error:', error);
    return { valid: false, errors: error };
  }
}

/**
 * Generates a personalized diet plan using AI based on user parameters
 */
export async function generateAIDiet(params: DietGenerationParams): Promise<DietPlan> {
  try {
    // Validate input parameters
    const validatedParams = dietGenerationSchema.parse(params);

    // Generate prompt for AI
    const prompt = generateDietPrompt(validatedParams);

    // Generate structured response using AI - similar to workout implementation
    const response = await generateStructuredContent<z.infer<typeof DietPlanSchema>>(
      prompt,
      validateDietPlanResponse, // Use our custom validation function
      {
        provider: 'gemini', // Use Gemini as the AI provider
        temperature: 0.7, // Add some creativity
        maxAttempts: 3, // Try up to 3 times
      },
    );

    if (!response || !response.success || !response.data) {
      console.error('Failed to generate diet plan - no valid response');
      throw new Error('Failed to generate diet plan');
    }

    // Transform the result to match our interface
    const aiGeneratedDiet = response.data;
    const dietPlan: DietPlan = {
      id: -1, // Temporary ID that will be replaced when saved to database
      name: aiGeneratedDiet.name,
      description: aiGeneratedDiet.description,
      targetCalories: aiGeneratedDiet.targetCalories,
      proteinRatio: aiGeneratedDiet.proteinRatio,
      carbsRatio: aiGeneratedDiet.carbsRatio,
      fatsRatio: aiGeneratedDiet.fatsRatio,
      meals: aiGeneratedDiet.meals.map((meal, index) => ({
        ...meal,
        id: meal.id || index + 1, // Use existing ID or generate one based on index
      })),
    };

    return dietPlan;
  } catch (error) {
    console.error('Error generating diet plan:', error);
    throw error;
  }
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_actions/get-customdiets.ts

```ts
"use server";

import { TrainerReqConfig } from "@/lib/AxiosInstance/trainerAxios";

// Match the DietPlan type from GetallDiets.ts
export interface DietPlan {
	id: number;
	name: string;
	description?: string;
	targetCalories: number;
	proteinRatio: number;
	carbsRatio: number;
	fatsRatio: number;
	meals: {
		id: number;
		name: string;
		timeOfDay: string;
		calories: number;
		protein: number;
		carbs: number;
		fats: number;
		instructions: string;
		ingredients?: Array<{
			name: string;
			quantity?: string;
		}>;
	}[];
	createdAt?: string;
	updatedAt?: string;
}

export interface CustomDietPlansResponse {
	success: boolean;
	msg: string;
	dietPlans: DietPlan[];
	error?: string;
}

export async function getCustomDietPlans(): Promise<DietPlan[]> {
	try {
		const trainerAxios = await TrainerReqConfig();
		const response =
			await trainerAxios.get<CustomDietPlansResponse>("/diet/alldietplans");

		if (response.data.success && Array.isArray(response.data.dietPlans)) {
			return response.data.dietPlans.map((plan) => {
				// Transform the data to ensure type compatibility
				return {
					...plan,
					// Ensure id is a number
					id: typeof plan.id === "string" ? Number.parseInt(plan.id, 10) : plan.id,
					// Ensure description is string | undefined (not null)
					description: plan.description === null ? undefined : plan.description,
					// Ensure createdAt exists for sorting purposes
					createdAt: plan.createdAt || new Date().toISOString(),
					// Process meals to ensure compatibility
					meals: plan.meals.map(meal => ({
						...meal,
						// Ensure id is a number and not undefined
						id: meal.id ?? 0, // Provide a default id if missing
						// Ensure instructions is a string (not null)
						instructions: meal.instructions || ""
					}))
				};
			});
		}

		console.error("Failed to fetch custom diet plans:", response.data.msg);
		return [];
	} catch (error) {
		console.error("Error fetching custom diet plans:", error);
		return [];
	}
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_actions/get-diet-history.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { DietPlan } from '../../_actions /GetallDiets';
import type { DietHistoryItem } from '../_store/diet-view-store';

// Response type from the getcustomdietplans endpoint
interface CustomDietPlansResponse {
  success: boolean;
  msg: string;
  dietPlans?: (DietPlan & { createdAt?: string; updatedAt?: string })[];
  error?: string;
}

export async function getDietHistory(
  userId: string,
): Promise<{ success: boolean; data?: DietHistoryItem[]; message?: string }> {
  try {
    const trainerAxios = await TrainerReqConfig();

    // Call the getcustomdietplans endpoint instead of /diet/history/{userId}
    const response = await trainerAxios.get('/diet/getcustomdietplans');
    const data = response.data as CustomDietPlansResponse;
    console.log("Response from getcustomdietplans:", data);

    // Check for success in the API response (look at success field, not msg)
    if (data.success === true) {
      // Transform the diet plans into DietHistoryItem format
      const dietHistoryItems: DietHistoryItem[] = (data.dietPlans || []).map((dietPlan) => {
        // Get the current date as ISO string for fallback
        const now = new Date().toISOString();

        return {
          id: dietPlan.id.toString(),
          clientName: 'Custom Template', // Default name for custom templates
          dietPlan: {
            id: dietPlan.id,
            name: dietPlan.name,
            description: dietPlan.description,
            targetCalories: dietPlan.targetCalories,
            proteinRatio: dietPlan.proteinRatio,
            carbsRatio: dietPlan.carbsRatio,
            fatsRatio: dietPlan.fatsRatio,
            meals: dietPlan.meals,
          },
          createdAt: dietPlan.createdAt || now,
          updatedAt: dietPlan.updatedAt || now,
          userId,
        };
      });

      return {
        success: true,
        data: dietHistoryItems,
      };
    }

    return {
      success: false,
      message: data.error || 'Failed to fetch diet plans from server',
    };
  } catch (error) {
    console.error('Error fetching diet plans:', error);

    // Create a more informative error message based on the type of error
    let errorMessage =
      'Unable to connect to the server. Your diet plans are still available locally.';

    // Check if it's a network error
    if (error && typeof error === 'object' && 'message' in error) {
      const errMsg = error.message as string;
      if (errMsg.includes('Network Error') || errMsg.includes('timeout')) {
        errorMessage = 'Network connection issue. Your diet plans are still available locally.';
      }
    }

    return {
      success: false,
      message: errorMessage,
    };
  }
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_actions/get-user-by-id.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

// Define response types for strong type safety
export interface HealthProfile {
  weight: number | null;
  height: number | null;
  goal: string | null;
  gender: string | null;
  age: number | null;
  // Additional diet-specific fields (optional)
  fitnessLevel?: string;
  goals?: string[];
  medicalConditions?: string[];
  dietPreferences?: string[];
  allergies?: string[];
}

export interface WorkoutPlan {
  id: number;
  name: string;
  description: string | null;
}

export interface UserData {
  id: string;
  name: string;
  email: string;
  healthProfile: HealthProfile | null;
  activeWorkoutPlan?: WorkoutPlan | null;
  hasActiveWorkoutPlan?: boolean;
  createdAt?: string;
  updatedAt?: string;
}

export async function getUserById(userId: string) {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.get(`/client/user/${userId}`);
    const data = response.data;

    if (data.msg === 'success' && data.user) {
      return {
        success: true,
        data: data.user as UserData,
      };
    }

    return {
      success: false,
      error: data.msg || 'Failed to fetch user data',
    };
  } catch (error) {
    console.error('Error fetching user by ID:', error);
    return {
      success: false,
      error: 'Failed to fetch user data',
    };
  }
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_actions/save-diet-plan.ts

```ts
"use server";

import { TrainerReqConfig } from "@/lib/AxiosInstance/trainerAxios";
import type { DietPlan } from "./get-customdiets";

// This is the type for the diet plan that is sent to the backend
// Define explicitly to avoid id field requirement in meals
export interface DietPlanInput {
  name: string;
  description?: string | null;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  meals: {
    name: string;
    timeOfDay: string;
    calories: number;
    protein: number;
    carbs: number;
    fats: number;
    instructions: string | null;
    order: number;
    ingredients?: Array<{
      name: string;
      quantity: number;
      unit: string;
      calories: number;
      protein?: number | null;
      carbs?: number | null;
      fats?: number | null;
    }>;
  }[];
}

// Define a type for the API response
interface ApiResponse {
  success: boolean;
  msg: string;
  data?: { id: number };
  error?: string;
}

export async function saveDietPlan(
  dietPlan: DietPlanInput
): Promise<{ success: boolean; dietPlanId?: number; message: string }> {
  const trainerAxios = await TrainerReqConfig();

  try {
    console.log("Sending diet plan to backend from saveDietPlan:", dietPlan);
    
    // We need to wrap the diet plan in a dietPlan object since that's what the backend expects
    const response = await trainerAxios.post("/diet/createcustomdietplan", {
      dietPlan: dietPlan
    });

    const data = response.data;
    console.log("Response from backend:", data);

    // Check the success field instead of msg field
    if (data.success === true) {
      // Extract dietPlanId from the response data if available
      const dietPlanId = data.data?.id;

      return {
        success: true,
        dietPlanId,
        message: data.msg || "Diet plan saved successfully",
      };
    }
    
    console.log("response.data from the assigndietplanwithai", response.data);
    return {
      success: false,
      message: data.error || data.msg || "Failed to save diet plan",
    };
  } catch (error) {
    console.error("Error saving diet plan:", error);

    return {
      success: false,
      message: "Error saving diet plan. Please try again.",
    };
  }
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-form/diet-form-skeleton.tsx

```tsx
import { Card, CardContent } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';

export function DietFormSkeleton() {
  return (
    <div className="max-w-2xl mx-auto">
      <Card className="bg-white/70 dark:bg-gray-950/70 border border-green-100/50 dark:border-green-800/30">
        <CardContent className="p-6">
          <div className="space-y-6">
            {/* Client Name field */}
            <div>
              <Skeleton className="h-4 w-24 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
              <Skeleton className="h-10 w-full bg-slate-300/80 dark:bg-slate-700/80" />
            </div>

            {/* Diet Preference */}
            <div>
              <Skeleton className="h-4 w-32 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
              <Skeleton className="h-10 w-full bg-slate-300/80 dark:bg-slate-700/80" />
            </div>

            {/* Medical Conditions */}
            <div>
              <Skeleton className="h-4 w-40 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
              <div className="space-y-2">
                {[1, 2, 3, 4, 5].map((index) => (
                  <div key={index} className="flex items-center">
                    <Skeleton className="h-4 w-4 mr-2 bg-slate-300/80 dark:bg-slate-700/80" />
                    <Skeleton className="h-4 w-24 bg-slate-300/80 dark:bg-slate-700/80" />
                  </div>
                ))}
              </div>
            </div>

            {/* Location */}
            <div>
              <Skeleton className="h-4 w-20 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
              <Skeleton className="h-10 w-full bg-slate-300/80 dark:bg-slate-700/80" />
            </div>

            {/* Country */}
            <div>
              <Skeleton className="h-4 w-16 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
              <Skeleton className="h-10 w-full bg-slate-300/80 dark:bg-slate-700/80" />
            </div>

            {/* Additional fields */}
            <div>
              <Skeleton className="h-4 w-36 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
              <Skeleton className="h-10 w-full bg-slate-300/80 dark:bg-slate-700/80" />
            </div>

            {/* Generate button */}
            <div className="pt-2">
              <Skeleton className="h-10 w-full sm:w-40 mx-auto bg-green-300/60 dark:bg-green-700/60" />
            </div>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-form/diet-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { zodResolver } from '@hookform/resolvers/zod';
import { Loader2, Sparkles } from 'lucide-react';
import React, { useState } from 'react';
import { useForm } from 'react-hook-form';
import type { DietPlan } from '../../../_actions /GetallDiets';
import { generateAIDiet } from '../../_actions/generate-ai-diet';
import type { UserData } from '../../_actions/get-user-by-id';
import { useDietViewStore } from '../../_store/diet-view-store';
import { dietGenerationSchema } from '../../types/dietGenerationSchema';
import type { DietGenerationParams } from '../../types/dietGenerationSchema';
import { useSaveToLocalStorageMutation } from '../diet-history/use-diet-history';

const DIET_PREFERENCES = [
  'Vegetarian',
  'Vegan',
  'Pescatarian',
  'Keto',
  'Paleo',
  'Mediterranean',
  'No Restrictions',
];

const MEDICAL_CONDITIONS = [
  'Diabetes',
  'Hypertension',
  'Celiac Disease',
  'Lactose Intolerance',
  'None',
];

interface DietFormProps {
  userId: string;
  userData?: UserData | null;
  onGenerateStateChange?: (generating: boolean) => void;
  onDietGenerated?: (diet: { clientName: string; dietPlan: DietPlan }) => void;
}

export function DietForm({
  userId,
  userData,
  onGenerateStateChange,
  onDietGenerated,
}: DietFormProps) {
  const [isLoading, setIsLoading] = useState(false);
  const [clientName, setClientName] = useState(userData?.name || 'Client');

  const { setActiveDiet, setActiveTab } = useDietViewStore();
  
  const saveToLocalStorage = useSaveToLocalStorageMutation();

  const {
    register,
    handleSubmit,
    formState: { errors },
  } = useForm<DietGenerationParams>({
    resolver: zodResolver(dietGenerationSchema),
    defaultValues: {
      medicalConditions: [],
      dietPreference: 'No Restrictions',
    },
  });

  const onSubmit = async (data: DietGenerationParams) => {
    try {
      setIsLoading(true);
      // Update the parent component about the loading state
      if (onGenerateStateChange) {
        onGenerateStateChange(true);
      }

      // Call our server action directly with simplified error handling
      const result = await generateAIDiet(data);

      // Create diet object with client name
      const dietData = {
        clientName: clientName,
        dietPlan: result,
      };

      // Save the diet to localStorage 
      await saveToLocalStorage.mutateAsync({
        clientName: clientName,
        dietPlan: result,
        userId
      });

      // Update the store and automatically switch to the diet tab
      setActiveDiet(dietData);

      // Notify parent component about diet generation
      if (onDietGenerated) {
        onDietGenerated(dietData);
      }

      // Automatically switch to the diet tab
      setActiveTab('diet');
    } catch (error) {
      console.error('Error generating diet plan:', error, userId);
      // Handle error appropriately - you could set an error state here
    } finally {
      setIsLoading(false);
      // Update the parent component that loading is done
      if (onGenerateStateChange) {
        onGenerateStateChange(false);
      }
    }
  };

  return (
    <div className="max-w-2xl mx-auto">
      <Card className="bg-white/70 dark:bg-gray-950/70 border border-indigo-100/50 dark:border-indigo-800/30">
        <CardContent className="p-6">
          <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
            {/* Client Name - optional field for reference */}
            <div>
              <label htmlFor="clientName" className="block text-sm font-medium mb-2">
                Client Name (Optional)
              </label>
              <input
                id="clientName"
                type="text"
                value={clientName}
                onChange={(e) => setClientName(e.target.value)}
                className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                placeholder="Enter client name"
              />
            </div>

            {/* Diet Preference */}
            <div>
              <label htmlFor="dietPreference" className="block text-sm font-medium mb-2">
                Diet Preference <span className="text-red-500">*</span>
              </label>
              <select
                id="dietPreference"
                {...register('dietPreference')}
                className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
              >
                {DIET_PREFERENCES.map((pref) => (
                  <option key={pref} value={pref}>
                    {pref}
                  </option>
                ))}
              </select>
              {errors.dietPreference && (
                <p className="text-red-500 text-sm mt-1">{errors.dietPreference.message}</p>
              )}
            </div>

            {/* Medical Conditions */}
            <div>
              <fieldset>
                <legend className="block text-sm font-medium mb-2">
                  Medical Conditions <span className="text-red-500">*</span>
                </legend>
                <div className="space-y-2">
                  {MEDICAL_CONDITIONS.map((condition) => {
                    const id = `condition-${condition}`;
                    return (
                      <label key={condition} htmlFor={id} className="flex items-center">
                        <input
                          id={id}
                          type="checkbox"
                          value={condition}
                          {...register('medicalConditions')}
                          className="mr-2 h-4 w-4 text-indigo-600 focus:ring-indigo-500"
                        />
                        {condition}
                      </label>
                    );
                  })}
                </div>
              </fieldset>
              {errors.medicalConditions && (
                <p className="text-red-500 text-sm mt-1">{errors.medicalConditions.message}</p>
              )}
            </div>

            {/* Location */}
            <div>
              <label htmlFor="location" className="block text-sm font-medium mb-2">
                Location <span className="text-red-500">*</span>
              </label>
              <input
                id="location"
                type="text"
                {...register('location')}
                className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                placeholder="Enter city/region"
                required
              />
              {errors.location && (
                <p className="text-red-500 text-sm mt-1">{errors.location.message}</p>
              )}
            </div>

            {/* Country */}
            <div>
              <label htmlFor="country" className="block text-sm font-medium mb-2">
                Country <span className="text-red-500">*</span>
              </label>
              <input
                id="country"
                type="text"
                {...register('country')}
                className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                placeholder="Enter country"
                required
              />
              {errors.country && (
                <p className="text-red-500 text-sm mt-1">{errors.country.message}</p>
              )}
            </div>

            {/* Target Calories */}
            <div>
              <label htmlFor="targetCalories" className="block text-sm font-medium mb-2">
                Target Calories <span className="text-red-500">*</span>
              </label>
              <input
                id="targetCalories"
                type="number"
                {...register('targetCalories', { valueAsNumber: true })}
                className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                placeholder="Enter target calories"
                required
              />
              {errors.targetCalories && (
                <p className="text-red-500 text-sm mt-1">{errors.targetCalories.message}</p>
              )}
            </div>

            {/* Special Instructions */}
            <div>
              <label htmlFor="specialInstructions" className="block text-sm font-medium mb-2">
                Special Instructions (Optional)
              </label>
              <textarea
                id="specialInstructions"
                {...register('specialInstructions')}
                className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                placeholder="Enter any special instructions or preferences"
                rows={3}
              />
              {errors.specialInstructions && (
                <p className="text-red-500 text-sm mt-1">{errors.specialInstructions.message}</p>
              )}
            </div>

            <Button
              type="submit"
              disabled={isLoading}
              className="w-full bg-gradient-to-br from-indigo-600/90 via-blue-600/80 to-indigo-700/90 hover:from-indigo-600 hover:to-blue-600 text-white py-2 px-4 rounded shadow-md disabled:opacity-50"
            >
              {isLoading ? (
                <>
                  <Loader2 className="h-4 w-4 mr-2 animate-spin" />
                  Generating...
                </>
              ) : (
                <>
                  <Sparkles className="h-4 w-4 mr-2" />
                  Generate Diet Plan
                </>
              )}
            </Button>
          </form>
        </CardContent>
      </Card>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-history/diet-history-provider.tsx

```tsx
'use client';

import { useSession } from 'next-auth/react';
// biome-ignore lint/style/useImportType: <Diet hsitory provider need it>
import React from 'react';
import { createContext, useContext } from 'react';
import type { DietHistoryItem } from '../../_store/diet-view-store';
import { useDietHistoryQuery } from './use-diet-history';

// This provider is now a lightweight wrapper around React Query
// It's kept for backward compatibility
interface DietHistoryContextType {
  loading: boolean;
  history: DietHistoryItem[];
  error: string | null;
  refreshHistory: () => Promise<void>;
}

const DietHistoryContext = createContext<DietHistoryContextType>({
  loading: true,
  history: [],
  error: null,
  refreshHistory: async () => {},
});

export const useDietHistory = () => useContext(DietHistoryContext);

export function DietHistoryProvider({
  children,
}: {
  children: React.ReactNode;
}) {
  const { data: session } = useSession();
  const userId = session?.user?.id || '';
  
  // Use the React Query hook
  const { 
    data = [], 
    isLoading,
    isError, 
    error,
    refetch 
  } = useDietHistoryQuery(userId);

  // Convert React Query state to the old interface for backward compatibility
  const contextValue = {
    loading: isLoading,
    history: data,
    error: isError ? (error instanceof Error ? error.message : 'Error loading diet history') : null,
    refreshHistory: async () => {
      await refetch();
    },
  };

  return (
    <DietHistoryContext.Provider value={contextValue}>
      {children}
    </DietHistoryContext.Provider>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-history/diet-history.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { formatDistanceToNow } from 'date-fns';
import { Calendar, Check, ChevronRight, RefreshCw, Search, UtensilsCrossed } from 'lucide-react';
import React, { useState } from 'react';
import type { DietHistoryItem } from '../../_store/diet-view-store';
import { useDietHistoryQuery } from './use-diet-history';

interface DietHistoryProps {
  onSelectDiet: (diet: DietHistoryItem) => void;
  userId: string;
}

export function DietHistory({ onSelectDiet, userId }: DietHistoryProps) {
  const [searchQuery, setSearchQuery] = useState('');
  
  // Use React Query hook for fetching diet history
  const { 
    data: history = [], 
    isLoading, 
    isError, 
    error, 
    refetch,
    isFetching
  } = useDietHistoryQuery(userId);

  const filteredHistory = React.useMemo(() => {
    if (!searchQuery.trim()) return history;

    const query = searchQuery.toLowerCase();
    return history.filter(
      (item) =>
        item.dietPlan.name.toLowerCase().includes(query) ||
        item.dietPlan.description?.toLowerCase().includes(query),
    );
  }, [history, searchQuery]);

  // Show loading state
  if (isLoading && !history.length) {
    return (
      <div className="flex justify-center items-center p-8">
        <RefreshCw className="h-6 w-6 animate-spin" />
      </div>
    );
  }

  // Show error state
  if (isError) {
    return (
      <div className="space-y-4">
        {history.length > 0 && (
          <div className="flex justify-between items-center">
            <p className="text-sm text-amber-500">
              <span className="font-medium">Note:</span> Using locally saved diets
            </p>
            <Button variant="outline" size="sm" onClick={() => refetch()}>
              <RefreshCw className="h-3 w-3 mr-1" /> Sync with server
            </Button>
          </div>
        )}
        
        {history.length > 0 ? (
          <DietHistoryList
            diets={filteredHistory}
            searchQuery={searchQuery}
            setSearchQuery={setSearchQuery}
            onSelectDiet={onSelectDiet}
          />
        ) : (
          <div className="p-6 text-center">
            <p className="text-red-500 mb-4">{error instanceof Error ? error.message : 'Error loading diet history'}</p>
            <Button variant="outline" onClick={() => refetch()}>
              <RefreshCw className="h-4 w-4 mr-2" /> Try Again
            </Button>
          </div>
        )}
      </div>
    );
  }

  // Show fetching state with current data
  if (isFetching && history.length > 0) {
    return (
      <div className="space-y-4">
        <div className="flex justify-between items-center">
          <p className="text-sm text-muted-foreground">
            Refreshing diet history...
          </p>
          <RefreshCw className="h-4 w-4 animate-spin" />
        </div>
        <DietHistoryList
          diets={filteredHistory}
          searchQuery={searchQuery}
          setSearchQuery={setSearchQuery}
          onSelectDiet={onSelectDiet}
        />
      </div>
    );
  }

  // No diets found
  if (filteredHistory.length === 0) {
    return (
      <div className="flex flex-col items-center justify-center p-8 text-center">
        <UtensilsCrossed className="h-12 w-12 text-muted-foreground mb-4" />
        <h3 className="text-lg font-medium">No diet plans saved yet</h3>
        <p className="text-sm text-muted-foreground mt-2 mb-4">
          Generate and save a diet plan to see it here
        </p>
      </div>
    );
  }

  // Normal state with data
  return (
    <div className="space-y-4">
      {isFetching && (
        <div className="flex justify-end">
          <RefreshCw className="h-4 w-4 animate-spin" />
        </div>
      )}
      <DietHistoryList
        diets={filteredHistory}
        searchQuery={searchQuery}
        setSearchQuery={setSearchQuery}
        onSelectDiet={onSelectDiet}
      />
    </div>
  );
}

interface DietHistoryListProps {
  diets: DietHistoryItem[];
  searchQuery: string;
  setSearchQuery: (query: string) => void;
  onSelectDiet: (diet: DietHistoryItem) => void;
}

function DietHistoryList({
  diets,
  searchQuery,
  setSearchQuery,
  onSelectDiet,
}: DietHistoryListProps) {
  return (
    <div className="space-y-4">
      <div className="relative">
        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground" />
        <Input
          placeholder="Search diet plans..."
          className="pl-10"
          value={searchQuery}
          onChange={(e) => setSearchQuery(e.target.value)}
        />
      </div>

      <div className="grid gap-4">
        {diets.length === 0 ? (
          <div className="text-center p-6">
            <p className="text-muted-foreground">No matching diet plans found</p>
          </div>
        ) : (
          diets.map((item) => (
            <Card
              key={item.id}
              className="overflow-hidden hover:border-green-300 transition-colors cursor-pointer"
              onClick={() => onSelectDiet(item)}
            >
              <CardContent className="p-0">
                <div className="flex items-start gap-3 p-4">
                  <div className="flex-shrink-0 p-2 bg-green-100 rounded-md">
                    <Calendar className="h-5 w-5 text-green-600" />
                  </div>
                  <div className="flex-1 min-w-0">
                    <div className="flex justify-between items-start gap-2">
                      <h3 className="font-semibold truncate">{item.dietPlan.name}</h3>
                      <div className="flex items-center text-sm text-muted-foreground">
                        <span className="whitespace-nowrap">
                          {formatDistanceToNow(new Date(item.createdAt), {
                            addSuffix: true,
                          })}
                        </span>
                        <ChevronRight className="h-4 w-4 ml-1" />
                      </div>
                    </div>
                    <p className="text-sm text-muted-foreground line-clamp-2 mt-1">
                      {item.dietPlan.description || 'No description'}
                    </p>
                    <div className="flex gap-2 mt-2">
                      <div className="inline-flex items-center text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">
                        <Check className="h-3 w-3 mr-1" />
                        {item.dietPlan.meals.length} meals
                      </div>
                      <div className="inline-flex items-center text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">
                        {Math.round(item.dietPlan.targetCalories)} calories
                      </div>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          ))
        )}
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-history/use-diet-history.ts

```ts
'use client';

import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';
import type { DietPlan } from '../../_actions/get-customdiets';
import { getCustomDietPlans } from '../../_actions/get-customdiets';
import { saveDietPlan } from '../../_actions/save-diet-plan';
import type { DietPlanInput } from '../../_actions/save-diet-plan';
import { useDietViewStore } from '../../_store/diet-view-store';
import type { DietHistoryItem } from '../../_store/diet-view-store';

// Define query keys
export const DIET_PLANS_QUERY_KEY = 'dietPlans';
export const CUSTOM_DIET_PLANS_QUERY_KEY = 'customDietPlans';

// Helper function to normalize dates for sorting
const normalizeDate = (dateStr?: string): Date => {
  if (!dateStr) return new Date();
  try {
    return new Date(dateStr);
  } catch (e) {
    return new Date();
  }
};

// Helper function to ensure DietPlan matches expected format
const normalizeDietPlan = (diet: DietPlan): DietPlan => {
  return {
    ...diet,
    // Ensure description is string | undefined (not null)
    description: diet.description === null ? undefined : diet.description,
    // Process meals to ensure compatibility
    meals: diet.meals.map(meal => ({
      ...meal,
      // Ensure id is present
      id: meal.id || 0,
      // Ensure instructions is a string (not null)
      instructions: meal.instructions || ""
    }))
  };
};

export function useDietHistoryQuery(userId: string) {
  const { getSavedDiets } = useDietViewStore();
  const localDiets = getSavedDiets(userId);

  return useQuery({
    queryKey: [CUSTOM_DIET_PLANS_QUERY_KEY],
    queryFn: async () => {
      // Fetch diet plans from backend
      const backendDiets = await getCustomDietPlans();
      
      // Get unique IDs from backend diets to filter local diets
      const backendIdsSet = new Set(backendDiets.map(diet => diet.id.toString()));
      
      // Filter out local diets that already exist in backend
      const uniqueLocalDiets = localDiets.filter(item => 
        !backendIdsSet.has(typeof item.dietPlan.id === 'string' 
          ? item.dietPlan.id 
          : item.dietPlan.id.toString()
        )
      );
      
      // Normalize backend diet data to match expected format
      const normalizedBackendDiets = backendDiets.map(diet => ({
        id: `backend-${diet.id}`,
        clientName: diet.name,
        dietPlan: normalizeDietPlan(diet),
        createdAt: diet.createdAt || new Date().toISOString(),
        updatedAt: diet.updatedAt || new Date().toISOString(),
        userId: userId
      }));
      
      // Combine all diets
      const allDiets = [...normalizedBackendDiets, ...uniqueLocalDiets];
      
      // Sort by createdAt (newest first) using improved date handling
      return allDiets.sort((a, b) => {
        const dateA = normalizeDate(a.createdAt);
        const dateB = normalizeDate(b.createdAt);
        return dateB.getTime() - dateA.getTime(); // Newest first
      });
    },
    initialData: localDiets, // Show local diets immediately while fetching
    staleTime: 30 * 1000, // 30 seconds
    retry: 1,
  });
}

// Mutation hook for saving a diet plan to localStorage ONLY
export function useSaveToLocalStorageMutation() {
  const { saveDietToLocalStorage } = useDietViewStore();
  
  return useMutation({
    mutationFn: async ({ 
      clientName, 
      dietPlan, 
      userId 
    }: { 
      clientName: string;
      dietPlan: DietPlan; 
      userId: string;
    }) => {
      // Normalize the diet plan to ensure type compatibility
      const normalizedDietPlan = normalizeDietPlan(dietPlan);
      
      saveDietToLocalStorage({ clientName, dietPlan: normalizedDietPlan }, userId);
      return { success: true };
    }
  });
}

// Mutation hook for saving a diet plan to the BACKEND ONLY
export function useSaveToBackendMutation() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: async ({ dietPlan }: { dietPlan: DietPlanInput }) => {
      // Pass the diet plan directly to saveDietPlan without wrapping it
      return await saveDietPlan(dietPlan);
    },
    onSuccess: () => {
      // Invalidate all diet-related queries to trigger refetches
      queryClient.invalidateQueries({ queryKey: [CUSTOM_DIET_PLANS_QUERY_KEY] });
    },
  });
}

// Combined mutation for saving diet plan to both localStorage and backend
export function useSaveDietPlanMutation() {
  const queryClient = useQueryClient();
  const { saveDietToLocalStorage } = useDietViewStore();
  
  return useMutation({
    mutationFn: async ({ 
      dietPlan, 
      userId, 
      clientName 
    }: { 
      dietPlan: DietPlan; 
      userId: string;
      clientName: string;
    }) => {
      // Normalize the diet plan to ensure type compatibility
      const normalizedDietPlan = normalizeDietPlan(dietPlan);
      
      // First save to localStorage
      saveDietToLocalStorage({ clientName, dietPlan: normalizedDietPlan }, userId);
      
      // Then transform and save to backend
      const dietPlanInput: DietPlanInput = {
        name: dietPlan.name,
        description: dietPlan.description || null,
        targetCalories: dietPlan.targetCalories,
        proteinRatio: dietPlan.proteinRatio,
        carbsRatio: dietPlan.carbsRatio,
        fatsRatio: dietPlan.fatsRatio,
        meals: dietPlan.meals.map((meal, index) => ({
          name: meal.name,
          timeOfDay: meal.timeOfDay,
          calories: meal.calories,
          protein: meal.protein,
          carbs: meal.carbs,
          fats: meal.fats,
          instructions: meal.instructions || null,
          order: index + 1, // Add the required order field
          ingredients: [] // Add empty ingredients array since it's not in the AI response
        }))
      };
      
      // Save to backend and return result
      console.log("dietPlanInput from the useSaveDietPlanMutation", dietPlanInput);

      return await saveDietPlan(dietPlanInput);
    },
    onSuccess: () => {
      // Invalidate the diet plans query to trigger a refetch
      queryClient.invalidateQueries({ queryKey: [CUSTOM_DIET_PLANS_QUERY_KEY] });
    },
  });
} 
```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-result/diet-results.tsx

```tsx
"use client";

import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
	CheckCircle,
	Clock,
	Save,
	Trash2,
	UserCheck,
	Utensils,
} from "lucide-react";
import { useState } from "react";
import { toast } from "sonner";
import { attachDietPlanToUser } from "../../../_actions /AttachDietPlanToUser";
import type { DietPlan } from "../../../_actions /GetallDiets";
import type { DietPlanInput } from "../../_actions/save-diet-plan";
import { useSaveToBackendMutation } from "../diet-history/use-diet-history";

// Extend the meal type to include optional ingredients
interface MealWithIngredients {
	id: number;
	name: string;
	timeOfDay: string;
	calories: number;
	protein: number;
	carbs: number;
	fats: number;
	instructions?: string;
	ingredients?: Array<{
		name: string;
		quantity: number;
		unit: string;
		calories: number;
		protein?: number | null;
		carbs?: number | null;
		fats?: number | null;
	}>;
}

// Extend DietPlan to ensure it has the right meal type
interface ExtendedDietPlan extends Omit<DietPlan, "meals"> {
	meals: MealWithIngredients[];
}

interface DietResultsProps {
	dietPlan: ExtendedDietPlan;
	onSuccess: () => void;
	clientName: string;
	userId: string;
	userName?: string;
}

// Define result data type
interface DietPlanResult {
	id: number;
	name?: string;
	description?: string | null;
	createdAt?: string;
	updatedAt?: string;
	createdByTrainerId?: number;
	meals?: {
		id: number;
		name: string;
		calories?: number;
		[key: string]: unknown;
	}[];
}

export default function DietResults({
	dietPlan,
	onSuccess,
	clientName = "Client",
	userId,
	userName,
}: DietResultsProps) {
	const [saveMessage, setSaveMessage] = useState("");
	const [saveSuccess, setSaveSuccess] = useState(false);
	const [isAssigning, setIsAssigning] = useState(false);
	const [assignMessage, setAssignMessage] = useState("");
	const [assignSuccess, setAssignSuccess] = useState(false);

	// Use the new backend-only mutation hook
	const saveToBackendMutation = useSaveToBackendMutation();

	// Transform diet plan to the format expected by saveDietPlan
	const transformDietPlanForCreation = (
		plan: ExtendedDietPlan,
	): DietPlanInput => {
		// Transform meals to match the DietPlanInput type (without id field)
		const transformedMeals = plan.meals.map((meal, index) => ({
			name: meal.name,
			timeOfDay: meal.timeOfDay,
			calories: meal.calories,
			protein: meal.protein,
			carbs: meal.carbs,
			fats: meal.fats,
			instructions: meal.instructions || null,
			order: index + 1,
			ingredients: meal.ingredients || [],
		}));

		return {
			name: plan.name,
			description: plan.description || null,
			targetCalories: plan.targetCalories,
			proteinRatio: plan.proteinRatio,
			carbsRatio: plan.carbsRatio,
			fatsRatio: plan.fatsRatio,
			meals: transformedMeals,
		};
	};

	const handleSave = async () => {
		setSaveMessage("");
		setSaveSuccess(false);

		try {
			// Transform the diet plan
			const transformedDietPlan = transformDietPlanForCreation(dietPlan);
			console.log("Sending diet plan to backend:", transformedDietPlan);
			
			// Use the backend-only mutation to save the diet plan
			const result = await saveToBackendMutation.mutateAsync({
				dietPlan: transformedDietPlan,
			});

			console.log("Save result from backend:", result);

			if (result.success) {
				setSaveSuccess(true);
				setSaveMessage("Diet plan created successfully!");
				toast.success("Diet plan created successfully!");

				// Update the local diet plan with the ID from the backend
				if (result.dietPlanId) {
					console.log("Diet plan ID from backend:", result.dietPlanId);
					dietPlan.id = result.dietPlanId;
				} else {
					console.warn("No diet plan ID returned from backend");
				}

				// Call the onSuccess callback if provided
				if (onSuccess) {
					setTimeout(() => {
						onSuccess();
					}, 1500);
				}
			} else {
				console.error("Failed to save diet plan:", result);
				setSaveSuccess(false);
				setSaveMessage(result.message || "Failed to create diet plan");
				toast.error(result.message || "Failed to create diet plan");
			}
		} catch (error) {
			console.error("Error saving diet plan:", error);
			setSaveSuccess(false);
			setSaveMessage("An unexpected error occurred while saving");
			toast.error("An unexpected error occurred while saving the diet plan");
		}
	};

	const handleAssignDietPlan = async () => {
		if (!dietPlan.id) {
			console.log("dietplan id is , userid is ", dietPlan.id, userId);
			setAssignMessage("Please save the diet plan first before assigning");
			setAssignSuccess(false);
			toast.error("Please save the diet plan first before assigning");
			return;
		}

		setIsAssigning(true);
		setAssignMessage("");
		setAssignSuccess(false);

		try {
			console.log("dietplan id is , userid is", dietPlan.id, userId);
			const result = await attachDietPlanToUser(userId, dietPlan.id.toString());

			if (result.success) {
				setAssignSuccess(true);
				setAssignMessage(
					`Diet plan successfully assigned to ${userName || clientName}!`,
				);
				// Show success toast notification
				toast.success(
					`Diet plan successfully assigned to ${userName || clientName}!`,
					{},
				);
			} else {
				setAssignSuccess(false);
				setAssignMessage(result.message || "Failed to assign diet plan");
				// Show error toast notification
				toast.error(result.message || "Failed to assign diet ");
			}
		} catch (error) {
			console.error("Error assigning diet plan:", error);
			setAssignSuccess(false);
			setAssignMessage(
				"An unexpected error occurred while assigning diet plan",
			);
			// Show error toast notification
			toast.error("An unexpected error occurred while assigning diet plan");
		} finally {
			setIsAssigning(false);
		}
	};

	return (
		<div className="space-y-8">
			{/* Header with save/discard buttons */}
			<div className="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4">
				<div>
					<h2 className="text-2xl font-bold">{dietPlan.name}</h2>
					<p className="text-muted-foreground">{dietPlan.description}</p>
				</div>

				<div className="flex gap-2">
					<Button
						variant="outline"
						className="gap-1 border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700 dark:border-red-900/30 dark:text-red-400 dark:hover:bg-red-950/50 dark:hover:text-red-300"
						onClick={() => onSuccess()}
					>
						<Trash2 className="h-4 w-4" />
						<span>Discard</span>
					</Button>

					<Button
						variant="default"
						className="gap-1 bg-gradient-to-br from-green-600/90 via-emerald-600/80 to-green-700/90 hover:from-green-600 hover:to-emerald-600 text-white shadow-md"
						onClick={handleSave}
						disabled={saveToBackendMutation.isPending || saveSuccess}
					>
						{saveToBackendMutation.isPending ? (
							<>
								<Clock className="h-4 w-4 animate-spin" />
								<span>Saving...</span>
							</>
						) : saveSuccess ? (
							<>
								<CheckCircle className="h-4 w-4" />
								<span>Saved</span>
							</>
						) : (
							<>
								<Save className="h-4 w-4" />
								<span>Save Diet Plan</span>
							</>
						)}
					</Button>
				</div>
			</div>

			{saveMessage && (
				<div
					className={`p-3 rounded-md ${
						saveSuccess
							? "bg-green-50 text-green-700 border border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-800/30"
							: "bg-red-50 text-red-700 border border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800/30"
					}`}
				>
					{saveMessage}
				</div>
			)}

			{/* Diet summary */}
			<Card className="bg-white/70 dark:bg-gray-950/70  border border-green-100/50 dark:border-green-800/30">
				<CardHeader className="bg-gradient-to-br from-green-50/50 via-emerald-50/30 to-green-50/50 dark:from-green-950/50 dark:via-emerald-950/30 dark:to-green-950/50 border-b border-green-100/50 dark:border-green-800/30">
					<CardTitle className="text-xl">Diet Plan Summary</CardTitle>
				</CardHeader>
				<CardContent className="pt-4">
					<div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
						<div className="p-3 bg-green-50/50 dark:bg-green-900/20 rounded-md border border-green-100/50 dark:border-green-800/30 text-center">
							<div className="text-sm text-muted-foreground mb-1">
								Daily Calories
							</div>
							<div className="text-xl font-semibold text-green-700 dark:text-green-300">
								{dietPlan.targetCalories} kcal
							</div>
						</div>

						<div className="p-3 bg-green-50/50 dark:bg-green-900/20 rounded-md border border-green-100/50 dark:border-green-800/30 text-center">
							<div className="text-sm text-muted-foreground mb-1">Protein</div>
							<div className="text-xl font-semibold text-green-700 dark:text-green-300">
								{Math.round(dietPlan.proteinRatio * 100)}%
							</div>
						</div>

						<div className="p-3 bg-green-50/50 dark:bg-green-900/20 rounded-md border border-green-100/50 dark:border-green-800/30 text-center">
							<div className="text-sm text-muted-foreground mb-1">
								Meals per Day
							</div>
							<div className="text-xl font-semibold text-green-700 dark:text-green-300">
								{dietPlan.meals.length}
							</div>
						</div>
					</div>

					<div className="space-y-6">
						<h3 className="font-medium text-lg flex items-center gap-2 text-green-800 dark:text-green-300">
							<Utensils className="h-5 w-5" />
							<span>Daily Meal Plan</span>
						</h3>

						<div className="space-y-4">
							{dietPlan.meals.map((meal) => (
								<Card
									key={meal.id}
									className="overflow-hidden border border-green-100/50 dark:border-green-800/30"
								>
									<CardHeader className="py-3 px-4 bg-green-50/70 dark:bg-green-900/30">
										<div className="flex justify-between items-center">
											<CardTitle className="text-base font-medium">
												{meal.name}
											</CardTitle>
											<span className="text-xs text-muted-foreground">
												{meal.timeOfDay}
											</span>
										</div>
									</CardHeader>
									<CardContent className="p-4">
										<div className="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3">
											<div className="text-sm">
												<span className="text-muted-foreground">Calories:</span>{" "}
												<span className="font-medium">
													{meal.calories} kcal
												</span>
											</div>
											<div className="text-sm">
												<span className="text-muted-foreground">Protein:</span>{" "}
												<span className="font-medium">{meal.protein}g</span>
											</div>
											<div className="text-sm">
												<span className="text-muted-foreground">Carbs:</span>{" "}
												<span className="font-medium">{meal.carbs}g</span>
											</div>
											<div className="text-sm">
												<span className="text-muted-foreground">Fats:</span>{" "}
												<span className="font-medium">{meal.fats}g</span>
											</div>
										</div>

										{meal.instructions && (
											<div className="mt-2 text-sm">
												<div className="text-muted-foreground font-medium mb-1">
													Instructions:
												</div>
												<p className="text-sm">{meal.instructions}</p>
											</div>
										)}
									</CardContent>
								</Card>
							))}
						</div>
					</div>
				</CardContent>
			</Card>

			{/* Bottom action buttons (mobile friendly duplication) */}
			<div className="flex flex-col sm:flex-row justify-end gap-2 pt-2">
				<Button
					variant="outline"
					className="gap-1 border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700 dark:border-red-900/30 dark:text-red-400 dark:hover:bg-red-950/50 dark:hover:text-red-300"
					onClick={() => onSuccess()}
				>
					<Trash2 className="h-4 w-4" />
					<span>Discard</span>
				</Button>

				<Button
					variant="default"
					className="gap-1 bg-gradient-to-br from-green-600/90 via-emerald-600/80 to-green-700/90 hover:from-green-600 hover:to-emerald-600 text-white shadow-md"
					onClick={handleSave}
					disabled={saveToBackendMutation.isPending || saveSuccess}
				>
					{saveToBackendMutation.isPending ? (
						<>
							<Clock className="h-4 w-4 animate-spin" />
							<span>Saving...</span>
						</>
					) : saveSuccess ? (
						<>
							<CheckCircle className="h-4 w-4" />
							<span>Saved</span>
						</>
					) : (
						<>
							<Save className="h-4 w-4" />
							<span>Save Diet Plan</span>
						</>
					)}
				</Button>

				<Button
					variant="default"
					className="gap-1 bg-gradient-to-br from-indigo-600/90 via-blue-600/80 to-indigo-700/90 hover:from-indigo-600 hover:to-blue-600 text-white shadow-md mt-2 sm:mt-0"
					onClick={handleAssignDietPlan}
					disabled={isAssigning || assignSuccess || !dietPlan.id}
				>
					{isAssigning ? (
						<>
							<Clock className="h-4 w-4 animate-spin" />
							<span>Assigning...</span>
						</>
					) : assignSuccess ? (
						<>
							<CheckCircle className="h-4 w-4" />
							<span>Assigned</span>
						</>
					) : (
						<>
							<UserCheck className="h-4 w-4" />
							<span>Assign to {userName || clientName}</span>
						</>
					)}
				</Button>
			</div>

			{/* Display assignment message */}
			{assignMessage && (
				<div
					className={`p-3 rounded-md mt-2 ${
						assignSuccess
							? "bg-indigo-50 text-indigo-700 border border-indigo-200 dark:bg-indigo-900/30 dark:text-indigo-300 dark:border-indigo-800/30"
							: "bg-red-50 text-red-700 border border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800/30"
					}`}
				>
					{assignMessage}
				</div>
			)}
		</div>
	);
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/diet-result/diet-skeleton.tsx

```tsx
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';
import { Utensils } from 'lucide-react';

export default function DietSkeleton() {
  return (
    <div className="space-y-8 animate-pulse">
      {/* Header with skeleton buttons */}
      <div className="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4">
        <div>
          <Skeleton className="h-8 w-48 mb-2 bg-slate-300/80 dark:bg-slate-700/80" />
          <Skeleton className="h-4 w-64 bg-slate-300/80 dark:bg-slate-700/80" />
        </div>

        <div className="flex gap-2">
          <Skeleton className="h-10 w-24 bg-slate-300/80 dark:bg-slate-700/80" />
          <Skeleton className="h-10 w-32 bg-green-300/60 dark:bg-green-700/60" />
        </div>
      </div>

      {/* Diet summary */}
      <Card className="bg-white/70 dark:bg-gray-950/70 border border-green-100/50 dark:border-green-800/30">
        <CardHeader className="bg-gradient-to-br from-green-50/50 via-emerald-50/30 to-green-50/50 dark:from-green-950/50 dark:via-emerald-950/30 dark:to-green-950/50 border-b border-green-100/50 dark:border-green-800/30">
          <CardTitle className="text-xl">Diet Plan Summary</CardTitle>
        </CardHeader>
        <CardContent className="pt-4">
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            {[1, 2, 3].map((index) => (
              <div
                key={index}
                className="p-3 bg-green-50/50 dark:bg-green-900/20 rounded-md border border-green-100/50 dark:border-green-800/30 text-center"
              >
                <div className="text-sm text-muted-foreground mb-1">
                  <Skeleton className="h-4 w-20 mx-auto bg-slate-300/80 dark:bg-slate-700/80" />
                </div>
                <div className="text-xl font-semibold">
                  <Skeleton className="h-6 w-16 mx-auto bg-slate-300/80 dark:bg-slate-700/80" />
                </div>
              </div>
            ))}
          </div>

          <div className="space-y-6">
            <h3 className="font-medium text-lg flex items-center gap-2 text-green-800 dark:text-green-300">
              <Utensils className="h-5 w-5" />
              <span>Daily Meal Plan</span>
            </h3>

            <div className="space-y-4">
              {[1, 2, 3, 4].map((index) => (
                <Card
                  key={index}
                  className="overflow-hidden border border-green-100/50 dark:border-green-800/30"
                >
                  <CardHeader className="py-3 px-4 bg-green-50/70 dark:bg-green-900/30">
                    <div className="flex justify-between items-center">
                      <Skeleton className="h-5 w-24 bg-slate-300/80 dark:bg-slate-700/80" />
                      <Skeleton className="h-4 w-16 bg-slate-300/80 dark:bg-slate-700/80" />
                    </div>
                  </CardHeader>
                  <CardContent className="p-4">
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3">
                      {[1, 2, 3, 4].map((i) => (
                        <div key={i} className="text-sm">
                          <Skeleton className="h-4 w-20 mb-1 bg-slate-300/80 dark:bg-slate-700/80" />
                          <Skeleton className="h-4 w-12 bg-slate-300/80 dark:bg-slate-700/80" />
                        </div>
                      ))}
                    </div>

                    <div className="mt-2">
                      <Skeleton className="h-4 w-24 mb-1 bg-slate-300/80 dark:bg-slate-700/80" />
                      <Skeleton className="h-4 w-full mb-1 bg-slate-300/80 dark:bg-slate-700/80" />
                      <Skeleton className="h-4 w-4/5 bg-slate-300/80 dark:bg-slate-700/80" />
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Bottom action buttons */}
      <div className="flex justify-end gap-2 pt-2">
        <Skeleton className="h-10 w-24 bg-slate-300/80 dark:bg-slate-700/80" />
        <Skeleton className="h-10 w-32 bg-green-300/60 dark:bg-green-700/60" />
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/history/diet-history-provider.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Loader2 } from 'lucide-react';
import { useEffect, useState } from 'react';
import { getDietHistory } from '../../_actions/get-diet-history';
import type { DietHistoryItem } from '../../_store/diet-view-store';
import { useDietViewStore } from '../../_store/diet-view-store';

interface DietHistoryProviderProps {
  userId: string;
  serverFallbackHistory: DietHistoryItem[];
}

export function DietHistoryProvider({ userId, serverFallbackHistory }: DietHistoryProviderProps) {
  const [history, setHistory] = useState<DietHistoryItem[]>(serverFallbackHistory || []);
  const [isLoading, setIsLoading] = useState(false);

  const { setActiveDiet, setActiveTab } = useDietViewStore();

  useEffect(() => {
    const loadHistory = async () => {
      if (serverFallbackHistory.length > 0) {
        // Use the server data if available
        setHistory(serverFallbackHistory);
        return;
      }

      setIsLoading(true);
      try {
        const response = await getDietHistory(userId);
        if (response.success && response.data) {
          setHistory(response.data);
        }
      } catch (error) {
        console.error('Failed to load diet history:', error);
      } finally {
        setIsLoading(false);
      }
    };

    loadHistory();
  }, [userId, serverFallbackHistory]);

  if (isLoading) {
    return (
      <div className="flex justify-center p-8">
        <Loader2 className="h-6 w-6 animate-spin text-muted-foreground" />
      </div>
    );
  }

  if (history.length === 0) {
    return (
      <div className="text-center py-12">
        <p className="text-muted-foreground mb-4">No diet plans have been generated yet.</p>
        <Button
          variant="outline"
          className="border-green-200 dark:border-green-800/30"
          onClick={() => {
            // Handle navigation to generate tab
            const tabElement = document.querySelector('[data-state="inactive"][value="generate"]');
            if (tabElement) {
              (tabElement as HTMLElement).click();
            }
            // Alternative way: use the store to navigate
            setActiveTab('generate');
          }}
        >
          Generate your first diet plan
        </Button>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {history.map((item) => (
        <div
          key={item.id}
          className="p-4 border border-green-100/50 dark:border-green-800/30 rounded-lg hover:bg-gradient-to-br hover:from-green-50/50 hover:via-emerald-50/30 hover:to-green-50/50 dark:hover:from-green-950/50 dark:hover:via-emerald-950/30 dark:hover:to-green-950/50 transition-colors"
        >
          <div className="flex justify-between items-start mb-2">
            <h4 className="font-medium">{item.dietPlan.name}</h4>
            <span className="text-xs text-muted-foreground">
              {new Date(item.createdAt).toLocaleDateString()}
            </span>
          </div>

          <p className="text-sm text-muted-foreground mb-3 line-clamp-2">
            {item.dietPlan.description || 'No description available'}
          </p>

          <div className="flex flex-wrap gap-2 text-xs mb-3">
            <span className="bg-green-50 text-green-700 px-2 py-1 rounded dark:bg-green-900/30 dark:text-green-300">
              {item.dietPlan.targetCalories} kcal
            </span>
            <span className="bg-green-50 text-green-700 px-2 py-1 rounded dark:bg-green-900/30 dark:text-green-300">
              {Math.round(item.dietPlan.proteinRatio * 100)}% protein
            </span>
            <span className="bg-green-50 text-green-700 px-2 py-1 rounded dark:bg-green-900/30 dark:text-green-300">
              {item.dietPlan.meals.length} meals
            </span>
          </div>

          <Button
            variant="outline"
            size="sm"
            className="w-full border-green-200 dark:border-green-800/30 hover:bg-green-50 dark:hover:bg-green-900/30"
            onClick={() => {
              // Use setActiveDiet instead of setDietFromHistory
              setActiveDiet({
                clientName: item.clientName,
                dietPlan: item.dietPlan
              });
              
              // Navigate to the diet tab
              setActiveTab('diet');
            }}
          >
            View Diet Plan
          </Button>
        </div>
      ))}
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/query-provider.tsx

```tsx
'use client';

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { type ReactNode, useState } from 'react';

export function QueryProvider({ children }: { children: ReactNode }) {
  const [queryClient] = useState(() => new QueryClient({
    defaultOptions: {
      queries: {
        staleTime: 60 * 1000, // 1 minute
        gcTime: 5 * 60 * 1000, // 5 minutes
        refetchOnWindowFocus: false,
      },
    },
  }));

  return (
    <QueryClientProvider client={queryClient}>
      {children}
    </QueryClientProvider>
  );
} 
```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/tabs-wrapper.tsx

```tsx
'use client';

import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import React, { useState } from 'react';
import type { DietPlan } from '../../_actions /GetallDiets';
import { useDietViewStore } from '../_store/diet-view-store';
import type { TabType } from '../_store/diet-view-store';
import { DietForm } from './diet-form/diet-form';
import { DietFormSkeleton } from './diet-form/diet-form-skeleton';
import { DietHistory } from './diet-history/diet-history';
import DietResults from './diet-result/diet-results';
import DietSkeleton from './diet-result/diet-skeleton';

interface TabsWrapperProps {
  userId: string;
}

export function TabsWrapper({ userId }: TabsWrapperProps) {
  const { activeTab, setActiveTab, activeDiet, setActiveDiet } = useDietViewStore();
  const [isGenerating, setIsGenerating] = useState(false);

  // Handler to be passed to DietForm to set the generating state
  const handleGenerateStateChange = (generating: boolean) => {
    setIsGenerating(generating);
  };

  // Handler for Generate Diet Plan button in empty state
  const handleEmptyStateGenerate = () => {
    setActiveTab('generate');
  };

  return (
    <Tabs
      value={activeTab}
      onValueChange={(value: string) => setActiveTab(value as TabType)}
      className="w-full"
    >
      <div className="sticky top-0 z-30 bg-white/95 dark:bg-gray-950/95 backdrop-blur-sm pb-6">
        <TabsList className="grid grid-cols-3 w-full">
          <TabsTrigger value="generate">Generate</TabsTrigger>
          <TabsTrigger value="diet">Diet</TabsTrigger>
          <TabsTrigger value="history">History</TabsTrigger>
        </TabsList>
      </div>

      <TabsContent value="generate">
        {isGenerating ? (
          <DietFormSkeleton />
        ) : (
          <DietForm userId={userId} onGenerateStateChange={handleGenerateStateChange} />
        )}
      </TabsContent>

      <TabsContent value="diet">
        {isGenerating ? (
          <DietSkeleton />
        ) : activeDiet ? (
          <DietResults
            clientName={activeDiet.clientName}
            dietPlan={activeDiet.dietPlan}
            onSuccess={() => setActiveTab('history')}
            userId={userId}
          />
        ) : (
          <div className="flex flex-col items-center justify-center p-8 text-center">
            <h3 className="text-lg font-medium">No active diet plan</h3>
            <p className="text-sm text-gray-500 mt-2">Generate a new diet plan to see it here</p>
            <button
              type="button"
              onClick={handleEmptyStateGenerate}
              className="mt-4 px-4 py-2 bg-green-600 text-white rounded-md"
            >
              Generate Diet Plan
            </button>
          </div>
        )}
      </TabsContent>

      <TabsContent value="history">
        <DietHistory
          onSelectDiet={(diet) => {
            setActiveDiet(diet);
            setActiveTab('diet');
          }}
          userId={userId}
        />
      </TabsContent>
    </Tabs>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/tabs/diet-tabs.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { ChevronLeft, Loader2, Sparkles, Utensils } from 'lucide-react';
import { Suspense, useState } from 'react';
import type { DietPlan } from '../../../_actions /GetallDiets';
import { type DietHistoryItem, useDietViewStore } from '../../_store/diet-view-store';
import { DietForm } from '../diet-form/diet-form';
import DietResults from '../diet-result/diet-results';
import { DietHistoryProvider } from '../history/diet-history-provider';

interface GeneratedDiet {
  clientName: string;
  dietPlan: DietPlan;
}

interface DietTabsProps {
  userId: string;
  userName?: string;
  serverFallbackHistory: DietHistoryItem[]; // Updated type to match DietHistoryProvider's expected type
}

// Loading skeleton for the generate tab
function GenerateDietSkeleton() {
  return (
    <div className="space-y-6 p-6">
      {/* Form header skeleton */}
      <div className="space-y-4">
        <Skeleton className="h-8 w-48" />
        <Skeleton className="h-4 w-72" />
      </div>

      {/* Form fields skeleton */}
      <div className="space-y-4">
        {[1, 2, 3, 4, 5].map((i) => (
          <div key={`field-${i}`} className="space-y-2">
            <Skeleton className="h-4 w-24" />
            <Skeleton className="h-10 w-full" />
          </div>
        ))}
      </div>

      {/* Submit button skeleton */}
      <div className="flex justify-end">
        <Skeleton className="h-10 w-32" />
      </div>
    </div>
  );
}

// Loading skeleton for the history tab
function HistorySkeleton() {
  return (
    <div className="space-y-6 p-6">
      <h3 className="text-xl font-medium">Previously Generated Diet Plans</h3>
      <div className="space-y-4">
        {[1, 2, 3].map((i) => (
          <div key={`history-${i}`} className="p-4 border rounded-lg space-y-3">
            <div className="flex justify-between items-start">
              <Skeleton className="h-6 w-1/3" />
              <Skeleton className="h-5 w-20" />
            </div>
            <Skeleton className="h-4 w-3/4" />
            <div className="flex flex-wrap gap-2">
              <Skeleton className="h-8 w-24" />
              <Skeleton className="h-8 w-32" />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

export default function DietTabs({ userId, userName, serverFallbackHistory }: DietTabsProps) {
  // Use local state for activeTab
  const [activeTab, setActiveTab] = useState<'generate' | 'history' | 'diet'>('generate');

  const { activeDiet, setShowDietDetails } = useDietViewStore();

  const handleTabChange = (value: string) => {
    setActiveTab(value as 'generate' | 'history' | 'diet');

    // If switching away from diet tab, reset the diet view
    if (value !== 'diet') {
      setShowDietDetails(false);
    }
  };

  const handleBackToHistory = () => {
    setActiveTab('history');
    setShowDietDetails(false);
  };

  const handleDietGenerated = (diet: GeneratedDiet) => {
    console.log('Diet generated:', diet);
    // When a diet is generated, switch to the diet tab
    setActiveTab('diet');
    setShowDietDetails(true);
  };

  return (
    <Tabs value={activeTab} onValueChange={handleTabChange} className="space-y-8 ">
      <div className="sticky top-0 z-10 pb-4 pt-2 bg-gradient-to-b from-background via-background to-background/95 backdrop-blur-lg">
        <div className="container max-w-5xl mx-auto px-4">
          <div className="flex justify-center">
            <TabsList className="w-full max-w-md bg-gradient-to-r from-green-50/80 via-emerald-50/80 to-green-50/80 dark:from-green-950/80 dark:via-emerald-950/80 dark:to-green-950/80 border border-green-100/50 dark:border-green-800/30 shadow-md rounded-lg p-1.5">
              <TabsTrigger
                value="generate"
                className="flex-1 data-[state=active]:bg-gradient-to-br data-[state=active]:from-green-600/90 data-[state=active]:via-emerald-600/80 data-[state=active]:to-green-700/90 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-300 rounded-md py-2"
              >
                <Sparkles className="h-4 w-4 mr-2" />
                Generate
              </TabsTrigger>
              <TabsTrigger
                value="history"
                className="flex-1 data-[state=active]:bg-gradient-to-br data-[state=active]:from-green-600/90 data-[state=active]:via-emerald-600/80 data-[state=active]:to-green-700/90 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-300 rounded-md py-2"
              >
                <Utensils className="h-4 w-4 mr-2" />
                History
              </TabsTrigger>
              <TabsTrigger
                value="diet"
                className="flex-1 data-[state=active]:bg-gradient-to-br data-[state=active]:from-green-600/90 data-[state=active]:via-emerald-600/80 data-[state=active]:to-green-700/90 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-300 rounded-md py-2"
              >
                <Loader2 className="h-4 w-4 mr-2" />
                Diet
              </TabsTrigger>
            </TabsList>
          </div>
        </div>
      </div>

      <TabsContent
        value="generate"
        className="space-y-6 focus-visible:outline-none focus-visible:ring-0"
      >
        <div className="container max-w-5xl mx-auto px-4">
          <Suspense fallback={<GenerateDietSkeleton />}>
            <div className="bg-gradient-to-br from-green-50/50 via-emerald-50/30 to-green-50/50 dark:from-green-950/50 dark:via-emerald-950/30 dark:to-green-950/50 p-4 rounded-lg border border-green-100/50 dark:border-green-800/20 mb-6">
              <h3 className="text-xl font-medium">Generate a Diet Plan</h3>
              <p className="text-sm text-muted-foreground mt-1">
                Fill out the form below to create a personalized diet plan
              </p>
            </div>
            <DietForm onDietGenerated={handleDietGenerated} userId={userId} />
          </Suspense>
        </div>
      </TabsContent>

      <TabsContent value="history" className="focus-visible:outline-none focus-visible:ring-0">
        <div className="container max-w-5xl mx-auto px-4">
          <Suspense fallback={<HistorySkeleton />}>
            <div className="space-y-6">
              <div className="bg-gradient-to-br from-green-50/50 via-emerald-50/30 to-green-50/50 dark:from-green-950/50 dark:via-emerald-950/30 dark:to-green-950/50 p-4 rounded-lg border border-green-100/50 dark:border-green-800/20 mb-6">
                <h3 className="text-xl font-medium">Previously Generated Diet Plans</h3>
                <p className="text-sm text-muted-foreground mt-1">
                  View and load your previously created diet plans
                </p>
              </div>
              <DietHistoryProvider userId={userId} serverFallbackHistory={serverFallbackHistory} />
            </div>
          </Suspense>
        </div>
      </TabsContent>

      <TabsContent value="diet" className="focus-visible:outline-none focus-visible:ring-0">
        <div className="container max-w-5xl mx-auto px-4">
          {activeDiet ? (
            <div className="space-y-6">
              <div className="bg-gradient-to-br from-green-50/50 via-emerald-50/30 to-green-50/50 dark:from-green-950/50 dark:via-emerald-950/30 dark:to-green-950/50 p-4 rounded-lg border border-green-100/50 dark:border-green-800/20 flex items-center justify-between">
                <Button
                  variant="ghost"
                  size="sm"
                  className="flex items-center gap-1 text-muted-foreground hover:text-foreground"
                  onClick={handleBackToHistory}
                >
                  <ChevronLeft className="h-4 w-4" />
                  <span>Back to history</span>
                </Button>
                <div className="text-sm">
                  Diet plan for:{' '}
                  <span className="font-medium text-green-700 dark:text-green-400">
                    {activeDiet.clientName}
                  </span>
                </div>
              </div>

              <DietResults
                dietPlan={activeDiet.dietPlan}
                onSuccess={() => {
                  // After saving, you might want to go back to history
                  handleBackToHistory();
                }}
                userId={userId}
                userName={userName}
                clientName={activeDiet.clientName}
              />
            </div>
          ) : (
            <div className="bg-white/70 dark:bg-gray-950/70  border border-green-100/50 dark:border-green-800/30 rounded-lg shadow-sm">
              <div className="flex flex-col items-center justify-center py-16 text-center px-4">
                <div className="w-16 h-16 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/40 dark:to-emerald-900/40 flex items-center justify-center mb-4 shadow-inner">
                  <Utensils className="h-8 w-8 text-green-600/70 dark:text-green-400/70" />
                </div>
                <h3 className="text-xl font-medium mb-2">No Diet Plan Selected</h3>
                <p className="text-muted-foreground max-w-md mb-6">
                  Please select a diet plan from your history or generate a new one to view it here.
                </p>
                <div className="flex gap-2">
                  <Button
                    variant="outline"
                    onClick={() => setActiveTab('history')}
                    className="gap-1 border-green-200 dark:border-green-800/30"
                  >
                    <ChevronLeft className="h-4 w-4" />
                    Go to History
                  </Button>
                  <Button
                    variant="default"
                    onClick={() => setActiveTab('generate')}
                    className="gap-1 bg-gradient-to-br from-green-600/90 via-emerald-600/80 to-green-700/90 hover:from-green-600 hover:to-emerald-600 text-white shadow-md"
                  >
                    <Sparkles className="h-4 w-4" />
                    Generate New Diet Plan
                  </Button>
                </div>
              </div>
            </div>
          )}
        </div>
      </TabsContent>
    </Tabs>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/tabs/tabs-wrapper.tsx

```tsx
'use client';

import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { useQueryClient } from '@tanstack/react-query';
import React, { useState } from 'react';
import type { DietPlan } from '../../../_actions /GetallDiets';
import type { UserData } from '../../_actions/get-user-by-id';
import { useDietViewStore } from '../../_store/diet-view-store';
import type { TabType } from '../../_store/diet-view-store';
import { DietForm } from '../diet-form/diet-form';
import { DietFormSkeleton } from '../diet-form/diet-form-skeleton';
import { DietHistory } from '../diet-history/diet-history';
import { DIET_PLANS_QUERY_KEY } from '../diet-history/use-diet-history';
import DietResults from '../diet-result/diet-results';
import DietSkeleton from '../diet-result/diet-skeleton';

interface TabsWrapperProps {
  userId: string;
  userData?: UserData | null;
}

export function TabsWrapper({ userId, userData }: TabsWrapperProps) {
  const { activeTab, setActiveTab, activeDiet, setActiveDiet } = useDietViewStore();
  const [isGenerating, setIsGenerating] = useState(false);
  const queryClient = useQueryClient();

  // Handler to be passed to DietForm to set the generating state
  const handleGenerateStateChange = (generating: boolean) => {
    setIsGenerating(generating);
  };

  // Handler for when a diet is generated
  const handleDietGenerated = (diet: { clientName: string; dietPlan: DietPlan }) => {
    // This function is called when a diet is successfully generated
    // We can prefetch the diet history data here to ensure it's up to date
    queryClient.invalidateQueries({ queryKey: [DIET_PLANS_QUERY_KEY, userId] });
  };

  // Handler for when a diet is saved
  const handleDietSaved = () => {
    // Invalidate the diet history query to refresh the data
    queryClient.invalidateQueries({ queryKey: [DIET_PLANS_QUERY_KEY] });
    // Switch to history tab after diet is saved
    setActiveTab('history');
  };

  // Handler for Generate Diet Plan button in empty state
  const handleEmptyStateGenerate = () => {
    setActiveTab('generate');
  };

  return (
    <Tabs
      value={activeTab}
      onValueChange={(value: string) => setActiveTab(value as TabType)}
      className="w-full"
    >
      <div className="sticky top-0 z-30 bg-white/95 dark:bg-gray-950/95 backdrop-blur-sm pb-6">
        <TabsList className="grid grid-cols-3 w-full">
          <TabsTrigger value="generate">Generate</TabsTrigger>
          <TabsTrigger value="diet">Diet</TabsTrigger>
          <TabsTrigger value="history">History</TabsTrigger>
        </TabsList>
      </div>

      <TabsContent value="generate">
        {isGenerating ? (
          <DietFormSkeleton />
        ) : (
          <DietForm
            userId={userId}
            userData={userData}
            onGenerateStateChange={handleGenerateStateChange}
            onDietGenerated={handleDietGenerated}
          />
        )}
      </TabsContent>

      <TabsContent value="diet">
        {isGenerating ? (
          <DietSkeleton />
        ) : activeDiet ? (
          <DietResults
            clientName={activeDiet.clientName}
            dietPlan={activeDiet.dietPlan}
            onSuccess={handleDietSaved}
            userId={userId}
          />
        ) : (
          <div className="flex flex-col items-center justify-center p-8 text-center">
            <h3 className="text-lg font-medium">No active diet plan</h3>
            <p className="text-sm text-gray-500 mt-2">Generate a new diet plan to see it here</p>
            <button
              type="button"
              onClick={handleEmptyStateGenerate}
              className="mt-4 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-700 dark:hover:bg-indigo-600 text-white rounded-md transition-colors"
            >
              Generate Diet Plan
            </button>
          </div>
        )}
      </TabsContent>

      <TabsContent value="history">
        <DietHistory
          onSelectDiet={(diet) => {
            setActiveDiet(diet);
            setActiveTab('diet');
          }}
          userId={userId}
        />
      </TabsContent>
    </Tabs>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_components/user-profile/user-profile-card.tsx

```tsx
'use client';

import { Badge } from '@/components/ui/badge';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { CalendarDays, Clipboard, User2 } from 'lucide-react';
import type { UserData } from '../../_actions/get-user-by-id';

interface UserProfileCardProps {
  user: UserData | null;
}

export default function UserProfileCard({ user }: UserProfileCardProps) {
  if (!user) {
    return (
      <Card className="h-full">
        <CardHeader className="pb-2">
          <CardTitle className="text-lg font-semibold">User Profile</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="text-center py-8 text-muted-foreground">
            <User2 className="h-12 w-12 mx-auto mb-3 opacity-20" />
            <p>User information not available</p>
          </div>
        </CardContent>
      </Card>
    );
  }

  const { name, email, healthProfile } = user;

  return (
    <Card className="h-full">
      <CardHeader className="pb-2">
        <CardTitle className="text-lg font-semibold">User Profile</CardTitle>
      </CardHeader>
      <CardContent className="space-y-6">
        <div className="space-y-1.5">
          <h3 className="text-xl font-semibold">{name}</h3>
          <p className="text-sm text-muted-foreground">{email}</p>
        </div>

        <div className="space-y-3">
          <div className="flex items-center gap-2 text-sm text-muted-foreground">
            <CalendarDays className="h-4 w-4" />
            <span>Member since {user.createdAt ? new Date(user.createdAt).toLocaleDateString() : 'Unknown'}</span>
          </div>
        </div>

        {healthProfile && (
          <>
            <div className="pt-3 border-t">
              <h4 className="text-sm font-medium mb-2">Health Profile</h4>
              <dl className="grid grid-cols-2 gap-x-4 gap-y-2">
                {healthProfile.age && (
                  <ProfileDetail label="Age" value={`${healthProfile.age} years`} />
                )}
                {healthProfile.gender && (
                  <ProfileDetail label="Gender" value={healthProfile.gender} />
                )}
                {healthProfile.height && (
                  <ProfileDetail label="Height" value={`${healthProfile.height} cm`} />
                )}
                {healthProfile.weight && (
                  <ProfileDetail label="Weight" value={`${healthProfile.weight} kg`} />
                )}
                {healthProfile.fitnessLevel && (
                  <ProfileDetail
                    label="Fitness Level"
                    value={healthProfile.fitnessLevel}
                    span={2}
                  />
                )}
              </dl>
            </div>

            {healthProfile.goals && healthProfile.goals.length > 0 && (
              <div className="pt-3 border-t">
                <h4 className="text-sm font-medium mb-2">Fitness Goals</h4>
                <div className="flex flex-wrap gap-1.5">
                  {healthProfile.goals.map((goal) => (
                    <Badge key={goal} variant="outline" className="bg-blue-50">
                      {goal}
                    </Badge>
                  ))}
                </div>
              </div>
            )}

            {healthProfile.dietPreferences && healthProfile.dietPreferences.length > 0 && (
              <div className="pt-3 border-t">
                <h4 className="text-sm font-medium mb-2">Diet Preferences</h4>
                <div className="flex flex-wrap gap-1.5">
                  {healthProfile.dietPreferences.map((pref) => (
                    <Badge
                      key={pref}
                      variant="outline"
                      className="bg-green-50 border-green-200 text-green-700"
                    >
                      {pref}
                    </Badge>
                  ))}
                </div>
              </div>
            )}

            {healthProfile.allergies && healthProfile.allergies.length > 0 && (
              <div className="pt-3 border-t">
                <h4 className="text-sm font-medium mb-2">Allergies</h4>
                <div className="flex flex-wrap gap-1.5">
                  {healthProfile.allergies.map((allergy) => (
                    <Badge
                      key={allergy}
                      variant="outline"
                      className="bg-red-50 border-red-200 text-red-700"
                    >
                      {allergy}
                    </Badge>
                  ))}
                </div>
              </div>
            )}

            {healthProfile.medicalConditions && healthProfile.medicalConditions.length > 0 && (
              <div className="pt-3 border-t">
                <h4 className="text-sm font-medium mb-2">Medical Conditions</h4>
                <div className="flex flex-wrap gap-1.5">
                  {healthProfile.medicalConditions.map((condition) => (
                    <Badge
                      key={condition}
                      variant="outline"
                      className="bg-amber-50 border-amber-200 text-amber-700"
                    >
                      {condition}
                    </Badge>
                  ))}
                </div>
              </div>
            )}
          </>
        )}
      </CardContent>
    </Card>
  );
}

function ProfileDetail({
  label,
  value,
  span = 1,
}: {
  label: string;
  value: string;
  span?: number;
}) {
  return (
    <div className={`col-span-${span}`}>
      <dt className="text-xs text-muted-foreground">{label}</dt>
      <dd className="text-sm font-medium">{value}</dd>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/_store/diet-view-store.ts

```ts
'use client';

import { create } from 'zustand';
import { persist } from 'zustand/middleware';
import type { DietPlan } from '../../_actions /GetallDiets';

export interface DietHistoryItem {
  id: string;
  clientName: string;
  dietPlan: DietPlan;
  createdAt: string;
  updatedAt: string;
  userId: string;
}

export type TabType = 'generate' | 'diet' | 'history';

interface DietViewStore {
  // State
  activeTab: TabType;
  activeDiet: { clientName: string; dietPlan: DietPlan } | null;
  showDietDetails: boolean;

  // Actions
  setActiveTab: (tab: TabType) => void;
  setActiveDiet: (diet: { clientName: string; dietPlan: DietPlan } | null) => void;
  setShowDietDetails: (show: boolean) => void;
  reset: () => void;

  // Storage actions
  saveDietToLocalStorage: (
    diet: { clientName: string; dietPlan: DietPlan },
    userId: string,
  ) => string;
  getSavedDiets: (userId?: string) => DietHistoryItem[];
  clearDietHistory: () => void;
}

// Helper to generate a unique ID
const generateId = () => `diet-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;

export const useDietViewStore = create<DietViewStore>()(
  persist(
    (set, get) => ({
      // Initial state
      activeTab: 'generate',
      activeDiet: null,
      showDietDetails: false,

      // Actions
      setActiveTab: (tab) => set({ activeTab: tab }),
      setActiveDiet: (diet) => set({ activeDiet: diet }),
      setShowDietDetails: (show) => set({ showDietDetails: show }),
      reset: () =>
        set({
          activeTab: 'generate',
          activeDiet: null,
          showDietDetails: false,
        }),

      // Storage actions
      saveDietToLocalStorage: (diet, userId) => {
        const dietId = generateId();

        // Create the diet history item
        const dietHistoryItem: DietHistoryItem = {
          id: dietId,
          clientName: diet.clientName,
          dietPlan: diet.dietPlan,
          createdAt: new Date().toISOString(),
          updatedAt: new Date().toISOString(),
          userId: userId,
        };

        // Get existing saved diets
        const existingSavedDiets = get().getSavedDiets();

        // Add the new diet
        const updatedDiets = [...existingSavedDiets, dietHistoryItem];

        // Save the updated diets to localStorage
        try {
          if (typeof window !== 'undefined') {
            localStorage.setItem('gym-navigator-saved-diets', JSON.stringify(updatedDiets));
          }
        } catch (error) {
          console.error('Failed to save diet to localStorage:', error);
        }

        return dietId;
      },

      getSavedDiets: (userId) => {
        if (typeof window === 'undefined') return [];

        try {
          const savedDietsStr = localStorage.getItem('gym-navigator-saved-diets');
          if (!savedDietsStr) return [];

          const allSavedDiets = JSON.parse(savedDietsStr) as DietHistoryItem[];

          // Filter by userId if provided
          return userId ? allSavedDiets.filter((diet) => diet.userId === userId) : allSavedDiets;
        } catch (error) {
          console.error('Failed to retrieve saved diets:', error);
          return [];
        }
      },

      clearDietHistory: () => {
        if (typeof window !== 'undefined') {
          try {
            localStorage.removeItem('gym-navigator-saved-diets');
          } catch (error) {
            console.error('Failed to clear diet history:', error);
          }
        }
      },
    }),
    {
      name: 'diet-view-store', // unique name for localStorage
      // Only persist specific keys
      partialize: (state) => ({
        activeTab: state.activeTab,
        activeDiet: state.activeDiet,
      }),
    },
  ),
);

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/loading.tsx

```tsx
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { DietFormSkeleton } from './_components/diet-form/diet-form-skeleton';

export default function Loading() {
  return (
    <div className="container mx-auto p-4">
      <Tabs defaultValue="generate" className="w-full">
        <div className="sticky top-0 z-30 bg-white/95 dark:bg-gray-950/95 backdrop-blur-sm pb-6">
          <TabsList className="grid grid-cols-3 w-full">
            <TabsTrigger value="generate" className="bg-green-50 dark:bg-green-900/30">
              Generate
            </TabsTrigger>
            <TabsTrigger value="diet" disabled>
              Diet
            </TabsTrigger>
            <TabsTrigger value="history" disabled>
              History
            </TabsTrigger>
          </TabsList>
        </div>

        <TabsContent value="generate">
          <DietFormSkeleton />
        </TabsContent>
      </Tabs>
    </div>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/page.tsx

```tsx
import { Card } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';
import { Apple, ChevronLeft, Salad, Utensils } from 'lucide-react';
import Link from 'next/link';
import React from 'react';
import { Suspense } from 'react';
import { getUserById } from './_actions/get-user-by-id';
import { DietHistoryProvider } from './_components/diet-history/diet-history-provider';
import { QueryProvider } from './_components/query-provider';
import { TabsWrapper } from './_components/tabs/tabs-wrapper';
import UserProfileCard from './_components/user-profile/user-profile-card';

// Pre-generate decoration positions
const decorations = [
  { left: '0%', top: '0%', transform: 'translate(20%, 30%)' },
  { left: '25%', top: '0%', transform: 'translate(-10%, 40%)' },
  { left: '50%', top: '0%', transform: 'translate(15%, -20%)' },
  { left: '75%', top: '0%', transform: 'translate(5%, 25%)' },
  { left: '0%', top: '33%', transform: 'translate(-5%, 10%)' },
  { left: '25%', top: '33%', transform: 'translate(25%, -15%)' },
  { left: '50%', top: '33%', transform: 'translate(-20%, 20%)' },
  { left: '75%', top: '33%', transform: 'translate(10%, -10%)' },
  { left: '0%', top: '66%', transform: 'translate(15%, -25%)' },
  { left: '25%', top: '66%', transform: 'translate(-15%, 5%)' },
  { left: '50%', top: '66%', transform: 'translate(25%, 15%)' },
  { left: '75%', top: '66%', transform: 'translate(-5%, -5%)' },
];

export default async function AssignDietPlanWithAI({
  searchParams,
}: {
  searchParams: Promise<{ userId?: string }>;
}) {
  // Get userId from search params
  const userId = (await searchParams).userId || 'defaultUserId';

  // Fetch user data
  const response = await getUserById(userId);
  const user = response.success && response.data ? response.data : null;

  return (
    <DietHistoryProvider>
      <div className="container max-w-5xl pb-16">
        {/* Navigation */}
        <Link
          href="/dashboard/trainer/diet/assigndietplan"
          className="inline-flex items-center text-muted-foreground hover:text-foreground mb-8 py-2 transition-colors"
        >
          <ChevronLeft className="h-4 w-4 mr-1" />
          <span>Back to diet plans</span>
        </Link>

          <div className="space-y-8">
            {/* Hero Banner */}
            <div className="relative overflow-hidden rounded-xl bg-gradient-to-br from-indigo-600/90 via-blue-600/80 to-indigo-700/90 p-8 border border-indigo-500/20 shadow-lg text-white">
              {/* Decorative background patterns */}
              <div className="absolute inset-0 opacity-5">
                <div className="absolute top-0 right-0 transform rotate-45 translate-x-1/3 -translate-y-1/2">
                  <Apple className="h-48 w-48" strokeWidth={0.5} />
                </div>
                <div className="absolute bottom-0 left-0 transform -rotate-12 -translate-x-1/4 translate-y-1/3">
                  <Salad className="h-40 w-40" strokeWidth={0.5} />
                </div>
                <div className="grid grid-cols-8 grid-rows-8 h-full w-full">
                  {decorations.map((style, i) => (
                    <div
                      key={`deco-${i}-${style.left}-${style.top}`}
                      className="flex items-center justify-center opacity-20"
                      style={{
                        position: 'absolute',
                        left: style.left,
                        top: style.top,
                        transform: style.transform,
                      }}
                    >
                      <Utensils className="h-8 w-8" strokeWidth={1} />
                    </div>
                  ))}
                </div>
              </div>

              {/* Glowing effects */}
              <div className="absolute top-1/2 right-1/4 h-40 w-40 rounded-full bg-blue-400/30 blur-3xl" />
              <div className="absolute bottom-0 left-1/4 h-32 w-32 rounded-full bg-indigo-300/20 blur-3xl" />

              <div className="relative z-10">
                <div className="inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm text-white px-4 py-1.5 rounded-full text-sm font-medium mb-4 shadow-sm">
                  <Utensils className="h-4 w-4" />
                  AI-Powered Diet Planner
                </div>

                <h1 className="text-3xl sm:text-4xl font-bold tracking-tight mb-3 drop-shadow-sm">
                  Create <span className="text-blue-200">Perfect Diet Plans</span> in Seconds
                </h1>

                <p className="max-w-2xl text-base text-indigo-100/90 sm:text-lg">
                  Let our AI design personalized nutrition plans tailored to your client's specific
                  needs and health goals — turning hours of planning into moments.
                </p>

                {/* Decorative icons */}
                <div className="absolute right-8 bottom-6 hidden lg:flex items-center gap-3">
                  <div className="h-10 w-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center">
                    <Apple className="h-5 w-5 text-white" />
                  </div>
                  <div className="h-10 w-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center">
                    <Salad className="h-5 w-5 text-white" />
                  </div>
                  <div className="h-10 w-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center">
                    <Utensils className="h-5 w-5 text-white" />
                  </div>
                </div>
              </div>
            </div>

            {/* Two-column layout */}
            <div className="grid grid-cols-1 md:grid-cols-12 gap-6">
              {/* Left column - User Profile */}
              <div className="md:col-span-4">
                <Suspense fallback={<UserProfileSkeleton />}>
                  <UserProfileCard user={user} />
                </Suspense>
              </div>

            {/* Right column - Diet Form */}
            <div className="md:col-span-8">
              <TabsWrapper userId={userId} userData={user} />
            </div>
          </div>
        </div>
      </div>
    </DietHistoryProvider>
  );
}

function UserProfileSkeleton() {
  return (
    <Card className="p-6 h-full">
      <div className="space-y-4">
        <Skeleton className="h-4 w-3/4" />
        <Skeleton className="h-10 w-full" />
        <Skeleton className="h-4 w-1/2" />
        <div className="py-2">
          <Skeleton className="h-4 w-full" />
          <Skeleton className="h-4 w-full mt-2" />
          <Skeleton className="h-4 w-3/4 mt-2" />
        </div>
        <div className="flex flex-col gap-2">
          <Skeleton className="h-6 w-1/3" />
          <div className="grid grid-cols-2 gap-2">
            <Skeleton className="h-10 w-full" />
            <Skeleton className="h-10 w-full" />
          </div>
        </div>
      </div>
    </Card>
  );
}

```

# app/dashboard/trainer/diet/assigndietplan/assigndietplanwithai/types/dietGenerationSchema.ts

```ts
import { z } from 'zod';

export const dietGenerationSchema = z.object({
  dietPreference: z.string().min(1, { message: "Diet preference is required" }),
  medicalConditions: z.array(z.string()).min(1, { message: "At least one medical condition must be selected" }),
  location: z.string().min(1, { message: "Location is required" }),
  country: z.string().min(1, { message: "Country is required" }),
  targetCalories: z.number().positive({ message: "Target calories must be a positive number" }),
  specialInstructions: z.string().optional(),
});

export type DietGenerationParams = z.infer<typeof dietGenerationSchema>;

```

# app/dashboard/trainer/diet/assigndietplan/page.tsx

```tsx
import Link from 'next/link';
import { Suspense } from 'react';
import { getAllDietPlans } from './_actions /GetallDiets';
import { getUsersAssignedToTrainer } from './_actions /GetassignedUserDietInfo';
import AssignDietToUsers from './_components/AssignDietToUsers';

export default async function Page() {
  const [users, dietPlans] = await Promise.all([getUsersAssignedToTrainer(), getAllDietPlans()]);

  return (
    <div className="min-h-screen bg-gray-50">
      <main className="p-6">
        <div className="mb-6 flex justify-between items-center">
          <h1 className="text-2xl font-semibold">Assign Diet Plans</h1>
        </div>
        <Suspense fallback={<div>Loading...</div>}>
          <AssignDietToUsers users={users} dietPlans={dietPlans} />
        </Suspense>
      </main>
    </div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_actions/assign-diet-plan.ts

```ts
'use client';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import type { AxiosError } from 'axios';
import { toast } from 'sonner';

export interface AssignDietPlanInput {
  userId: number;
  dietPlanId: number;
}

// Define interface for user data structure
interface UserData {
  dietPlanId?: number;
  [key: string]: unknown; // For other properties in the user data
}

export function useAssignDietPlan() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ userId, dietPlanId }: AssignDietPlanInput) => {
      const trainerAxios = await TrainerReqConfig();

      const response = await trainerAxios.post('/diet/assigndiettouser', {
        userId,
        dietPlanId,
      });

      if (response.status !== 200) {
        throw new Error(response.data.msg || 'Failed to assign diet plan');
      }

      return response.data.data;
    },
    onMutate: async (newAssignment) => {
      // Cancel outgoing refetches to avoid overwriting optimistic update
      await queryClient.cancelQueries({
        queryKey: ['user', newAssignment.userId],
      });
      await queryClient.cancelQueries({
        queryKey: ['userDietPlan', newAssignment.userId],
      });

      // Get current data
      const previousUserData = queryClient.getQueryData(['user', newAssignment.userId]);

      // Optimistically update the cache
      queryClient.setQueryData(['user', newAssignment.userId], (old: UserData | undefined) => {
        if (!old) return old;
        return {
          ...old,
          dietPlanId: newAssignment.dietPlanId,
          isOptimisticUpdate: true,
        };
      });

      // Return context with previous values
      return { previousUserData };
    },
    onSuccess: (_, variables) => {
      // Update queries that may be affected
      queryClient.invalidateQueries({
        queryKey: ['user', variables.userId],
      });
      queryClient.invalidateQueries({
        queryKey: ['userDietPlan', variables.userId],
      });
      queryClient.invalidateQueries({
        queryKey: ['userAssignments'],
      });

      toast.success('Diet plan assigned successfully');
    },
    onError: (error, variables, context) => {
      // Rollback optimistic update on error
      if (context?.previousUserData) {
        queryClient.setQueryData(['user', variables.userId], context.previousUserData);
      }

      const axiosError = error as AxiosError<{ msg: string }>;
      toast.error(axiosError.response?.data?.msg || 'Failed to assign diet plan');
    },
  });
}

```

# app/dashboard/trainer/diet/createdietplan/_actions/create-diet-plan.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { AxiosError } from 'axios';

// Types matching the backend expectations
export interface MealIngredientInput {
  name: string;
  quantity: number;
  unit: string;
  calories: number;
  protein?: number | null;
  carbs?: number | null;
  fats?: number | null;
}

export interface MealInput {
  name: string;
  timeOfDay: string;
  calories: number;
  protein: number;
  carbs: number;
  fats: number;
  instructions?: string | null;
  order: number;
  ingredients: MealIngredientInput[];
}

export interface DietPlanInput {
  name: string;
  description?: string | null;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  meals: MealInput[];
}

// Replace 'any' with a more specific generic type or unknown
export interface ApiResponse<T = unknown> {
  success: boolean;
  message: string;
  data?: T;
  error?: string;
}

export async function createDietPlan(dietPlan: DietPlanInput): Promise<ApiResponse> {
  'use server'; // Ensure this is marked as a server action

  const trainerAxios = await TrainerReqConfig();

  try {
    // Add order to meals if not present
    const mealsWithOrder = dietPlan.meals.map((meal, index) => ({
      ...meal,
      order: meal.order || index + 1,
    }));

    // Transform data from frontend format to backend format if needed
    const response = await trainerAxios.post('/diet/createdietplan', {
      ...dietPlan,
      meals: mealsWithOrder,
    });

    if (response.status === 201) {
      return {
        success: true,
        message: 'Diet plan created successfully',
        data: response.data.data,
      };
    }
    throw new Error(response.data.msg || 'Failed to create diet plan');
  } catch (error: unknown) {
    const axiosError = error as AxiosError<{ msg: string }>;
    console.error('Error creating diet plan:', axiosError);
    return {
      success: false,
      message: axiosError.response?.data?.msg || 'Failed to create diet plan',
    };
  }
}

```

# app/dashboard/trainer/diet/createdietplan/_actions/update-diet-plan.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { AxiosError } from 'axios';
import type { ApiResponse } from './create-diet-plan';

export interface DietPlanUpdateInput {
  id: number;
  name?: string;
  description?: string | null;
  targetCalories?: number;
  proteinRatio?: number;
  carbsRatio?: number;
  fatsRatio?: number;
  // We don't include meals here as they might need dedicated update endpoints
}

export async function updateDietPlan(dietPlan: DietPlanUpdateInput): Promise<ApiResponse> {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.put('/diet/updatedietplan', dietPlan);

    if (response.status === 200) {
      return {
        success: true,
        message: 'Diet plan updated successfully',
        data: response.data.data,
      };
    }
    throw new Error(response.data.msg || 'Failed to update diet plan');
  } catch (error: unknown) {
    const axiosError = error as AxiosError<{ msg: string }>;
    console.error('Error updating diet plan:', axiosError);
    return {
      success: false,
      message: axiosError.response?.data?.msg || 'Failed to update diet plan',
    };
  }
}

```

# app/dashboard/trainer/diet/createdietplan/_actions/use-diet-plan-mutation.ts

```ts
'use client';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import { toast } from 'sonner';

interface DietPlanResponse {
  id: number;
  name: string;
  description?: string | null;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  createdAt: string;
  updatedAt: string;
  // Add other fields from backend response
}

// Define the DietPlanInput type
export interface DietPlanInput {
  name: string;
  description: string | null;
  targetCalories: number;
  proteinRatio: number;
  carbsRatio: number;
  fatsRatio: number;
  meals: {
    name: string;
    timeOfDay: string;
    calories: number;
    protein: number;
    carbs: number;
    fats: number;
    instructions: string | null;
    ingredients: Array<{
      name: string;
      quantity: number;
      unit: string;
      calories: number;
      protein?: number | null;
      carbs?: number | null;
      fats?: number | null;
    }>;
    order?: number;
  }[];
}

// Define the DietPlanUpdateInput type
export interface DietPlanUpdateInput extends DietPlanInput {
  id: number;
}

export interface Meal {
  name: string;
  foods: Food[];
}

export interface Food {
  name: string;
  quantity: string;
  calories: number;
}

export function useDietPlanMutation() {
  const queryClient = useQueryClient();

  const createDietPlanMutation = useMutation({
    mutationFn: async (dietPlan: DietPlanInput) => {
      const trainerAxios = await TrainerReqConfig();

      // Add order to meals if not present
      const mealsWithOrder = dietPlan.meals.map((meal, index: number) => ({
        ...meal,
        order: meal.order || index + 1,
      }));

      const response = await trainerAxios.post('/diet/createdietplan', {
        ...dietPlan,
        meals: mealsWithOrder,
      });

      if (response.status !== 201) {
        throw new Error(response.data.msg || 'Failed to create diet plan');
      }

      return response.data.data as DietPlanResponse;
    },
    onSuccess: () => {
      // Invalidate relevant queries
      queryClient.invalidateQueries({ queryKey: ['dietPlans'] });
      toast.success('Diet plan created successfully');
    },
    onError: (error: Error) => {
      console.error('Error creating diet plan:', error);
      toast.error(error.message || 'Failed to create diet plan');
    },
  });

  const updateDietPlanMutation = useMutation({
    mutationFn: async (dietPlan: DietPlanUpdateInput) => {
      const trainerAxios = await TrainerReqConfig();
      const response = await trainerAxios.put('/diet/updatedietplan', dietPlan);

      if (response.status !== 200) {
        throw new Error(response.data.msg || 'Failed to update diet plan');
      }

      return response.data.data as DietPlanResponse;
    },
    onSuccess: (_, variables) => {
      // Update the diet plan in the cache
      queryClient.invalidateQueries({ queryKey: ['dietPlans'] });
      queryClient.invalidateQueries({ queryKey: ['dietPlan', variables.id] });
      toast.success('Diet plan updated successfully');
    },
    onError: (error: Error) => {
      console.error('Error updating diet plan:', error);
      toast.error(error.message || 'Failed to update diet plan');
    },
  });

  return {
    createDietPlanMutation,
    updateDietPlanMutation,
  };
}

// Add proper types to parameters
export const calculateTotalCalories = (meals: Meal[]): number => {
  return meals.reduce((total, meal: Meal, index: number) => {
    console.log('meal', meal, index);
    // ...existing code...
    return total;
  }, 0);
};

```

# app/dashboard/trainer/diet/createdietplan/_components/create-diet-plan.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { useQueryClient } from '@tanstack/react-query';
import { AnimatePresence } from 'framer-motion';
import { ArrowRight, Save } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import { toast } from 'sonner';
import { createDietPlan } from '../_actions/create-diet-plan';
import type { DietPlanInterface, MealInterface } from './diet-plan-types';
import ProgressSteps from './progress-steps';
import StepOne from './steps/step-one';
import StepThree from './steps/step-three';
import StepTwo from './steps/step-two';

const DEFAULT_DIET_PLAN: DietPlanInterface = {
  name: '',
  description: '',
  targetCalories: 2000,
  macroSplit: {
    protein: 30,
    carbs: 40,
    fats: 30,
  },
  meals: [],
};

const DEFAULT_MEAL: MealInterface = {
  name: '',
  time: '',
  calories: 0,
  protein: 0,
  carbs: 0,
  fats: 0,
  ingredients: [],
  instructions: '',
  order: 0,
};

export default function CreateDietPlan() {
  const router = useRouter();
  const queryClient = useQueryClient();
  const [isSubmitting, setIsSubmitting] = useState(false);

  const [currentStep, setCurrentStep] = useState(() => {
    if (typeof window !== 'undefined') {
      return Number.parseInt(localStorage.getItem('dietPlanStep') || '1');
    }
    return 1;
  });

  const [dietPlan, setDietPlan] = useState<DietPlanInterface>(() => {
    if (typeof window !== 'undefined') {
      const savedPlan = localStorage.getItem('dietPlanData');
      return savedPlan ? JSON.parse(savedPlan) : DEFAULT_DIET_PLAN;
    }
    return DEFAULT_DIET_PLAN;
  });

  const [currentMeal, setCurrentMeal] = useState<MealInterface>(() => {
    if (typeof window !== 'undefined') {
      const savedMeal = localStorage.getItem('currentMealData');
      return savedMeal ? JSON.parse(savedMeal) : DEFAULT_MEAL;
    }
    return DEFAULT_MEAL;
  });

  // Save to localStorage whenever data changes
  useEffect(() => {
    localStorage.setItem('dietPlanStep', currentStep.toString());
    localStorage.setItem('dietPlanData', JSON.stringify(dietPlan));
    localStorage.setItem('currentMealData', JSON.stringify(currentMeal));
  }, [currentStep, dietPlan, currentMeal]);

  // Add checkpoint saving logic
  const saveCheckpoint = (meal: MealInterface) => {
    const checkpoints = JSON.parse(localStorage.getItem('dietPlanCheckpoints') || '[]');
    checkpoints.push({
      step: currentStep,
      meal: meal,
      timestamp: new Date().toISOString(),
    });
    localStorage.setItem('dietPlanCheckpoints', JSON.stringify(checkpoints));
    toast.success('Progress saved');
  };

  // Handle submission using server action
  const handleSubmit = async () => {
    try {
      // Validation checks
      if (!dietPlan.name) {
        toast.error('Please enter a plan name');
        return;
      }

      if (dietPlan.meals.length === 0) {
        toast.error('Please add at least one meal');
        return;
      }

      const total =
        dietPlan.macroSplit.protein + dietPlan.macroSplit.carbs + dietPlan.macroSplit.fats;
      if (total !== 100) {
        toast.error('Macro split percentages must add up to 100%');
        return;
      }

      // Prepare data for submission
      const dietPlanData = {
        name: dietPlan.name,
        description: dietPlan.description,
        targetCalories: dietPlan.targetCalories,
        proteinRatio: dietPlan.macroSplit.protein,
        carbsRatio: dietPlan.macroSplit.carbs,
        fatsRatio: dietPlan.macroSplit.fats,
        meals: dietPlan.meals.map((meal, index) => ({
          name: meal.name,
          timeOfDay: meal.time,
          calories: meal.calories,
          protein: meal.protein,
          carbs: meal.carbs,
          fats: meal.fats,
          instructions: meal.instructions,
          order: index + 1,
          ingredients: meal.ingredients.map((ingredient) => ({
            name: ingredient,
            quantity: 1,
            unit: 'serving',
            calories: 0,
            protein: 0,
            carbs: 0,
            fats: 0,
          })),
        })),
      };

      // Optimistically update UI
      const optimisticId = Date.now();

      // Add optimistic data to the cache with proper typing
      queryClient.setQueryData(['dietPlans'], (old: Array<{ id: number }> | undefined) => {
        const optimisticDietPlan = {
          id: optimisticId,
          ...dietPlanData,
          isOptimistic: true,
          createdAt: new Date().toISOString(),
          updatedAt: new Date().toISOString(),
        };

        return old ? [...old, optimisticDietPlan] : [optimisticDietPlan];
      });

      setIsSubmitting(true);

      // Call the server action
      const result = await createDietPlan(dietPlanData);

      if (result.success) {
        // Clear all stored data
        localStorage.removeItem('dietPlanCheckpoints');
        localStorage.removeItem('dietPlanStep');
        localStorage.removeItem('dietPlanData');
        localStorage.removeItem('currentMealData');

        // Invalidate and refetch relevant queries
        queryClient.invalidateQueries({ queryKey: ['dietPlans'] });

        toast.success(result.message);
        router.push('/dashboard/trainer/diet/assigndietplan');
      } else {
        toast.error(result.message);
      }
    } catch (error) {
      console.error('Error submitting diet plan:', error);
      toast.error('Failed to create diet plan');
    } finally {
      setIsSubmitting(false);
    }
  };

  const addMeal = () => {
    if (currentMeal.name && currentMeal.time) {
      setDietPlan((prev) => ({
        ...prev,
        meals: [...prev.meals, currentMeal],
      }));
      // Save checkpoint after adding meal
      saveCheckpoint(currentMeal);
      setCurrentMeal({
        name: '',
        time: '',
        calories: 0,
        protein: 0,
        carbs: 0,
        fats: 0,
        ingredients: [],
        instructions: '',
        order: 0,
      });
    }
  };

  const removeMeal = (index: number) => {
    setDietPlan((prev) => ({
      ...prev,
      meals: prev.meals.filter((_, i) => i !== index),
    }));
  };

  return (
    <div className="container mx-auto p-6">
      <ProgressSteps currentStep={currentStep} />

      <AnimatePresence mode="wait">
        {currentStep === 1 && <StepOne dietPlan={dietPlan} setDietPlan={setDietPlan} />}

        {currentStep === 2 && <StepTwo dietPlan={dietPlan} setDietPlan={setDietPlan} />}

        {currentStep === 3 && (
          <StepThree
            dietPlan={dietPlan}
            // setDietPlan={setDietPlan}
            currentMeal={currentMeal}
            setCurrentMeal={setCurrentMeal}
            addMeal={addMeal}
            removeMeal={removeMeal}
            saveCheckpoint={saveCheckpoint}
          />
        )}
      </AnimatePresence>

      <div className="flex justify-between mt-8">
        <Button
          onClick={() => setCurrentStep((current) => Math.max(current - 1, 1))}
          disabled={currentStep === 1}
        >
          Previous
        </Button>
        {currentStep === 3 ? (
          <Button onClick={handleSubmit} variant="default" disabled={isSubmitting}>
            {isSubmitting ? (
              <>
                <div className="h-4 w-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent" />
                Creating...
              </>
            ) : (
              <>
                <Save className="w-4 h-4 mr-2" />
                Save Diet Plan
              </>
            )}
          </Button>
        ) : (
          <Button onClick={() => setCurrentStep((current) => Math.min(current + 1, 3))}>
            Next
            <ArrowRight className="w-4 h-4 ml-2" />
          </Button>
        )}
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_components/diet-plan-types.ts

```ts
export interface MealInterface {
  name: string;
  time: string;
  calories: number;
  protein: number;
  carbs: number;
  fats: number;
  ingredients: string[];
  instructions: string;
  order: number;
}

export interface DietPlanInterface {
  name: string;
  description: string;
  targetCalories: number;
  macroSplit: {
    protein: number;
    carbs: number;
    fats: number;
  };
  meals: MealInterface[];
}

export const mealTimes = [
  'Breakfast (6-8 AM)',
  'Morning Snack (10-11 AM)',
  'Lunch (1-2 PM)',
  'Evening Snack (4-5 PM)',
  'Dinner (7-8 PM)',
  'Late Night (9-10 PM)',
];

```

# app/dashboard/trainer/diet/createdietplan/_components/meals/meal-form.tsx

```tsx
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Textarea } from '@/components/ui/textarea';
import { useState } from 'react';
import { type MealInterface, mealTimes } from '../diet-plan-types';

interface MealFormProps {
  currentMeal: MealInterface;
  setCurrentMeal: React.Dispatch<React.SetStateAction<MealInterface>>;
  addMeal: () => void;
}

export default function MealForm({ currentMeal, setCurrentMeal, addMeal }: MealFormProps) {
  const [newIngredient, setNewIngredient] = useState('');

  const addIngredient = () => {
    if (newIngredient.trim()) {
      setCurrentMeal((prev) => ({
        ...prev,
        ingredients: [...prev.ingredients, newIngredient.trim()],
      }));
      setNewIngredient('');
    }
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      addIngredient();
    }
  };

  const removeIngredient = (index: number) => {
    setCurrentMeal((prev) => ({
      ...prev,
      ingredients: prev.ingredients.filter((_, i) => i !== index),
    }));
  };

  return (
    <div className="bg-white p-6 rounded-lg border border-gray-200 space-y-4">
      <h3 className="text-lg font-semibold">Add New Meal</h3>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="meal-name">
            Meal Name
          </label>
          <Input
            id="meal-name"
            value={currentMeal.name}
            onChange={(e) =>
              setCurrentMeal((prev) => ({
                ...prev,
                name: e.target.value,
              }))
            }
            placeholder="e.g., Breakfast"
          />
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="meal-time">
            Time of Day
          </label>
          <Select
            onValueChange={(value) => setCurrentMeal((prev) => ({ ...prev, time: value }))}
            value={currentMeal.time || undefined}
          >
            <SelectTrigger id="meal-time">
              <SelectValue placeholder="Select time" />
            </SelectTrigger>
            <SelectContent>
              {mealTimes.map((time) => (
                <SelectItem key={time} value={time}>
                  {time}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="meal-calories">
            Calories
          </label>
          <Input
            id="meal-calories"
            type="number"
            value={currentMeal.calories || ''}
            onChange={(e) =>
              setCurrentMeal((prev) => ({
                ...prev,
                calories: Number.parseInt(e.target.value) || 0,
              }))
            }
            placeholder="Calories"
          />
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="meal-protein">
            Protein (g)
          </label>
          <Input
            id="meal-protein"
            type="number"
            value={currentMeal.protein || ''}
            onChange={(e) =>
              setCurrentMeal((prev) => ({
                ...prev,
                protein: Number.parseInt(e.target.value) || 0,
              }))
            }
            placeholder="Protein in grams"
          />
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="meal-carbs">
            Carbs (g)
          </label>
          <Input
            id="meal-carbs"
            type="number"
            value={currentMeal.carbs || ''}
            onChange={(e) =>
              setCurrentMeal((prev) => ({
                ...prev,
                carbs: Number.parseInt(e.target.value) || 0,
              }))
            }
            placeholder="Carbs in grams"
          />
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="meal-fats">
            Fats (g)
          </label>
          <Input
            id="meal-fats"
            type="number"
            value={currentMeal.fats || ''}
            onChange={(e) =>
              setCurrentMeal((prev) => ({
                ...prev,
                fats: Number.parseInt(e.target.value) || 0,
              }))
            }
            placeholder="Fats in grams"
          />
        </div>
      </div>

      {/* Ingredients Section */}
      <div className="space-y-3">
        <label className="block text-sm font-medium mb-2" htmlFor="meal-ingredients">
          Ingredients
        </label>
        <div className="flex gap-2">
          <Input
            id="meal-ingredients"
            value={newIngredient}
            onChange={(e) => setNewIngredient(e.target.value)}
            placeholder="Add ingredient"
            onKeyDown={handleKeyDown}
          />
          <Button onClick={addIngredient} type="button">
            Add
          </Button>
        </div>
        <div className="flex flex-wrap gap-2 mt-2">
          {currentMeal.ingredients.map((ingredient) => (
            <div
              key={`ingredient-${ingredient}`}
              className="bg-gray-100 px-3 py-1 rounded-full flex items-center gap-2"
            >
              <span>{ingredient}</span>
              <button
                onClick={() => removeIngredient(currentMeal.ingredients.indexOf(ingredient))}
                className="text-gray-500 hover:text-red-500"
                type="button"
                aria-label={`Remove ${ingredient}`}
              >
                ×
              </button>
            </div>
          ))}
        </div>
      </div>

      {/* Instructions */}
      <div>
        <label className="block text-sm font-medium mb-2" htmlFor="meal-instructions">
          Instructions
        </label>
        <Textarea
          id="meal-instructions"
          value={currentMeal.instructions}
          onChange={(e) =>
            setCurrentMeal((prev) => ({
              ...prev,
              instructions: e.target.value,
            }))
          }
          placeholder="Add preparation instructions"
          rows={3}
        />
      </div>

      <Button
        onClick={addMeal}
        className="w-full"
        disabled={!currentMeal.name || !currentMeal.time}
      >
        Add Meal to Plan
      </Button>
    </div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_components/meals/meal-list.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { m } from 'framer-motion';
import type { MealInterface } from '../diet-plan-types';

interface MealListProps {
  meals: MealInterface[];
  removeMeal: (index: number) => void;
}

export default function MealList({ meals, removeMeal }: MealListProps) {
  if (meals.length === 0) {
    return (
      <div className="bg-gray-50 p-6 rounded-lg border border-gray-200 text-center text-gray-500">
        No meals added yet. Use the form above to add meals to your diet plan.
      </div>
    );
  }

  return (
    <div className="space-y-4">
      <h3 className="text-lg font-semibold">Planned Meals</h3>

      {meals.map((meal, index) => (
        <m.div
          key={`meal-${meal.name}-${index}`}
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="bg-white p-4 rounded-lg border border-gray-200"
        >
          <div className="flex justify-between items-start">
            <div>
              <h4 className="font-medium">{meal.name}</h4>
              <p className="text-sm text-gray-600">{meal.time}</p>
              <p className="text-sm">
                Calories: {meal.calories} | P: {meal.protein}g | C: {meal.carbs}g | F: {meal.fats}g
              </p>

              {meal.ingredients &&
                Array.isArray(meal.ingredients) &&
                meal.ingredients.length > 0 && (
                  <div className="mt-2">
                    <p className="text-sm font-medium">Ingredients:</p>
                    <p className="text-sm text-gray-600">{meal.ingredients.join(', ')}</p>
                  </div>
                )}

              {meal.instructions && (
                <div className="mt-2">
                  <p className="text-sm font-medium">Instructions:</p>
                  <p className="text-sm text-gray-600">{meal.instructions}</p>
                </div>
              )}
            </div>

            <Button
              variant="ghost"
              size="sm"
              onClick={() => removeMeal(index)}
              className="text-red-500 hover:text-red-700"
              aria-label={`Remove ${meal.name}`}
            >
              Remove
            </Button>
          </div>
        </m.div>
      ))}

      <div className="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-md">
        <p className="text-sm text-blue-800">
          <span className="font-medium">Total meals:</span> {meals.length}
        </p>
        <p className="text-sm text-blue-800">
          <span className="font-medium">Total calories:</span>{' '}
          {meals.reduce((sum, meal) => sum + meal.calories, 0)}
        </p>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_components/progress-steps.tsx

```tsx
import { m } from 'framer-motion';

interface ProgressStepsProps {
  currentStep: number;
}

export default function ProgressSteps({ currentStep }: ProgressStepsProps) {
  return (
    <m.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="max-w-4xl mx-auto mb-8"
    >
      <div className="flex justify-between">
        {[1, 2, 3].map((step) => (
          <div
            key={step}
            className={`flex items-center ${
              currentStep >= step ? 'text-green-600' : 'text-gray-400'
            }`}
          >
            <div
              className={`w-8 h-8 rounded-full flex items-center justify-center border-2 
                ${currentStep >= step ? 'border-green-600 bg-green-50' : 'border-gray-300'}`}
            >
              {step}
            </div>
            {step < 3 && (
              <div
                className={`flex-1 h-1 mx-4 ${currentStep > step ? 'bg-green-600' : 'bg-gray-300'}`}
              />
            )}
          </div>
        ))}
      </div>
    </m.div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_components/steps/step-one.tsx

```tsx
import { Input } from '@/components/ui/input';
import { Slider } from '@/components/ui/slider';
import { Textarea } from '@/components/ui/textarea';
import { m } from 'framer-motion';
import type { DietPlanInterface } from '../diet-plan-types';

interface StepOneProps {
  dietPlan: DietPlanInterface;
  setDietPlan: React.Dispatch<React.SetStateAction<DietPlanInterface>>;
}

export default function StepOne({ dietPlan, setDietPlan }: StepOneProps) {
  return (
    <m.div
      key="step1"
      initial={{ opacity: 0, x: -20 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: 20 }}
      className="space-y-6"
    >
      <h2 className="text-2xl font-bold">Diet Plan Basics</h2>
      <div className="space-y-4">
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="plan-name">
            Plan Name
          </label>
          <Input
            id="plan-name"
            value={dietPlan.name}
            onChange={(e) => setDietPlan((prev) => ({ ...prev, name: e.target.value }))}
            placeholder="e.g., Weight Loss Meal Plan"
          />
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="plan-description">
            Description
          </label>
          <Textarea
            id="plan-description"
            value={dietPlan.description}
            onChange={(e) =>
              setDietPlan((prev) => ({
                ...prev,
                description: e.target.value,
              }))
            }
            placeholder="Describe the goals and features of this diet plan..."
            rows={4}
          />
        </div>
        <div>
          <label className="block text-sm font-medium mb-2" htmlFor="plan-target-calories">
            Target Daily Calories: {dietPlan.targetCalories}
          </label>
          <Slider
            id="plan-target-calories"
            defaultValue={[dietPlan.targetCalories]}
            max={4000}
            min={1200}
            step={100}
            onValueChange={([value]) =>
              setDietPlan((prev) => ({
                ...prev,
                targetCalories: value,
              }))
            }
          />
        </div>
      </div>
    </m.div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_components/steps/step-three.tsx

```tsx
'use client';

import { m } from 'framer-motion';
import type { DietPlanInterface, MealInterface } from '../diet-plan-types';
import MealForm from '../meals/meal-form';
import MealList from '../meals/meal-list';

interface StepThreeProps {
  dietPlan: DietPlanInterface;
  currentMeal: MealInterface;
  setCurrentMeal: React.Dispatch<React.SetStateAction<MealInterface>>;
  addMeal: () => void;
  removeMeal: (index: number) => void;
  saveCheckpoint: (meal: MealInterface) => void;
}

export default function StepThree({
  dietPlan,
  currentMeal,
  setCurrentMeal,
  addMeal,
  removeMeal,
  // saveCheckpoint,
}: StepThreeProps) {
  return (
    <m.div
      key="step3"
      initial={{ opacity: 0, x: -20 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: 20 }}
      className="space-y-6"
    >
      <h2 className="text-2xl font-bold">Meal Planning</h2>

      {/* Meal Form */}
      <MealForm currentMeal={currentMeal} setCurrentMeal={setCurrentMeal} addMeal={addMeal} />

      {/* Meals List */}
      <MealList meals={dietPlan.meals} removeMeal={removeMeal} />
    </m.div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/_components/steps/step-two.tsx

```tsx
import { Slider } from '@/components/ui/slider';
import { ArcElement, Chart as ChartJS, Legend, Tooltip } from 'chart.js';
import { m } from 'framer-motion';
import { Pie } from 'react-chartjs-2';
import type { DietPlanInterface } from '../diet-plan-types';

ChartJS.register(ArcElement, Tooltip, Legend);

interface StepTwoProps {
  dietPlan: DietPlanInterface;
  setDietPlan: React.Dispatch<React.SetStateAction<DietPlanInterface>>;
}

export default function StepTwo({ dietPlan, setDietPlan }: StepTwoProps) {
  const chartData = {
    labels: ['Protein', 'Carbs', 'Fats'],
    datasets: [
      {
        data: [dietPlan.macroSplit.protein, dietPlan.macroSplit.carbs, dietPlan.macroSplit.fats],
        backgroundColor: ['#22c55e', '#3b82f6', '#ef4444'],
        borderWidth: 0,
      },
    ],
  };

  return (
    <m.div
      key="step2"
      initial={{ opacity: 0, x: -20 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: 20 }}
      className="space-y-6"
    >
      <h2 className="text-2xl font-bold">Macro Split</h2>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div className="space-y-6">
          <div>
            <label className="block text-sm font-medium mb-2" htmlFor="plan-protein">
              Protein: {dietPlan.macroSplit.protein}%
            </label>
            <Slider
              id="plan-protein"
              defaultValue={[dietPlan.macroSplit.protein]}
              max={60}
              min={10}
              step={5}
              onValueChange={([value]) =>
                setDietPlan((prev) => ({
                  ...prev,
                  macroSplit: { ...prev.macroSplit, protein: value },
                }))
              }
            />
          </div>
          <div>
            <label className="block text-sm font-medium mb-2" htmlFor="plan-carbs">
              Carbs: {dietPlan.macroSplit.carbs}%
            </label>
            <Slider
              id="plan-carbs"
              defaultValue={[dietPlan.macroSplit.carbs]}
              max={60}
              min={10}
              step={5}
              onValueChange={([value]) =>
                setDietPlan((prev) => ({
                  ...prev,
                  macroSplit: { ...prev.macroSplit, carbs: value },
                }))
              }
            />
          </div>
          <div>
            <label className="block text-sm font-medium mb-2" htmlFor="plan-fats">
              Fats: {dietPlan.macroSplit.fats}%
            </label>
            <Slider
              id="plan-fats"
              defaultValue={[dietPlan.macroSplit.fats]}
              max={60}
              min={10}
              step={5}
              onValueChange={([value]) =>
                setDietPlan((prev) => ({
                  ...prev,
                  macroSplit: { ...prev.macroSplit, fats: value },
                }))
              }
            />
          </div>
          <div className="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md">
            <p className="text-sm text-yellow-700">
              Total:{' '}
              {dietPlan.macroSplit.protein + dietPlan.macroSplit.carbs + dietPlan.macroSplit.fats}%
              {dietPlan.macroSplit.protein +
                dietPlan.macroSplit.carbs +
                dietPlan.macroSplit.fats !==
                100 && ' (should equal 100%)'}
            </p>
          </div>
        </div>
        <div className="flex items-center justify-center">
          <div className="w-64 h-64">
            <Pie data={chartData} />
          </div>
        </div>
      </div>
    </m.div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/CreateDietPlan.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Slider } from '@/components/ui/slider';
import { Textarea } from '@/components/ui/textarea';
import { ArcElement, Chart as ChartJS, Legend, Tooltip } from 'chart.js';
import { AnimatePresence, m } from 'framer-motion';
import { ArrowRight, Save } from 'lucide-react';
import { useRouter } from 'next/navigation';
import React, { useState, useEffect } from 'react';
import { Pie } from 'react-chartjs-2';
import { toast } from 'sonner';
import { createDietPlan } from './_actions/create-diet-plan';

ChartJS.register(ArcElement, Tooltip, Legend);

interface Meal {
  name: string;
  time: string;
  calories: number;
  protein: number;
  carbs: number;
  fats: number;
  ingredients: string[];
  instructions: string;
  order: number; // Add order field
}

interface DietPlan {
  name: string;
  description: string;
  targetCalories: number;
  macroSplit: {
    protein: number;
    carbs: number;
    fats: number;
  };
  meals: Meal[];
}

const mealTimes = [
  'Breakfast (6-8 AM)',
  'Morning Snack (10-11 AM)',
  'Lunch (1-2 PM)',
  'Evening Snack (4-5 PM)',
  'Dinner (7-8 PM)',
  'Late Night (9-10 PM)',
];

export default function CreateDietPlan() {
  const router = useRouter();
  const [currentStep, setCurrentStep] = useState(() => {
    if (typeof window !== 'undefined') {
      return Number.parseInt(localStorage.getItem('dietPlanStep') || '1');
    }
    return 1;
  });

  const [dietPlan, setDietPlan] = useState<DietPlan>(() => {
    if (typeof window !== 'undefined') {
      const savedPlan = localStorage.getItem('dietPlanData');
      return savedPlan
        ? JSON.parse(savedPlan)
        : {
            name: '',
            description: '',
            targetCalories: 2000,
            macroSplit: {
              protein: 30,
              carbs: 40,
              fats: 30,
            },
            meals: [],
          };
    }
    return {
      name: '',
      description: '',
      targetCalories: 2000,
      macroSplit: {
        protein: 30,
        carbs: 40,
        fats: 30,
      },
      meals: [],
    };
  });

  const [currentMeal, setCurrentMeal] = useState<Meal>(() => {
    if (typeof window !== 'undefined') {
      const savedMeal = localStorage.getItem('currentMealData');
      return savedMeal
        ? JSON.parse(savedMeal)
        : {
            name: '',
            time: '',
            calories: 0,
            protein: 0,
            carbs: 0,
            fats: 0,
            ingredients: [],
            instructions: '',
            order: 0,
          };
    }
    return {
      name: '',
      time: '',
      calories: 0,
      protein: 0,
      carbs: 0,
      fats: 0,
      ingredients: [],
      instructions: '',
      order: 0,
    };
  });

  // Save to localStorage whenever data changes
  useEffect(() => {
    localStorage.setItem('dietPlanStep', currentStep.toString());
    localStorage.setItem('dietPlanData', JSON.stringify(dietPlan));
    localStorage.setItem('currentMealData', JSON.stringify(currentMeal));
  }, [currentStep, dietPlan, currentMeal]);

  const [newIngredient, setNewIngredient] = useState('');

  // Add checkpoint saving logic
  const saveCheckpoint = (meal: Meal) => {
    const checkpoints = JSON.parse(localStorage.getItem('dietPlanCheckpoints') || '[]');
    checkpoints.push({
      step: currentStep,
      meal: meal,
      timestamp: new Date().toISOString(),
    });
    localStorage.setItem('dietPlanCheckpoints', JSON.stringify(checkpoints));
    toast.success('Progress saved');
  };

  const addMeal = () => {
    if (currentMeal.name && currentMeal.time) {
      setDietPlan((prev) => ({
        ...prev,
        meals: [...prev.meals, currentMeal],
      }));
      // Save checkpoint after adding meal
      saveCheckpoint(currentMeal);
      setCurrentMeal({
        name: '',
        time: '',
        calories: 0,
        protein: 0,
        carbs: 0,
        fats: 0,
        ingredients: [],
        instructions: '',
        order: 0,
      });
    }
  };

  const addIngredient = () => {
    if (newIngredient.trim()) {
      setCurrentMeal((prev) => ({
        ...prev,
        ingredients: [...prev.ingredients, newIngredient.trim()],
      }));
      setNewIngredient('');
    }
  };

  const removeIngredient = (index: number) => {
    setCurrentMeal((prev) => ({
      ...prev,
      ingredients: prev.ingredients.filter((_, i) => i !== index),
    }));
  };

  const removeMeal = (index: number) => {
    setDietPlan((prev) => ({
      ...prev,
      meals: prev.meals.filter((_, i) => i !== index),
    }));
  };

  const chartData = {
    labels: ['Protein', 'Carbs', 'Fats'],
    datasets: [
      {
        data: [dietPlan.macroSplit.protein, dietPlan.macroSplit.carbs, dietPlan.macroSplit.fats],
        backgroundColor: ['#22c55e', '#3b82f6', '#ef4444'],
        borderWidth: 0,
      },
    ],
  };

  const handleSubmit = async () => {
    try {
      // Validate required fields
      if (!dietPlan.name) {
        toast.error('Please enter a plan name');
        return;
      }

      if (dietPlan.meals.length === 0) {
        toast.error('Please add at least one meal');
        return;
      }

      const total =
        dietPlan.macroSplit.protein + dietPlan.macroSplit.carbs + dietPlan.macroSplit.fats;
      if (total !== 100) {
        toast.error('Macro split percentages must add up to 100%');
        return;
      }

      // Prepare data for submission
      const dietPlanData = {
        name: dietPlan.name,
        description: dietPlan.description,
        targetCalories: dietPlan.targetCalories,
        proteinRatio: dietPlan.macroSplit.protein,
        carbsRatio: dietPlan.macroSplit.carbs,
        fatsRatio: dietPlan.macroSplit.fats,
        meals: dietPlan.meals.map((meal, index) => ({
          name: meal.name,
          timeOfDay: meal.time,
          calories: meal.calories,
          protein: meal.protein,
          carbs: meal.carbs,
          fats: meal.fats,
          instructions: meal.instructions,
          order: index + 1, // Add order based on array index
          ingredients: meal.ingredients.map((ingredient) => ({
            name: ingredient,
            quantity: 1, // Default quantity
            unit: 'serving', // Default unit
            calories: 0, // These will be updated later if needed
            protein: 0,
            carbs: 0,
            fats: 0,
          })),
        })),
      };

      const result = await createDietPlan(dietPlanData);

      if (result.success) {
        // Clear all stored data
        localStorage.removeItem('dietPlanCheckpoints');
        localStorage.removeItem('dietPlanStep');
        localStorage.removeItem('dietPlanData');
        localStorage.removeItem('currentMealData');

        toast.success(result.message);
        router.push('/dashboard/trainer/diet/assigndietplan');
      } else {
        toast.error(result.message);
      }
    } catch (error) {
      console.error('Error submitting diet plan:', error);
      toast.error('Failed to create diet plan');
    }
  };

  // Add restore checkpoint function

  return (
    <div className="container mx-auto p-6">
      <m.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="max-w-4xl mx-auto"
      >
        {/* Progress Steps */}
        <div className="flex justify-between mb-8">
          {[1, 2, 3].map((step) => (
            <div
              key={step}
              className={`flex items-center ${
                currentStep >= step ? 'text-green-600' : 'text-gray-400'
              }`}
            >
              <div
                className={`w-8 h-8 rounded-full flex items-center justify-center border-2 
                  ${currentStep >= step ? 'border-green-600 bg-green-50' : 'border-gray-300'}`}
              >
                {step}
              </div>
              {step < 3 && (
                <div
                  className={`flex-1 h-1 mx-4 ${
                    currentStep > step ? 'bg-green-600' : 'bg-gray-300'
                  }`}
                />
              )}
            </div>
          ))}
        </div>

        <AnimatePresence mode="wait">
          {/* Step 1: Basic Information */}
          {currentStep === 1 && (
            <m.div
              key="step1"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: 20 }}
              className="space-y-6"
            >
              {/* ... Step 1 content ... */}
              <h2 className="text-2xl font-bold">Diet Plan Basics</h2>
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium mb-2" htmlFor="plan-name">
                    Plan Name
                  </label>
                  <Input
                    value={dietPlan.name}
                    onChange={(e) => setDietPlan((prev) => ({ ...prev, name: e.target.value }))}
                    placeholder="e.g., Weight Loss Meal Plan"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-2" htmlFor="plan-description">
                    Description
                  </label>
                  <Textarea
                    value={dietPlan.description}
                    onChange={(e) =>
                      setDietPlan((prev) => ({
                        ...prev,
                        description: e.target.value,
                      }))
                    }
                    placeholder="Describe the goals and features of this diet plan..."
                    rows={4}
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-2" htmlFor="plan-target-calories">
                    Target Daily Calories: {dietPlan.targetCalories}
                  </label>
                  <Slider
                    defaultValue={[dietPlan.targetCalories]}
                    max={4000}
                    min={1200}
                    step={100}
                    onValueChange={([value]) =>
                      setDietPlan((prev) => ({
                        ...prev,
                        targetCalories: value,
                      }))
                    }
                  />
                </div>
              </div>
            </m.div>
          )}

          {/* Step 2: Macro Split */}
          {currentStep === 2 && (
            <m.div
              key="step2"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: 20 }}
              className="space-y-6"
            >
              <h2 className="text-2xl font-bold">Macro Split</h2>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div className="space-y-6">
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-protein">
                      Protein: {dietPlan.macroSplit.protein}%
                    </label>
                    <Slider
                      defaultValue={[dietPlan.macroSplit.protein]}
                      max={60}
                      min={10}
                      step={5}
                      onValueChange={([value]) =>
                        setDietPlan((prev) => ({
                          ...prev,
                          macroSplit: { ...prev.macroSplit, protein: value },
                        }))
                      }
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-carbs">
                      Carbs: {dietPlan.macroSplit.carbs}%
                    </label>
                    <Slider
                      defaultValue={[dietPlan.macroSplit.carbs]}
                      max={60}
                      min={10}
                      step={5}
                      onValueChange={([value]) =>
                        setDietPlan((prev) => ({
                          ...prev,
                          macroSplit: { ...prev.macroSplit, carbs: value },
                        }))
                      }
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-fats">
                      Fats: {dietPlan.macroSplit.fats}%
                    </label>
                    <Slider
                      defaultValue={[dietPlan.macroSplit.fats]}
                      max={60}
                      min={10}
                      step={5}
                      onValueChange={([value]) =>
                        setDietPlan((prev) => ({
                          ...prev,
                          macroSplit: { ...prev.macroSplit, fats: value },
                        }))
                      }
                    />
                  </div>
                </div>
                <div className="flex items-center justify-center">
                  <div className="w-64 h-64">
                    <Pie data={chartData} />
                  </div>
                </div>
              </div>
            </m.div>
          )}

          {/* Step 3: Meal Planning */}
          {currentStep === 3 && (
            <m.div
              key="step3"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: 20 }}
              className="space-y-6"
            >
              <h2 className="text-2xl font-bold">Meal Planning</h2>

              {/* Current Meal Form */}
              <div className="bg-white p-6 rounded-lg border border-gray-200 space-y-4">
                <h3 className="text-lg font-semibold">Add New Meal</h3>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-name">
                      Meal Name
                    </label>
                    <Input
                      value={currentMeal.name}
                      onChange={(e) =>
                        setCurrentMeal((prev) => ({
                          ...prev,
                          name: e.target.value,
                        }))
                      }
                      placeholder="e.g., Breakfast"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-time">
                      Time of Day
                    </label>
                    <Select
                      onValueChange={(value) =>
                        setCurrentMeal((prev) => ({ ...prev, time: value }))
                      }
                    >
                      <SelectTrigger>
                        <SelectValue placeholder="Select time" />
                      </SelectTrigger>
                      <SelectContent>
                        {mealTimes.map((time) => (
                          <SelectItem key={time} value={time}>
                            {time}
                          </SelectItem>
                        ))}
                      </SelectContent>
                    </Select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-calories">
                      Calories
                    </label>
                    <Input
                      type="number"
                      value={currentMeal.calories}
                      onChange={(e) =>
                        setCurrentMeal((prev) => ({
                          ...prev,
                          calories: Number.parseInt(e.target.value),
                        }))
                      }
                      placeholder="Calories"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-protein">
                      Protein (g)
                    </label>
                    <Input
                      type="number"
                      value={currentMeal.protein}
                      onChange={(e) =>
                        setCurrentMeal((prev) => ({
                          ...prev,
                          protein: Number.parseInt(e.target.value),
                        }))
                      }
                      placeholder="Protein in grams"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-carbs">
                      Carbs (g)
                    </label>
                    <Input
                      type="number"
                      value={currentMeal.carbs}
                      onChange={(e) =>
                        setCurrentMeal((prev) => ({
                          ...prev,
                          carbs: Number.parseInt(e.target.value),
                        }))
                      }
                      placeholder="Carbs in grams"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-2" htmlFor="plan-fats">
                      Fats (g)
                    </label>
                    <Input
                      type="number"
                      value={currentMeal.fats}
                      onChange={(e) =>
                        setCurrentMeal((prev) => ({
                          ...prev,
                          fats: Number.parseInt(e.target.value),
                        }))
                      }
                      placeholder="Fats in grams"
                    />
                  </div>
                </div>

                {/* Ingredients Section */}
                <div className="space-y-3">
                  <label className="block text-sm font-medium mb-2" htmlFor="plan-ingredients">
                    Ingredients
                  </label>
                  <div className="flex gap-2">
                    <Input
                      value={newIngredient}
                      onChange={(e) => setNewIngredient(e.target.value)}
                      placeholder="Add ingredient"
                      onKeyPress={(e) => e.key === 'Enter' && addIngredient()}
                    />
                    <Button onClick={addIngredient} type="button">
                      Add
                    </Button>
                  </div>
                  <div className="flex flex-wrap gap-2">
                    {currentMeal.ingredients.map((ingredient, index) => (
                      <div
                        key={index as number}
                        className="bg-gray-100 px-3 py-1 rounded-full flex items-center gap-2"
                      >
                        <span>{ingredient}</span>
                        <button
                          onClick={() => removeIngredient(index)}
                          className="text-gray-500 hover:text-red-500"
                          type="button"
                        >
                          ×
                        </button>
                      </div>
                    ))}
                  </div>
                </div>

                {/* Instructions */}
                <div>
                  <label className="block text-sm font-medium mb-2" htmlFor="plan-instructions">
                    Instructions
                  </label>
                  <Textarea
                    value={currentMeal.instructions}
                    onChange={(e) =>
                      setCurrentMeal((prev) => ({
                        ...prev,
                        instructions: e.target.value,
                      }))
                    }
                    placeholder="Add preparation instructions"
                    rows={3}
                  />
                </div>

                <Button onClick={addMeal} className="w-full">
                  Add Meal to Plan
                </Button>
              </div>

              {/* Meals List */}
              <div className="space-y-4">
                <h3 className="text-lg font-semibold">Planned Meals</h3>
                {dietPlan.meals.map((meal, index) => (
                  <m.div
                    key={index as number}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    className="bg-white p-4 rounded-lg border border-gray-200"
                  >
                    <div className="flex justify-between items-start">
                      <div>
                        <h4 className="font-medium">{meal.name}</h4>
                        <p className="text-sm text-gray-600">{meal.time}</p>
                        <p className="text-sm">
                          Calories: {meal.calories} | P: {meal.protein}g | C: {meal.carbs}g | F:{' '}
                          {meal.fats}g
                        </p>
                        {meal.ingredients.length > 0 && (
                          <div className="mt-2">
                            <p className="text-sm font-medium">Ingredients:</p>
                            <p className="text-sm text-gray-600">{meal.ingredients.join(', ')}</p>
                          </div>
                        )}
                        {meal.instructions && (
                          <div className="mt-2">
                            <p className="text-sm font-medium">Instructions:</p>
                            <p className="text-sm text-gray-600">{meal.instructions}</p>
                          </div>
                        )}
                      </div>
                      <Button
                        variant="ghost"
                        size="sm"
                        onClick={() => removeMeal(index)}
                        className="text-red-500 hover:text-red-700"
                      >
                        Remove
                      </Button>
                    </div>
                  </m.div>
                ))}
              </div>
            </m.div>
          )}
        </AnimatePresence>

        {/* Navigation Buttons */}
        <div className="flex justify-between mt-8">
          <Button
            onClick={() => setCurrentStep((current) => Math.max(current - 1, 1))}
            disabled={currentStep === 1}
          >
            Previous
          </Button>
          {currentStep === 3 ? (
            <Button onClick={handleSubmit} variant="default">
              <Save className="w-4 h-4 mr-2" />
              Save Diet Plan
            </Button>
          ) : (
            <Button onClick={() => setCurrentStep((current) => Math.min(current + 1, 3))}>
              Next
              <ArrowRight className="w-4 h-4 ml-2" />
            </Button>
          )}
        </div>
      </m.div>
    </div>
  );
}

```

# app/dashboard/trainer/diet/createdietplan/page.tsx

```tsx
import CreateDietPlan from './_components/create-diet-plan';

export default function Page() {
  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <CreateDietPlan />
    </div>
  );
}

```

# app/dashboard/trainer/layout.tsx

```tsx
import type React from 'react';

export default function layout({ children }: { children: React.ReactNode }) {
  return (
    <>
      <div className="">{children}</div>
    </>
  );
}

```

# app/dashboard/trainer/page.tsx

```tsx
import ErrorScreen from '@/components/extras/ErrorScreen';
import React from 'react';
import GetTrainerStats from './(common)/GetTrainerstats';
import TrainerStats from './(common)/components/TrainerStats';

export default async function Page() {
  const trainerData = await GetTrainerStats();

  if ('error' in trainerData) {
    return <ErrorScreen error={trainerData.error} />;
  }

  return <TrainerStats data={trainerData} />;
}

```

# app/dashboard/trainer/workouts/addworkout/page.tsx

```tsx
import CreateWorkout from '@/components/trainer/AddWorkouts';
import React from 'react';

export default function page() {
  return (
    <>
      <div className="w-full h-screen overflow-auto flex justify-center items-center">
        <CreateWorkout />
      </div>
    </>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/assign-workout-plan.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';
import type { WorkoutPlan } from './generate-ai-workout';

export async function assignWorkoutPlan(userId: string, workoutPlanId: number) {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.post('/workouts/assignworkoutplan', {
      userId,
      workoutPlanId,
    });

    if (response.data.msg === 'success') {
      return {
        success: true,
      };
    }

    throw new Error(response.data.error || 'Failed to assign workout plan');
  } catch (error) {
    console.error('Error assigning workout plan:', error);
    throw error;
  }
}

interface WorkoutPlanInfo {
  id: number;
  name: string;
  description: string | null;
}

export interface CustomWorkoutPlanResponse {
  success: boolean;
  workoutPlanId: number;
  msg: string;
  error?: string;
  previousPlan: WorkoutPlanInfo | null;
  newPlan: WorkoutPlanInfo;
}

/**
 * Assigns a custom AI-generated workout plan to a user
 */
export async function assignCustomWorkoutPlan(
  userId: string,
  workoutPlan: WorkoutPlan,
): Promise<CustomWorkoutPlanResponse> {
  const trainerAxios = await TrainerReqConfig();

  try {
    // Create and assign a workout plan to the user in one request
    const response = await trainerAxios.post('/workouts/customworkoutplan', {
      userId,
      workoutPlan: {
        name: workoutPlan.name,
        description: workoutPlan.description,
        schedules: workoutPlan.schedules.map((schedule) => ({
          dayOfWeek: schedule.dayOfWeek,
          muscleTarget: schedule.muscleTarget,
          duration: schedule.duration,
          calories: schedule.calories,
          exercises: schedule.exercises.map((exercise) => ({
            name: exercise.name,
            sets: exercise.sets,
            reps: exercise.reps,
            description: exercise.description,
            order: exercise.order,
          })),
        })),
      },
    });

    if (!response.data.success) {
      throw new Error(response.data.error || 'Failed to create and assign custom workout plan');
    }

    return {
      success: true,
      workoutPlanId: response.data.workoutPlanId,
      msg: response.data.msg,
      previousPlan: response.data.previousPlan,
      newPlan: response.data.newPlan,
    };
  } catch (error) {
    console.error('Error assigning custom workout plan:', error);
    return {
      success: false,
      workoutPlanId: -1,
      msg: 'Failed to assign workout plan',
      error: error instanceof Error ? error.message : 'Unknown error',
      previousPlan: null,
      newPlan: { id: -1, name: '', description: null },
    };
  }
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/generate-ai-workout.ts

```ts
'use server';

import { generateStructuredContent, validateResponseWithSchema } from '@/lib/AI';
import { generateWorkoutPrompt } from '@/lib/AI/prompts/workout-prompts';
import { WorkoutPlanSchema } from '@/lib/AI/types/workout-types';
import type { z } from 'zod';

// Define the expected schema for workout plans
export interface Exercise {
  id?: number;
  name: string;
  sets: number;
  reps: string;
  description: string;
  order: number;
}

export interface WorkoutSchedule {
  id?: number;
  dayOfWeek: string;
  muscleTarget: string;
  duration: number;
  calories: number;
  exercises: Exercise[];
}

export interface WorkoutPlan {
  id?: number;
  name: string;
  description: string | null;
  schedules: WorkoutSchedule[];
}

export interface WorkoutGenerationParams {
  userId: string;
  goals: string;
  fitnessLevel: string;
  preferredDays?: string[];
  focusAreas?: string[];
  healthConditions?: string[];
  workoutDuration?: number;
  equipment?: string[];
  specialInstructions?: string;
}

/**
 * Generates a personalized workout plan using AI based on user parameters
 */
export async function generateAiWorkout(params: WorkoutGenerationParams): Promise<{
  success: boolean;
  workoutPlan?: WorkoutPlan;
  error?: string;
}> {
  try {
    // Generate prompt based on parameters
    const prompt = generateWorkoutPrompt(params);

    // Generate structured content with AI
    const result = await generateStructuredContent<z.infer<typeof WorkoutPlanSchema>>(
      prompt,
      (response) => validateResponseWithSchema(response, WorkoutPlanSchema),
      {
        provider: 'gemini', // Or 'openai' based on preference
        maxAttempts: 3,
        temperature: 0.7,
      },
    );

    if (result.success && result.data) {
      // Transform the result to match our interface
      const workoutPlan: WorkoutPlan = {
        ...result.data,
        id: 0, // Will be assigned by backend when saved
      };

      return {
        success: true,
        workoutPlan,
      };
    }

    return {
      success: false,
      error: 'Failed to generate a valid workout plan',
    };
  } catch (error) {
    console.error('Error generating AI workout plan:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to generate AI workout plan',
    };
  }
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/get-all-clients.ts

```ts

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/get-user-by-id.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

// Define response types for strong type safety
export interface HealthProfile {
  weight: number | null;
  height: number | null;
  goal: string | null;
  gender: string | null;
  age: number | null;
}

export interface WorkoutPlan {
  id: number;
  name: string;
  description: string | null;
}

export interface UserData {
  id: string;
  name: string;
  email: string;
  healthProfile: HealthProfile | null;
  activeWorkoutPlan: WorkoutPlan | null;
  hasActiveWorkoutPlan: boolean;
}

export async function getUserById(userId: string) {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.get(`/client/user/${userId}`);
    const data = response.data;

    if (data.msg === 'success' && data.user) {
      return {
        success: true,
        data: data.user as UserData,
      };
    }

    return {
      success: false,
      error: data.msg || 'Failed to fetch user data',
    };
  } catch (error) {
    console.error('Error fetching user by ID:', error);
    return {
      success: false,
      error: 'Failed to fetch user data',
    };
  }
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/get-workout-history.ts

```ts
'use server';

import type { ChatMessage, SavedWorkout } from '../_store/workout-chat-store';
import type { WorkoutPlan, WorkoutSchedule } from './generate-ai-workout';

// Use SavedWorkout from store which already uses WorkoutPlan from generate-ai-workout
export type WorkoutHistoryItem = SavedWorkout;

export interface WorkoutHistoryResponse {
  success: boolean;
  data?: WorkoutHistoryItem[];
  error?: string;
}

// In a real application, this would query a database
export async function getWorkoutHistory(userId: string): Promise<WorkoutHistoryResponse> {
  try {
    // Mock data that conforms to the WorkoutPlan interface from generate-ai-workout.ts
    const mockHistory: WorkoutHistoryItem[] =
      userId !== 'defaultUserId'
        ? [
            {
              id: 'wh-1',
              workoutPlan: {
                id: 1,
                name: 'Strength Building Program',
                description: 'A program focused on building functional strength',
                schedules: [
                  {
                    id: 1,
                    dayOfWeek: 'Monday',
                    muscleTarget: 'Upper Body', // Using muscleTarget instead of focus
                    duration: 45, // Adding required number field
                    calories: 350, // Adding required number field
                    exercises: [
                      {
                        name: 'Bench Press',
                        sets: 3,
                        reps: '8-10',
                        description: 'Standard bench press movement', // Adding required description
                        order: 0, // Adding required order
                      },
                      {
                        name: 'Shoulder Press',
                        sets: 3,
                        reps: '8-10',
                        description: 'Overhead press with dumbbells',
                        order: 1,
                      },
                    ],
                  },
                  {
                    id: 2,
                    dayOfWeek: 'Wednesday',
                    muscleTarget: 'Lower Body',
                    duration: 50,
                    calories: 400,
                    exercises: [
                      {
                        name: 'Squats',
                        sets: 4,
                        reps: '8-10',
                        description: 'Standard barbell squat',
                        order: 0,
                      },
                      {
                        name: 'Deadlifts',
                        sets: 3,
                        reps: '8-10',
                        description: 'Conventional deadlift form',
                        order: 1,
                      },
                    ],
                  },
                ],
              },
              createdAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
              clientId: userId,
              clientName: 'Jane Smith',
              conversationHistory: [
                {
                  type: 'ai',
                  message:
                    "Here's your personalized workout plan. Let me know if you'd like any modifications!",
                  workout: {
                    id: 1,
                    name: 'Strength Building Program',
                    description: 'A program focused on building functional strength',
                    schedules: [
                      {
                        id: 1,
                        dayOfWeek: 'Monday',
                        muscleTarget: 'Upper Body',
                        duration: 45,
                        calories: 350,
                        exercises: [
                          {
                            name: 'Bench Press',
                            sets: 3,
                            reps: '8-10',
                            description: 'Standard bench press movement',
                            order: 0,
                          },
                          {
                            name: 'Shoulder Press',
                            sets: 3,
                            reps: '8-10',
                            description: 'Overhead press with dumbbells',
                            order: 1,
                          },
                        ],
                      },
                      {
                        id: 2,
                        dayOfWeek: 'Wednesday',
                        muscleTarget: 'Lower Body',
                        duration: 50,
                        calories: 400,
                        exercises: [
                          {
                            name: 'Squats',
                            sets: 4,
                            reps: '8-10',
                            description: 'Standard barbell squat',
                            order: 0,
                          },
                          {
                            name: 'Deadlifts',
                            sets: 3,
                            reps: '8-10',
                            description: 'Conventional deadlift form',
                            order: 1,
                          },
                        ],
                      },
                    ],
                  },
                  timestamp: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),
                },
                {
                  type: 'user',
                  message: 'Could you increase the intensity a bit for the upper body day?',
                  timestamp: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000 + 1000 * 60 * 5),
                },
                {
                  type: 'ai',
                  message:
                    "I've increased the intensity by adding more sets for the upper body exercises!",
                  timestamp: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000 + 1000 * 60 * 6),
                },
              ],
            },
            {
              id: 'wh-2',
              workoutPlan: {
                id: 2,
                name: 'Cardio Endurance Program',
                description:
                  'Improve cardiovascular health and endurance. Note: In a real application, this data would come from your database with actual saved workouts.',
                schedules: [
                  {
                    id: 3,
                    dayOfWeek: 'Tuesday',
                    muscleTarget: 'Cardio', // Using muscleTarget instead of focus
                    duration: 30,
                    calories: 250,
                    exercises: [
                      {
                        name: 'Running',
                        sets: 1,
                        reps: '30 mins',
                        description: 'Steady state running',
                        order: 0,
                      },
                      {
                        name: 'Jump Rope',
                        sets: 3,
                        reps: '5 mins',
                        description: 'High intensity rope jumping',
                        order: 1,
                      },
                    ],
                  },
                  {
                    id: 4,
                    dayOfWeek: 'Thursday',
                    muscleTarget: 'HIIT',
                    duration: 40,
                    calories: 300,
                    exercises: [
                      {
                        name: 'Burpees',
                        sets: 4,
                        reps: '45s work/15s rest',
                        description: 'High intensity interval training',
                        order: 0,
                      },
                      {
                        name: 'Mountain Climbers',
                        sets: 4,
                        reps: '45s work/15s rest',
                        description: 'High intensity interval training',
                        order: 1,
                      },
                    ],
                  },
                ],
              },
              createdAt: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000).toISOString(),
              clientId: userId,
              clientName: 'Jane Smith',
              conversationHistory: [
                {
                  type: 'ai',
                  message:
                    "Here's your personalized workout plan. Let me know if you'd like any modifications!",
                  workout: {
                    id: 2,
                    name: 'Cardio Endurance Program',
                    description: 'Improve cardiovascular health and endurance',
                    schedules: [
                      {
                        id: 3,
                        dayOfWeek: 'Tuesday',
                        muscleTarget: 'Cardio',
                        duration: 30,
                        calories: 250,
                        exercises: [
                          {
                            name: 'Running',
                            sets: 1,
                            reps: '30 mins',
                            description: 'Steady state running',
                            order: 0,
                          },
                          {
                            name: 'Jump Rope',
                            sets: 3,
                            reps: '5 mins',
                            description: 'High intensity rope jumping',
                            order: 1,
                          },
                        ],
                      },
                      {
                        id: 4,
                        dayOfWeek: 'Thursday',
                        muscleTarget: 'HIIT',
                        duration: 40,
                        calories: 300,
                        exercises: [
                          {
                            name: 'Burpees',
                            sets: 4,
                            reps: '45s work/15s rest',
                            description: 'High intensity interval training',
                            order: 0,
                          },
                          {
                            name: 'Mountain Climbers',
                            sets: 4,
                            reps: '45s work/15s rest',
                            description: 'High intensity interval training',
                            order: 1,
                          },
                        ],
                      },
                    ],
                  },
                  timestamp: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000),
                },
              ],
            },
          ]
        : [];

    return {
      success: true,
      data: mockHistory,
    };
  } catch (error) {
    console.error('Error fetching workout history:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to fetch workout history',
    };
  }
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/refine-workout.ts

```ts
'use server';

import { generateStructuredContent, validateResponseWithSchema } from '@/lib/AI';
import { generateFeedbackPrompt } from '@/lib/AI/prompts/workout-prompts';
import { WorkoutPlanSchema } from '@/lib/AI/types/workout-types';
import { revalidatePath } from 'next/cache';
import { z } from 'zod';
import type { z as zod } from 'zod';
import type { WorkoutPlan } from './generate-ai-workout';

const RefineWorkoutSchema = z.object({
  userId: z.string(),
  originalWorkoutPlan: z.any(), // This should be WorkoutPlan type but using any for flexibility
  feedback: z.string().min(1, 'Feedback is required'),
  conversationHistory: z.array(
    z.object({
      type: z.enum(['ai', 'user']),
      message: z.string(),
      timestamp: z.date(),
    }),
  ),
});

type RefineWorkoutInput = z.infer<typeof RefineWorkoutSchema>;

export async function refineWorkout(input: RefineWorkoutInput): Promise<{
  success: boolean;
  workoutPlan?: WorkoutPlan;
  error?: string;
}> {
  try {
    // Validate input
    const validatedData = RefineWorkoutSchema.parse(input);

    // Format conversation history for context
    const conversationContext = validatedData.conversationHistory
      .map((entry) => `${entry.type === 'ai' ? 'AI' : 'Trainer'}: ${entry.message}`)
      .join('\n\n');

    // Generate prompt with context
    const prompt = generateFeedbackPrompt({
      userId: validatedData.userId,
      originalWorkoutPlan: validatedData.originalWorkoutPlan,
      feedback: validatedData.feedback,
      conversationHistory: conversationContext,
    });

    // Generate updated workout plan
    const result = await generateStructuredContent<zod.infer<typeof WorkoutPlanSchema>>(
      prompt,
      (response) => validateResponseWithSchema(response, WorkoutPlanSchema),
      {
        provider: 'gemini', // Or 'openai' based on your configuration
        maxAttempts: 3,
        temperature: 0.7,
      },
    );

    if (result.success && result.data) {
      // Transform the result to match our interface
      const refinedWorkoutPlan: WorkoutPlan = {
        ...result.data,
        // Preserve original ID if it exists
        id: validatedData.originalWorkoutPlan.id || 0,
        // Keep original name unless modified in the feedback
        name: result.data.name || validatedData.originalWorkoutPlan.name,
      };

      // Update cache to reflect changes
      revalidatePath('/dashboard/trainer/workouts/assigncustomworkoutswithai');

      return {
        success: true,
        workoutPlan: refinedWorkoutPlan,
      };
    }

    return {
      success: false,
      error: 'Failed to generate a refined workout plan',
    };
  } catch (error) {
    console.error('Error refining workout:', error);
    return {
      success: false,
      error: error instanceof Error ? error.message : 'Failed to refine workout',
    };
  }
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/client display/client-display.tsx

```tsx
'use client';

import { Avatar, AvatarFallback } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Activity, ArrowRight, CalendarClock, Ruler, User, UserSearch, Weight } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import type { UserData } from '../../_actions/get-user-by-id';

interface ClientDisplayProps {
  user: UserData | null;
}

export default function ClientDisplay({ user }: ClientDisplayProps) {
  const router = useRouter();
  const [isNavigating, setIsNavigating] = useState(false);

  const handleClientSelection = () => {
    setIsNavigating(true);
    router.push('/dashboard/trainer/clients');
  };

  if (!user) {
    return (
      <Card className="overflow-hidden border-dashed">
        <CardHeader className="bg-muted/30 pb-8">
          <CardTitle className="flex items-center gap-2 text-lg">
            <User className="h-4 w-4" />
            Client Information
          </CardTitle>
        </CardHeader>
        <CardContent className="p-6 -mt-4">
          <div className="flex flex-col items-center justify-center p-6 text-center space-y-4">
            <div className="h-16 w-16 rounded-full bg-muted flex items-center justify-center">
              <User className="h-8 w-8 text-muted-foreground/60" />
            </div>
            <div className="space-y-2">
              <h3 className="font-medium">No Client Selected</h3>
              <p className="text-sm text-muted-foreground max-w-xs">
                Please select a client to create a personalized AI workout plan
              </p>
            </div>
            <Button
              className="mt-2 w-full sm:w-auto transition-all"
              onClick={handleClientSelection}
              disabled={isNavigating}
            >
              {isNavigating ? (
                <span className="flex items-center gap-2">
                  <div className="animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full" />
                  Navigating...
                </span>
              ) : (
                <span className="flex items-center gap-2">
                  <UserSearch className="h-4 w-4" />
                  Select Client
                  <ArrowRight className="h-4 w-4 ml-1" />
                </span>
              )}
            </Button>
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card>
      <CardHeader className="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20">
        <CardTitle className="flex items-center gap-2 text-lg">
          <User className="h-4 w-4" />
          Client Information
        </CardTitle>
      </CardHeader>
      <CardContent className="p-6">
        <div className="flex flex-col sm:flex-row sm:items-center gap-4 mb-4 pb-4 border-b">
          <Avatar className="h-16 w-16 border-2 border-primary/10">
            <AvatarFallback className="bg-gradient-to-br from-blue-100 to-blue-200 text-blue-700 text-xl">
              {user.name[0]}
            </AvatarFallback>
          </Avatar>
          <div>
            <h3 className="font-medium text-lg">{user.name}</h3>
            <p className="text-sm text-muted-foreground">{user.email}</p>
            {user.hasActiveWorkoutPlan && (
              <Badge variant="secondary" className="mt-2 gap-1.5">
                <Activity className="h-3 w-3" />
                Active Plan: {user.activeWorkoutPlan?.name}
              </Badge>
            )}
          </div>
        </div>

        {user.healthProfile ? (
          <div className="grid grid-cols-2 gap-3">
            <div className="flex items-center gap-2 p-3 rounded-lg bg-muted/40">
              <div className="h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                <Weight className="h-4 w-4" />
              </div>
              <div>
                <div className="text-xs text-muted-foreground">Weight</div>
                <div className="font-medium">
                  {user.healthProfile.weight ? `${user.healthProfile.weight} kg` : '—'}
                </div>
              </div>
            </div>
            <div className="flex items-center gap-2 p-3 rounded-lg bg-muted/40">
              <div className="h-8 w-8 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                <Ruler className="h-4 w-4" />
              </div>
              <div>
                <div className="text-xs text-muted-foreground">Height</div>
                <div className="font-medium">
                  {user.healthProfile.height ? `${user.healthProfile.height} cm` : '—'}
                </div>
              </div>
            </div>
            <div className="flex items-center gap-2 p-3 rounded-lg bg-muted/40">
              <div className="h-8 w-8 rounded-full bg-amber-100 flex items-center justify-center text-amber-600">
                <CalendarClock className="h-4 w-4" />
              </div>
              <div>
                <div className="text-xs text-muted-foreground">Age</div>
                <div className="font-medium">
                  {user.healthProfile.age ? `${user.healthProfile.age} years` : '—'}
                </div>
              </div>
            </div>
            <div className="flex items-center gap-2 p-3 rounded-lg bg-muted/40">
              <div className="h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600">
                <Activity className="h-4 w-4" />
              </div>
              <div>
                <div className="text-xs text-muted-foreground">Goal</div>
                <div className="font-medium">{user.healthProfile.goal || '—'}</div>
              </div>
            </div>
          </div>
        ) : (
          <div className="flex items-center gap-3 p-4 rounded-lg bg-amber-50 border border-amber-200 text-amber-800">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeWidth="2"
              strokeLinecap="round"
              strokeLinejoin="round"
              role="img"
              aria-label="Warning icon"
            >
              <circle cx="12" cy="12" r="10" />
              <line x1="12" x2="12" y1="8" y2="12" />
              <line x1="12" x2="12.01" y1="16" y2="16" />
            </svg>
            <div className="text-sm">
              <p className="font-medium">No Health Profile</p>
              <p>The AI workout will use general parameters</p>
            </div>
          </div>
        )}
      </CardContent>
    </Card>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/client display/client-workout-generator.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';
import { motion } from 'framer-motion';
import { ArrowLeft } from 'lucide-react';
import { useState } from 'react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';
import type { UserData } from '../../_actions/get-user-by-id';
import { useWorkoutViewStore } from '../../_store/workout-view-store';
import WorkoutForm from '../workout-form/workout-form';
import WorkoutResults from '../workout-result/workout-results';
import ClientDisplay from './client-display';

interface GeneratedWorkout {
  clientName: string;
  workoutPlan: WorkoutPlan;
}

interface ClientWorkoutGeneratorProps {
  user: UserData | null;
  onWorkoutGenerated?: (workout: GeneratedWorkout) => void;
}

export default function ClientWorkoutGenerator({
  user,
  onWorkoutGenerated,
}: ClientWorkoutGeneratorProps) {
  const { toast } = useToast();
  const { loadWorkout } = useWorkoutViewStore();
  const [workoutPlan, setWorkoutPlan] = useState<WorkoutPlan | null>(null);
  const [isSaving, setIsSaving] = useState(false);

  const handleWorkoutGenerated = (plan: WorkoutPlan) => {
    setWorkoutPlan(plan);
  };

  const handleSaveWorkout = async (plan: WorkoutPlan) => {
    if (!user) return;

    setIsSaving(true);

    try {
      // Create a complete workout object
      const workout: GeneratedWorkout = {
        clientName: user.name || 'Client',
        workoutPlan: plan,
      };

      // Load the workout into the store
      loadWorkout(workout);

      // Call the callback to switch to the workout tab
      onWorkoutGenerated?.(workout);

      toast({
        title: 'Success',
        description: 'Workout plan has been generated successfully!',
      });

      // Reset state after save
      setWorkoutPlan(null);
    } catch (error) {
      console.error('Error saving workout plan:', error);
      toast({
        title: 'Error',
        description: 'Failed to generate the workout plan',
        variant: 'destructive',
      });
    } finally {
      setIsSaving(false);
    }
  };

  const handleDiscardWorkout = () => {
    setWorkoutPlan(null);
  };

  return (
    <div className="space-y-6">
      {!workoutPlan ? (
        <motion.div
          className="grid gap-6 md:grid-cols-5"
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.3 }}
        >
          <div className="md:col-span-2">
            <ClientDisplay user={user} />
          </div>
          <div className="md:col-span-3 border rounded-lg p-5 sm:p-6 bg-white dark:bg-gray-950">
            <h2 className="text-xl font-medium mb-4">Generate AI Workout Plan</h2>
            <WorkoutForm user={user} onWorkoutGenerated={handleWorkoutGenerated} />
          </div>
        </motion.div>
      ) : (
        <motion.div
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.3 }}
          className="rounded-lg p-3 sm:p-8 dark:bg-gray-950"
        >
          <div className="mb-6">
            <Button
              variant="ghost"
              size="sm"
              onClick={handleDiscardWorkout}
              className="text-muted-foreground hover:text-foreground -ml-2"
            >
              <ArrowLeft className="h-4 w-4 mr-2" />
              Back to form
            </Button>
          </div>
          <WorkoutResults
            workoutPlan={workoutPlan}
            onSave={handleSaveWorkout}
            onDiscard={handleDiscardWorkout}
            isLoading={isSaving}
            userId={user?.id || ''}
          />
        </motion.div>
      )}
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/client-selector/client-selector.tsx

```tsx

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/feedback/feedback-chat.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Textarea } from '@/components/ui/textarea';
import { Loader2, MessageSquare, SendIcon } from 'lucide-react';
import { useState } from 'react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';

interface FeedbackChatProps {
  workoutPlan: WorkoutPlan;
  onSendFeedback: (feedback: string) => Promise<void>;
  isSubmitting: boolean;
  conversationHistory: Array<{
    type: 'ai' | 'user';
    message: string;
    workout?: WorkoutPlan;
    timestamp: Date;
  }>;
}

export function FeedbackChat({
  // workoutPlan,
  onSendFeedback,
  isSubmitting,
  conversationHistory,
}: FeedbackChatProps) {
  const [feedback, setFeedback] = useState('');

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!feedback.trim() || isSubmitting) return;

    await onSendFeedback(feedback);
    setFeedback('');
  };

  return (
    <div className="flex flex-col space-y-4 mt-6">
      <div className="rounded-lg bg-muted/30 p-4 max-h-[400px] overflow-y-auto">
        <div className="space-y-4">
          {conversationHistory.map((entry, index) => (
            <div
              key={`chat-${index}-${entry.timestamp.getTime()}`}
              className={`flex ${entry.type === 'user' ? 'justify-end' : 'justify-start'}`}
            >
              <div
                className={`max-w-[85%] p-4 rounded-lg ${
                  entry.type === 'user'
                    ? 'bg-primary text-primary-foreground'
                    : 'bg-muted text-muted-foreground'
                }`}
              >
                {entry.type === 'user' ? (
                  <div className="flex gap-2 items-start">
                    <div className="whitespace-pre-wrap text-sm">{entry.message}</div>
                  </div>
                ) : (
                  <div className="space-y-2">
                    <div className="flex gap-2 items-center text-sm font-medium">
                      <MessageSquare className="h-4 w-4" />
                      AI Response
                    </div>
                    <div className="whitespace-pre-wrap text-sm">{entry.message}</div>
                  </div>
                )}
                <p className="text-xs opacity-70 text-right mt-2">
                  {entry.timestamp.toLocaleTimeString([], {
                    hour: '2-digit',
                    minute: '2-digit',
                  })}
                </p>
              </div>
            </div>
          ))}
        </div>
      </div>

      <form onSubmit={handleSubmit} className="flex gap-2 items-end">
        <Textarea
          value={feedback}
          onChange={(e) => setFeedback(e.target.value)}
          placeholder="Provide feedback to refine this workout plan..."
          className="resize-none min-h-[100px]"
          disabled={isSubmitting}
        />
        <Button
          type="submit"
          size="icon"
          className="h-10 w-10 shrink-0"
          disabled={isSubmitting || !feedback.trim()}
        >
          {isSubmitting ? (
            <Loader2 className="h-4 w-4 animate-spin" />
          ) : (
            <SendIcon className="h-4 w-4" />
          )}
        </Button>
      </form>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/history/exercise.tsx

```tsx
'use client';

import { Dumbbell } from 'lucide-react';

interface ExerciseProps {
  exercise: {
    name: string;
    sets: string | number;
    reps: string | number;
    description: string;
    weight?: string | number;
    duration?: string | number;
    rest?: string | number;
    muscleGroup?: string;
  };
  index: number;
  variant?: 'default' | 'compact' | 'detailed';
  showMuscleGroup?: boolean;
  showIndex?: boolean;
}

export default function Exercise({
  exercise,
  index,
  variant = 'default',
  showMuscleGroup = false,
  showIndex = true,
}: ExerciseProps) {
  // Handle different display variants
  if (variant === 'compact') {
    return (
      <div className="flex items-center justify-between py-2 px-3 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors">
        <div className="flex items-center gap-2">
          {showIndex && (
            <span className="bg-indigo-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold shadow-sm">
              {index + 1}
            </span>
          )}
          <span className="font-medium text-sm truncate max-w-[180px]">{exercise.name}</span>
        </div>
        <span className="text-xs bg-background/50 px-2 py-1 rounded-full">
          {exercise.sets} × {exercise.reps}
        </span>
      </div>
    );
  }

  if (variant === 'detailed') {
    return (
      <div className="rounded-xl p-4 transition-all shadow-sm group bg-gradient-to-br from-transparent to-muted/10 hover:bg-indigo-50/30 dark:hover:bg-indigo-900/10 border">
        <div className="flex items-start gap-3">
          {showIndex ? (
            <span className="bg-indigo-600 text-white text-sm rounded-full h-8 w-8 flex items-center justify-center font-bold shadow-sm mt-0.5">
              {index + 1}
            </span>
          ) : (
            <span className="bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 rounded-full h-8 w-8 flex items-center justify-center shadow-sm mt-0.5">
              <Dumbbell className="h-4 w-4" />
            </span>
          )}
          <div className="flex-1">
            <h4 className="font-medium text-base group-hover:text-indigo-600 transition-colors">
              {exercise.name}
            </h4>

            {showMuscleGroup && exercise.muscleGroup && (
              <span className="text-xs text-muted-foreground bg-muted/50 px-2 py-0.5 rounded-full mt-1 inline-block">
                {exercise.muscleGroup}
              </span>
            )}

            <p className="text-sm mt-2 text-muted-foreground group-hover:text-foreground/70 transition-colors">
              {exercise.description}
            </p>

            <div className="flex flex-wrap gap-2 mt-3">
              <span className="text-xs bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-300 px-2.5 py-1 rounded-full font-medium">
                {exercise.sets} sets × {exercise.reps} reps
              </span>

              {exercise.weight && (
                <span className="text-xs bg-muted/50 px-2.5 py-1 rounded-full">
                  {exercise.weight} weight
                </span>
              )}

              {exercise.rest && (
                <span className="text-xs bg-muted/50 px-2.5 py-1 rounded-full">
                  {exercise.rest} rest
                </span>
              )}

              {exercise.duration && (
                <span className="text-xs bg-muted/50 px-2.5 py-1 rounded-full">
                  {exercise.duration} duration
                </span>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  }

  // Default variant
  return (
    <div className="rounded-xl p-3 sm:p-4 transition-all hover:shadow-md group bg-gradient-to-br from-transparent to-muted/5 hover:bg-indigo-50/20 dark:hover:bg-indigo-900/5">
      <div className="flex flex-col sm:flex-row sm:items-center gap-2">
        <div className="flex items-start gap-2 min-w-0 flex-1">
          {showIndex && (
            <span className="bg-indigo-600 text-white text-sm rounded-full h-7 w-7 sm:h-8 sm:w-8 flex items-center justify-center font-bold shrink-0 shadow-sm mt-0.5">
              {index + 1}
            </span>
          )}
          <div className="min-w-0 flex-1">
            <h4 className="font-medium text-sm sm:text-base group-hover:text-indigo-600 transition-colors truncate">
              {exercise.name}
            </h4>
            <p className="text-xs sm:text-sm mt-1 text-muted-foreground group-hover:text-foreground/80 transition-colors line-clamp-2">
              {exercise.description}
            </p>
          </div>
        </div>
        <div className="ml-9 sm:ml-0 mt-1 sm:mt-0">
          <span className="text-xs sm:text-sm font-medium bg-muted/80 group-hover:bg-indigo-50 dark:group-hover:bg-indigo-900/10 group-hover:text-indigo-600 px-2.5 py-1.5 rounded-full transition-colors inline-block">
            {exercise.sets} × {exercise.reps}
          </span>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/history/workout-history-provider.tsx

```tsx
'use client';

import { useEffect, useState } from 'react';
import type { WorkoutHistoryItem } from '../../_actions/get-workout-history';
import { useWorkoutChatStore } from '../../_store/workout-chat-store';
import WorkoutHistory from './workout-history';

interface WorkoutHistoryProviderProps {
  userId: string;
  serverFallbackHistory: WorkoutHistoryItem[];
}

export function WorkoutHistoryProvider({
  userId,
  serverFallbackHistory,
}: WorkoutHistoryProviderProps) {
  const [isLoading, setIsLoading] = useState(true);
  const [history, setHistory] = useState<WorkoutHistoryItem[]>(serverFallbackHistory);
  const { getSavedWorkouts, initializeConversation, reset } = useWorkoutChatStore();

  // biome-ignore lint/correctness/useExhaustiveDependencies: <explanation>
  useEffect(() => {
    // This runs on client-side only
    try {
      // Get saved workouts from localStorage
      const savedWorkouts = getSavedWorkouts(userId);

      // If we have saved workouts, use those instead of the server fallback
      if (savedWorkouts && savedWorkouts.length > 0) {
        setHistory(savedWorkouts);
      }
    } catch (error) {
      console.error('Error fetching saved workouts:', error);
    } finally {
      setIsLoading(false);
    }
  }, [userId, getSavedWorkouts, serverFallbackHistory]);

  // Handle view workout functionality
  const handleViewWorkout = (workout: WorkoutHistoryItem) => {
    try {
      // Reset the current conversation first
      reset();

      // If conversation history exists, restore it
      if (workout.conversationHistory && workout.conversationHistory.length > 0) {
        // Load the conversation history
        for (const message of workout.conversationHistory) {
          if (message.type === 'ai' && message.workout) {
            initializeConversation(message.workout);
            break; // We only need the last workout from AI
          }
        }
      } else {
        // Fallback to just initializing with the workout plan
        initializeConversation(workout.workoutPlan);
      }
    } catch (error) {
      console.error('Error viewing workout:', error);
    }
  };

  return (
    <>
      {/* Show debug info about data source */}
      {/* <div className="text-xs text-muted-foreground mb-4">
        Showing {history.length} workout(s)
        {history.length > 0 && history[0].id.startsWith("workout-")
          ? " from localStorage"
          : " from server"}
      </div> */}

      <WorkoutHistory
        history={history}
        isLoading={isLoading}
        onViewWorkout={handleViewWorkout}
        dataSource={history.length > 0 && history[0].id.startsWith('workout-') ? 'local' : 'server'}
      />
    </>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/history/workout-history.tsx

```tsx
'use client';

import { formatDistanceToNow } from 'date-fns';
import {
  Activity,
  Calendar,
  ChevronRight,
  Clock,
  Dumbbell,
  Goal,
  Grid3x3,
  ListFilter,
  MessageSquare,
  Sparkles,
  Target,
  X,
} from 'lucide-react';
import { useState } from 'react';

import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { useToast } from '@/hooks/use-toast';
import type { WorkoutPlan, WorkoutSchedule } from '../../_actions/generate-ai-workout';
import type { WorkoutHistoryItem } from '../../_actions/get-workout-history';
import { useWorkoutChatStore } from '../../_store/workout-chat-store';
import Exercise from './exercise';

// Define interfaces for handling alternative property names
interface WorkoutPlanWithAlternativeNames extends Partial<WorkoutPlan> {
  title?: string; // Alternative to 'name'
}

interface WorkoutScheduleWithAlternativeNames extends Partial<WorkoutSchedule> {
  focus?: string; // Alternative to 'muscleTarget'
}

// Define workout difficulty levels with corresponding colors
const DIFFICULTY_COLORS = {
  easy: 'bg-green-100 text-green-800',
  moderate: 'bg-blue-100 text-blue-800',
  challenging: 'bg-orange-100 text-orange-800',
  intense: 'bg-red-100 text-red-800',
  default: 'bg-gray-100 text-gray-800',
};

// Mapping for muscle target icons
const MUSCLE_ICONS: Record<string, React.ReactNode> = {
  'Upper Body': <Target className="h-3 w-3" />,
  'Lower Body': <Dumbbell className="h-3 w-3" />,
  'Full Body': <Activity className="h-3 w-3" />,
  Core: <Target className="h-3 w-3" />,
  Arms: <Dumbbell className="h-3 w-3" />,
  Legs: <Dumbbell className="h-3 w-3" />,
  Chest: <Target className="h-3 w-3" />,
  Back: <Target className="h-3 w-3" />,
};

interface WorkoutHistoryProps {
  history: WorkoutHistoryItem[];
  isLoading?: boolean;
  onViewWorkout?: (workout: WorkoutHistoryItem) => void;
  dataSource: 'local' | 'server';
}

// Helper function to get workout name regardless of field structure
function getWorkoutTitle(workoutPlan: WorkoutPlan | WorkoutPlanWithAlternativeNames): string {
  return (
    workoutPlan.name || (workoutPlan as WorkoutPlanWithAlternativeNames).title || 'Untitled Workout'
  );
}

// Helper function to determine workout focus/target area
function getWorkoutFocus(schedule: WorkoutSchedule | WorkoutScheduleWithAlternativeNames): string {
  return (
    schedule.muscleTarget || (schedule as WorkoutScheduleWithAlternativeNames).focus || 'General'
  );
}

// Helper function to determine workout difficulty
function getWorkoutDifficulty(workout: WorkoutHistoryItem): string {
  const exercisesCount = workout.workoutPlan.schedules.reduce(
    (sum, day) => sum + day.exercises.length,
    0,
  );
  const avgDuration =
    workout.workoutPlan.schedules.reduce((sum, day) => sum + (day.duration || 0), 0) /
    workout.workoutPlan.schedules.length;

  if (exercisesCount > 30 || avgDuration > 60) return 'intense';
  if (exercisesCount > 20 || avgDuration > 45) return 'challenging';
  if (exercisesCount > 10 || avgDuration > 30) return 'moderate';
  return 'easy';
}

export default function WorkoutHistory({
  history,
  isLoading = false,
  onViewWorkout,
  // dataSource,
}: WorkoutHistoryProps) {
  const { toast } = useToast();
  const [expandedItemId, setExpandedItemId] = useState<string | null>(null);
  const [viewMode, setViewMode] = useState<'list' | 'grid'>('list');
  const [selectedDay, setSelectedDay] = useState<{
    workoutId: string;
    dayIndex: number;
  } | null>(null);
  const { initializeConversation, reset } = useWorkoutChatStore();

  const toggleExpand = (id: string) => {
    // If we're viewing exercises for a day in this workout, close that view first
    if (selectedDay?.workoutId === id) {
      setSelectedDay(null);
    }
    setExpandedItemId(expandedItemId === id ? null : id);
  };

  const handleDayClick = (workoutId: string, dayIndex: number) => {
    setSelectedDay({ workoutId, dayIndex });
  };

  const closeSelectedDay = () => {
    setSelectedDay(null);
  };

  const handleViewWorkout = (workout: WorkoutHistoryItem) => {
    try {
      // Reset the current conversation first
      reset();

      // If conversation history exists, restore it instead of just initializing
      if (workout.conversationHistory && workout.conversationHistory.length > 0) {
        // Load the entire conversation history
        for (const message of workout.conversationHistory) {
          if (message.type === 'ai' && message.workout) {
            initializeConversation(message.workout);
          }
        }
      } else {
        // Fallback to just initializing with the workout plan
        initializeConversation(workout.workoutPlan);
      }

      if (onViewWorkout) {
        onViewWorkout(workout);
      }
    } catch (error) {
      console.error('Error viewing workout:', error);
      toast({
        title: 'Error',
        description: 'Failed to load workout details',
        variant: 'destructive',
      });
    }
  };

  if (isLoading) {
    return (
      <div className="space-y-4">
        {[1, 2, 3].map((i) => (
          <div key={i} className="p-4 border rounded-lg">
            <div className="flex justify-between items-start">
              <Skeleton className="h-6 w-1/3 mb-2" />
              <Skeleton className="h-5 w-20" />
            </div>
            <Skeleton className="h-4 w-3/4 mb-4" />
            <div className="flex flex-wrap gap-2">
              <Skeleton className="h-8 w-24" />
              <Skeleton className="h-8 w-32" />
            </div>
          </div>
        ))}
      </div>
    );
  }

  if (history.length === 0) {
    return (
      <div className="py-12 text-center bg-muted/20 rounded-lg">
        <div className="inline-flex h-12 w-12 items-center justify-center rounded-full bg-muted mb-4">
          <Calendar className="h-6 w-6 text-muted-foreground" />
        </div>
        <p className="text-muted-foreground">You haven't generated any workouts yet.</p>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {/* Basic stats */}
      <div className="grid grid-cols-2 md:grid-cols-3 gap-2 mb-4">
        <div className="bg-muted/20 rounded-lg p-3">
          <div className="text-xs text-muted-foreground">Total Workouts</div>
          <div className="text-2xl font-semibold">{history.length}</div>
        </div>
        <div className="bg-muted/20 rounded-lg p-3">
          <div className="text-xs text-muted-foreground">Latest Workout</div>
          <div className="text-lg font-semibold truncate">
            {history.length > 0
              ? formatDistanceToNow(new Date(history[0].createdAt), {
                  addSuffix: true,
                })
              : 'None'}
          </div>
        </div>
        {/* <div className="bg-muted/20 rounded-lg p-3">
          <div className="text-xs text-muted-foreground">Data Source</div>
          <div className="text-2xl font-semibold truncate capitalize">{dataSource}</div>
        </div> */}
      </div>

      {/* View toggle */}
      <div className="flex justify-end mb-4">
        <div className="flex gap-2">
          <Button
            variant={viewMode === 'list' ? 'default' : 'outline'}
            size="icon"
            onClick={() => setViewMode('list')}
            className="h-9 w-9"
          >
            <ListFilter className="h-4 w-4" />
          </Button>
          <Button
            variant={viewMode === 'grid' ? 'default' : 'outline'}
            size="icon"
            onClick={() => setViewMode('grid')}
            className="h-9 w-9"
          >
            <Grid3x3 className="h-4 w-4" />
          </Button>
        </div>
      </div>

      {/* Workout list */}
      <div className={viewMode === 'grid' ? 'grid grid-cols-1 sm:grid-cols-2 gap-4' : 'space-y-4'}>
        {history.map((item) => {
          const difficulty = getWorkoutDifficulty(item);
          const difficultyClass =
            DIFFICULTY_COLORS[difficulty as keyof typeof DIFFICULTY_COLORS] ||
            DIFFICULTY_COLORS.default;
          const isShowingDayExercises = selectedDay?.workoutId === item.id;

          return (
            <div
              key={item.id}
              className="border rounded-lg overflow-hidden bg-background hover:border-primary/30 transition-colors"
            >
              {/* Workout Header - Always visible */}
              <button
                type="button"
                className={`p-4 w-full text-left cursor-pointer hover:bg-muted/10 transition-colors ${
                  isShowingDayExercises ? 'bg-muted/10' : ''
                }`}
                onClick={() => toggleExpand(item.id)}
              >
                <div className="flex justify-between items-start mb-2">
                  <div>
                    <div className="flex items-center gap-2">
                      <h4 className="font-medium">{getWorkoutTitle(item.workoutPlan)}</h4>
                      <div className={`text-xs px-2 py-0.5 rounded-full ${difficultyClass}`}>
                        {difficulty}
                      </div>
                    </div>
                  </div>
                  <span className="text-xs text-muted-foreground">
                    {formatDistanceToNow(new Date(item.createdAt), {
                      addSuffix: true,
                    })}
                  </span>
                </div>
                <p className="text-sm text-muted-foreground mb-3 line-clamp-2">
                  {item.workoutPlan.description}
                </p>

                <div className="flex flex-wrap gap-2 text-xs">
                  <div className="bg-muted px-2.5 py-1 rounded-full flex items-center gap-1">
                    <Goal className="h-3 w-3" />
                    <span>{item.clientName || 'Client'}</span>
                  </div>
                  <div className="bg-muted px-2.5 py-1 rounded-full flex items-center gap-1">
                    <Activity className="h-3 w-3" />
                    <span>
                      {item.workoutPlan.schedules.length} day
                      {item.workoutPlan.schedules.length !== 1 ? 's' : ''}
                    </span>
                  </div>
                  <div className="bg-muted px-2.5 py-1 rounded-full flex items-center gap-1">
                    <Clock className="h-3 w-3" />
                    <span>
                      {Math.max(...item.workoutPlan.schedules.map((s) => s.duration || 0))} min
                    </span>
                  </div>
                  {item.conversationHistory && item.conversationHistory.length > 0 && (
                    <div className="bg-muted px-2.5 py-1 rounded-full flex items-center gap-1">
                      <MessageSquare className="h-3 w-3" />
                      <span>{item.conversationHistory.length} messages</span>
                    </div>
                  )}
                </div>
              </button>

              {/* Schedule Summary or Day Exercise Detail */}
              {expandedItemId === item.id && (
                <div className="p-4 pt-0 border-t border-dashed">
                  {!isShowingDayExercises ? (
                    <div className="mt-3 space-y-2">
                      <h5 className="text-sm font-medium">Schedule Summary:</h5>
                      <div className="space-y-1.5">
                        {item.workoutPlan.schedules.map((day, idx) => {
                          const focus = getWorkoutFocus(day);
                          const _icon = MUSCLE_ICONS[focus] || <Target className="h-3 w-3" />;

                          return (
                            <div
                              key={`${item.id}-day-${day.dayOfWeek}`}
                              // type="button"
                              className="text-xs flex items-center bg-muted/30 px-3 py-2 rounded cursor-pointer hover:bg-muted/60 transition-colors w-full text-left"
                              onClick={(e) => {
                                e.stopPropagation();
                                handleDayClick(item.id, idx);
                              }}
                              onKeyDown={(e) => {
                                if (e.key === 'Enter' || e.key === ' ') {
                                  e.stopPropagation();
                                  handleDayClick(item.id, idx);
                                }
                              }}
                            >
                              <div className="font-medium w-20">{day.dayOfWeek}:</div>
                              <div className="flex items-center mr-2">
                                {_icon}
                                <span className="ml-1 text-muted-foreground">{focus}</span>
                              </div>
                              <span className="text-xs text-muted-foreground ml-auto">
                                {day.exercises.length} exercises • {day.duration || '?'} min
                              </span>
                              <ChevronRight className="h-3.5 w-3.5 ml-2 text-muted-foreground" />
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  ) : (
                    <div className="mt-3 space-y-3">
                      {/* Day exercise details */}
                      {(() => {
                        const dayIndex = selectedDay?.dayIndex ?? 0;
                        const day = item.workoutPlan.schedules[dayIndex];
                        const focus = getWorkoutFocus(day);
                        const _icon = MUSCLE_ICONS[focus] || <Target className="h-3 w-3" />;

                        return (
                          <>
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-2">
                                <Button
                                  size="icon"
                                  variant="ghost"
                                  className="h-7 w-7"
                                  onClick={(e) => {
                                    e.stopPropagation();
                                    closeSelectedDay();
                                  }}
                                >
                                  <ChevronRight className="h-4 w-4 -rotate-180" />
                                </Button>
                                <h5 className="text-sm font-medium flex items-center">
                                  <span>
                                    {day.dayOfWeek} - {focus}
                                  </span>
                                </h5>
                              </div>
                              <div className="text-xs flex items-center gap-1">
                                <Clock className="h-3.5 w-3.5 text-muted-foreground" />
                                <span>{day.duration || '?'} min</span>
                              </div>
                            </div>

                            <div className="space-y-2 mt-2">
                              {day.exercises.map((exercise, exIndex) => (
                                <Exercise
                                  key={`${exercise.name}-${exIndex}`}
                                  exercise={exercise}
                                  index={exIndex}
                                  variant="default"
                                  showIndex={true}
                                />
                              ))}
                            </div>
                          </>
                        );
                      })()}
                    </div>
                  )}

                  {/* Show conversation summary if it exists */}
                  {!isShowingDayExercises &&
                    item.conversationHistory &&
                    item.conversationHistory.length > 1 && (
                      <div className="mt-3 space-y-2">
                        <h5 className="text-sm font-medium flex items-center gap-1">
                          <MessageSquare className="h-3.5 w-3.5" />
                          <span>Conversation History:</span>
                        </h5>
                        <div className="text-xs bg-muted/30 px-3 py-2 rounded max-h-24 overflow-y-auto">
                          {item.conversationHistory.slice(1).map((message, idx) => (
                            <div key={idx as number} className="mb-1">
                              <span
                                className={`font-medium ${
                                  message.type === 'user' ? 'text-primary' : 'text-muted-foreground'
                                }`}
                              >
                                {message.type === 'user' ? 'You: ' : 'AI: '}
                              </span>
                              <span className="truncate line-clamp-1">{message.message}</span>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                  {/* Load button - always at the bottom */}
                  <div className="mt-4">
                    <Button
                      variant="default"
                      size="sm"
                      className="w-full gap-1"
                      onClick={(e) => {
                        e.stopPropagation();
                        handleViewWorkout(item);
                      }}
                    >
                      <Sparkles className="h-3.5 w-3.5" />
                      <span>Load This Workout</span>
                      <ChevronRight className="h-3.5 w-3.5 ml-auto" />
                    </Button>
                  </div>
                </div>
              )}
            </div>
          );
        })}
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/tabs/workout-tabs.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { ChevronLeft, Dumbbell, Loader2, Sparkles } from 'lucide-react';
import { Suspense, useState } from 'react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';
import type { UserData } from '../../_actions/get-user-by-id';
import type { WorkoutHistoryItem } from '../../_actions/get-workout-history';
import { useWorkoutViewStore } from '../../_store/workout-view-store';
import ClientWorkoutGenerator from '../client display/client-workout-generator';
import { WorkoutHistoryProvider } from '../history/workout-history-provider';
import WorkoutResults from '../workout-result/workout-results';

interface GeneratedWorkout {
  clientName: string;
  workoutPlan: WorkoutPlan;
}

interface WorkoutTabsProps {
  userId: string;
  user: UserData | null;
  serverFallbackHistory: WorkoutHistoryItem[];
}

// Loading skeleton for the generate tab
function GenerateWorkoutSkeleton() {
  return (
    <div className="space-y-6 p-6">
      {/* Form header skeleton */}
      <div className="space-y-4">
        <Skeleton className="h-8 w-48" />
        <Skeleton className="h-4 w-72" />
      </div>

      {/* Form fields skeleton */}
      <div className="space-y-4">
        {[1, 2, 3].map((i) => (
          <div key={`field-${i}`} className="space-y-2">
            <Skeleton className="h-4 w-24" />
            <Skeleton className="h-10 w-full" />
          </div>
        ))}
      </div>

      {/* Submit button skeleton */}
      <div className="flex justify-end">
        <Skeleton className="h-10 w-32" />
      </div>
    </div>
  );
}

// Loading skeleton for the history tab
function HistorySkeleton() {
  return (
    <div className="space-y-6 p-6">
      <h3 className="text-xl font-medium">Previously Generated Workouts</h3>
      <div className="space-y-4">
        {[1, 2, 3].map((i) => (
          <div key={`history-${i}`} className="p-4 border rounded-lg space-y-3">
            <div className="flex justify-between items-start">
              <Skeleton className="h-6 w-1/3" />
              <Skeleton className="h-5 w-20" />
            </div>
            <Skeleton className="h-4 w-3/4" />
            <div className="flex flex-wrap gap-2">
              <Skeleton className="h-8 w-24" />
              <Skeleton className="h-8 w-32" />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

export default function WorkoutTabs({ userId, user, serverFallbackHistory }: WorkoutTabsProps) {
  // Use local state for activeTab instead of store
  const [activeTab, setActiveTab] = useState<'generate' | 'history' | 'workout'>('generate');

  const {
    activeWorkout,
    setShowWorkoutDetails,
    // reset,
  } = useWorkoutViewStore();

  const handleTabChange = (value: string) => {
    setActiveTab(value as 'generate' | 'history' | 'workout');

    // If switching away from workout tab, reset the workout view
    if (value !== 'workout') {
      setShowWorkoutDetails(false);
    }
  };

  const handleBackToHistory = () => {
    setActiveTab('history');
    setShowWorkoutDetails(false);
  };

  const handleWorkoutGenerated = (workout: GeneratedWorkout) => {
    console.log('workout', workout);
    // When a workout is generated, switch to the workout tab
    setActiveTab('workout');
    setShowWorkoutDetails(true);
  };

  return (
    <Tabs value={activeTab} onValueChange={handleTabChange} className="space-y-8">
      <div className="sticky top-0 z-10 pb-4 pt-2 bg-gradient-to-b from-background via-background to-background/95 backdrop-blur-lg">
        <div className="container max-w-5xl mx-auto px-4">
          <div className="flex justify-center">
            <TabsList className="w-full max-w-md bg-gradient-to-r from-indigo-50/80 via-blue-50/80 to-indigo-50/80 dark:from-indigo-950/80 dark:via-blue-950/80 dark:to-indigo-950/80 border border-indigo-100/50 dark:border-indigo-800/30 shadow-md rounded-lg p-1.5">
              <TabsTrigger
                value="generate"
                className="flex-1 data-[state=active]:bg-gradient-to-br data-[state=active]:from-indigo-600/90 data-[state=active]:via-blue-600/80 data-[state=active]:to-indigo-700/90 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-300 rounded-md py-2"
              >
                <Sparkles className="h-4 w-4 mr-2" />
                Generate
              </TabsTrigger>
              <TabsTrigger
                value="history"
                className="flex-1 data-[state=active]:bg-gradient-to-br data-[state=active]:from-indigo-600/90 data-[state=active]:via-blue-600/80 data-[state=active]:to-indigo-700/90 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-300 rounded-md py-2"
              >
                <Dumbbell className="h-4 w-4 mr-2" />
                History
              </TabsTrigger>
              <TabsTrigger
                value="workout"
                className="flex-1 data-[state=active]:bg-gradient-to-br data-[state=active]:from-indigo-600/90 data-[state=active]:via-blue-600/80 data-[state=active]:to-indigo-700/90 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-300 rounded-md py-2"
              >
                <Loader2 className="h-4 w-4 mr-2" />
                Workout
              </TabsTrigger>
            </TabsList>
          </div>
        </div>
      </div>

      <TabsContent
        value="generate"
        className="space-y-6 focus-visible:outline-none focus-visible:ring-0"
      >
        <div className="container max-w-5xl mx-auto px-4">
          <Suspense fallback={<GenerateWorkoutSkeleton />}>
            <ClientWorkoutGenerator user={user} onWorkoutGenerated={handleWorkoutGenerated} />
          </Suspense>
        </div>
      </TabsContent>

      <TabsContent value="history" className="focus-visible:outline-none focus-visible:ring-0">
        <div className="container max-w-5xl mx-auto px-4">
          <Suspense fallback={<HistorySkeleton />}>
            <div className="space-y-6">
              <div className="bg-gradient-to-br from-indigo-50/50 via-blue-50/30 to-indigo-50/50 dark:from-indigo-950/50 dark:via-blue-950/30 dark:to-indigo-950/50 p-4 rounded-lg border border-indigo-100/50 dark:border-indigo-800/20 mb-6">
                <h3 className="text-xl font-medium">Previously Generated Workouts</h3>
                <p className="text-sm text-muted-foreground mt-1">
                  View and load your previously created workout plans
                </p>
              </div>
              <WorkoutHistoryProvider
                userId={userId}
                serverFallbackHistory={serverFallbackHistory}
              />
            </div>
          </Suspense>
        </div>
      </TabsContent>

      <TabsContent value="workout" className="focus-visible:outline-none focus-visible:ring-0">
        <div className="container max-w-5xl mx-auto px-4">
          {activeWorkout ? (
            <div className="space-y-6">
              <div className="bg-gradient-to-br from-indigo-50/50 via-blue-50/30 to-indigo-50/50 dark:from-indigo-950/50 dark:via-blue-950/30 dark:to-indigo-950/50 p-4 rounded-lg border border-indigo-100/50 dark:border-indigo-800/20 flex items-center justify-between">
                <Button
                  variant="ghost"
                  size="sm"
                  className="flex items-center gap-1 text-muted-foreground hover:text-foreground"
                  onClick={handleBackToHistory}
                >
                  <ChevronLeft className="h-4 w-4" />
                  <span>Back to history</span>
                </Button>
                <div className="text-sm">
                  Workout for:{' '}
                  <span className="font-medium text-indigo-700 dark:text-indigo-400">
                    {activeWorkout.clientName}
                  </span>
                </div>
              </div>

              <WorkoutResults
                workoutPlan={activeWorkout.workoutPlan}
                onSave={() => {
                  // After saving, you might want to go back to history
                  handleBackToHistory();
                }}
                onDiscard={handleBackToHistory}
                userId={userId}
                userName={user?.name}
              />
            </div>
          ) : (
            <div className="bg-white/70 dark:bg-gray-950/70 backdrop-blur-sm border border-indigo-100/50 dark:border-indigo-800/30 rounded-lg shadow-sm">
              <div className="flex flex-col items-center justify-center py-16 text-center px-4">
                <div className="w-16 h-16 rounded-full bg-gradient-to-br from-indigo-100 to-blue-100 dark:from-indigo-900/40 dark:to-blue-900/40 flex items-center justify-center mb-4 shadow-inner">
                  <Dumbbell className="h-8 w-8 text-indigo-600/70 dark:text-indigo-400/70" />
                </div>
                <h3 className="text-xl font-medium mb-2">No Workout Selected</h3>
                <p className="text-muted-foreground max-w-md mb-6">
                  Please select a workout from your history or generate a new one to view it here.
                </p>
                <div className="flex gap-2">
                  <Button
                    variant="outline"
                    onClick={() => setActiveTab('history')}
                    className="gap-1 border-indigo-200 dark:border-indigo-800/30"
                  >
                    <ChevronLeft className="h-4 w-4" />
                    Go to History
                  </Button>
                  <Button
                    variant="default"
                    onClick={() => setActiveTab('generate')}
                    className="gap-1 bg-gradient-to-br from-indigo-600/90 via-blue-600/80 to-indigo-700/90 hover:from-indigo-600 hover:to-blue-600 text-white shadow-md"
                  >
                    <Sparkles className="h-4 w-4" />
                    Generate New Workout
                  </Button>
                </div>
              </div>
            </div>
          )}
        </div>
      </TabsContent>
    </Tabs>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-form/workout-form.tsx

```tsx
'use client';

import { zodResolver } from '@hookform/resolvers/zod';
import { Calendar, Clock, Dumbbell, Gauge, Loader2, Sparkles, StickyNote } from 'lucide-react';
import { useEffect, useState } from 'react';
import { useForm } from 'react-hook-form';
import { z } from 'zod';

import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import {
  Form,
  FormControl,
  FormDescription,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Slider } from '@/components/ui/slider';
import { Textarea } from '@/components/ui/textarea';
import { toast } from '@/hooks/use-toast';
import { type WorkoutPlan, generateAiWorkout } from '../../_actions/generate-ai-workout';
import type { UserData } from '../../_actions/get-user-by-id';

const daysOfWeek = [
  { id: 'monday', label: 'Monday' },
  { id: 'tuesday', label: 'Tuesday' },
  { id: 'wednesday', label: 'Wednesday' },
  { id: 'thursday', label: 'Thursday' },
  { id: 'friday', label: 'Friday' },
  { id: 'saturday', label: 'Saturday' },
  { id: 'sunday', label: 'Sunday' },
];

const formSchema = z.object({
  workoutName: z.string().min(3, {
    message: 'Workout name must be at least 3 characters.',
  }),
  goal: z.string().min(1, {
    message: 'Please select a workout goal.',
  }),
  experience: z.string().min(1, {
    message: 'Please select experience level.',
  }),
  duration: z.number().min(10).max(120),
  workoutDays: z.array(z.string()).min(1, {
    message: 'Select at least one workout day.',
  }),
  specialInstructions: z.string().optional(),
});

interface WorkoutFormProps {
  user: UserData | null;
  onWorkoutGenerated?: (plan: WorkoutPlan) => void;
}

export default function WorkoutForm({ user, onWorkoutGenerated }: WorkoutFormProps) {
  const [isGenerating, setIsGenerating] = useState(false);

  // Pre-fill goal if user has one in health profile
  const userGoal = user?.healthProfile?.goal?.toLowerCase() || '';
  const mappedGoal = userGoal.includes('strength')
    ? 'strength'
    : userGoal.includes('muscle') || userGoal.includes('hypertrophy')
      ? 'hypertrophy'
      : userGoal.includes('endurance')
        ? 'endurance'
        : userGoal.includes('weight') || userGoal.includes('fat')
          ? 'weight-loss'
          : userGoal.includes('tone') || userGoal.includes('lean')
            ? 'toning'
            : '';

  const form = useForm<z.infer<typeof formSchema>>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      workoutName: user ? `Custom Plan for ${user.name}` : '',
      goal: mappedGoal,
      experience: 'intermediate', // Default value
      duration: 45,
      workoutDays: ['Monday', 'Wednesday', 'Friday'], // Default MWF schedule
      specialInstructions: '',
    },
  });

  // Get current values for form fields
  const selectedDays = form.watch('workoutDays');

  async function onSubmit(values: z.infer<typeof formSchema>) {
    if (!user) {
      toast({
        title: 'Error',
        description: 'Please select a client first',
        variant: 'destructive',
      });
      return;
    }

    setIsGenerating(true);

    try {
      // Map form values to workout generation params
      const params = {
        userId: user.id,
        goals: values.goal,
        fitnessLevel: values.experience,
        preferredDays: values.workoutDays,
        workoutDuration: values.duration,
        focusAreas: [], // Can be extended in future
        specialInstructions: values.specialInstructions,
      };

      const result = await generateAiWorkout(params);

      if (result.success && result.workoutPlan) {
        // Set the workout plan with the name from the form
        const workoutPlan = {
          ...result.workoutPlan,
          name: values.workoutName,
        };

        // Notify parent component
        if (onWorkoutGenerated) {
          onWorkoutGenerated(workoutPlan);
        }

        toast({
          title: 'Success',
          description: 'AI workout plan generated successfully!',
        });
      } else {
        toast({
          title: 'Generation Failed',
          description: result.error || 'Failed to generate workout plan',
          variant: 'destructive',
        });
      }
    } catch (error) {
      console.error('Error generating workout:', error);
      toast({
        title: 'Error',
        description: 'An unexpected error occurred while generating the workout',
        variant: 'destructive',
      });
    } finally {
      setIsGenerating(false);
    }
  }

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-5">
        <FormField
          control={form.control}
          name="workoutName"
          render={({ field }) => (
            <FormItem>
              <FormLabel className="flex items-center gap-2 text-base">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  strokeWidth="2"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  aria-labelledby="editIconTitle"
                  role="img"
                >
                  <title id="editIconTitle">Edit</title>
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                </svg>
                Workout Name
              </FormLabel>
              <FormControl>
                <Input
                  placeholder="e.g. Summer Shred Program"
                  {...field}
                  className="h-11 focus:border-indigo-600"
                />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />

        <div className="grid grid-cols-1 gap-5 sm:grid-cols-2">
          <FormField
            control={form.control}
            name="goal"
            render={({ field }) => (
              <FormItem>
                <FormLabel className="flex items-center gap-2 text-base">
                  <Dumbbell className="h-4 w-4" />
                  Workout Goal
                </FormLabel>
                <Select onValueChange={field.onChange} defaultValue={field.value}>
                  <FormControl>
                    <SelectTrigger className="h-11 border-gray-200 focus:border-indigo-600 bg-white-500 z-10">
                      <SelectValue placeholder="Select goal" />
                    </SelectTrigger>
                  </FormControl>
                  <SelectContent>
                    <SelectItem value="strength">Strength Building</SelectItem>
                    <SelectItem value="hypertrophy">Muscle Growth</SelectItem>
                    <SelectItem value="endurance">Endurance</SelectItem>
                    <SelectItem value="weight-loss">Weight Loss</SelectItem>
                    <SelectItem value="toning">Toning</SelectItem>
                  </SelectContent>
                </Select>
                <FormMessage />
              </FormItem>
            )}
          />

          <FormField
            control={form.control}
            name="experience"
            render={({ field }) => (
              <FormItem>
                <FormLabel className="flex items-center gap-2 text-base">
                  <Gauge className="h-4 w-4" />
                  Experience Level
                </FormLabel>
                <Select onValueChange={field.onChange} defaultValue={field.value}>
                  <FormControl>
                    <SelectTrigger className="h-11 border-gray-200 focus:border-indigo-600">
                      <SelectValue placeholder="Select level" />
                    </SelectTrigger>
                  </FormControl>
                  <SelectContent>
                    <SelectItem value="beginner">Beginner</SelectItem>
                    <SelectItem value="intermediate">Intermediate</SelectItem>
                    <SelectItem value="advanced">Advanced</SelectItem>
                  </SelectContent>
                </Select>
                <FormMessage />
              </FormItem>
            )}
          />
        </div>

        <FormField
          control={form.control}
          name="duration"
          render={({ field }) => (
            <FormItem className="border border-gray-100 rounded-lg p-4 shadow-sm">
              <FormLabel className="flex items-center gap-2 text-base">
                <Clock className="h-4 w-4" />
                Workout Duration
              </FormLabel>
              <div className="pt-2 px-1">
                <div className="flex justify-between text-sm mb-1">
                  <span>10 min</span>
                  <span className="font-medium text-indigo-700">{field.value} min</span>
                  <span>120 min</span>
                </div>
                <FormControl>
                  <Slider
                    min={10}
                    max={120}
                    step={5}
                    defaultValue={[field.value]}
                    onValueChange={(value) => field.onChange(value[0])}
                    className="py-5"
                  />
                </FormControl>
              </div>
              <FormMessage />
            </FormItem>
          )}
        />

        <FormField
          control={form.control}
          name="workoutDays"
          render={() => (
            <FormItem className="border border-gray-100 rounded-lg p-4 shadow-sm">
              <FormLabel className="flex items-center gap-2 text-base">
                <Calendar className="h-4 w-4" />
                Workout Days
              </FormLabel>
              <FormDescription>
                Select the days to include in the workout plan ({selectedDays.length} days selected)
              </FormDescription>
              <div className="grid grid-cols-7 gap-2 mt-2">
                {daysOfWeek.map((day) => (
                  <FormField
                    key={day.id}
                    control={form.control}
                    name="workoutDays"
                    render={({ field }) => {
                      return (
                        <FormItem key={day.id} className="flex flex-col items-center space-y-1">
                          <FormControl>
                            <Checkbox
                              checked={field.value?.includes(day.label)}
                              onCheckedChange={(checked) => {
                                return checked
                                  ? field.onChange([...field.value, day.label])
                                  : field.onChange(
                                      field.value?.filter((value) => value !== day.label),
                                    );
                              }}
                              className="data-[state=checked]:bg-indigo-600 data-[state=checked]:border-indigo-600"
                            />
                          </FormControl>
                          <FormLabel className="text-xs font-normal cursor-pointer">
                            {day.label.substring(0, 3)}
                          </FormLabel>
                        </FormItem>
                      );
                    }}
                  />
                ))}
              </div>
              <FormMessage />
            </FormItem>
          )}
        />

        <FormField
          control={form.control}
          name="specialInstructions"
          render={({ field }) => (
            <FormItem>
              <FormLabel className="flex items-center gap-2 text-base">
                <StickyNote className="h-4 w-4" />
                Special Instructions (Optional)
              </FormLabel>
              <FormControl>
                <Textarea
                  placeholder="Add any specific requirements or preferences for this workout"
                  className="resize-none h-24 focus:border-indigo-600"
                  {...field}
                />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />

        <Button
          type="submit"
          className="w-full h-12 mt-2 text-base bg-gradient-to-br from-indigo-600/90 via-blue-600/80 to-indigo-700/90 text-white border-0 hover:opacity-90 shadow-md"
          disabled={isGenerating || !user}
        >
          {isGenerating ? (
            <>
              <Loader2 className="mr-2 h-5 w-5 animate-spin" />
              Generating Workout...
            </>
          ) : (
            <>
              <Sparkles className="mr-2 h-5 w-5" />
              Generate AI Workout
            </>
          )}
        </Button>

        {!user && (
          <div className="text-sm text-center text-amber-600 bg-amber-50 border border-amber-200 rounded-md p-3 mt-4">
            <p className="font-medium">No Client Selected</p>
            <p className="text-amber-700">
              Please select a client first to generate a workout plan
            </p>
          </div>
        )}
      </form>
    </Form>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-preview/workout-preview.tsx

```tsx
'use client';

import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from '@/components/ui/accordion';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Calendar, CheckCircle, Clock, Dumbbell, Edit } from 'lucide-react';
import { useEffect, useState } from 'react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';
import type { UserData } from '../../_actions/get-user-by-id';

// Define interface for displayed exercise
interface ExerciseDisplay {
  id: string;
  name: string;
  sets: number;
  reps: string;
  rest: string;
  notes?: string;
}

// Define interface for displayed workout
interface WorkoutDisplay {
  name: string;
  description: string;
  goal: string;
  duration: number;
  experience: string;
  days: string[];
  exercises: ExerciseDisplay[];
}

// Initialize with null - will be populated when the AI generates a workout
// const workoutData = null;

interface WorkoutPreviewProps {
  user: UserData | null;
  generatedWorkout?: WorkoutPlan;
}

export default function WorkoutPreview({
  user,
  generatedWorkout: propWorkout,
}: WorkoutPreviewProps) {
  const [isAssigning, setIsAssigning] = useState(false);
  const [assigned, setAssigned] = useState(false);
  const [generatedWorkout, setGeneratedWorkout] = useState<WorkoutDisplay | null>(null);

  // Update local state when prop changes
  useEffect(() => {
    if (propWorkout) {
      // Transform WorkoutPlan to WorkoutDisplay format
      const displayWorkout: WorkoutDisplay = {
        name: propWorkout.name,
        description: propWorkout.description || '',
        goal: propWorkout.schedules[0]?.muscleTarget || 'General fitness',
        duration: Math.round(
          propWorkout.schedules.reduce((sum, s) => sum + s.duration, 0) /
            propWorkout.schedules.length,
        ),
        experience: 'intermediate', // Default, can be made dynamic
        days: propWorkout.schedules.map((s) => s.dayOfWeek),
        exercises: propWorkout.schedules.flatMap((s) =>
          s.exercises.map((e, i) => ({
            id: `${s.dayOfWeek}-${i}`,
            name: e.name,
            sets: e.sets,
            reps: e.reps,
            rest: '60 sec', // Default, can be made dynamic
            notes: e.description,
          })),
        ),
      };

      setGeneratedWorkout(displayWorkout);
    }
  }, [propWorkout]);

  const handleAssignWorkout = () => {
    if (!user || !generatedWorkout) return;

    setIsAssigning(true);

    // Simulate API call
    setTimeout(() => {
      console.log(`Assigning workout to ${user.name} (ID: ${user.id})`);
      setIsAssigning(false);
      setAssigned(true);
    }, 1500);
  };

  if (!generatedWorkout) {
    return (
      <div className="flex flex-col items-center justify-center h-full py-12 px-4 text-center">
        <div className="bg-muted/30 p-6 rounded-full mb-4">
          <Dumbbell className="h-12 w-12 text-muted-foreground/70" strokeWidth={1.5} />
        </div>
        <h3 className="text-xl font-medium mb-2">No Workout Generated Yet</h3>
        <p className="text-muted-foreground max-w-md">
          {user
            ? 'Complete the form and click "Generate AI Workout" to create a personalized workout plan.'
            : 'Select a client first, then complete the form to generate a personalized workout plan.'}
        </p>
      </div>
    );
  }

  if (assigned) {
    return (
      <Alert className="bg-green-50 border-green-200 text-green-800">
        <CheckCircle className="h-5 w-5" />
        <AlertTitle className="text-green-800">Workout Successfully Assigned!</AlertTitle>
        <AlertDescription className="text-green-700">
          "{generatedWorkout.name}" has been assigned to {user?.name}. They'll be notified about
          their new workout plan.
        </AlertDescription>
        <Button
          variant="outline"
          className="mt-4 border-green-200 bg-green-100/50 text-green-800 hover:bg-green-100 hover:text-green-900"
          onClick={() => setAssigned(false)}
        >
          Create Another Workout
        </Button>
      </Alert>
    );
  }

  return (
    <div className="space-y-6">
      <div className="space-y-1.5">
        <h3 className="text-xl font-semibold">{generatedWorkout.name}</h3>
        <p className="text-sm text-muted-foreground">{generatedWorkout.description}</p>
      </div>

      <div className="flex flex-wrap gap-2">
        <Badge variant="secondary" className="flex items-center gap-1">
          <Dumbbell className="h-3 w-3" />
          {generatedWorkout.goal}
        </Badge>
        <Badge variant="secondary" className="flex items-center gap-1">
          <Clock className="h-3 w-3" />
          {generatedWorkout.duration} minutes
        </Badge>
        <Badge variant="secondary">{generatedWorkout.experience}</Badge>
        {generatedWorkout.days.map((day) => (
          <Badge key={day} variant="outline" className="flex items-center gap-1">
            <Calendar className="h-3 w-3" />
            {day}
          </Badge>
        ))}
      </div>

      <Accordion type="single" collapsible className="w-full">
        {generatedWorkout.exercises.map((exercise) => (
          <AccordionItem key={exercise.id} value={exercise.id}>
            <AccordionTrigger className="hover:no-underline py-4 px-4 -mx-4 rounded-md hover:bg-muted/30 transition-colors">
              <div className="flex justify-between w-full pr-2 text-left">
                <div className="font-medium">{exercise.name}</div>
                <div className="text-sm text-muted-foreground hidden sm:block">
                  {exercise.sets} sets × {exercise.reps} reps
                </div>
              </div>
            </AccordionTrigger>
            <AccordionContent className="text-sm px-1">
              <div className="grid grid-cols-3 gap-2 mb-2">
                <div className="border rounded-md p-3 text-center">
                  <div className="text-xs text-muted-foreground mb-1">Sets</div>
                  <div className="font-medium">{exercise.sets}</div>
                </div>
                <div className="border rounded-md p-3 text-center">
                  <div className="text-xs text-muted-foreground mb-1">Reps</div>
                  <div className="font-medium">{exercise.reps}</div>
                </div>
                <div className="border rounded-md p-3 text-center">
                  <div className="text-xs text-muted-foreground mb-1">Rest</div>
                  <div className="font-medium">{exercise.rest}</div>
                </div>
              </div>
              {exercise.notes && (
                <div className="text-sm text-muted-foreground mt-3 p-3 bg-muted/20 rounded-md">
                  <span className="font-medium text-foreground block mb-1">Instructions:</span>
                  {exercise.notes}
                </div>
              )}
            </AccordionContent>
          </AccordionItem>
        ))}
      </Accordion>

      <div className="flex flex-col-reverse sm:flex-row justify-between items-center gap-3 pt-4 border-t mt-6">
        <Button variant="outline" size="sm" className="w-full sm:w-auto h-10">
          <Edit className="h-4 w-4 mr-2" /> Edit Workout
        </Button>
        <Button
          onClick={handleAssignWorkout}
          disabled={isAssigning || !user}
          className="w-full sm:w-auto h-11 sm:h-10 px-6"
          size="default"
        >
          {isAssigning ? (
            <>
              <div className="animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full mr-2" />
              Assigning...
            </>
          ) : (
            'Assign to Client'
          )}
        </Button>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-result/action-buttons.tsx

```tsx
import { Button } from '@/components/ui/button';
import { MessageSquare, Save, UserCheck } from 'lucide-react';

interface ActionButtonsProps {
  onSave: () => void;
  onDiscard: () => void;
  onAssign?: () => void;
  isLoading: boolean;
  isAssigning?: boolean;
  showFeedbackChat?: boolean;
  toggleFeedback?: () => void;
}

export default function ActionButtons({
  onSave,
  onDiscard,
  onAssign,
  isLoading,
  isAssigning = false,
  showFeedbackChat = false,
  toggleFeedback,
}: ActionButtonsProps) {
  return (
    <div className="flex flex-col-reverse sm:flex-row justify-end gap-3 mt-8 pt-5 border-t">
      <Button
        variant="outline"
        onClick={onDiscard}
        className="h-12 sm:h-11 hover:bg-red-50 hover:text-red-600 hover:border-red-200 transition-colors"
      >
        Discard Plan
      </Button>

      {toggleFeedback && (
        <Button
          variant="outline"
          onClick={toggleFeedback}
          className={`h-12 sm:h-11 ${
            showFeedbackChat
              ? 'bg-indigo-50 text-indigo-700 border-indigo-200'
              : 'hover:bg-indigo-50 hover:text-indigo-600 hover:border-indigo-200'
          } transition-colors`}
        >
          <MessageSquare className="h-4 w-4 mr-2" />
          {showFeedbackChat ? 'Hide Feedback' : 'Provide Feedback'}
        </Button>
      )}

      {onAssign && (
        <Button
          onClick={onAssign}
          disabled={isAssigning}
          className="h-12 sm:h-11 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-sm"
        >
          {isAssigning ? (
            <>
              <div className="animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full mr-2" />
              Assigning...
            </>
          ) : (
            <>
              <UserCheck className="h-4 w-4 mr-2" /> Assign Workout
            </>
          )}
        </Button>
      )}

      <Button
        onClick={onSave}
        disabled={isLoading}
        className="h-12 sm:h-11 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-sm"
      >
        {isLoading ? (
          <>
            <div className="animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full mr-2" />
            Saving...
          </>
        ) : (
          <>
            <Save className="h-4 w-4 mr-2" /> Save Workout Plan
          </>
        )}
      </Button>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-result/feedback-section.tsx

```tsx
import { Alert, AlertDescription } from '@/components/ui/alert';
import { MessageSquarePlus } from 'lucide-react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';
import { FeedbackChat } from '../feedback/feedback-chat';

interface FeedbackSectionProps {
  plan: WorkoutPlan;
  feedbackError: string | null;
  isSubmittingFeedback: boolean;
  conversationHistory: Array<{
    type: 'ai' | 'user';
    message: string;
    workout?: WorkoutPlan;
    timestamp: Date;
  }>;
  onSendFeedback: (feedback: string) => Promise<void>;
}

export default function FeedbackSection({
  plan,
  feedbackError,
  isSubmittingFeedback,
  conversationHistory,
  onSendFeedback,
}: FeedbackSectionProps) {
  return (
    <div className="rounded-xl border bg-white dark:bg-gray-950 overflow-hidden shadow-sm">
      <div className="p-5 border-b">
        <h3 className="text-lg font-semibold flex items-center gap-2">
          <MessageSquarePlus className="h-5 w-5 text-purple-500" />
          Refine Your Workout Plan
        </h3>
        <p className="text-sm text-muted-foreground mt-1">
          Not satisfied with this workout plan? Provide feedback to get a refined version that
          better suits your needs.
        </p>
      </div>

      {feedbackError && (
        <Alert variant="destructive" className="mx-5 mt-4 mb-0">
          <AlertDescription>{feedbackError}</AlertDescription>
        </Alert>
      )}

      <div className="p-5">
        <FeedbackChat
          workoutPlan={plan}
          onSendFeedback={onSendFeedback}
          isSubmitting={isSubmittingFeedback}
          conversationHistory={conversationHistory}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-result/weekly-schedule-tabs.tsx

```tsx
import { Button } from '@/components/ui/button';
import { ChevronLeft, ChevronRight } from 'lucide-react';
import { type RefObject, useEffect, useState } from 'react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';

interface WeeklyScheduleTabsProps {
  plan: WorkoutPlan;
  activeTab: string;
  setActiveTab: (tab: string) => void;
  tabsRef: RefObject<HTMLDivElement | null>;
  scrollTabs: (direction: 'left' | 'right') => void;
}

export default function WeeklyScheduleTabs({
  plan,
  activeTab,
  setActiveTab,
  tabsRef,
  scrollTabs,
}: WeeklyScheduleTabsProps) {
  // Track if scrolling is possible
  const [canScrollLeft, setCanScrollLeft] = useState(false);
  const [canScrollRight, setCanScrollRight] = useState(false);

  // Check scroll position on mount and when content changes
  useEffect(() => {
    const checkScrollPosition = () => {
      if (tabsRef.current) {
        const { scrollLeft, scrollWidth, clientWidth } = tabsRef.current;
        setCanScrollLeft(scrollLeft > 0);
        setCanScrollRight(scrollLeft + clientWidth < scrollWidth);
      }
    };

    checkScrollPosition();

    // Set up scroll event listener to update scroll buttons state
    const currentTabsRef = tabsRef.current;
    if (currentTabsRef) {
      currentTabsRef.addEventListener('scroll', checkScrollPosition);
      return () => currentTabsRef.removeEventListener('scroll', checkScrollPosition);
    }
  }, [tabsRef]);

  // Directly use the parent component's scrollTabs function
  const handleScrollLeft = () => scrollTabs('left');
  const handleScrollRight = () => scrollTabs('right');

  return (
    <div className="relative">
      <div className="flex items-center justify-between mb-2 pb-2 border-b">
        <h3 className="font-medium text-base sm:text-lg">Weekly Schedule</h3>
        <div className="flex items-center gap-1">
          <Button
            type="button"
            variant="ghost"
            size="icon"
            onClick={handleScrollLeft}
            className={`h-8 w-8 rounded-full ${
              canScrollLeft
                ? 'text-indigo-700 hover:bg-indigo-50 dark:hover:bg-indigo-900/20'
                : 'text-gray-400 cursor-not-allowed'
            }`}
            disabled={!canScrollLeft}
          >
            <ChevronLeft className="h-4 w-4" />
          </Button>
          <Button
            type="button"
            variant="ghost"
            size="icon"
            onClick={handleScrollRight}
            className={`h-8 w-8 rounded-full ${
              canScrollRight
                ? 'text-indigo-700 hover:bg-indigo-50 dark:hover:bg-indigo-900/20'
                : 'text-gray-400 cursor-not-allowed'
            }`}
            disabled={!canScrollRight}
          >
            <ChevronRight className="h-4 w-4" />
          </Button>
        </div>
      </div>

      <div className="w-full relative">
        {/* Fade indicators for scrollable content */}
        <div className="absolute left-0 top-0 bottom-0 w-6 bg-gradient-to-r from-background to-transparent z-10 pointer-events-none" />
        <div className="absolute right-0 top-0 bottom-0 w-6 bg-gradient-to-l from-background to-transparent z-10 pointer-events-none" />

        <div className="w-full overflow-x-auto pb-3 scrollbar-hide">
          <div
            ref={tabsRef}
            className="flex gap-2 pb-1 min-w-full px-2"
            style={{ scrollbarWidth: 'none', msOverflowStyle: 'none' }}
          >
            {plan.schedules.map((schedule) => (
              <button
                key={schedule.dayOfWeek}
                type="button"
                onClick={() => setActiveTab(schedule.dayOfWeek)}
                className={`flex flex-col items-center justify-center min-h-[5rem] min-w-[5rem] w-[5rem] sm:h-24 sm:w-24 rounded-xl text-sm transition-all ${
                  activeTab === schedule.dayOfWeek
                    ? 'bg-indigo-500/10 dark:bg-indigo-500/20 shadow-sm border-0'
                    : 'bg-white dark:bg-gray-900 hover:bg-indigo-50 dark:hover:bg-indigo-900/10 border border-gray-200 dark:border-gray-800'
                }`}
              >
                <div
                  className={`flex items-center justify-center w-8 h-8 rounded-full mb-1.5 text-white ${
                    activeTab === schedule.dayOfWeek
                      ? 'bg-indigo-600 shadow-md'
                      : 'bg-indigo-500/80'
                  }`}
                >
                  {schedule.dayOfWeek.slice(0, 1)}
                </div>
                <span
                  className={`font-medium ${activeTab === schedule.dayOfWeek ? 'text-indigo-700 dark:text-indigo-300' : ''}`}
                >
                  {schedule.dayOfWeek.slice(0, 3)}
                </span>
                <span className="text-xs mt-0.5 max-w-full px-1 truncate opacity-80">
                  {schedule.muscleTarget.split(' ')[0]}
                </span>
              </button>
            ))}
          </div>
        </div>

        {/* Page indicator dots */}
        <div className="flex justify-center gap-1 mt-1">
          {plan.schedules.map((schedule, index) => (
            <span
              key={`dot-${schedule.dayOfWeek + index}`}
              className={`h-1.5 rounded-full transition-all ${
                activeTab === schedule.dayOfWeek
                  ? 'w-4 bg-indigo-600'
                  : 'w-1.5 bg-gray-300 dark:bg-gray-700'
              }`}
              aria-hidden="true"
            />
          ))}
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-result/workout-day-details.tsx

```tsx
import { Badge } from '@/components/ui/badge';
import { CheckCheck, Clock, Dumbbell, FlameIcon } from 'lucide-react';
import type { WorkoutSchedule } from '../../_actions/generate-ai-workout';

interface WorkoutDayDetailsProps {
  currentSchedule: WorkoutSchedule;
}

// Exercise item component to handle layout issues
interface ExerciseItemProps {
  exercise: {
    name: string;
    sets: string | number;
    reps: string | number;
    description: string;
  };
  index: number;
}

function ExerciseItem({ exercise, index }: ExerciseItemProps) {
  return (
    <div className="rounded-xl p-3 sm:p-4 transition-all hover:shadow-md group bg-gradient-to-br from-transparent to-muted/5 hover:bg-indigo-50/20 dark:hover:bg-indigo-900/5">
      <div className="flex flex-col sm:flex-row sm:items-center gap-2">
        <div className="flex items-start gap-2 min-w-0 flex-1">
          <span className="bg-indigo-600 text-white text-sm rounded-full h-7 w-7 sm:h-8 sm:w-8 flex items-center justify-center font-bold shrink-0 shadow-sm mt-0.5">
            {index + 1}
          </span>
          <div className="min-w-0 flex-1">
            <h4 className="font-medium text-sm sm:text-base group-hover:text-indigo-600 transition-colors truncate">
              {exercise.name}
            </h4>
            <p className="text-xs sm:text-sm mt-1 text-muted-foreground group-hover:text-foreground/80 transition-colors line-clamp-2">
              {exercise.description}
            </p>
          </div>
        </div>
        <div className="ml-9 sm:ml-0 mt-1 sm:mt-0">
          <span className="text-xs sm:text-sm font-medium bg-muted/80 group-hover:bg-indigo-50 dark:group-hover:bg-indigo-900/10 group-hover:text-indigo-600 px-2.5 py-1.5 rounded-full transition-colors inline-block">
            {exercise.sets} × {exercise.reps}
          </span>
        </div>
      </div>
    </div>
  );
}

export default function WorkoutDayDetails({ currentSchedule }: WorkoutDayDetailsProps) {
  return (
    <div className="rounded-xl border bg-white dark:bg-gray-950 overflow-hidden shadow-sm">
      {/* Workout header */}
      <div className="p-4 sm:p-5 bg-indigo-50/50 dark:bg-indigo-900/10 border-b relative overflow-hidden">
        <div className="relative z-10 flex flex-col sm:flex-row sm:justify-between sm:items-start">
          <div>
            <h3 className="text-lg font-semibold flex items-center gap-2">
              <span className="inline-flex items-center justify-center bg-indigo-600 text-white rounded-full h-8 w-8 shadow-sm">
                <Dumbbell className="h-4 w-4" />
              </span>
              {currentSchedule.muscleTarget}
            </h3>
            <div className="flex flex-wrap gap-x-4 gap-y-1 mt-2">
              <span className="flex items-center gap-1 text-sm">
                <Clock className="h-4 w-4 text-indigo-600" />
                {currentSchedule.duration} minutes
              </span>
              <span className="flex items-center gap-1 text-sm">
                <FlameIcon className="h-4 w-4 text-indigo-600" />~{currentSchedule.calories}{' '}
                calories
              </span>
            </div>
          </div>
        </div>
      </div>

      {/* Exercise list */}
      <div className="p-2 sm:p-3">
        <div className="space-y-2">
          {currentSchedule.exercises.map((exercise, index) => (
            <ExerciseItem key={`${exercise.name}-${index}`} exercise={exercise} index={index} />
          ))}

          <div className="w-full flex justify-center pt-3 sm:pt-4">
            <Badge
              variant="outline"
              className="flex items-center gap-2 py-1.5 px-3 sm:py-2 sm:px-4 border-indigo-200 dark:border-indigo-800/30"
            >
              <CheckCheck className="h-3.5 w-3.5 sm:h-4 sm:w-4 text-indigo-600" />
              Complete All Exercises
            </Badge>
          </div>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-result/workout-header.tsx

```tsx
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import {
  Award,
  CalendarDays,
  CheckCircle,
  Clock,
  Dumbbell,
  MessageSquarePlus,
  Pencil,
  X,
} from 'lucide-react';
import type { WorkoutPlan } from '../../_actions/generate-ai-workout';

interface WorkoutHeaderProps {
  plan: WorkoutPlan;
  setPlan: (plan: WorkoutPlan) => void;
  editMode: boolean;
  setEditMode: (edit: boolean) => void;
  showFeedbackChat: boolean;
  setShowFeedbackChat: (show: boolean) => void;
}

export default function WorkoutHeader({
  plan,
  setPlan,
  editMode,
  setEditMode,
  showFeedbackChat,
  setShowFeedbackChat,
}: WorkoutHeaderProps) {
  return (
    <div className="relative overflow-hidden rounded-2xl border bg-gradient-to-br from-white to-slate-50/80 dark:from-gray-900 dark:to-gray-950/80 p-6 shadow-sm">
      <div className="absolute top-0 right-0 h-32 w-32 opacity-5 pointer-events-none">
        <Dumbbell className="h-full w-full" strokeWidth={1} />
      </div>

      <div className="flex flex-col md:flex-row md:justify-between md:items-start gap-4">
        <div className="flex-1">
          {editMode ? (
            <Input
              value={plan.name}
              onChange={(e) => setPlan({ ...plan, name: e.target.value })}
              className="font-bold text-xl py-2 mb-3"
              aria-label="Workout name"
            />
          ) : (
            <h2 className="text-xl sm:text-2xl font-bold mb-1 flex items-center gap-2 text-transparent bg-clip-text bg-gradient-to-r from-primary to-primary/80 flex-shrink-0 ">
              <Award className="size-10 text-primary -mt-6" />
              {plan.name}
            </h2>
          )}

          <div className="text-muted-foreground text-sm mt-2">
            {editMode ? (
              <Textarea
                value={plan.description || ''}
                onChange={(e) => setPlan({ ...plan, description: e.target.value })}
                className="mt-2 min-h-[80px]"
                placeholder="Add a description for this workout plan"
                aria-label="Workout description"
              />
            ) : (
              <p className="ml-8 text-base">{plan.description}</p>
            )}
          </div>
        </div>

        <div className="flex gap-2">
          {editMode ? (
            <>
              <Button
                variant="outline"
                size="sm"
                onClick={() => setEditMode(false)}
                className="h-10 px-4 hover:bg-red-50 hover:text-red-600 hover:border-red-200 transition-colors"
              >
                <X className="h-4 w-4 mr-1.5" /> Cancel
              </Button>
              <Button
                variant="default"
                size="sm"
                onClick={() => setEditMode(false)}
                className="h-10 px-4"
              >
                <CheckCircle className="h-4 w-4 mr-1.5" /> Done
              </Button>
            </>
          ) : (
            <>
              <Button
                variant="outline"
                size="sm"
                onClick={() => setEditMode(true)}
                className="h-10 px-4 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 transition-colors"
              >
                <Pencil className="h-4 w-4 mr-1.5" /> Edit
              </Button>
              <Button
                variant={showFeedbackChat ? 'secondary' : 'outline'}
                size="sm"
                onClick={() => setShowFeedbackChat(!showFeedbackChat)}
                className={`h-10 px-4 ${
                  showFeedbackChat
                    ? 'bg-primary/10 text-primary border-primary/20'
                    : 'hover:bg-purple-50 hover:text-purple-600 hover:border-purple-200'
                } transition-colors`}
              >
                <MessageSquarePlus className="h-4 w-4 mr-1.5" />
                {showFeedbackChat ? 'Hide Feedback' : 'Request Changes'}
              </Button>
            </>
          )}
        </div>
      </div>

      {/* Workout stats badges */}
      {plan.schedules.length > 0 && (
        <div className="flex flex-wrap gap-2 mt-5">
          <Badge
            variant="secondary"
            className="flex items-center gap-1 px-3 py-1 text-sm bg-primary/10 text-primary border-primary/20"
          >
            <Dumbbell className="h-3.5 w-3.5" />
            {plan.schedules.length} workout days
          </Badge>
          <Badge variant="secondary" className="flex items-center gap-1 px-3 py-1 text-sm">
            <CalendarDays className="h-3.5 w-3.5" />
            Weekly plan
          </Badge>
          <Badge variant="secondary" className="flex items-center gap-1 px-3 py-1 text-sm">
            <Clock className="h-3.5 w-3.5" />
            {Math.round(
              plan.schedules.reduce((avg, s) => avg + s.duration, 0) / plan.schedules.length,
            )}{' '}
            min avg
          </Badge>
        </div>
      )}
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_components/workout-result/workout-results.tsx

```tsx
'use client';

import { toast } from '@/hooks/use-toast';
import { useEffect, useRef, useState } from 'react';
import { assignCustomWorkoutPlan } from '../../_actions/assign-workout-plan';
import type { WorkoutPlan, WorkoutSchedule } from '../../_actions/generate-ai-workout';
import { refineWorkout } from '../../_actions/refine-workout';
import { useWorkoutChatStore } from '../../_store/workout-chat-store';

// Import the response type from the server action
import type { CustomWorkoutPlanResponse } from '../../_actions/assign-workout-plan';

import ActionButtons from './action-buttons';
import FeedbackSection from './feedback-section';
import WeeklyScheduleTabs from './weekly-schedule-tabs';
import WorkoutDayDetails from './workout-day-details';
import WorkoutHeader from './workout-header';

interface WorkoutResultsProps {
  workoutPlan: WorkoutPlan;
  onSave: (plan: WorkoutPlan) => void;
  onDiscard: () => void;
  isLoading?: boolean;
  userId: string;
  userName?: string;
}

export default function WorkoutResults({
  workoutPlan,
  onSave,
  onDiscard,
  isLoading = false,
  userId,
  userName = 'Client', // Default name if not provided
}: WorkoutResultsProps) {
  const [plan, setPlan] = useState<WorkoutPlan>(workoutPlan);
  const [editMode, setEditMode] = useState(false);
  const [activeTab, setActiveTab] = useState(plan.schedules[0]?.dayOfWeek || 'Monday');
  const [isAssigning, setIsAssigning] = useState(false);
  const tabsRef = useRef<HTMLDivElement>(null);

  // Fetch state and actions from Zustand store
  const {
    conversationHistory,
    isSubmittingFeedback,
    feedbackError,
    showFeedbackChat,
    initializeConversation,
    addUserMessage,
    addAIMessage,
    setSubmittingFeedback,
    setFeedbackError,
    toggleFeedbackChat,
    setShowFeedbackChat,
    saveWorkoutToHistory,
  } = useWorkoutChatStore();

  // Initialize conversation with initial workout
  useEffect(() => {
    initializeConversation(workoutPlan);
  }, [workoutPlan, initializeConversation]);

  const handleSave = () => {
    try {
      // Save workout with conversation history to localStorage
      const workoutId = saveWorkoutToHistory(plan, userId, userName);

      // Log success with workout ID
      console.log('Workout saved successfully with ID:', workoutId);
      console.log('Conversation history saved:', conversationHistory);

      // Call the parent's onSave with the updated plan
      onSave(plan);

      // Show success toast
      toast({
        title: 'Workout Saved',
        description: 'Workout plan has been saved successfully with conversation history.',
      });
    } catch (error) {
      console.error('Error saving workout:', error);
      toast({
        title: 'Error Saving',
        description: 'There was a problem saving your workout plan.',
        variant: 'destructive',
      });
    }
  };

  const handleAssignWorkout = async () => {
    try {
      setIsAssigning(true);

      // Call the server action to assign the workout
      const result = await assignCustomWorkoutPlan(userId, plan);

      if (result.success) {
        // Show different toast messages based on whether this is an update or new assignment
        const wasUpdate = result.previousPlan !== null;

        toast({
          title: wasUpdate ? 'Workout Updated' : 'Workout Assigned',
          description: wasUpdate
            ? `The previous workout "${result.previousPlan?.name}" has been replaced with "${result.newPlan.name}".`
            : `The custom workout "${result.newPlan.name}" has been assigned to ${userName}.`,
        });

        // Save the workout to history too
        saveWorkoutToHistory(plan, userId, userName);

        // After successful assignment, we might want to return to the dashboard
        // or stay on the same page and show a success message
      } else {
        throw new Error(result.error || 'Failed to assign workout');
      }
    } catch (error) {
      console.error('Error assigning workout:', error);
      toast({
        title: 'Assignment Failed',
        description:
          error instanceof Error
            ? error.message
            : 'There was a problem assigning the workout to the user.',
        variant: 'destructive',
      });
    } finally {
      setIsAssigning(false);
    }
  };

  // const updateSchedule = (index: number, updatedSchedule: WorkoutSchedule) => {
  //   const newSchedules = [...plan.schedules];
  //   newSchedules[index] = updatedSchedule;
  //   setPlan({ ...plan, schedules: newSchedules });
  // };

  // Handle feedback submission
  const handleSendFeedback = async (feedback: string) => {
    try {
      setFeedbackError(null);
      setSubmittingFeedback(true);

      // Add user's feedback to conversation history
      addUserMessage(feedback);

      // Call server action to refine workout
      const result = await refineWorkout({
        userId,
        originalWorkoutPlan: plan,
        feedback,
        conversationHistory: conversationHistory.map(({ type, message, timestamp }) => ({
          type,
          message,
          timestamp,
        })),
      });

      if (result.success && result.workoutPlan) {
        // Add AI's response to conversation history
        addAIMessage(
          "I've refined the workout plan based on your feedback. Here's the updated version!",
          result.workoutPlan,
        );

        setPlan(result.workoutPlan);

        toast({
          title: 'Workout Plan Updated',
          description: 'The AI has refined your workout plan based on your feedback.',
        });
      } else {
        setFeedbackError(result.error || 'Failed to refine workout');
        toast({
          title: 'Error',
          description: result.error || 'Failed to refine workout plan',
          variant: 'destructive',
        });
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'An unexpected error occurred';
      setFeedbackError(errorMessage);
      toast({
        title: 'Error',
        description: errorMessage,
        variant: 'destructive',
      });
    } finally {
      setSubmittingFeedback(false);
    }
  };

  // Get the current schedule
  const currentSchedule =
    plan.schedules.find((s) => s.dayOfWeek === activeTab) || plan.schedules[0];

  const scrollTabs = (direction: 'left' | 'right') => {
    if (tabsRef.current) {
      // Increase the scroll amount for better UX
      const scrollAmount = direction === 'left' ? -200 : 200;

      // Use scrollTo with smooth behavior
      const currentScroll = tabsRef.current.scrollLeft;
      tabsRef.current.scrollTo({
        left: currentScroll + scrollAmount,
        behavior: 'smooth',
      });

      // Add logging to help debug
      console.log(`Scrolling ${direction}: ${currentScroll} -> ${currentScroll + scrollAmount}`);
    }
  };

  return (
    <div className="space-y-8">
      <WorkoutHeader
        plan={plan}
        setPlan={setPlan}
        editMode={editMode}
        setEditMode={setEditMode}
        showFeedbackChat={showFeedbackChat}
        setShowFeedbackChat={setShowFeedbackChat}
      />

      {showFeedbackChat && (
        <FeedbackSection
          plan={plan}
          feedbackError={feedbackError}
          isSubmittingFeedback={isSubmittingFeedback}
          conversationHistory={conversationHistory}
          onSendFeedback={handleSendFeedback}
        />
      )}

      <WeeklyScheduleTabs
        plan={plan}
        activeTab={activeTab}
        setActiveTab={setActiveTab}
        tabsRef={tabsRef}
        scrollTabs={scrollTabs}
      />

      {currentSchedule && <WorkoutDayDetails currentSchedule={currentSchedule} />}

      <ActionButtons
        onSave={handleSave}
        onDiscard={onDiscard}
        onAssign={handleAssignWorkout}
        isLoading={isLoading}
        isAssigning={isAssigning}
        showFeedbackChat={showFeedbackChat}
        toggleFeedback={toggleFeedbackChat}
      />
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_store/workout-chat-store.ts

```ts
import { create } from 'zustand';
import type { WorkoutPlan } from '../_actions/generate-ai-workout';

// Define types for alternative property names that might exist in API responses
interface WorkoutPlanWithAlternativeNames extends Partial<WorkoutPlan> {
  title?: string; // Alternative to 'name'
}

interface WorkoutScheduleWithAlternativeNames {
  focus?: string; // Alternative to 'muscleTarget'
}

// Define the shape of a chat message
export interface ChatMessage {
  type: 'ai' | 'user';
  message: string;
  workout?: WorkoutPlan;
  timestamp: Date;
}

// Interface for saved workout history - using WorkoutPlan from generate-ai-workout.ts
export interface SavedWorkout {
  id: string;
  workoutPlan: WorkoutPlan; // Using the imported type
  createdAt: string;
  clientId: string;
  clientName: string;
  conversationHistory: ChatMessage[];
}

// Define the shape of our store
interface WorkoutChatStore {
  // State
  conversationHistory: ChatMessage[];
  isSubmittingFeedback: boolean;
  feedbackError: string | null;
  showFeedbackChat: boolean;

  // Actions
  initializeConversation: (workoutPlan: WorkoutPlan) => void;
  addUserMessage: (message: string) => void;
  addAIMessage: (message: string, workoutPlan?: WorkoutPlan) => void;
  setSubmittingFeedback: (isSubmitting: boolean) => void;
  setFeedbackError: (error: string | null) => void;
  toggleFeedbackChat: () => void;
  setShowFeedbackChat: (show: boolean) => void;
  reset: () => void;

  // Storage actions
  saveWorkoutToHistory: (workout: WorkoutPlan, userId: string, userName: string) => string;
  getSavedWorkouts: (userId: string) => SavedWorkout[];
  clearWorkoutHistory: () => void;
}

// Helper to generate a unique ID
const generateId = () => `workout-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;

// Helper to safely parse JSON with date handling
const parseWithDates = (jsonString: string) => {
  return JSON.parse(jsonString, (_key, value) => {
    // Convert ISO date strings back to Date objects
    if (typeof value === 'string' && /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/.test(value)) {
      return new Date(value);
    }
    return value;
  });
};

// Create the store
export const useWorkoutChatStore = create<WorkoutChatStore>((set, get) => ({
  // Initial state
  conversationHistory: [],
  isSubmittingFeedback: false,
  feedbackError: null,
  showFeedbackChat: false,

  // Actions
  initializeConversation: (workoutPlan) =>
    set({
      conversationHistory: [
        {
          type: 'ai',
          message:
            "Here's your personalized workout plan. Let me know if you'd like any modifications!",
          workout: workoutPlan,
          timestamp: new Date(),
        },
      ],
      feedbackError: null,
    }),

  addUserMessage: (message) =>
    set((state) => ({
      conversationHistory: [
        ...state.conversationHistory,
        {
          type: 'user',
          message,
          timestamp: new Date(),
        },
      ],
    })),

  addAIMessage: (message, workoutPlan) =>
    set((state) => ({
      conversationHistory: [
        ...state.conversationHistory,
        {
          type: 'ai',
          message,
          workout: workoutPlan,
          timestamp: new Date(),
        },
      ],
    })),

  setSubmittingFeedback: (isSubmitting) => set({ isSubmittingFeedback: isSubmitting }),

  setFeedbackError: (error) => set({ feedbackError: error }),

  toggleFeedbackChat: () =>
    set((state) => ({
      showFeedbackChat: !state.showFeedbackChat,
    })),

  setShowFeedbackChat: (show) => set({ showFeedbackChat: show }),

  reset: () =>
    set({
      conversationHistory: [],
      isSubmittingFeedback: false,
      feedbackError: null,
      showFeedbackChat: false,
    }),

  // Storage actions
  saveWorkoutToHistory: (workoutPlan, userId, userName) => {
    const workoutId = generateId();
    const { conversationHistory } = get();

    // Ensure workoutPlan conforms to WorkoutPlan interface
    const normalizedWorkoutPlan: WorkoutPlan = {
      ...workoutPlan,
      // If name is missing, use title or default
      name:
        workoutPlan.name ||
        (workoutPlan as WorkoutPlanWithAlternativeNames).title ||
        'Untitled Workout',
      // Force description to be a string
      description: workoutPlan.description || '',
      // Ensure schedules use the correct fields
      schedules: workoutPlan.schedules.map((schedule) => ({
        ...schedule,
        // If muscleTarget is missing, use focus or default
        muscleTarget:
          schedule.muscleTarget ||
          (schedule as WorkoutScheduleWithAlternativeNames).focus ||
          'General',
        // Ensure duration and calories exist
        duration: schedule.duration || 0,
        calories: schedule.calories || 0,
        // Ensure exercises have all required fields
        exercises: schedule.exercises.map((exercise, idx) => ({
          ...exercise,
          order: exercise.order !== undefined ? exercise.order : idx,
          description: exercise.description || '',
        })),
      })),
    };

    // Create the workout history item with normalized workoutPlan
    const workoutHistoryItem: SavedWorkout = {
      id: workoutId,
      workoutPlan: normalizedWorkoutPlan,
      conversationHistory: [...conversationHistory],
      createdAt: new Date().toISOString(),
      clientId: userId,
      clientName: userName,
    };

    // Save to localStorage - in a real app this would be a database call
    if (typeof window !== 'undefined') {
      try {
        // Get existing saved workouts
        const savedWorkoutsStr = localStorage.getItem('gym-navigator-saved-workouts') || '[]';
        const savedWorkouts = JSON.parse(savedWorkoutsStr);

        // Add the new workout
        savedWorkouts.push(workoutHistoryItem);

        // Save back to localStorage
        localStorage.setItem('gym-navigator-saved-workouts', JSON.stringify(savedWorkouts));
      } catch (error) {
        console.error('Failed to save workout to localStorage:', error);
      }
    }

    return workoutId;
  },

  getSavedWorkouts: (userId) => {
    if (typeof window === 'undefined') return [];

    try {
      const savedWorkoutsStr = localStorage.getItem('gym-navigator-saved-workouts');
      if (!savedWorkoutsStr) return [];

      const allSavedWorkouts = parseWithDates(savedWorkoutsStr) as SavedWorkout[];
      console.log('Found saved workouts in localStorage:', allSavedWorkouts.length);

      // Filter by user ID if provided
      return userId
        ? allSavedWorkouts.filter((workout) => workout.clientId === userId)
        : allSavedWorkouts;
    } catch (error) {
      console.error('Failed to retrieve saved workouts:', error);
      return [];
    }
  },

  clearWorkoutHistory: () => {
    if (typeof window !== 'undefined') {
      try {
        localStorage.removeItem('gym-navigator-saved-workouts');
      } catch (error) {
        console.error('Failed to clear workout history:', error);
      }
    }
  },
}));

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/_store/workout-view-store.ts

```ts
import { create } from 'zustand';
import type { WorkoutPlan } from '../_actions/generate-ai-workout';
import type { SavedWorkout } from './workout-chat-store';

interface WorkoutViewStore {
  // State
  activeWorkout: SavedWorkout | null;
  isAssigning: boolean;
  assignmentError: string | null;
  showWorkoutDetails: boolean;

  // Actions
  setActiveWorkout: (workout: SavedWorkout | null) => void;
  setShowWorkoutDetails: (show: boolean) => void;
  assignWorkout: (workout: SavedWorkout) => Promise<void>;
  loadWorkout: (workout: { clientName: string; workoutPlan: WorkoutPlan }) => void;
  reset: () => void;
}

export const useWorkoutViewStore = create<WorkoutViewStore>((set) => ({
  // Initial state
  activeWorkout: null,
  isAssigning: false,
  assignmentError: null,
  showWorkoutDetails: false,

  // Actions
  setActiveWorkout: (workout) =>
    set({
      activeWorkout: workout,
      showWorkoutDetails: !!workout,
    }),

  setShowWorkoutDetails: (show) => set({ showWorkoutDetails: show }),

  loadWorkout: (workout) => {
    // Convert the workout format to SavedWorkout format and set as active
    const savedWorkout: SavedWorkout = {
      id: Date.now().toString(), // Generate a temporary ID
      clientName: workout.clientName,
      workoutPlan: workout.workoutPlan,
      createdAt: new Date().toISOString(),
      clientId: '', // Default empty client ID
      conversationHistory: [], // Default empty conversation history
    };
    
    set({
      activeWorkout: savedWorkout,
      showWorkoutDetails: true,
    });
  },

  assignWorkout: async (_workout) => {
    try {
      set({ isAssigning: true, assignmentError: null });

      // TODO: Implement the actual assignment logic here
      // This would typically involve:
      // 1. Calling an API to assign the workout
      // 2. Updating the workout status in the database
      // 3. Notifying the client

      // For now, we'll just simulate a delay
      await new Promise((resolve) => setTimeout(resolve, 1000));

      set({ isAssigning: false });
    } catch (error) {
      set({
        isAssigning: false,
        assignmentError: error instanceof Error ? error.message : 'Failed to assign workout',
      });
    }
  },

  reset: () =>
    set({
      activeWorkout: null,
      isAssigning: false,
      assignmentError: null,
      showWorkoutDetails: false,
    }),
}));

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/loading.tsx

```tsx
import { Card } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { ChevronLeft } from 'lucide-react';
import Link from 'next/link';

export default function Loading() {
  return (
    <div className="container max-w-5xl px-4 sm:px-6 pb-16">
      <Link
        href="/dashboard/trainer/workouts"
        className="inline-flex items-center text-muted-foreground mb-8 py-2"
      >
        <ChevronLeft className="h-4 w-4 mr-1" />
        <span>Back to workouts</span>
      </Link>

      <div className="space-y-8">
        <div>
          <Skeleton className="h-9 w-3/4 max-w-md mb-2" />
          <Skeleton className="h-5 w-full max-w-2xl" />
        </div>

        <Tabs defaultValue="generate" className="space-y-6">
          <div className="bg-background sticky top-0 z-10 pb-2 pt-1 backdrop-blur-sm border-b">
            <TabsList className="w-full max-w-md mx-auto">
              <TabsTrigger value="generate" className="flex-1">
                Generate
              </TabsTrigger>
              <TabsTrigger value="history" className="flex-1">
                History
              </TabsTrigger>
            </TabsList>
          </div>

          <TabsContent value="generate" className="space-y-6 mt-6">
            <div className="grid grid-cols-1 lg:grid-cols-5 gap-8">
              {/* Client selection area */}
              <div className="lg:col-span-2">
                <Card className="overflow-hidden">
                  <div className="p-6">
                    <Skeleton className="h-7 w-40 mb-4" />
                    <div className="space-y-2">
                      <Skeleton className="h-10 w-full" />
                      <div className="mt-6">
                        <Skeleton className="h-6 w-32 mb-3" />
                        <div className="space-y-3">
                          {Array.from({ length: 4 }).map((_, i) => (
                            <div key={i as number} className="flex items-center gap-3">
                              <Skeleton className="h-12 w-12 rounded-full" />
                              <div className="space-y-2">
                                <Skeleton className="h-5 w-32" />
                                <Skeleton className="h-4 w-24" />
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>
                </Card>
              </div>

              {/* Workout form area */}
              <div className="lg:col-span-3">
                <Card className="overflow-hidden">
                  <div className="p-6">
                    <Skeleton className="h-7 w-48 mb-6" />
                    <div className="space-y-5">
                      <Skeleton className="h-[70px] w-full" />
                      <div className="grid grid-cols-1 sm:grid-cols-2 gap-5">
                        <Skeleton className="h-[80px] w-full" />
                        <Skeleton className="h-[80px] w-full" />
                      </div>
                      <Skeleton className="h-[80px] w-full" />
                      <Skeleton className="h-[100px] w-full" />
                      <Skeleton className="h-12 w-full" />
                    </div>
                  </div>
                </Card>
              </div>
            </div>
          </TabsContent>
        </Tabs>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assigncustomworkoutswithai/page.tsx

```tsx
import { Activity, ChevronLeft, Dumbbell, Zap } from 'lucide-react';
import Link from 'next/link';
import { getUserById } from './_actions/get-user-by-id';
import type { UserData } from './_actions/get-user-by-id';
import { getWorkoutHistory } from './_actions/get-workout-history';
import WorkoutTabs from './_components/tabs/workout-tabs';

// Pre-generate decoration positions instead of using map with index
const decorations = [
  { left: '0%', top: '0%', transform: 'translate(20%, 30%)' },
  { left: '25%', top: '0%', transform: 'translate(-10%, 40%)' },
  { left: '50%', top: '0%', transform: 'translate(15%, -20%)' },
  { left: '75%', top: '0%', transform: 'translate(5%, 25%)' },
  { left: '0%', top: '33%', transform: 'translate(-5%, 10%)' },
  { left: '25%', top: '33%', transform: 'translate(25%, -15%)' },
  { left: '50%', top: '33%', transform: 'translate(-20%, 20%)' },
  { left: '75%', top: '33%', transform: 'translate(10%, -10%)' },
  { left: '0%', top: '66%', transform: 'translate(15%, -25%)' },
  { left: '25%', top: '66%', transform: 'translate(-15%, 5%)' },
  { left: '50%', top: '66%', transform: 'translate(25%, 15%)' },
  { left: '75%', top: '66%', transform: 'translate(-5%, -5%)' },
];

export default async function AssignCustomWorkoutsWithAI({
  searchParams,
}: {
  searchParams: Promise<{ userId?: string }>;
}) {
  // Next.js 15.2 requires awaiting searchParams before accessing properties
  const params = await searchParams;
  const userId = params.userId || 'defaultUserId';

  const response = await getUserById(userId);
  // Fix type error by ensuring user is strictly UserData | null (not undefined)
  const user: UserData | null = response.success && response.data ? response.data : null;

  // Get server fallback history data for passing to client component
  const historyResponse = await getWorkoutHistory(userId);
  const serverFallbackHistory =
    historyResponse.success && historyResponse.data ? historyResponse.data : [];

  return (
    <div className="container max-w-5xl pb-16">
      {/* Navigation with improved mobile tap target */}
      <Link
        href="/dashboard/trainer/workouts"
        className="inline-flex items-center text-muted-foreground hover:text-foreground mb-8 py-2 transition-colors"
      >
        <ChevronLeft className="h-4 w-4 mr-1" />
        <span>Back to workouts</span>
      </Link>

      <div className="space-y-8">
        <div className="relative overflow-hidden rounded-xl bg-gradient-to-br from-indigo-600/90 via-blue-600/80 to-indigo-700/90 p-8 border border-indigo-500/20 shadow-lg text-white">
          {/* Decorative background patterns */}
          <div className="absolute inset-0 opacity-5">
            <div className="absolute top-0 right-0 transform rotate-45 translate-x-1/3 -translate-y-1/2">
              <Dumbbell className="h-48 w-48" strokeWidth={0.5} />
            </div>
            <div className="absolute bottom-0 left-0 transform -rotate-12 -translate-x-1/4 translate-y-1/3">
              <Activity className="h-40 w-40" strokeWidth={0.5} />
            </div>
            <div className="grid grid-cols-8 grid-rows-8 h-full w-full">
              {decorations.map((style, i) => (
                <div
                  key={`deco-${i}-${style.left}-${style.top}`}
                  className="flex items-center justify-center opacity-20"
                  style={{
                    position: 'absolute',
                    left: style.left,
                    top: style.top,
                    transform: style.transform,
                  }}
                >
                  <Dumbbell className="h-8 w-8" strokeWidth={1} />
                </div>
              ))}
            </div>
          </div>

          {/* Glowing effects */}
          <div className="absolute top-1/2 right-1/4 h-40 w-40 rounded-full bg-blue-400/30 blur-3xl" />
          <div className="absolute bottom-0 left-1/4 h-32 w-32 rounded-full bg-indigo-300/20 blur-3xl" />

          <div className="relative z-10">
            <div className="inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm text-white px-4 py-1.5 rounded-full text-sm font-medium mb-4 shadow-sm">
              <Zap className="h-4 w-4" />
              AI-Powered Workout Builder
            </div>

            <h1 className="text-3xl sm:text-4xl font-bold tracking-tight mb-3 drop-shadow-sm">
              Craft <span className="text-blue-200">Perfect Workouts</span> in Seconds
            </h1>

            <p className="max-w-2xl text-base text-indigo-100/90 sm:text-lg">
              Let our AI design personalized workout plans tailored to your client's specific goals
              and fitness level — turning hours of planning into moments.
            </p>

            {/* Decorative icons */}
            <div className="absolute right-8 bottom-6 hidden lg:flex items-center gap-3">
              <div className="h-10 w-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center">
                <Dumbbell className="h-5 w-5 text-white" />
              </div>
              <div className="h-10 w-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center">
                <Activity className="h-5 w-5 text-white" />
              </div>
              <div className="h-10 w-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center">
                <Zap className="h-5 w-5 text-white" />
              </div>
            </div>
          </div>
        </div>

        {/* Use the new WorkoutTabs component */}
        <WorkoutTabs userId={userId} user={user} serverFallbackHistory={serverFallbackHistory} />
      </div>
    </div>
  );
}

// TabsHistoryContent has been removed as it's now handled internally by the WorkoutTabs component

```

# app/dashboard/trainer/workouts/assignworkout/_actions/assign-workout-plan.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export async function assignWorkoutPlan(userId: string, workoutPlanId: number) {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.post('/workouts/assign', {
      userId,
      workoutPlanId,
    });

    if (response.data.msg === 'success') {
      return {
        success: true,
      };
    }

    throw new Error(response.data.error || 'Failed to assign workout plan');
  } catch (error) {
    console.error('Error assigning workout plan:', error);
    throw error;
  }
}

```

# app/dashboard/trainer/workouts/assignworkout/_actions/get-workout-plans.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export interface Exercise {
  id: number;
  name: string;
  sets: number;
  reps: string;
  description: string;
  order: number;
}

export interface WorkoutSchedule {
  id: number;
  dayOfWeek: string;
  muscleTarget: string;
  duration: number;
  calories: number;
  exercises: Exercise[];
}

export interface WorkoutPlan {
  id: number;
  name: string;
  description: string | null;
  schedules: WorkoutSchedule[];
}

export async function getWorkoutPlans() {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get('/workouts/allworkoutplans');
    const data = response.data;

    if (data.msg === 'success') {
      return {
        success: true,
        workoutPlans: data.workoutPlans as WorkoutPlan[],
      };
    }
    return {
      success: false,
      workoutPlans: [],
    };
  } catch (error) {
    console.error('Error fetching workout plans:', error);
    return {
      success: false,
      workoutPlans: [],
      error: 'Failed to fetch workout plans',
    };
  }
}

```

# app/dashboard/trainer/workouts/assignworkout/_components/user-workout-list.tsx

```tsx
'use client';

import Link from 'next/link';
import type { AssignedUser } from '../../../assignedusers/GetuserassignedTotrainers';

interface Props {
  users: AssignedUser[];
}

export default function UserWorkoutList({ users }: Props) {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {users.map((user) => (
        <Link
          key={user.id}
          href={`/dashboard/trainer/workouts/assignworkout/${user.id}`}
          className="block"
        >
          <div className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
            <div className="flex items-center space-x-4">
              <div className="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center">
                <span className="text-xl text-gray-600">{user.name[0]}</span>
              </div>
              <div>
                <h3 className="font-medium">{user.name}</h3>
                <p className="text-sm text-gray-600">{user.email}</p>
              </div>
            </div>

            {user.HealthProfile && (
              <div className="mt-4 pt-4 border-t">
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div>
                    <span className="text-gray-600">Goal:</span>
                    <p className="font-medium">{user.HealthProfile.goal || 'Not specified'}</p>
                  </div>
                  <div>
                    <span className="text-gray-600">Status:</span>
                    <p
                      className={`font-medium ${
                        user.membershipStatus === 'active' ? 'text-green-600' : 'text-red-600'
                      }`}
                    >
                      {user.membershipStatus}
                    </p>
                  </div>
                </div>
              </div>
            )}
          </div>
        </Link>
      ))}
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assignworkout/[userid]/_actions/assign-workout.ts

```ts
'use server';

import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export async function assignWorkoutPlanToUser(userId: string, workoutPlanId: number) {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.post('/workouts/assign', {
      userId,
      workoutPlanId,
    });

    if (response.data.msg === 'success') {
      return {
        success: true,
      };
    }

    throw new Error(response.data.error || 'Failed to assign workout plan');
  } catch (error) {
    console.error('Error assigning workout plan:', error);
    throw error;
  }
}

```

# app/dashboard/trainer/workouts/assignworkout/[userid]/_assests/gemini-logo.png

This is a binary file of the type: Image

# app/dashboard/trainer/workouts/assignworkout/[userid]/_components/UserWorkoutAssignmentDetails.tsx

```tsx
'use client';

import Image from 'next/image';
import Link from 'next/link';
import { useState } from 'react';
import { toast } from 'sonner';
import type { AssignedUser } from '../../../../assignedusers/GetuserassignedTotrainers';
import { assignWorkoutPlan } from '../../_actions/assign-workout-plan';
import type { WorkoutPlan } from '../../_actions/get-workout-plans';
import CreateWOrkoutImaage from '../_assests/gemini-logo.png';
import WorkoutSearchFilters from './workout-search-filters';
interface Props {
  user: AssignedUser;
  workoutPlans: WorkoutPlan[];
}

export default function UserWorkoutAssignmentDetails({ user, workoutPlans }: Props) {
  const [selectedPlan, setSelectedPlan] = useState<number | null>(null);
  const [isAssigning, setIsAssigning] = useState(false);
  const [filteredWorkouts, setFilteredWorkouts] = useState<WorkoutPlan[]>(workoutPlans);

  const handleAssignWorkout = async () => {
    if (!selectedPlan) {
      toast.error('Please select a workout plan');
      return;
    }

    try {
      setIsAssigning(true);
      await assignWorkoutPlan(user.id, selectedPlan);
      toast.success('Workout plan assigned successfully');
    } catch (error) {
      toast.error('Failed to assign workout plan');
      console.error('Error assigning workout plan:', error);
    } finally {
      setIsAssigning(false);
    }
  };

  return (
    <div className="space-y-6">
      {/* User Profile Section */}
      <div className="bg-white rounded-lg shadow-md p-6">
        <div className="flex flex-col sm:flex-row sm:items-center gap-4 mb-6">
          <h2 className="text-xl font-semibold">User Profile</h2>
          <Link
            href={`/dashboard/trainer/workouts/assigncustomworkoutswithai?userId=${user.id}`}
            className="group relative flex items-center gap-3 px-4 py-3 bg-gradient-to-r from-violet-500 to-purple-600 text-white text-sm font-medium rounded-md hover:from-violet-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500 transition-all sm:ml-auto w-full sm:w-auto justify-center sm:justify-start overflow-hidden shadow-lg hover:shadow-xl"
          >
            <div className="relative z-10 flex items-center gap-3">
              <div className="relative flex items-center justify-center w-8 h-8 rounded-full bg-white/10 backdrop-blur-sm">
                <Image
                  src={CreateWOrkoutImaage}
                  alt="AI Workout"
                  className="w-5 h-5 object-contain brightness-0 invert opacity-90"
                />
              </div>
              <span className="font-medium tracking-wide">Custom Workout with AI</span>
            </div>
            <div className="absolute inset-0 bg-gradient-to-r from-violet-400/20 to-purple-500/20 backdrop-blur-[1px]" />
          </Link>
        </div>
        <div className="space-y-4">
          <div className="flex items-center space-x-4">
            <div className="w-20 h-20 bg-gradient-to-br from-blue-100 to-blue-50 rounded-full flex items-center justify-center shadow-inner">
              <span className="text-2xl text-blue-600 font-semibold">{user.name[0]}</span>
            </div>
            <div>
              <h3 className="font-medium text-lg">{user.name}</h3>
              <p className="text-gray-600">{user.email}</p>
            </div>
          </div>

          <div className="border-t pt-4 mt-4">
            <h4 className="font-medium mb-4 text-gray-900">Health Profile</h4>
            {user.HealthProfile ? (
              <div className="grid grid-cols-2 gap-6">
                <div className="bg-gray-50 p-3 rounded-lg">
                  <p className="text-sm text-gray-600 mb-1">Height</p>
                  <p className="font-medium text-gray-900">{user.HealthProfile.height} cm</p>
                </div>
                <div className="bg-gray-50 p-3 rounded-lg">
                  <p className="text-sm text-gray-600 mb-1">Weight</p>
                  <p className="font-medium text-gray-900">{user.HealthProfile.weight} kg</p>
                </div>
                <div className="bg-gray-50 p-3 rounded-lg">
                  <p className="text-sm text-gray-600 mb-1">Gender</p>
                  <p className="font-medium text-gray-900">{user.HealthProfile.gender}</p>
                </div>
                <div className="bg-gray-50 p-3 rounded-lg">
                  <p className="text-sm text-gray-600 mb-1">Goal</p>
                  <p className="font-medium text-gray-900">
                    {user.HealthProfile.goal || 'Not specified'}
                  </p>
                </div>
              </div>
            ) : (
              <p className="text-gray-500">No health profile available</p>
            )}
          </div>
        </div>
      </div>

      {/* Search and Filters */}
      <WorkoutSearchFilters workoutPlans={workoutPlans} onFilterChange={setFilteredWorkouts} />

      {/* Workout Plans Section */}
      <div className="bg-white rounded-lg shadow-md p-6">
        <div className="flex items-center justify-between mb-6">
          <div>
            <h2 className="text-xl font-semibold">Available Workout Plans</h2>
            <p className="text-sm text-gray-600 mt-1">Select a plan to assign to {user.name}</p>
          </div>
          <div className="flex items-center gap-2">
            <span className="hidden md:inline text-sm text-gray-600">Total:</span>
            <span className="px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-sm font-medium">
              {filteredWorkouts.length}
            </span>
          </div>
        </div>

        <div className="space-y-4">
          {filteredWorkouts.length === 0 ? (
            <div className="text-center py-8">
              <p className="text-gray-500">No workout plans match your filters</p>
            </div>
          ) : (
            filteredWorkouts.map((plan) => (
              <button
                key={plan.id}
                type="button"
                className={`group w-full text-left p-4 border rounded-lg transition-all ${
                  selectedPlan === plan.id
                    ? 'border-blue-500 bg-blue-50 ring-2 ring-blue-200'
                    : 'border-gray-200 hover:border-blue-300 hover:bg-gray-50'
                }`}
                onClick={() => setSelectedPlan(plan.id)}
              >
                <div className="flex flex-col sm:flex-row sm:items-start gap-3">
                  <div className="flex-1 min-w-0">
                    <div className="flex items-start justify-between">
                      <h3 className="font-medium text-gray-900 truncate pr-4">{plan.name}</h3>
                      <div className="flex items-center gap-2 sm:hidden">
                        <span className="shrink-0 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-50 text-blue-700">
                          {plan.schedules.length}
                          <span className="ml-1 hidden xs:inline">days</span>
                        </span>
                      </div>
                    </div>
                    {plan.description && (
                      <p className="text-sm text-gray-600 mt-1 line-clamp-2">{plan.description}</p>
                    )}
                  </div>
                  <div className="hidden sm:block shrink-0">
                    <span className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-50 text-blue-700">
                      {plan.schedules.length} days
                    </span>
                  </div>
                </div>

                <div className="mt-3 flex flex-wrap gap-1.5">
                  {plan.schedules.map((schedule) => (
                    <span
                      key={schedule.id}
                      className="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700 group-hover:bg-gray-200 transition-colors"
                    >
                      <span className="w-[1.125rem] h-[1.125rem] flex items-center justify-center rounded-full bg-gray-700 text-white mr-1.5">
                        {schedule.dayOfWeek[0]}
                      </span>
                      {schedule.muscleTarget}
                    </span>
                  ))}
                </div>
              </button>
            ))
          )}
        </div>

        <div className="mt-6 flex items-center justify-between">
          <Link
            href="/dashboard/trainer/workouts/createworkout"
            className="text-blue-600 hover:text-blue-700 text-sm font-medium inline-flex items-center group"
          >
            <span className="w-5 h-5 mr-2 rounded-full bg-blue-100 text-blue-600 inline-flex items-center justify-center group-hover:bg-blue-200 transition-colors">
              <svg
                className="w-3.5 h-3.5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
              >
                <title>Create new plan icon</title>
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth={2}
                  d="M12 4v16m8-8H4"
                />
              </svg>
            </span>
            Create New Plan
          </Link>
          <button
            type="button"
            onClick={handleAssignWorkout}
            disabled={!selectedPlan || isAssigning}
            className={`px-6 py-2.5 rounded-md text-white font-medium transition-all ${
              !selectedPlan || isAssigning
                ? 'bg-gray-400 cursor-not-allowed'
                : 'bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500'
            }`}
          >
            {isAssigning ? (
              <span className="inline-flex items-center">
                <svg
                  className="animate-spin -ml-1 mr-2 h-4 w-4 text-white"
                  fill="none"
                  viewBox="0 0 24 24"
                  aria-hidden="true"
                >
                  <title>Loading spinner</title>
                  <circle
                    className="opacity-25"
                    cx="12"
                    cy="12"
                    r="10"
                    stroke="currentColor"
                    strokeWidth="4"
                  />
                  <path
                    className="opacity-75"
                    fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                  />
                </svg>
                Assigning...
              </span>
            ) : (
              'Assign Workout Plan'
            )}
          </button>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assignworkout/[userid]/_components/workout-search-filters.tsx

```tsx
'use client';

import { useState } from 'react';
import type { WorkoutPlan } from '../../_actions/get-workout-plans';

interface Props {
  workoutPlans: WorkoutPlan[];
  onFilterChange: (filtered: WorkoutPlan[]) => void;
}

export default function WorkoutSearchFilters({ workoutPlans, onFilterChange }: Props) {
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedDays, setSelectedDays] = useState<string[]>([]);
  const [selectedMuscleTargets, setSelectedMuscleTargets] = useState<string[]>([]);

  // Get unique muscle targets and days from all workout plans
  const uniqueMuscleTargets = Array.from(
    new Set(
      workoutPlans.flatMap((plan) => plan.schedules.map((schedule) => schedule.muscleTarget)),
    ),
  ).sort();

  const uniqueDays = Array.from(
    new Set(workoutPlans.flatMap((plan) => plan.schedules.map((s) => s.dayOfWeek))),
  ).sort();

  const handleSearch = (query: string) => {
    setSearchQuery(query);
    filterWorkouts(query, selectedDays, selectedMuscleTargets);
  };

  const handleDayFilter = (day: string) => {
    const newDays = selectedDays.includes(day)
      ? selectedDays.filter((d) => d !== day)
      : [...selectedDays, day];
    setSelectedDays(newDays);
    filterWorkouts(searchQuery, newDays, selectedMuscleTargets);
  };

  const handleMuscleFilter = (muscle: string) => {
    const newMuscles = selectedMuscleTargets.includes(muscle)
      ? selectedMuscleTargets.filter((m) => m !== muscle)
      : [...selectedMuscleTargets, muscle];
    setSelectedMuscleTargets(newMuscles);
    filterWorkouts(searchQuery, selectedDays, newMuscles);
  };

  const filterWorkouts = (query: string, days: string[], muscles: string[]) => {
    let filtered = workoutPlans;

    // Search by name or description
    if (query) {
      const lowerQuery = query.toLowerCase();
      filtered = filtered.filter(
        (plan) =>
          plan.name.toLowerCase().includes(lowerQuery) ||
          (plan.description?.toLowerCase() || '').includes(lowerQuery),
      );
    }

    // Filter by selected days
    if (days.length > 0) {
      filtered = filtered.filter((plan) =>
        plan.schedules.some((schedule) => days.includes(schedule.dayOfWeek)),
      );
    }

    // Filter by selected muscle targets
    if (muscles.length > 0) {
      filtered = filtered.filter((plan) =>
        plan.schedules.some((schedule) => muscles.includes(schedule.muscleTarget)),
      );
    }

    onFilterChange(filtered);
  };

  return (
    <div className="bg-white rounded-lg shadow-md p-6">
      <div className="space-y-6">
        {/* Search Input */}
        <div>
          <div className="relative">
            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <svg
                className="h-5 w-5 text-gray-400"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                aria-hidden="true"
              >
                <path
                  fillRule="evenodd"
                  d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                  clipRule="evenodd"
                />
              </svg>
            </div>
            <input
              type="text"
              placeholder="Search workout plans..."
              value={searchQuery}
              onChange={(e) => handleSearch(e.target.value)}
              className="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"
            />
          </div>
        </div>

        {/* Active Filters Summary */}
        {(selectedDays.length > 0 || selectedMuscleTargets.length > 0) && (
          <div className="flex items-center gap-2 text-sm text-gray-600">
            <span>Active filters:</span>
            <div className="flex flex-wrap gap-2">
              {selectedDays.map((day) => (
                <span
                  key={day}
                  className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
                >
                  {day}
                  <button
                    type="button"
                    onClick={() => handleDayFilter(day)}
                    className="ml-1 inline-flex items-center justify-center"
                    aria-label={`Remove ${day} filter`}
                  >
                    <svg className="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                      <title>Remove {day} filter</title>
                      <path
                        fillRule="evenodd"
                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                        clipRule="evenodd"
                      />
                    </svg>
                  </button>
                </span>
              ))}
              {selectedMuscleTargets.map((muscle) => (
                <span
                  key={muscle}
                  className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"
                >
                  {muscle}
                  <button
                    type="button"
                    onClick={() => handleMuscleFilter(muscle)}
                    className="ml-1 inline-flex items-center justify-center"
                    aria-label={`Remove ${muscle} filter`}
                  >
                    <svg className="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                      <title>Remove {muscle} filter</title>
                      <path
                        fillRule="evenodd"
                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                        clipRule="evenodd"
                      />
                    </svg>
                  </button>
                </span>
              ))}
            </div>
          </div>
        )}

        {/* Filter Groups */}
        <div className="grid md:grid-cols-2 gap-6">
          {/* Days Filter */}
          <div>
            <h3 className="font-medium mb-3 text-gray-900">Training Days</h3>
            <div className="flex flex-wrap gap-2">
              {uniqueDays.map((day) => (
                <button
                  key={day}
                  onClick={() => handleDayFilter(day)}
                  type="button"
                  className={`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${
                    selectedDays.includes(day)
                      ? 'bg-blue-500 text-white shadow-sm'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {day}
                </button>
              ))}
            </div>
          </div>

          {/* Muscle Targets Filter */}
          <div>
            <h3 className="font-medium mb-3 text-gray-900">Muscle Groups</h3>
            <div className="flex flex-wrap gap-2">
              {uniqueMuscleTargets.map((muscle) => (
                <button
                  key={muscle}
                  onClick={() => handleMuscleFilter(muscle)}
                  type="button"
                  className={`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${
                    selectedMuscleTargets.includes(muscle)
                      ? 'bg-indigo-500 text-white shadow-sm'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {muscle}
                </button>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assignworkout/[userid]/page.tsx

```tsx
import { notFound } from "next/navigation";
import {
  type AssignedUser,
  getUsersAssignedToTrainer,
} from "../../../assignedusers/GetuserassignedTotrainers";
import { type WorkoutPlan, getAllWorkoutPlans } from "../Getworkout";
import UserWorkoutAssignmentDetails from "./_components/UserWorkoutAssignmentDetails";

export default async function AssignWorkoutToUserPage({
  params,
}: {
  params: Promise<{ userid: string }>;
}) {
  const { userid } = await params;

  // Fetch user details and available workout plans
  const [users, workoutPlansResult] = await Promise.all([
    getUsersAssignedToTrainer(),
    getAllWorkoutPlans(),
  ]);

  const user = users.find((u) => u.id === userid);

  if (!user) {
    notFound();
  }

  const workoutPlans = workoutPlansResult.workoutPlans || [];

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-2xl font-bold mb-6">Assign Workout Plan</h1>
      <UserWorkoutAssignmentDetails user={user} workoutPlans={workoutPlans} />
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assignworkout/AttachWorkoutplantoUser.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

interface AssignWorkoutPlanResponse {
  msg: string;
  previousPlan?: {
    id: number;
    name: string;
    description?: string;
  } | null;
  newPlan?: {
    id: number;
    name: string;
    description?: string;
  } | null;
}

export async function attachWorkoutPlanToUser(
  userId: string,
  workoutPlanId: string,
): Promise<AssignWorkoutPlanResponse> {
  try {
    const trainerAxios = await TrainerReqConfig();
    const response = await trainerAxios.post('/workouts/assignworkoutplan', {
      userId: Number.parseInt(userId),
      workoutPlanId: Number.parseInt(workoutPlanId),
    });

    if (response.data.error) {
      throw new Error(response.data.error);
    }

    return response.data;
  } catch (error) {
    console.error('Error assigning workout plan:', error);
    throw new Error(error instanceof Error ? error.message : 'Failed to assign workout plan');
  }
}

```

# app/dashboard/trainer/workouts/assignworkout/GetuserassignedTotrainers.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export interface AssignedUser {
  id: string;
  name: string;
  email: string;
  gender: string;
  goal: string;
  membershipStatus: string;
  activeWorkoutPlanId: number | null;
  activeWorkoutPlanName: string | null;
  hasActiveWorkoutPlan: boolean;
  HealthProfile?: {
    weight: number;
    height: number;
    goal: string | null;
    gender: string;
  } | null;
}

export const getUsersAssignedToTrainer = async () => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get('/client/assignedusers');
    const data = response.data;

    if (data.msg === 'success') {
      // console.log("this are the assigned users", data.users);
      return data.users as AssignedUser[];
    }
    return [];
  } catch (error) {
    console.error('Error fetching assigned users:', error);
    return [];
  }
};

```

# app/dashboard/trainer/workouts/assignworkout/Getworkout.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

export interface Exercise {
  id: number;
  name: string;
  sets: number;
  reps: string;
  description: string;
  order: number;
}

export interface WorkoutSchedule {
  id: number;
  dayOfWeek: string;
  muscleTarget: string;
  duration: number;
  calories: number;
  exercises: Exercise[];
}

export interface WorkoutPlan {
  id: number;
  name: string;
  description: string | null;
  schedules: WorkoutSchedule[];
}

export const getAllWorkoutPlans = async () => {
  const trainerAxios = await TrainerReqConfig();
  try {
    const response = await trainerAxios.get('/workouts/allworkoutplans');
    const data = response.data;

    if (data.msg === 'success') {
      // console.log("this are the all of the workous" , data.workoutPlans);
      return {
        success: true,
        workoutPlans: data.workoutPlans as WorkoutPlan[],
      };
    }
    return {
      success: false,
      workoutPlans: [],
    };
  } catch (error) {
    console.error('Error fetching workout plans:', error);
    return {
      success: false,
      workoutPlans: [],
      error: 'Failed to fetch workout plans',
    };
  }
};

```

# app/dashboard/trainer/workouts/assignworkout/page.tsx

```tsx
import { getUsersAssignedToTrainer } from '../../assignedusers/GetuserassignedTotrainers';
import UserWorkoutList from './_components/user-workout-list';

export default async function AssignWorkoutPage() {
  const users = await getUsersAssignedToTrainer();

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-2xl font-bold mb-6">Assign Workout Plans</h1>
      <UserWorkoutList users={users} />
    </div>
  );
}

```

# app/dashboard/trainer/workouts/assignworkout/UserWorkoutAssignment.tsx

```tsx
'use client';
import { DataCard } from '@/components/Table/UserCard';
import { DataTable } from '@/components/Table/UsersTable';
import { StatusCard } from '@/components/common/StatusCard';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import type { ColumnDef } from '@tanstack/react-table';
import { ArrowUpDown, type LucideIcon } from 'lucide-react';
import * as LucideIcons from 'lucide-react';
import React, { useState, useEffect, useMemo, useCallback } from 'react';
import { toast } from 'sonner';
import { attachWorkoutPlanToUser } from './AttachWorkoutplantoUser';
import type { WorkoutPlan } from './Getworkout';

// Update StatusCardProps interface
interface StatusCardProps {
  title: string;
  value: number;
  iconName: string;
  gradient: string;
}

// Update UserType to exactly match AssignedUser from GetuserassignedTotrainers
interface UserType {
  id: string;
  name: string;
  email: string;
  gender: string;
  goal: string;
  membershipStatus: string;
  activeWorkoutPlanId: number | null;
  activeWorkoutPlanName: string | null;
  hasActiveWorkoutPlan: boolean;
}

interface UserWorkoutAssignmentProps {
  Users: UserType[];
  statusCards: StatusCardProps[];
  workoutPlans: WorkoutPlan[];
}

// Update the Select component in the columns definition to use workoutPlans
const createColumns = (
  workoutPlans: WorkoutPlan[],
  handleWorkoutAssignment: (userId: string, workoutPlanId: string) => Promise<void>, // Changed userId to string
): ColumnDef<UserType>[] => [
  {
    accessorKey: 'name',
    header: ({ column }) => {
      return (
        <Button
          variant="ghost"
          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
        >
          User Name
          <ArrowUpDown className="ml-2 h-4 w-4" />
        </Button>
      );
    },
  },
  {
    accessorKey: 'gender',
    header: 'Gender',
  },
  {
    accessorKey: 'goal',
    header: 'Fitness Goal',
  },
  {
    accessorKey: 'assignedWorkout',
    header: 'Assign Workout',
    cell: ({ row }) => {
      const user = row.original;
      console.log('Rendering workout for user:', user); // Debug log

      return (
        <div className="flex flex-col gap-1">
          <Select
            value={user.activeWorkoutPlanId?.toString() || undefined}
            onValueChange={(value) => handleWorkoutAssignment(user.id, value)}
          >
            <SelectTrigger
              className={`w-[200px] ${
                user.hasActiveWorkoutPlan
                  ? 'bg-green-50 border-green-200 text-green-700'
                  : 'bg-red-50 border-red-200 text-red-700'
              }`}
            >
              <SelectValue
                placeholder={
                  user.hasActiveWorkoutPlan
                    ? `Current: ${user.activeWorkoutPlanName}`
                    : 'No workout assigned'
                }
              />
            </SelectTrigger>
            <SelectContent>
              {workoutPlans.map((plan) => (
                <SelectItem
                  key={plan.id}
                  value={plan.id.toString()}
                  className={plan.id === user.activeWorkoutPlanId ? 'bg-green-50' : ''}
                >
                  {plan.name}
                  {plan.id === user.activeWorkoutPlanId && (
                    <span className="ml-2 text-green-600">•</span>
                  )}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
          {user.hasActiveWorkoutPlan && (
            <p className="text-xs text-green-600">Active Plan: {user.activeWorkoutPlanName}</p>
          )}
        </div>
      );
    },
  },
];

export default function UserWorkoutAssignment({
  Users,
  statusCards,
  workoutPlans,
}: UserWorkoutAssignmentProps) {
  const [searchTerm, setSearchTerm] = useState('');
  const [genderFilter, setGenderFilter] = useState<'Male' | 'Female' | 'All'>('All');
  const [assignmentFilter, setAssignmentFilter] = useState<'all' | 'assigned' | 'unassigned'>(
    'all',
  );
  const [filteredUsers, setFilteredUsers] = useState<UserType[]>(Users);

  // Update handleWorkoutAssignment to use string ID
  const handleWorkoutAssignment = useCallback(
    async (userId: string, workoutPlanId: string) => {
      try {
        const previousPlan = Users.find((u) => u.id === userId)?.activeWorkoutPlanName;
        const newPlan = workoutPlans.find((p) => p.id === Number.parseInt(workoutPlanId));

        await attachWorkoutPlanToUser(userId, workoutPlanId);

        // Update local state
        setFilteredUsers((current) =>
          current.map((user) =>
            user.id === userId
              ? {
                  ...user,
                  activeWorkoutPlanId: Number.parseInt(workoutPlanId),
                  activeWorkoutPlanName: newPlan?.name || '',
                  hasActiveWorkoutPlan: true,
                }
              : user,
          ),
        );

        toast.success(
          previousPlan
            ? `Workout plan updated from "${previousPlan}" to "${newPlan?.name}"`
            : `Workout plan "${newPlan?.name}" assigned successfully`,
          {
            description: "The user's workout plan has been updated.",
          },
        );
      } catch (error) {
        console.error('Error assigning workout plan:', error);
        toast.error('Failed to assign workout plan', {
          description: 'Please try again or contact support if the issue persists.',
        });
      }
    },
    [Users, workoutPlans],
  );

  const columns = useMemo(
    () => createColumns(workoutPlans, handleWorkoutAssignment),
    [handleWorkoutAssignment, workoutPlans],
  );

  // Helper function to get icon component
  const getIcon = (iconName: string): LucideIcon => {
    const Icon = LucideIcons[iconName as keyof typeof LucideIcons] as LucideIcon;
    return Icon || (LucideIcons.HelpCircle as LucideIcon);
  };

  // Calculate stats

  useEffect(() => {
    const filtered = Users.filter(
      (user) =>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) &&
        (genderFilter === 'All' || user.gender === genderFilter) &&
        (assignmentFilter === 'all' ||
          (assignmentFilter === 'assigned' && user.hasActiveWorkoutPlan) ||
          (assignmentFilter === 'unassigned' && !user.hasActiveWorkoutPlan)),
    );
    setFilteredUsers(filtered);
  }, [searchTerm, genderFilter, assignmentFilter, Users]);

  return (
    <div className="container mx-auto p-6 space-y-8">
      <h1 className="text-2xl font-bold text-center">Workout Assignment</h1>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        {statusCards.map((card) => {
          const IconComponent = getIcon(card.iconName);
          return (
            <StatusCard
              key={card.title}
              title={card.title}
              value={card.value}
              icon={IconComponent}
              gradient={card.gradient as 'blue' | 'green' | 'red'}
            />
          );
        })}
      </div>

      <div className="flex flex-col md:flex-row gap-4 mb-6">
        <Input
          placeholder="Search users..."
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="max-w-sm"
        />
        <Select
          value={genderFilter}
          onValueChange={(value: 'Male' | 'Female' | 'All') => setGenderFilter(value)}
        >
          <SelectTrigger className="w-[180px]">
            <SelectValue placeholder="Select gender" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="All">All</SelectItem>
            <SelectItem value="Male">Male</SelectItem>
            <SelectItem value="Female">Female</SelectItem>
          </SelectContent>
        </Select>
        <Select
          value={assignmentFilter}
          onValueChange={(value: 'all' | 'assigned' | 'unassigned') => setAssignmentFilter(value)}
        >
          <SelectTrigger className="w-[180px]">
            <SelectValue placeholder="Filter by assignment" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="all">All Users</SelectItem>
            <SelectItem value="assigned">Assigned</SelectItem>
            <SelectItem value="unassigned">Unassigned</SelectItem>
          </SelectContent>
        </Select>
      </div>

      {/* Desktop View */}
      <div className="hidden md:block">
        <DataTable data={filteredUsers} columns={columns} filterColumn="name" />
      </div>

      {/* Mobile View */}
      <div className="md:hidden">
        <DataCard
          data={filteredUsers}
          renderCard={(user) => {
            const hasWorkout = user.hasActiveWorkoutPlan;

            return (
              <div className="p-4 space-y-2">
                <h3 className="font-medium">{user.name}</h3>
                <p className="text-sm text-gray-500">Gender: {user.gender}</p>
                <p className="text-sm text-gray-500">Goal: {user.goal}</p>
                <Select
                  value={user.activeWorkoutPlanId?.toString()}
                  onValueChange={(value) => handleWorkoutAssignment(user.id, value)}
                >
                  <SelectTrigger
                    className={`w-full ${
                      hasWorkout
                        ? 'bg-green-50 border-green-200 text-green-700'
                        : 'bg-red-50 border-red-200 text-red-700'
                    }`}
                  >
                    <SelectValue
                      placeholder={
                        hasWorkout
                          ? `Current: ${user.activeWorkoutPlanName}`
                          : 'No workout assigned'
                      }
                    />
                  </SelectTrigger>
                  <SelectContent>
                    {workoutPlans.map((plan) => (
                      <SelectItem
                        key={plan.id}
                        value={plan.id.toString()}
                        className={plan.id === user.activeWorkoutPlanId ? 'bg-green-50' : ''}
                      >
                        {plan.name}
                        {plan.id === user.activeWorkoutPlanId && (
                          <span className="ml-2 text-green-600">•</span>
                        )}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
                {hasWorkout && (
                  <p className="text-xs text-green-600">
                    Active Plan: {user.activeWorkoutPlanName}
                  </p>
                )}
              </div>
            );
          }}
        />
      </div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/createworkout/CreateWorkoutPlan.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Textarea } from '@/components/ui/textarea';
import { AnimatePresence, m } from 'framer-motion';
import { ChevronLeft, ChevronRight, Plus, Save, X } from 'lucide-react';
import { useRouter } from 'next/navigation';
import React, { useState, useEffect } from 'react';
import { DragDropContext, Draggable, type DropResult, Droppable } from 'react-beautiful-dnd';
import { toast } from 'sonner';
import { createWorkoutPlan } from './PostCreatedWorkoutplan';

interface Exercise {
  name: string;
  sets: number;
  reps: string;
  description: string;
  order: number;
}

interface DaySchedule {
  dayOfWeek: string;
  muscleTarget: string;
  duration: number;
  calories: number;
  exercises: Exercise[];
}

interface WorkoutPlanResponse {
  success: boolean;
  message: string;
}

interface WorkoutPlanData {
  name: string;
  description: string;
  schedules: DaySchedule[];
}

// Type guard function to verify response shape
function isWorkoutPlanResponse(response: unknown): response is WorkoutPlanResponse {
  return (
    typeof response === 'object' &&
    response !== null &&
    'success' in response &&
    'message' in response &&
    typeof (response as WorkoutPlanResponse).success === 'boolean' &&
    typeof (response as WorkoutPlanResponse).message === 'string'
  );
}

const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
const muscleGroups = ['Chest', 'Back', 'Legs', 'Shoulders', 'Arms', 'Core', 'Full Body'];

export default function CreateWorkoutPlan() {
  const router = useRouter();
  const [selectedDay, setSelectedDay] = useState<string | null>(null);
  const [currentStep, setCurrentStep] = useState(() => {
    if (typeof window !== 'undefined') {
      return Number.parseInt(localStorage.getItem('workoutPlanStep') || '1');
    }
    return 1;
  });

  const [planName, setPlanName] = useState(() => {
    if (typeof window !== 'undefined') {
      return localStorage.getItem('workoutPlanName') || '';
    }
    return '';
  });

  const [planDescription, setPlanDescription] = useState(() => {
    if (typeof window !== 'undefined') {
      return localStorage.getItem('workoutPlanDescription') || '';
    }
    return '';
  });

  const [schedules, setSchedules] = useState<DaySchedule[]>(() => {
    if (typeof window !== 'undefined') {
      const savedSchedules = localStorage.getItem('workoutSchedules');
      return savedSchedules ? JSON.parse(savedSchedules) : [];
    }
    return [];
  });

  // Save to localStorage whenever data changes
  useEffect(() => {
    localStorage.setItem('workoutPlanStep', currentStep.toString());
    localStorage.setItem('workoutPlanName', planName);
    localStorage.setItem('workoutPlanDescription', planDescription);
    localStorage.setItem('workoutSchedules', JSON.stringify(schedules));
  }, [currentStep, planName, planDescription, schedules]);

  const handleDragEnd = (result: DropResult) => {
    if (!result.destination) return;

    const day = selectedDay;
    const items = Array.from(schedules.find((s) => s.dayOfWeek === day)?.exercises || []);

    const [reorderedItem] = items.splice(result.source.index, 1);

    items.splice(result.destination.index, 0, reorderedItem);

    setSchedules((current) =>
      current.map((schedule) =>
        schedule.dayOfWeek === day
          ? {
              ...schedule,
              exercises: items.map((item, index) => ({
                ...item,
                order: index,
              })),
            }
          : schedule,
      ),
    );
  };

  // Add checkpoint saving logic
  const saveCheckpoint = (daySchedule: DaySchedule) => {
    const checkpoints = JSON.parse(localStorage.getItem('workoutPlanCheckpoints') || '[]');
    checkpoints.push({
      step: currentStep,
      schedule: daySchedule,
      timestamp: new Date().toISOString(),
    });
    localStorage.setItem('workoutPlanCheckpoints', JSON.stringify(checkpoints));
    toast.success('Progress saved');
  };

  // Modify addExercise to save checkpoint when day is complete
  const addExercise = (day: string) => {
    const newExercise: Exercise = {
      name: '',
      sets: 3,
      reps: '8-12',
      description: '',
      order: schedules.find((s) => s.dayOfWeek === day)?.exercises?.length || 0,
    };

    setSchedules((current) => {
      const existingSchedule = current.find((s) => s.dayOfWeek === day);
      if (existingSchedule) {
        const updatedSchedule = {
          ...existingSchedule,
          exercises: [...existingSchedule.exercises, newExercise],
        };
        // Save checkpoint when day has 3 or more exercises
        if (updatedSchedule.exercises.length >= 3) {
          saveCheckpoint(updatedSchedule);
        }
        return current.map((schedule) => (schedule.dayOfWeek === day ? updatedSchedule : schedule));
      }
      const newSchedule = {
        dayOfWeek: day,
        muscleTarget: '',
        duration: 60,
        calories: 400,
        exercises: [newExercise],
      };
      return [...current, newSchedule];
    });
  };

  const updateExercise = (
    dayOfWeek: string,
    index: number,
    field: keyof Exercise,
    value: string | number,
  ) => {
    setSchedules((current) =>
      current.map((schedule) =>
        schedule.dayOfWeek === dayOfWeek
          ? {
              ...schedule,
              exercises: schedule.exercises.map((ex, i) =>
                i === index ? { ...ex, [field]: value } : ex,
              ),
            }
          : schedule,
      ),
    );
  };

  // Clear localStorage after successful submission
  const handleSubmit = async () => {
    try {
      // Validate schedules data
      if (!schedules.length) {
        toast.error('Please add at least one workout schedule');
        return;
      }

      // Prepare the workout plan data
      const workoutPlanData: WorkoutPlanData = {
        name: planName,
        description: planDescription,
        schedules: schedules.map((schedule) => ({
          dayOfWeek: schedule.dayOfWeek,
          muscleTarget: schedule.muscleTarget,
          duration: schedule.duration,
          calories: schedule.calories,
          exercises: schedule.exercises.map((exercise, index) => ({
            ...exercise,
            order: index,
          })),
        })),
      };

      const response = await createWorkoutPlan(workoutPlanData);

      if (!isWorkoutPlanResponse(response)) {
        throw new Error('Invalid response format from server');
      }

      if (response.success) {
        // Clear all stored data
        localStorage.removeItem('workoutPlanCheckpoints');
        localStorage.removeItem('workoutPlanStep');
        localStorage.removeItem('workoutPlanName');
        localStorage.removeItem('workoutPlanDescription');
        localStorage.removeItem('workoutSchedules');

        toast.success(response.message);
        // Optionally redirect to workout plans list
        router.push('/trainerdashboard/workouts/assignworkout');
      } else {
        toast.error(response.message);
      }
    } catch (error) {
      toast.error('Error submitting workout plan');
      console.error(error);
    }
  };

  // Add restore checkpoint function

  return (
    <div className="container mx-auto p-6">
      <m.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="max-w-4xl mx-auto"
      >
        {/* Progress Steps */}
        <div className="flex justify-between mb-8">
          {[1, 2].map((step) => (
            <div
              key={step}
              className={`flex items-center ${
                currentStep >= step ? 'text-blue-600' : 'text-gray-400'
              }`}
            >
              <div
                className={`w-8 h-8 rounded-full flex items-center justify-center border-2 
                  ${currentStep >= step ? 'border-blue-600 bg-blue-50' : 'border-gray-300'}`}
              >
                {step}
              </div>
              {step < 2 && (
                <div
                  className={`flex-1 h-1 mx-4 ${
                    currentStep > step ? 'bg-blue-600' : 'bg-gray-300'
                  }`}
                />
              )}
            </div>
          ))}
        </div>

        {/* Step 1: Basic Information */}
        <AnimatePresence mode="wait">
          {currentStep === 1 && (
            <m.div
              key="step1"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: 20 }}
              className="space-y-6"
            >
              <h2 className="text-2xl font-bold">Create Workout Plan</h2>
              <div className="space-y-4">
                <div>
                  <label htmlFor="planName" className="block text-sm font-medium mb-2">
                    Plan Name
                  </label>
                  <Input
                    id="planName"
                    value={planName}
                    onChange={(e) => setPlanName(e.target.value)}
                    placeholder="e.g., Beginner Strength Training"
                  />
                </div>
                <div>
                  <label htmlFor="planDescription" className="block text-sm font-medium mb-2">
                    Description
                  </label>
                  <Textarea
                    id="planDescription"
                    value={planDescription}
                    onChange={(e) => setPlanDescription(e.target.value)}
                    placeholder="Describe the workout plan..."
                    rows={4}
                  />
                </div>
              </div>
            </m.div>
          )}

          {/* Step 2: Schedule Selection */}
          {currentStep === 2 && (
            <m.div
              key="step2"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: 20 }}
              className="space-y-6"
            >
              <h2 className="text-2xl font-bold">Workout Schedule</h2>
              <div className="grid grid-cols-7 gap-4">
                {daysOfWeek.map((day) => (
                  <Card
                    key={day}
                    className={`p-4 cursor-pointer transition-all ${
                      selectedDay === day ? 'ring-2 ring-blue-500' : ''
                    }`}
                    onClick={() => setSelectedDay(day)}
                  >
                    <p className="text-sm font-medium text-center">{day}</p>
                  </Card>
                ))}
              </div>

              {selectedDay && (
                <DragDropContext onDragEnd={handleDragEnd}>
                  <div className="mt-6 space-y-4">
                    <div className="flex gap-4">
                      <Select
                        onValueChange={(value) =>
                          setSchedules((current) =>
                            current.map((schedule) =>
                              schedule.dayOfWeek === selectedDay
                                ? { ...schedule, muscleTarget: value }
                                : schedule,
                            ),
                          )
                        }
                      >
                        <SelectTrigger>
                          <SelectValue placeholder="Select muscle group" />
                        </SelectTrigger>
                        <SelectContent>
                          {muscleGroups.map((group) => (
                            <SelectItem key={group} value={group}>
                              {group}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                      <Input
                        type="number"
                        placeholder="Duration (minutes)"
                        className="w-32"
                        onChange={(e) =>
                          setSchedules((current) =>
                            current.map((schedule) =>
                              schedule.dayOfWeek === selectedDay
                                ? {
                                    ...schedule,
                                    duration: Number.parseInt(e.target.value),
                                  }
                                : schedule,
                            ),
                          )
                        }
                      />
                      <Input
                        type="number"
                        placeholder="Calories"
                        className="w-32"
                        onChange={(e) =>
                          setSchedules((current) =>
                            current.map((schedule) =>
                              schedule.dayOfWeek === selectedDay
                                ? {
                                    ...schedule,
                                    calories: Number.parseInt(e.target.value),
                                  }
                                : schedule,
                            ),
                          )
                        }
                      />
                    </div>

                    <Droppable droppableId="exercises">
                      {(provided) => (
                        <div
                          {...provided.droppableProps}
                          ref={provided.innerRef}
                          className="space-y-4"
                        >
                          {schedules
                            .find((s) => s.dayOfWeek === selectedDay)
                            ?.exercises.map((exercise, index) => (
                              <Draggable
                                key={`${selectedDay}-exercise-${exercise.name}-${index}`}
                                draggableId={`exercise-${index}`}
                                index={index}
                              >
                                {(provided) => (
                                  <div
                                    ref={provided.innerRef}
                                    {...provided.draggableProps}
                                    {...provided.dragHandleProps}
                                    className="bg-white p-4 rounded-lg shadow space-y-3"
                                  >
                                    <div className="flex justify-between items-start">
                                      <div className="flex-1 space-y-3">
                                        <Input
                                          placeholder="Exercise name"
                                          value={exercise.name}
                                          onChange={(e) =>
                                            updateExercise(
                                              selectedDay,
                                              index,
                                              'name',
                                              e.target.value,
                                            )
                                          }
                                        />
                                        <div className="flex gap-4">
                                          <div className="w-24">
                                            <Input
                                              type="number"
                                              placeholder="Sets"
                                              value={exercise.sets}
                                              onChange={(e) =>
                                                updateExercise(
                                                  selectedDay,
                                                  index,
                                                  'sets',
                                                  Number.parseInt(e.target.value),
                                                )
                                              }
                                            />
                                          </div>
                                          <div className="flex-1">
                                            <Input
                                              placeholder="Reps (e.g., 8-12)"
                                              value={exercise.reps}
                                              onChange={(e) =>
                                                updateExercise(
                                                  selectedDay,
                                                  index,
                                                  'reps',
                                                  e.target.value,
                                                )
                                              }
                                            />
                                          </div>
                                        </div>
                                        <Textarea
                                          placeholder="Exercise description"
                                          value={exercise.description}
                                          onChange={(e) =>
                                            updateExercise(
                                              selectedDay,
                                              index,
                                              'description',
                                              e.target.value,
                                            )
                                          }
                                          rows={2}
                                        />
                                      </div>
                                      <Button
                                        variant="ghost"
                                        size="icon"
                                        className="ml-2"
                                        onClick={() => {
                                          setSchedules((current) =>
                                            current.map((schedule) =>
                                              schedule.dayOfWeek === selectedDay
                                                ? {
                                                    ...schedule,
                                                    exercises: schedule.exercises.filter(
                                                      (_, i) => i !== index,
                                                    ),
                                                  }
                                                : schedule,
                                            ),
                                          );
                                        }}
                                      >
                                        <X className="h-4 w-4" />
                                      </Button>
                                    </div>
                                  </div>
                                )}
                              </Draggable>
                            ))}
                          {provided.placeholder}
                        </div>
                      )}
                    </Droppable>

                    <Button
                      onClick={() => selectedDay && addExercise(selectedDay)}
                      className="mt-4"
                    >
                      <Plus className="w-4 h-4 mr-2" />
                      Add Exercise
                    </Button>
                  </div>
                </DragDropContext>
              )}
            </m.div>
          )}
        </AnimatePresence>

        {/* Navigation Buttons */}
        <div className="flex justify-between mt-8">
          <Button
            onClick={() => setCurrentStep((current) => Math.max(current - 1, 1))}
            disabled={currentStep === 1}
          >
            <ChevronLeft className="w-4 h-4 mr-2" />
            Previous
          </Button>
          {currentStep === 2 ? (
            <Button onClick={handleSubmit} variant="default">
              <Save className="w-4 h-4 mr-2" />
              Save Workout Plan
            </Button>
          ) : (
            <Button onClick={() => setCurrentStep((current) => Math.min(current + 1, 2))}>
              Next
              <ChevronRight className="w-4 h-4 ml-2" />
            </Button>
          )}
        </div>
      </m.div>
    </div>
  );
}

```

# app/dashboard/trainer/workouts/createworkout/page.tsx

```tsx
'use client';
import React from 'react';
import CreateWorkoutPlan from './CreateWorkoutPlan';

export default function Page() {
  return (
    <div className="min-h-screen bg-gray-50">
      <CreateWorkoutPlan />
    </div>
  );
}

```

# app/dashboard/trainer/workouts/createworkout/PostCreatedWorkoutplan.ts

```ts
'use server';
import { TrainerReqConfig } from '@/lib/AxiosInstance/trainerAxios';

interface ExerciseInput {
  name: string;
  sets: number;
  reps: string;
  description: string;
  order: number;
}

interface ScheduleInput {
  dayOfWeek: string;
  muscleTarget: string;
  duration: number;
  calories: number;
  exercises: ExerciseInput[];
}

interface WorkoutPlanInput {
  name: string;
  description?: string;
  schedules: ScheduleInput[];
}

interface WorkoutPlanResponse {
  success: boolean;
  message: string;
  workoutPlan?: {
    id: number;
    name: string;
    description?: string;
    createdByTrainerId: number;
    schedules: Array<{
      id: number;
      dayOfWeek: string;
      muscleTarget: string;
      duration: number;
      calories: number;
      exercises: Array<{
        id: number;
        name: string;
        sets: number;
        reps: string;
        description: string;
        order: number;
      }>;
    }>;
  };
}

export const createWorkoutPlan = async (
  workoutPlan: WorkoutPlanInput,
): Promise<WorkoutPlanResponse> => {
  const trainerAxios = await TrainerReqConfig();

  try {
    const response = await trainerAxios.post('/workouts/createworkoutplans', workoutPlan);

    if (response.status === 201) {
      return {
        success: true,
        message: 'Workout plan created successfully',
        workoutPlan: response.data.workoutPlan,
      };
    }

    return {
      success: false,
      message: response.data.msg || 'Failed to create workout plan',
    };
  } catch (error: unknown) {
    console.error('Error creating workout plan:', error);
    return {
      success: false,
      message: error instanceof Error ? error.message : 'Failed to create workout plan',
    };
  }
};

```

# app/globals.css

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
  * {
    @apply border-[hsl(var(--border))];
  }
  body {
    @apply bg-background text-foreground;
  }
}

.swal2-container {
  z-index: 100 !important; /* Adjust this value as needed */
}

.perspective {
  perspective: 1000px;
}

.backface-hidden {
  backface-visibility: hidden;
}

.transform-style-3d {
  transform-style: preserve-3d;
}

.rotate-y-180 {
  transform: rotateY(180deg);
}

@keyframes float {
  0% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-20px);
  }
  100% {
    transform: translateY(0px);
  }
}

.floating {
  animation: float 6s ease-in-out infinite;
}

@keyframes gradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.animate-gradient {
  background-size: 200% 200%;
  animation: gradient 8s ease infinite;
}

/* Add these CSS classes for the flip card */
.flip-card {
  perspective: 1000px;
}

.flip-card .preserve-3d {
  transform-style: preserve-3d;
}

.flip-card .backface-hidden {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

.flip-card .rotate-y-180 {
  transform: rotateY(180deg);
}

.perspective-1000 {
  perspective: 1000px;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-in forwards;
}

@layer utilities {
  .animate-fade-in {
    animation: fadeIn 0.5s ease-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}

```

# app/gym/[gymname]/FetchGymData.ts

```ts
'use server';

interface GymDataType {
  name: string;
  id: string;
  img: string;
  address: string;
}

export default async function FetchGymData(gymname: string): Promise<GymDataType | null> {
  try {
    const response = await fetch(
      `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/public/gym/${gymname}`,
      {
        next: { revalidate: 3600 },
      },
    );

    if (!response.ok) {
      console.error(`API request failed with status ${response.status}`);
      return null;
    }

    const data = await response.json();

    if (data.msg === 'success') {
      return data.gym;
    }
    return null;
  } catch (error) {
    console.error('Error fetching gym data:', error);
    return null;
  }
}

```

# app/gym/[gymname]/Gym.tsx

```tsx
'use client';

import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import Image from 'next/image';
// change
interface GymProps {
  gymData: {
    name: string;
    id: string;
    img: string;
    address: string;
  };
}

export default function Gym({ gymData }: GymProps) {
  return (
    <div className="container mx-auto p-6">
      <Card className="w-full max-w-4xl mx-auto">
        <CardHeader>
          <div className="flex items-center gap-6">
            <div className="relative h-24 w-24 rounded-full overflow-hidden">
              <Image src={gymData.img} alt={gymData.name} fill className="object-cover" />
            </div>
            <div>
              <CardTitle className="text-3xl">{gymData.name}</CardTitle>
              <CardDescription className="text-lg mt-2">ID: {gymData.id}</CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent>
          <div className="mt-4">
            <h3 className="text-xl font-semibold mb-2">Location</h3>
            <p className="text-gray-600">{gymData.address}</p>
          </div>
          {/* Add more sections for additional gym information */}
        </CardContent>
      </Card>
    </div>
  );
}

```

# app/gym/[gymname]/page.tsx

```tsx
import React from 'react';
import FetchGymData from './FetchGymData';
import Gym from './Gym';

// Reintroduce generateStaticParams for static generation
interface GymNameResponse {
  msg: 'success' | 'unexpected error';
  gyms?: { name: string }[];
}

export async function generateStaticParams() {
  // Fetch all gym names to pre-render their pages at build time
  try {
    const response = await fetch(
      `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/public/gym/allgymnames`,
      {
        next: { revalidate: 3600 }, // Revalidate gym list every hour
      },
    );
    const data: GymNameResponse = await response.json();
    if (data.msg === 'success' && data.gyms) {
      return data.gyms.map((gym) => ({
        gymname: gym.name,
      }));
    }
    return [];
  } catch (error) {
    console.error('Error fetching gyms for static params:', error);
    return [];
  }
}

interface PageProps {
  params: Promise<{
    gymname: string;
  }>;
}

const GymPage = async (props: PageProps) => {
  const params = await props.params;
  const { gymname } = params;
  console.log('gymname received:', gymname);

  const gymData = await FetchGymData(gymname);

  if (!gymData) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <h1 className="text-2xl font-bold text-red-500">Gym not found</h1>
      </div>
    );
  }

  return (
    <div>
      <Gym gymData={gymData} />
    </div>
  );
};

// Add global revalidation
export const revalidate = 3600; // Revalidate all pages every hour

// Add metadata for SEO
export async function generateMetadata(props: PageProps) {
  const params = await props.params;
  const gymData = await FetchGymData(params.gymname);
  return {
    title: `${gymData?.name || 'Gym'} | Fitness Platform`,
    description: gymData?.address
      ? `Visit ${gymData.name} at ${gymData.address}`
      : 'Professional fitness center',
    openGraph: {
      images: [gymData?.img || '/default-gym.jpg'],
    },
  };
}

export default GymPage;

```

# app/gym/layout.tsx

```tsx
import type { Metadata } from 'next';

export const metadata: Metadata = {
  title: 'Gyms | GymNavigator Admin',
  description: 'View and manage gyms in GymNavigator',
};

export default function GymLayout({ children }: { children: React.ReactNode }) {
  return <div className="min-h-screen bg-gray-50">{children}</div>;
}

```

# app/healthprofileform/_actions/submit-health-profile.ts

```ts
"use server";

import { ClientReqConfig } from "@/lib/AxiosInstance/clientAxios";
import {
  HealthProfileState,
  ActivityLevel,
} from "../_store/health-profile-store";

// Define a type that matches what we need for the API request
export interface HealthProfileApiRequest {
  fullname: string;
  contact: string;
  gender: string;
  age: number;
  activityLevel: ActivityLevel; // Use the ActivityLevel type for consistency
  height: { value: number; unit: string };
  weight: { value: number; unit: string };
  goal: string;
  otherGoal?: string;
  dietaryPreference: string;
  otherDietaryPreference?: string;
  nonVegDays?: Array<{ day: string; selected: boolean }>;
  allergies: Array<{ id: string; name: string; selected: boolean }>;
  otherAllergy?: string;
  mealTimes: string;
  medicalConditions: Array<{ id: string; name: string; selected: boolean }>;
  otherMedicalCondition?: string;
  religiousPreference: string | null;
  otherReligiousPreference?: string;
  dietaryRestrictions?: string[];
}

export interface HealthProfileResponse {
  success: boolean;
  data?: any;
  error?: string;
  details?: string;
}

export const submitHealthProfileToApi = async (
  profileData: HealthProfileApiRequest
): Promise<HealthProfileResponse> => {
  try {
    const clientAxios = await ClientReqConfig();
   console.log("profiledata is this",profileData);
    const response = await clientAxios.post<HealthProfileResponse>(
      "/profile/healthprofileform",
      profileData
    );

    return response.data;
  } catch (error) {
    console.error("Error submitting health profile data:", error);
    return {
      success: false,
      error: "Failed to submit health profile data",
      details: error instanceof Error ? error.message : "Unknown error",
    };
  }
};

```

# app/healthprofileform/_actions/use-health-profile-mutation.ts

```ts
'use server';

import { revalidatePath } from 'next/cache';
import { HealthProfileState, ReligiousPreference, DietaryPreference, MealTimes, GoalType, ActivityLevel } from '../_store/health-profile-store';
import { z } from 'zod';
import { calculateHealthMetrics } from '../calculate-health-data/calculate-all-metrics';
import { HealthMetrics } from '../calculate-health-data/health-data-types';
import { submitHealthProfileToApi, HealthProfileApiRequest } from './submit-health-profile';

// Use our ActivityLevel type directly for consistency across the application
const healthProfileSchema = z.object({
  gender: z.enum(['male', 'female', 'other']),
  age: z.number().min(1).max(120),
  activityLevel: z.enum(['sedentary', 'light', 'moderate', 'active', 'athlete']),
  height: z.object({
    value: z.number().min(1),
    unit: z.enum(['cm', 'ft'])
  }),
  weight: z.object({
    value: z.number().min(1),
    unit: z.enum(['kg', 'lb'])
  }),
  goal: z.enum(['fat-loss', 'muscle-building', 'muscle-building-with-fat-loss', 'bodybuilding', 'maintenance', 'general-fitness', 'other']),
  otherGoal: z.string().optional(),
  // New fields
  dietaryPreference: z.enum(['vegetarian', 'non-vegetarian', 'vegan', 'other']),
  otherDietaryPreference: z.string().optional(),
  nonVegDays: z.array(z.object({
    day: z.string(),
    selected: z.boolean()
  })).optional(),
  allergies: z.array(z.object({
    id: z.string(),
    name: z.string(),
    selected: z.boolean()
  })),
  otherAllergy: z.string().optional(),
  mealTimes: z.enum(['2', '3', '4+']),
  // Original fields
  medicalConditions: z.array(z.object({
    id: z.string(),
    name: z.string(),
    selected: z.boolean()
  })),
  otherMedicalCondition: z.string().optional(),
  religiousPreference: z.enum(['hindu', 'muslim', 'sikh', 'jain', 'christian', 'buddhist', 'other', 'none']).nullable(),
  otherReligiousPreference: z.string().optional(),
  dietaryRestrictions: z.array(z.string()).optional(),
  // Additional fields for API
  fullname: z.string(),
  contact: z.string()
});

export type HealthProfileData = z.infer<typeof healthProfileSchema>;

export async function submitHealthProfile(formData: Partial<HealthProfileState> & { fullname?: string; contact?: string }) {
  // Extract only the required fields from the form data
  const profileData: HealthProfileApiRequest = {
    gender: formData.gender || 'other',
    age: formData.age || 30,
    activityLevel: formData.activityLevel || 'moderate',
    height: {
      value: formData.height?.value || 170,
      unit: formData.height?.unit || 'cm'
    },
    weight: {
      value: formData.weight?.value || 70,
      unit: formData.weight?.unit || 'kg'
    },
    goal: formData.goal || 'general-fitness',
    otherGoal: formData.goal === 'other' ? formData.otherGoal : undefined,
    // New fields
    dietaryPreference: formData.dietaryPreference || 'vegetarian',
    otherDietaryPreference: formData.otherDietaryPreference,
    nonVegDays: formData.dietaryPreference === 'non-vegetarian' ? formData.nonVegDays : undefined,
    allergies: (formData.allergies || []).filter(allergy => allergy.selected),
    otherAllergy: formData.otherAllergy,
    mealTimes: formData.mealTimes || '3',
    // Original fields
    medicalConditions: (formData.medicalConditions || []).filter(condition => condition.selected),
    otherMedicalCondition: formData.otherMedicalCondition,
    religiousPreference: formData.religiousPreference || null,
    otherReligiousPreference: formData.otherReligiousPreference,
    dietaryRestrictions: formData.dietaryRestrictions || [],
    // Additional fields
    fullname: formData.fullname || 'Unknown',
    contact: formData.contact || 'Unknown'
  };

  try {
    // Calculate health metrics
    let healthMetrics: HealthMetrics | null = null;
    
    try {
      healthMetrics = calculateHealthMetrics({
        gender: formData.gender!,
        age: formData.age!,
        weight: formData.weight as { value: number, unit: 'kg' | 'lb' },
        height: formData.height as { value: number, unit: 'cm' | 'ft' },
        activityLevel: formData.activityLevel || 'moderate',
        goal: formData.goal!
      });
      
      console.log("Calculated health metrics:", healthMetrics);
    } catch (metricError) {
      console.error("Error calculating health metrics:", metricError);
    }
    
    // Submit to the backend API
    const response = await submitHealthProfileToApi(profileData);
    
    if (!response.success) {
      throw new Error(response.error || 'API submission failed');
    }
    
    // Revalidate paths that may depend on this data
    revalidatePath('/dashboard');
    revalidatePath('/healthprofileform');
    
    return { success: true, healthMetrics };
  } catch (error) {
    console.error('Error submitting health profile:', error);
    return { success: false, error: error instanceof Error ? error.message : 'An unknown error occurred' };
  }
}

```

# app/healthprofileform/_assests/activity form.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_assests/age form.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_assests/female-svgrepo-com.svg

This is a file of the type: SVG Image

# app/healthprofileform/_assests/gender form.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_assests/height form.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_assests/male-symbol-svgrepo-com.svg

This is a file of the type: SVG Image

# app/healthprofileform/_assests/medical condition to be aware fo.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_assests/running-svgrepo-com.svg

This is a file of the type: SVG Image

# app/healthprofileform/_assests/target weight form.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_assests/weight form.jpeg

This is a binary file of the type: Image

# app/healthprofileform/_components/activity-form.tsx

```tsx
"use client";

import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import {
  Activity,
  ArrowLeft,
  ArrowRight,
  Bike,
  Dumbbell,
  Footprints,
  Zap,
} from "lucide-react";
import { useState } from "react";
import {
  ActivityLevel,
  useHealthProfileStore,
} from "../_store/health-profile-store";

export default function ActivityForm() {
  const { activityLevel, setActivityLevel, nextStep, prevStep } =
    useHealthProfileStore();
  const [selected, setSelected] = useState<string | null>(
    activityLevel || null
  );

  const handleNext = () => {
    if (selected) {
      setActivityLevel(selected as ActivityLevel);
      nextStep();
    }
  };

  const activities = [
    {
      id: "sedentary",
      name: "Sedentary",
      description: "Desk job, minimal physical activity (< 5,000 steps/day)",
      icon: (
        <Footprints
          className={`h-6 w-6 ${
            selected === "sedentary" ? "text-blue-600" : "text-gray-600"
          }`}
        />
      ),
    },
    {
      id: "light",
      name: "Light",
      description: "Light exercise/sports 1-3 days/week (5,000-7,500 steps/day)",
      icon: (
        <Activity
          className={`h-6 w-6 ${
            selected === "light" ? "text-blue-600" : "text-blue-400"
          }`}
        />
      ),
    },
    {
      id: "moderate",
      name: "Moderate",
      description: "Moderate exercise 3-5 days/week (7,500-10,000 steps/day)",
      icon: (
        <Dumbbell
          className={`h-6 w-6 ${
            selected === "moderate" ? "text-blue-600" : "text-blue-500"
          }`}
        />
      ),
    },

    {
      id: "athlete",
      name: "Athlete",
      description: "Intense exercise 6-7 days/week (>10,000 steps/day)",
      icon: (
        <Bike
          className={`h-6 w-6 ${
            selected === "athlete" ? "text-blue-600" : "text-blue-700"
          }`}
        />
      ),
    },
  ];

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">
          What's your activity level?
        </h1>
        <p className="text-gray-500 mb-6">
          This helps us calculate your daily calorie needs
        </p>

        <div className="grid grid-cols-1 gap-3">
          {activities.map((activity) => (
            <button
              key={activity.id}
              type="button"
              onClick={() => setSelected(activity.id)}
              className={cn(
                "flex items-center p-4 rounded-xl border-2 transition-all",
                selected === activity.id
                  ? "border-blue-500 bg-blue-50"
                  : "border-gray-200 hover:border-blue-200"
              )}
              aria-pressed={selected === activity.id}
            >
              <div
                className={`w-10 h-10 ${
                  selected === activity.id ? "bg-blue-100" : "bg-gray-100"
                } rounded-full flex items-center justify-center mr-3`}
              >
                {activity.icon}
              </div>
              <div className="text-left">
                <span className="font-medium text-gray-800 block">
                  {activity.name}
                </span>
                <span className="text-xs text-gray-500">
                  {activity.description}
                </span>
              </div>
            </button>
          ))}
        </div>
      </div>

      <div className="mt-8 grid grid-cols-2 gap-2">
        <Button
          onClick={prevStep}
          variant="outline"
          className="flex items-center justify-center gap-1"
        >
          <ArrowLeft className="h-4 w-4" /> Back
        </Button>
        <Button
          onClick={handleNext}
          disabled={!selected}
          className={cn(
            "flex items-center justify-center gap-1",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-4 w-4" />
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_components/age-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight, Clock } from 'lucide-react';
import { useState } from 'react';
import { useHealthProfileStore } from '../_store/health-profile-store';

export default function AgeForm() {
  const { age, setAge, nextStep, prevStep } = useHealthProfileStore();
  const [value, setValue] = useState<number>(age || 25);
  
  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setValue(Number(e.target.value));
  };

  const handleNext = () => {
    setAge(value);
    nextStep();
  };

  const getAgeLabel = () => {
    if (value < 20) return 'Teen';
    if (value < 35) return 'Young adult';
    if (value < 55) return 'Adult';
    if (value < 70) return 'Senior';
    return 'Elder';
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">How old are you?</h1>
        <p className="text-gray-500 mb-6">Your age helps us create a program that's right for you</p>
        
        <div className="flex flex-col items-center justify-center space-y-8 mt-10">
          <div className="flex flex-col items-center">
            <div className="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center">
              <Clock className="h-10 w-10 text-blue-600" />
            </div>
            <div className="mt-4 text-center">
              <p className="text-4xl font-bold text-blue-600">{value}</p>
              <p className="text-gray-500">{getAgeLabel()}</p>
            </div>
          </div>
          
          <div className="w-full px-4">
            <input 
              type="range" 
              min="16" 
              max="90" 
              value={value} 
              onChange={handleChange} 
              className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
              aria-label="Select your age"
            />
            <div className="flex justify-between text-xs text-gray-400 px-1 mt-1">
              <span>16</span>
              <span>90</span>
            </div>
          </div>
        </div>
      </div>
      
      <div className="mt-8 grid grid-cols-2 gap-2">
        <Button
          onClick={prevStep}
          variant="outline"
          className="flex items-center justify-center gap-1"
        >
          <ArrowLeft className="h-4 w-4" /> Back
        </Button>
        <Button
          onClick={handleNext}
          className={cn(
            "flex items-center justify-center gap-1",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-4 w-4" />
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_components/allergies-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import { Input } from '@/components/ui/input';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight, Check, Loader2 } from 'lucide-react';
import { useState } from 'react';
import { useHealthProfileStore } from '../_store/health-profile-store';

export default function AllergiesForm() {
  const { 
    allergies, 
    otherAllergy,
    toggleAllergy,
    setOtherAllergy,
    nextStep,
    prevStep
  } = useHealthProfileStore();
  
  const [newAllergy, setNewAllergy] = useState('');
  
  const handleAddAllergy = () => {
    if (newAllergy.trim()) {
      setOtherAllergy(newAllergy.trim());
      setNewAllergy('');
    }
  };
  
  const handleSubmit = () => {
    nextStep();
  };
  
  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">Allergies</h1>
        <p className="text-gray-500 mb-6">Select any allergies that apply to you</p>
        
        <div className="space-y-4">
          {allergies.map((allergy) => (
            <div key={allergy.id} className="flex items-center space-x-3">
              <Checkbox 
                id={`allergy-${allergy.id}`} 
                checked={allergy.selected}
                onCheckedChange={() => toggleAllergy(allergy.id)}
                className="border-gray-300 text-blue-600 focus:ring-blue-500"
              />
              <label 
                htmlFor={`allergy-${allergy.id}`}
                className="text-base font-medium text-gray-700 cursor-pointer"
              >
                {allergy.name}
              </label>
            </div>
          ))}
          
          <div className="pt-4 border-t border-gray-200">
            <label htmlFor="new-allergy-input" className="text-base font-medium text-gray-700 mb-2 block">Other allergy not listed?</label>
            <div className="flex gap-2">
              <Input 
                id="new-allergy-input"
                placeholder="Type allergy here" 
                value={newAllergy} 
                onChange={(e) => setNewAllergy(e.target.value)} 
                className="flex-grow"
              />
              <Button 
                type="button" 
                variant="outline" 
                onClick={handleAddAllergy} 
                disabled={!newAllergy.trim()}
                className="border-blue-300 hover:bg-blue-50"
              >
                Add
              </Button>
            </div>
            
            {otherAllergy && (
              <div className="mt-2 p-3 bg-blue-50 rounded-md text-blue-800 flex items-center">
                <Check size={16} className="mr-2" />
                <span>{otherAllergy}</span>
              </div>
            )}
          </div>
        </div>
      </div>
      
      <div className="mt-8 flex flex-col gap-3">
        <Button
          onClick={handleSubmit}
          className={cn(
            "w-full py-6 flex items-center justify-center gap-2 text-base",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-5 w-5" />
        </Button>
        
        <Button
          onClick={prevStep}
          variant="outline"
          className="w-full py-6 flex items-center justify-center gap-2 text-base"
        >
          <ArrowLeft className="h-5 w-5" /> Go Back
        </Button>
      </div>
    </div>
  );
}
```

# app/healthprofileform/_components/dietary-preferences-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight } from 'lucide-react';
import { useHealthProfileStore, DietaryPreference } from '../_store/health-profile-store';

const dietaryOptions: { value: DietaryPreference; label: string }[] = [
  { value: 'vegetarian', label: 'Vegetarian' },
  { value: 'non-vegetarian', label: 'Non-Vegetarian' },
  { value: 'vegan', label: 'Vegan' },
  { value: 'other', label: 'Other' },
];

export default function DietaryPreferencesForm() {
  const { 
    dietaryPreference, 
    otherDietaryPreference,
    setDietaryPreference, 
    setOtherDietaryPreference,
    nextStep,
    prevStep
  } = useHealthProfileStore();

  const handleSubmit = () => {
    nextStep();
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">Dietary Preferences</h1>
        <p className="text-gray-500 mb-6">Select your dietary preference</p>

        <div className="space-y-4">
          {dietaryOptions.map((option) => (
            <button
              key={option.value}
              onClick={() => setDietaryPreference(option.value)}
              className={cn(
                "w-full p-4 rounded-lg border flex items-center justify-between",
                dietaryPreference === option.value
                  ? "border-blue-500 bg-blue-50 text-blue-700"
                  : "border-gray-200 hover:border-blue-300 hover:bg-blue-50"
              )}
            >
              <span className="font-medium">{option.label}</span>
              {dietaryPreference === option.value && (
                <div className="h-4 w-4 rounded-full bg-blue-500" />
              )}
            </button>
          ))}

          {dietaryPreference === 'other' && (
            <div className="mt-4">
              <label htmlFor="otherDietaryPreference" className="block text-sm font-medium text-gray-700 mb-1">
                Please specify your dietary preference
              </label>
              <Input
                id="otherDietaryPreference"
                value={otherDietaryPreference}
                onChange={(e) => setOtherDietaryPreference(e.target.value)}
                placeholder="Enter your dietary preference"
                className="w-full"
              />
            </div>
          )}
        </div>
      </div>

      <div className="mt-8 flex flex-col gap-3">
        <Button
          onClick={handleSubmit}
          disabled={!dietaryPreference || (dietaryPreference === 'other' && !otherDietaryPreference)}
          className={cn(
            "w-full py-6 flex items-center justify-center gap-2 text-base",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-5 w-5" />
        </Button>

        <Button
          onClick={prevStep}
          variant="outline"
          className="w-full py-6 flex items-center justify-center gap-2 text-base"
        >
          <ArrowLeft className="h-5 w-5" /> Go Back
        </Button>
      </div>
    </div>
  );
}
```

# app/healthprofileform/_components/gender-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';
import { ArrowRight, Users } from 'lucide-react';
import Image from 'next/image';
import { useState } from 'react';
import FemaleSvg from '../_assests/female-svgrepo-com.svg';
import MaleSvg from '../_assests/male-symbol-svgrepo-com.svg';
import { useHealthProfileStore } from '../_store/health-profile-store';

export default function GenderForm() {
  const { gender, setGender, nextStep } = useHealthProfileStore();
  const [selected, setSelected] = useState<string | null>(gender || null);
  
  const handleNext = () => {
    if (selected) {
      setGender(selected as 'male' | 'female' | 'other');
      nextStep();
    }
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">What is your gender?</h1>
        <p className="text-gray-500 mb-6">This helps us personalize your fitness journey</p>
        
        <div className="grid grid-cols-1 gap-4">
          <button
            type="button"
            onClick={() => setSelected('male')}
            className={cn(
              "flex items-center p-4 rounded-xl border-2 transition-all",
              selected === 'male'
                ? "border-blue-500 bg-blue-50"
                : 'border-gray-200 hover:border-blue-200'
            )}
            aria-pressed={selected === 'male'}
          >
            <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3">
              <Image 
                src={MaleSvg} 
                alt="Male" 
                width={24} 
                height={24}
                className={selected === 'male' ? 'text-blue-600' : 'text-blue-600'} 
              />
            </div>
            <span className="font-medium text-gray-800">Male</span>
          </button>
          
          <button
            type="button"
            onClick={() => setSelected('female')}
            className={cn(
              "flex items-center p-4 rounded-xl border-2 transition-all",
              selected === 'female'
                ? "border-pink-500 bg-pink-50"
                : 'border-gray-200 hover:border-blue-200'
            )}
            aria-pressed={selected === 'female'}
          >
            <div className="w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center mr-3">
              <Image 
                src={FemaleSvg} 
                alt="Female" 
                width={24} 
                height={24}
                className="text-pink-600" 
              />
            </div>
            <span className="font-medium text-gray-800">Female</span>
          </button>
          
          <button
            type="button"
            onClick={() => setSelected('other')}
            className={cn(
              "flex items-center p-4 rounded-xl border-2 transition-all",
              selected === 'other'
                ? "border-purple-500 bg-purple-50"
                : 'border-gray-200 hover:border-blue-200'
            )}
            aria-pressed={selected === 'other'}
          >
            <div className="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mr-3">
              <Users className={`h-6 w-6 ${selected === 'other' ? 'text-purple-600' : 'text-purple-600'}`} />
            </div>
            <span className="font-medium text-gray-800">Other</span>
          </button>
        </div>
      </div>
      
      <div className="mt-8">
        <Button
          onClick={handleNext}
          disabled={!selected}
          className="w-full py-6 flex items-center justify-center gap-2 text-base bg-gradient-to-r from-blue-500 to-blue-600"
        >
          Continue <ArrowRight className="h-5 w-5" />
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_components/goal-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight } from 'lucide-react';
import { useHealthProfileStore, GoalType } from '../_store/health-profile-store';

const goalOptions: { value: GoalType; label: string; description: string }[] = [
  { 
    value: 'fat-loss', 
    label: 'Fat Loss', 
    description: 'Focus on reducing body fat percentage'
  },
  { 
    value: 'muscle-building', 
    label: 'Muscle Building', 
    description: 'Focus on building muscle mass and strength'
  },
  { 
    value: 'muscle-building-with-fat-loss', 
    label: 'Muscle Building with Fat Loss', 
    description: 'Aim to build muscle while reducing body fat (body recomposition)'
  },
  { 
    value: 'bodybuilding', 
    label: 'Bodybuilding', 
    description: 'Competitive bodybuilding focused on aesthetics and physique'
  },
  { 
    value: 'maintenance', 
    label: 'Maintenance', 
    description: 'Maintain current body composition and fitness level'
  },
  { 
    value: 'general-fitness', 
    label: 'General Fitness', 
    description: 'Improve overall health and fitness'
  },
  { 
    value: 'other', 
    label: 'Other', 
    description: 'Specify your own fitness goal'
  },
];

export default function GoalForm() {
  const { 
    goal, 
    otherGoal,
    setGoal, 
    setOtherGoal,
    nextStep,
    prevStep
  } = useHealthProfileStore();

  const handleSubmit = () => {
    nextStep();
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">Fitness Goal</h1>
        <p className="text-gray-500 mb-6">What is your primary fitness goal?</p>

        <div className="space-y-4">
          {goalOptions.map((option) => (
            <button
              key={option.value}
              onClick={() => setGoal(option.value)}
              className={cn(
                "w-full p-4 rounded-lg border flex flex-col items-start text-left",
                goal === option.value
                  ? "border-blue-500 bg-blue-50 text-blue-700"
                  : "border-gray-200 hover:border-blue-300 hover:bg-blue-50"
              )}
            >
              <div className="flex w-full items-center justify-between">
                <span className="font-medium">{option.label}</span>
                {goal === option.value && (
                  <div className="h-4 w-4 rounded-full bg-blue-500" />
                )}
              </div>
              <span className="text-sm text-gray-500 mt-1">{option.description}</span>
            </button>
          ))}

          {goal === 'other' && (
            <div className="mt-4">
              <label htmlFor="otherGoal" className="block text-sm font-medium text-gray-700 mb-1">
                Please specify your fitness goal
              </label>
              <Input
                id="otherGoal"
                value={otherGoal}
                onChange={(e) => setOtherGoal(e.target.value)}
                placeholder="Enter your fitness goal"
                className="w-full"
              />
            </div>
          )}
        </div>
      </div>

      <div className="mt-8 flex flex-col gap-3">
        <Button
          onClick={handleSubmit}
          disabled={!goal || (goal === 'other' && !otherGoal)}
          className={cn(
            "w-full py-6 flex items-center justify-center gap-2 text-base",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-5 w-5" />
        </Button>

        <Button
          onClick={prevStep}
          variant="outline"
          className="w-full py-6 flex items-center justify-center gap-2 text-base"
        >
          <ArrowLeft className="h-5 w-5" /> Go Back
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_components/height-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight, Ruler } from 'lucide-react';
import { useEffect, useState } from 'react';
import { useHealthProfileStore } from '../_store/health-profile-store';

export default function HeightForm() {
  const { height, setHeight, nextStep, prevStep } = useHealthProfileStore();
  const [value, setValue] = useState<number>(height.value || 170);
  const [unit, setUnit] = useState<'cm' | 'ft'>(height.unit || 'cm');
  
  // Convert between cm and ft when unit changes
  useEffect(() => {
    if (unit === 'cm' && height.unit === 'ft' && height.value) {
      // Convert from ft to cm (approximate)
      setValue(Math.round(height.value * 30.48));
    } else if (unit === 'ft' && height.unit === 'cm' && height.value) {
      // Convert from cm to ft (approximate)
      setValue(Math.round(height.value / 30.48 * 10) / 10);
    }
  }, [unit, height.unit, height.value]);
  
  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setValue(Number(e.target.value));
  };

  const toggleUnit = () => {
    if (unit === 'cm') {
      setUnit('ft');
      setValue(Math.round(value / 30.48 * 10) / 10); // cm to ft
    } else {
      setUnit('cm');
      setValue(Math.round(value * 30.48)); // ft to cm
    }
  };

  const handleNext = () => {
    setHeight(value, unit);
    nextStep();
  };
  
  const minHeight = unit === 'cm' ? 140 : 4.5;
  const maxHeight = unit === 'cm' ? 220 : 7.2;
  
  const getHeightDisplay = () => {
    if (unit === 'cm') {
      return `${value} cm`;
    }
    
    const feet = Math.floor(value);
    const inches = Math.round((value - feet) * 12);
    return `${feet}'${inches}"`;
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">How tall are you?</h1>
        <p className="text-gray-500 mb-6">Your height helps us calculate your ideal body metrics</p>
        
        <div className="flex flex-col items-center justify-center space-y-8 mt-10">
          <div className="flex flex-col items-center">
            <div className="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center">
              <Ruler className="h-10 w-10 text-blue-600" />
            </div>
            <div className="mt-4 text-center">
              <p className="text-4xl font-bold text-blue-600">{getHeightDisplay()}</p>
            </div>
          </div>
          
          <div className="w-full px-4">
            <div className="flex justify-end mb-2">
              <button
                type="button"
                onClick={toggleUnit}
                className="text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full"
                aria-label={`Switch to ${unit === 'cm' ? 'feet' : 'cm'}`}
              >
                Switch to {unit === 'cm' ? 'feet' : 'cm'}
              </button>
            </div>
            
            <input 
              type="range" 
              min={minHeight} 
              max={maxHeight}
              step={unit === 'cm' ? 1 : 0.1}
              value={value} 
              onChange={handleChange} 
              className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
              aria-label={`Select height value between ${minHeight} and ${maxHeight} ${unit}`}
            />
            <div className="flex justify-between text-xs text-gray-400 px-1 mt-1">
              <span>{minHeight}{unit === 'cm' ? 'cm' : 'ft'}</span>
              <span>{maxHeight}{unit === 'cm' ? 'cm' : 'ft'}</span>
            </div>
          </div>
        </div>
      </div>
      
      <div className="mt-8 grid grid-cols-2 gap-2">
        <Button
          onClick={prevStep}
          variant="outline"
          className="flex items-center justify-center gap-1"
        >
          <ArrowLeft className="h-4 w-4" /> Back
        </Button>
        <Button
          onClick={handleNext}
          className={cn(
            "flex items-center justify-center gap-1",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-4 w-4" />
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_components/meal-times-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight } from 'lucide-react';
import { useHealthProfileStore, MealTimes } from '../_store/health-profile-store';

const mealOptions: { value: MealTimes; label: string }[] = [
  { value: '2', label: '2 Meals per day' },
  { value: '3', label: '3 Meals per day' },
  { value: '4+', label: '4+ Meals per day' },
];

export default function MealTimesForm() {
  const { 
    mealTimes, 
    setMealTimes,
    nextStep,
    prevStep
  } = useHealthProfileStore();

  const handleSubmit = () => {
    nextStep();
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">Meal Times</h1>
        <p className="text-gray-500 mb-6">How many meals do you typically have per day?</p>

        <div className="space-y-4">
          {mealOptions.map((option) => (
            <button
              key={option.value}
              onClick={() => setMealTimes(option.value)}
              className={cn(
                "w-full p-4 rounded-lg border flex items-center justify-between",
                mealTimes === option.value
                  ? "border-blue-500 bg-blue-50 text-blue-700"
                  : "border-gray-200 hover:border-blue-300 hover:bg-blue-50"
              )}
            >
              <span className="font-medium">{option.label}</span>
              {mealTimes === option.value && (
                <div className="h-4 w-4 rounded-full bg-blue-500" />
              )}
            </button>
          ))}
        </div>
      </div>

      <div className="mt-8 flex flex-col gap-3">
        <Button
          onClick={handleSubmit}
          disabled={!mealTimes}
          className={cn(
            "w-full py-6 flex items-center justify-center gap-2 text-base",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-5 w-5" />
        </Button>

        <Button
          onClick={prevStep}
          variant="outline"
          className="w-full py-6 flex items-center justify-center gap-2 text-base"
        >
          <ArrowLeft className="h-5 w-5" /> Go Back
        </Button>
      </div>
    </div>
  );
}
```

# app/healthprofileform/_components/medical-conditions-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import { Input } from '@/components/ui/input';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight, Check, Loader2 } from 'lucide-react';
import { useState } from 'react';
import { useHealthProfileStore } from '../_store/health-profile-store';

interface MedicalConditionsFormProps {
  onSubmit: () => Promise<void>;
  isSubmitting: boolean;
}

export default function MedicalConditionsForm({ onSubmit, isSubmitting }: MedicalConditionsFormProps) {
  const { 
    medicalConditions, 
    otherMedicalCondition, 
    toggleMedicalCondition, 
    setOtherMedicalCondition,
    prevStep,
    nextStep
  } = useHealthProfileStore();
  
  const [newCondition, setNewCondition] = useState('');
  
  const handleAddCondition = () => {
    if (newCondition.trim()) {
      // Instead of directly adding, set to "other" field
      setOtherMedicalCondition(newCondition.trim());
      setNewCondition('');
    }
  };
  
  const handleSubmit = async () => {
    await onSubmit();
  };
  
  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">Medical Conditions</h1>
        <p className="text-gray-500 mb-6">Select any medical conditions that apply to you</p>
        
        <div className="space-y-4">
          {medicalConditions.map((condition) => (
            <div key={condition.id} className="flex items-center space-x-3">
              <Checkbox 
                id={`condition-${condition.id}`} 
                checked={condition.selected}
                onCheckedChange={() => toggleMedicalCondition(condition.id)}
                className="border-gray-300 text-blue-600 focus:ring-blue-500"
              />
              <label 
                htmlFor={`condition-${condition.id}`}
                className="text-base font-medium text-gray-700 cursor-pointer"
              >
                {condition.name}
              </label>
            </div>
          ))}
          
          <div className="pt-4 border-t border-gray-200">
            <label htmlFor="new-condition-input" className="text-base font-medium text-gray-700 mb-2 block">Other condition not listed?</label>
            <div className="flex gap-2">
              <Input 
                id="new-condition-input"
                placeholder="Type condition here" 
                value={newCondition} 
                onChange={(e) => setNewCondition(e.target.value)} 
                className="flex-grow"
              />
              <Button 
                type="button" 
                variant="outline" 
                onClick={handleAddCondition} 
                disabled={!newCondition.trim()}
                className="border-blue-300 hover:bg-blue-50"
              >
                Add
              </Button>
            </div>
            
            {otherMedicalCondition && (
              <div className="mt-2 p-3 bg-blue-50 rounded-md text-blue-800 flex items-center">
                <Check size={16} className="mr-2" />
                <span>{otherMedicalCondition}</span>
              </div>
            )}
          </div>
        </div>
      </div>
      
      <div className="mt-8 flex flex-col gap-3">
        <Button
          onClick={handleSubmit}
          disabled={isSubmitting}
          className={cn(
            "w-full py-6 flex items-center justify-center gap-2 text-base",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          {isSubmitting ? (
            <>
              <Loader2 className="h-5 w-5 animate-spin" />
              Submitting...
            </>
          ) : (
            <>
              Continue <ArrowRight className="h-5 w-5" />
            </>
          )}
        </Button>
        
        <Button
          onClick={prevStep}
          variant="outline"
          disabled={isSubmitting}
          className="w-full py-6 flex items-center justify-center gap-2 text-base"
        >
          <ArrowLeft className="h-5 w-5" /> Go Back
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_components/non-veg-days-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight } from 'lucide-react';
import { useHealthProfileStore } from '../_store/health-profile-store';

export default function NonVegDaysForm() {
  const { 
    nonVegDays, 
    toggleNonVegDay,
    nextStep,
    prevStep
  } = useHealthProfileStore();

  const handleSubmit = () => {
    nextStep();
  };

  const anyDaySelected = nonVegDays.some(day => day.selected);

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">Non-Vegetarian Days</h1>
        <p className="text-gray-500 mb-6">Select the days when you prefer to have non-vegetarian meals</p>

        <div className="space-y-4">
          {nonVegDays.map((day) => (
            <div key={day.day} className="flex items-center space-x-3">
              <Checkbox 
                id={`day-${day.day}`} 
                checked={day.selected}
                onCheckedChange={() => toggleNonVegDay(day.day)}
                className="border-gray-300 text-blue-600 focus:ring-blue-500"
              />
              <label 
                htmlFor={`day-${day.day}`}
                className="text-base font-medium text-gray-700 cursor-pointer"
              >
                {day.day}
              </label>
            </div>
          ))}
        </div>
      </div>

      <div className="mt-8 flex flex-col gap-3">
        <Button
          onClick={handleSubmit}
          className={cn(
            "w-full py-6 flex items-center justify-center gap-2 text-base",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-5 w-5" />
        </Button>

        <Button
          onClick={prevStep}
          variant="outline"
          className="w-full py-6 flex items-center justify-center gap-2 text-base"
        >
          <ArrowLeft className="h-5 w-5" /> Go Back
        </Button>
      </div>
    </div>
  );
}
```

# app/healthprofileform/_components/religious-preferences-form.tsx

```tsx
"use client";

import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { RadioGroup, RadioGroupItem } from "@/components/ui/radio-group";
import { cn } from "@/lib/utils";
import { ArrowLeft, ArrowRight, Heart, Loader2 } from "lucide-react";
import { useState } from "react";
import {
	type ReligiousPreference,
	useHealthProfileStore,
} from "../_store/health-profile-store";

interface ReligiousPreferencesFormProps {
	onSubmit: () => Promise<void>;
	isSubmitting: boolean;
	isLast?: boolean;
}

export default function ReligiousPreferencesForm({
	onSubmit,
	isSubmitting,
	isLast = false,
}: ReligiousPreferencesFormProps) {
	const {
		religiousPreference,
		otherReligiousPreference,
		dietaryRestrictions,
		setReligiousPreference,
		setOtherReligiousPreference,
		addDietaryRestriction,
		removeDietaryRestriction,
		prevStep,
	} = useHealthProfileStore();

	const [newRestriction, setNewRestriction] = useState("");

	const handleAddRestriction = () => {
		if (newRestriction.trim()) {
			addDietaryRestriction(newRestriction.trim());
			setNewRestriction("");
		}
	};

	const handlePreferenceChange = (value: string) => {
		setReligiousPreference(value as ReligiousPreference);

		// Clear other preference when not selecting "other"
		if (value !== "other") {
			setOtherReligiousPreference("");
		}
	};

	return (
		<div className="flex flex-col min-h-[60vh] justify-between">
			<div>
				<h1 className="text-2xl font-bold mb-2 text-gray-800">
					Dietary Preferences
				</h1>
				<p className="text-gray-500 mb-6">
					Help us understand your dietary needs
				</p>

				<div className="space-y-6">
					<div>
						<label
							htmlFor="religious-preferences"
							className="text-base font-medium text-gray-700 mb-3 block"
						>
							Do you have any religious dietary preferences?
						</label>

						<RadioGroup
							id="religious-preferences"
							value={religiousPreference || ""}
							onValueChange={handlePreferenceChange}
							className="space-y-3"
						>
							{[
								{ value: "hindu", label: "Hindu" },
								{ value: "muslim", label: "Muslim" },
								{ value: "sikh", label: "Sikh" },
								{ value: "jain", label: "Jain" },
								{ value: "christian", label: "Christian" },
								{ value: "buddhist", label: "Buddhist" },
								{ value: "other", label: "Other" },
								{ value: "none", label: "None / Not applicable" },
							].map((option) => (
								<div key={option.value} className="flex items-center space-x-3">
									<RadioGroupItem
										id={option.value}
										value={option.value}
										className="border-gray-300 text-blue-600 focus:ring-blue-500"
									/>
									<label
										htmlFor={option.value}
										className="font-medium text-gray-700"
									>
										{option.label}
									</label>
								</div>
							))}
						</RadioGroup>

						{religiousPreference === "other" && (
							<div className="mt-3 pl-7">
								<Input
									placeholder="Please specify"
									value={otherReligiousPreference}
									onChange={(e) => setOtherReligiousPreference(e.target.value)}
									className="max-w-sm"
								/>
							</div>
						)}
					</div>

					<div>
						<label
							htmlFor="dietary-restriction-input"
							className="text-base font-medium text-gray-700 mb-3 block"
						>
							Any specific foods you don't eat?
						</label>
						<div className="flex gap-2">
							<Input
								id="dietary-restriction-input"
								placeholder="e.g. Beef, Pork, Seafood..."
								value={newRestriction}
								onChange={(e) => setNewRestriction(e.target.value)}
								className="flex-grow"
							/>
							<Button
								type="button"
								variant="outline"
								onClick={handleAddRestriction}
								disabled={!newRestriction.trim()}
								className="border-blue-300 hover:bg-blue-50"
							>
								Add
							</Button>
						</div>

						{dietaryRestrictions.length > 0 && (
							<div className="mt-3 flex flex-wrap gap-2">
								{dietaryRestrictions.map((restriction) => (
									<Badge
										key={`restriction-${restriction}`}
										className="bg-gradient-to-r from-blue-500 to-blue-600 hover:bg-blue-700 px-3 py-1.5"
										onClick={() => removeDietaryRestriction(restriction)}
									>
										{restriction} &times;
									</Badge>
								))}
							</div>
						)}
					</div>
				</div>
			</div>

			<div className="mt-8 flex flex-col gap-3">
				<Button
					onClick={onSubmit}
					disabled={isSubmitting}
					className={cn(
						"w-full py-6 flex items-center justify-center gap-2 text-base",
						"bg-gradient-to-r from-blue-500 to-blue-600",
					)}
				>
					{isSubmitting ? (
						<>
							<Loader2 className="h-5 w-5 animate-spin" />
							Submitting...
						</>
					) : isLast ? (
						<>
							<Heart className="h-5 w-5" /> Complete Profile
						</>
					) : (
						<>
							Continue <ArrowRight className="h-5 w-5" />
						</>
					)}
				</Button>

				<Button
					onClick={prevStep}
					variant="outline"
					disabled={isSubmitting}
					className="w-full py-6 flex items-center justify-center gap-2 text-base"
				>
					<ArrowLeft className="h-5 w-5" /> Go Back
				</Button>
			</div>
		</div>
	);
}

```

# app/healthprofileform/_components/weight-form.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';
import { ArrowLeft, ArrowRight, Scale } from 'lucide-react';
import { useEffect, useState } from 'react';
import { useHealthProfileStore } from '../_store/health-profile-store';

export default function WeightForm() {
  const { weight, setWeight, nextStep, prevStep } = useHealthProfileStore();
  const [value, setValue] = useState<number>(weight.value || 70);
  const [unit, setUnit] = useState<'kg' | 'lb'>(weight.unit || 'kg');
  
  // Convert between kg and lb when unit changes
  useEffect(() => {
    if (unit === 'kg' && weight.unit === 'lb' && weight.value) {
      // Convert from lb to kg
      setValue(Math.round(weight.value * 0.453592));
    } else if (unit === 'lb' && weight.unit === 'kg' && weight.value) {
      // Convert from kg to lb
      setValue(Math.round(weight.value * 2.20462));
    }
  }, [unit, weight.unit, weight.value]);

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setValue(Number(e.target.value));
  };

  const toggleUnit = () => {
    if (unit === 'kg') {
      setUnit('lb');
      setValue(Math.round(value * 2.20462)); // kg to lb
    } else {
      setUnit('kg');
      setValue(Math.round(value * 0.453592)); // lb to kg
    }
  };

  const handleNext = () => {
    setWeight(value, unit);
    nextStep();
  };
  
  const minWeight = unit === 'kg' ? 40 : 88;
  const maxWeight = unit === 'kg' ? 200 : 440;
  
  const getWeightDisplay = () => {
    return `${value} ${unit}`;
  };

  return (
    <div className="flex flex-col min-h-[60vh] justify-between">
      <div>
        <h1 className="text-2xl font-bold mb-2 text-gray-800">What's your current weight?</h1>
        <p className="text-gray-500 mb-6">This helps us track your fitness progress</p>
        
        <div className="flex flex-col items-center justify-center space-y-8 mt-10">
          <div className="flex flex-col items-center">
            <div className="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center">
              <Scale className="h-10 w-10 text-blue-600" />
            </div>
            <div className="mt-4 text-center">
              <p className="text-4xl font-bold text-blue-600">{value} {unit}</p>
            </div>
          </div>
          
          <div className="w-full px-4">
            <div className="flex justify-end mb-2">
              <button
                type="button"
                onClick={toggleUnit}
                className="text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full"
                aria-label={`Switch to ${unit === 'kg' ? 'pounds' : 'kg'}`}
              >
                Switch to {unit === 'kg' ? 'pounds' : 'kg'}
              </button>
            </div>
            
            <input 
              type="range" 
              min={minWeight} 
              max={maxWeight} 
              value={value} 
              onChange={handleChange} 
              className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
              aria-label={`Select weight between ${minWeight} and ${maxWeight} ${unit}`}
            />
            <div className="flex justify-between text-xs text-gray-400 px-1 mt-1">
              <span>{minWeight} {unit}</span>
              <span>{maxWeight} {unit}</span>
            </div>
          </div>
        </div>
      </div>
      
      <div className="mt-8 grid grid-cols-2 gap-2">
        <Button
          onClick={prevStep}
          variant="outline"
          className="flex items-center justify-center gap-1"
        >
          <ArrowLeft className="h-4 w-4" /> Back
        </Button>
        <Button
          onClick={handleNext}
          className={cn(
            "flex items-center justify-center gap-1",
            "bg-gradient-to-r from-blue-500 to-blue-600"
          )}
        >
          Continue <ArrowRight className="h-4 w-4" />
        </Button>
      </div>
    </div>
  );
}

```

# app/healthprofileform/_store/health-profile-store.ts

```ts
import { create } from "zustand";

export type Gender = "male" | "female" | "other";
export type ActivityLevel = "sedentary" | "light" | "moderate" | "active" | "athlete";
export type DietaryPreference =
  | "vegetarian"
  | "non-vegetarian"
  | "vegan"
  | "other";
export type ReligiousPreference =
  | "hindu"
  | "muslim"
  | "sikh"
  | "jain"
  | "christian"
  | "buddhist"
  | "other"
  | "none";
export type MealTimes = "2" | "3" | "4+";
export type GoalType =
  | "fat-loss"
  | "muscle-building"
  | "muscle-building-with-fat-loss"
  | "bodybuilding"
  | "maintenance"
  | "general-fitness"
  | "other";

export interface MedicalCondition {
  id: string;
  name: string;
  selected: boolean;
}

export interface Allergy {
  id: string;
  name: string;
  selected: boolean;
}

export interface NonVegDay {
  day: string;
  selected: boolean;
}

export interface HealthProfileState {
  // Form data
  gender: Gender | null;
  age: number | null;
  activityLevel: ActivityLevel | null;
  height: { value: number | null; unit: "cm" | "ft" };
  weight: { value: number | null; unit: "kg" | "lb" };
  goal: GoalType | null;
  otherGoal: string;

// New fields
  dietaryPreference: DietaryPreference | null;
  otherDietaryPreference: string;
  nonVegDays: NonVegDay[];
  allergies: Allergy[];
  otherAllergy: string;
  mealTimes: MealTimes | null;

  // Original fields
  medicalConditions: MedicalCondition[];
  otherMedicalCondition: string;
  religiousPreference: ReligiousPreference | null;
  otherReligiousPreference: string;
  dietaryRestrictions: string[];

  // Form navigation
  currentStep: number;
  totalSteps: number;

  // Actions
  setGender: (gender: Gender) => void;
  setAge: (age: number) => void;
  setActivityLevel: (level: ActivityLevel) => void;
  setHeight: (value: number, unit: "cm" | "ft") => void;
  setWeight: (value: number, unit: "kg" | "lb") => void;
  setGoal: (goal: GoalType) => void;
  setOtherGoal: (text: string) => void;

  // New actions
  setDietaryPreference: (preference: DietaryPreference) => void;
  setOtherDietaryPreference: (text: string) => void;
  toggleNonVegDay: (day: string) => void;
  toggleAllergy: (id: string) => void;
  addAllergy: (allergy: string) => void;
  setOtherAllergy: (text: string) => void;
  setMealTimes: (times: MealTimes) => void;

  // Original actions
  toggleMedicalCondition: (id: string) => void;
  addMedicalCondition: (condition: string) => void;
  setOtherMedicalCondition: (text: string) => void;
  setReligiousPreference: (preference: ReligiousPreference) => void;
  setOtherReligiousPreference: (text: string) => void;
  addDietaryRestriction: (restriction: string) => void;
  removeDietaryRestriction: (restriction: string) => void;

  nextStep: () => void;
  prevStep: () => void;
  goToStep: (step: number) => void;
  resetForm: () => void;
}

export const defaultMedicalConditions: MedicalCondition[] = [
  { id: "1", name: "Diabetes", selected: false },
  { id: "2", name: "Heart Disease", selected: false },
  { id: "3", name: "Thyroid", selected: false },
  { id: "4", name: "Hypertension", selected: false },
  { id: "5", name: "PCOS", selected: false },
  { id: "6", name: "Asthma", selected: false },
  { id: "7", name: "Arthritis", selected: false },
  { id: "8", name: "Back Pain", selected: false },
  { id: "9", name: "None", selected: false },
];

export const defaultAllergies: Allergy[] = [
  { id: "1", name: "Gluten", selected: false },
  { id: "2", name: "Lactose", selected: false },
  { id: "3", name: "Nuts", selected: false },
  { id: "4", name: "Soy", selected: false },
  { id: "5", name: "Shellfish", selected: false },
  { id: "6", name: "None", selected: false },
];

export const defaultNonVegDays: NonVegDay[] = [
  { day: "Monday", selected: false },
  { day: "Tuesday", selected: false },
  { day: "Wednesday", selected: false },
  { day: "Thursday", selected: false },
  { day: "Friday", selected: false },
  { day: "Saturday", selected: false },
  { day: "Sunday", selected: false },
];

export const useHealthProfileStore = create<HealthProfileState>((set) => ({
  // Initial state
  gender: null,
  age: null,
  activityLevel: null,
  height: { value: null, unit: "cm" },
  weight: { value: null, unit: "kg" },
  goal: null,
  otherGoal: "",

  // New state fields
  dietaryPreference: null,
  otherDietaryPreference: "",
  nonVegDays: [...defaultNonVegDays],
  allergies: [...defaultAllergies],
  otherAllergy: "",
  mealTimes: null,

  // Original state fields
  medicalConditions: [...defaultMedicalConditions],
  otherMedicalCondition: "",
  religiousPreference: null,
  otherReligiousPreference: "",
  dietaryRestrictions: [],

  currentStep: 1,
  totalSteps: 12,

  // Actions
  setGender: (gender) => set({ gender }),

  setAge: (age) => set({ age }),

  setActivityLevel: (activityLevel) => set({ activityLevel }),

  setHeight: (value, unit) => set({ height: { value, unit } }),

  setWeight: (value, unit) => set({ weight: { value, unit } }),

  setGoal: (goal) => set({ goal }),

  setOtherGoal: (text) => set({ otherGoal: text }),

  // New actions
  setDietaryPreference: (dietaryPreference) => set({ dietaryPreference }),

  setOtherDietaryPreference: (text) => set({ otherDietaryPreference: text }),

  toggleNonVegDay: (day) =>
    set((state) => ({
      nonVegDays: state.nonVegDays.map((d) =>
        d.day === day ? { ...d, selected: !d.selected } : d
      ),
    })),

  toggleAllergy: (id) =>
    set((state) => ({
      allergies: state.allergies.map((allergy) =>
        allergy.id === id
          ? { ...allergy, selected: !allergy.selected }
          : // If selecting "None", unselect all others, and vice versa
          id === "6" || allergy.id === "6"
          ? { ...allergy, selected: false }
          : allergy
      ),
    })),

  addAllergy: (allergy) =>
    set((state) => ({
      allergies: [
        ...state.allergies,
        { id: `custom-${Date.now()}`, name: allergy, selected: true },
      ],
    })),

  setOtherAllergy: (text) => set({ otherAllergy: text }),

  setMealTimes: (mealTimes) => set({ mealTimes }),

  // Original actions
  toggleMedicalCondition: (id) =>
    set((state) => ({
      medicalConditions: state.medicalConditions.map((condition) =>
        condition.id === id
          ? { ...condition, selected: !condition.selected }
          : // If selecting "None", unselect all others, and vice versa
          id === "9" || condition.id === "9"
          ? { ...condition, selected: false }
          : condition
      ),
    })),

  addMedicalCondition: (condition) =>
    set((state) => ({
      medicalConditions: [
        ...state.medicalConditions,
        { id: `custom-${Date.now()}`, name: condition, selected: true },
      ],
    })),

  setOtherMedicalCondition: (text) => set({ otherMedicalCondition: text }),

  setReligiousPreference: (preference) =>
    set({ religiousPreference: preference }),

  setOtherReligiousPreference: (text) =>
    set({ otherReligiousPreference: text }),

  addDietaryRestriction: (restriction) =>
    set((state) => ({
      dietaryRestrictions: [...state.dietaryRestrictions, restriction],
    })),

  removeDietaryRestriction: (restriction) =>
    set((state) => ({
      dietaryRestrictions: state.dietaryRestrictions.filter(
        (item) => item !== restriction
      ),
    })),

  nextStep: () =>
    set((state) => ({
      currentStep: Math.min(state.currentStep + 1, state.totalSteps),
    })),

  prevStep: () =>
    set((state) => ({
      currentStep: Math.max(state.currentStep - 1, 1),
    })),

  goToStep: (step) => set({ currentStep: step }),

  resetForm: () =>
    set({
      gender: null,
      age: null,
      activityLevel: null,
      height: { value: null, unit: "cm" },
      weight: { value: null, unit: "kg" },
      goal: null,
      otherGoal: "",
      dietaryPreference: null,
      otherDietaryPreference: "",
      nonVegDays: [...defaultNonVegDays],
      allergies: [...defaultAllergies],
      otherAllergy: "",
      mealTimes: null,
      medicalConditions: [...defaultMedicalConditions],
      otherMedicalCondition: "",
      religiousPreference: null,
      otherReligiousPreference: "",
      dietaryRestrictions: [],
      currentStep: 1,
    }),
}));

```

# app/healthprofileform/calculate-health-data/calculate-all-metrics.ts

```ts
import { Gender, ActivityLevel, GoalType } from '../_store/health-profile-store';
import { HealthMetrics } from './health-data-types';
import {
  calculateBMI,
  getBMICategory,
  calculateBMR,
  calculateTDEE,
  calculateTargetCalories,
  calculateMacros,
  convertWeight,
  convertHeight
} from './index';

interface CalculateHealthMetricsParams {
  gender: Gender;
  age: number;
  weight: { value: number; unit: 'kg' | 'lb' };
  height: { value: number; unit: 'cm' | 'ft' };
  activityLevel: ActivityLevel;
  goal: GoalType;
}

/**
 * Calculate all health metrics based on the user's profile data
 * 
 * @param params Object containing all required parameters
 * @returns Object with all calculated health metrics
 */
export function calculateHealthMetrics(params: CalculateHealthMetricsParams): HealthMetrics {
  // Convert units to metric if needed
  const weightInKg = params.weight.unit === 'kg' 
    ? params.weight.value 
    : convertWeight(params.weight.value, 'lb', 'kg');
  
  const heightInCm = params.height.unit === 'cm' 
    ? params.height.value 
    : convertHeight(params.height.value, 'ft', 'cm');
  
  // Calculate BMI
  const bmi = calculateBMI(weightInKg, heightInCm);
  const bmiCategory = getBMICategory(bmi);
  
  // Calculate BMR
  const bmr = calculateBMR(params.gender, weightInKg, heightInCm, params.age);
  
  // Calculate TDEE
  const tdee = calculateTDEE(bmr, params.activityLevel);
  
  // Calculate target calories
  const targetCalories = calculateTargetCalories(tdee, params.goal);
  
  // Calculate macros
  const macros = calculateMacros(targetCalories, params.goal);
  
  return {
    bmi: Math.round(bmi * 10) / 10, // Round to 1 decimal place
    bmiCategory,
    bmr: Math.round(bmr),
    tdee: Math.round(tdee),
    targetCalories: Math.round(targetCalories),
    macros
  };
} 
```

# app/healthprofileform/calculate-health-data/health-data-types.ts

```ts
/**
 * Types for health data calculations
 */

export interface HealthMetrics {
  bmi: number;
  bmiCategory: string;
  bmr: number;
  tdee: number;
  targetCalories: number;
  macros: MacronutrientDistribution;
}

export interface MacronutrientDistribution {
  protein: number;
  carbs: number;
  fat: number;
} 
```

# app/healthprofileform/calculate-health-data/index.ts

```ts
import {
  Gender,
  ActivityLevel,
  GoalType,
} from "../_store/health-profile-store";

// Export all functions from this directory
export * from "./calculate-all-metrics";
export * from "./health-data-types";

/**
 * Calculate Body Mass Index (BMI)
 * Formula: BMI = Weight (kg) / (Height (cm) / 100)²
 *
 * @param weight Weight in kilograms
 * @param height Height in centimeters
 * @returns Calculated BMI value
 */
export function calculateBMI(weight: number, height: number): number {
  // Convert height from cm to meters and square it
  const heightInMeters = height / 100;
  return weight / Math.pow(heightInMeters, 2);
}

/**
 * Get BMI category based on calculated BMI value
 *
 * @param bmi Calculated BMI value
 * @returns BMI category as a string
 */
export function getBMICategory(bmi: number): string {
  if (bmi < 18.5) return "Underweight";
  if (bmi >= 18.5 && bmi < 25) return "Normal weight";
  if (bmi >= 25 && bmi < 30) return "Overweight";
  if (bmi >= 30 && bmi < 35) return "Obesity (Class 1)";
  if (bmi >= 35 && bmi < 40) return "Obesity (Class 2)";
  return "Obesity (Class 3 - Severe/Morbid)";
}

/**
 * BMR calculation method options
 */
export type BMRMethod = "mifflin-st-jeor" | "harris-benedict";

/**
 * Calculate Basal Metabolic Rate (BMR) using the Mifflin-St Jeor equation (more accurate)
 * Formulas:
 * For Men: BMR = (10 × weight in kg) + (6.25 × height in cm) - (5 × age in years) + 5
 * For Women: BMR = (10 × weight in kg) + (6.25 × height in cm) - (5 × age in years) - 161
 *
 * @param gender User's gender
 * @param weight Weight in kilograms
 * @param height Height in centimeters
 * @param age Age in years
 * @returns Calculated BMR value
 */
export function calculateBMRMifflin(
  gender: Gender,
  weight: number,
  height: number,
  age: number
): number {
  const baseBMR = 10 * weight + 6.25 * height - 5 * age;

  if (gender === "male") {
    return baseBMR + 5;
  } else {
    // Use female formula for both 'female' and 'other' for now
    return baseBMR - 161;
  }
}

/**
 * Calculate Basal Metabolic Rate (BMR) using the Harris-Benedict equation
 * Formulas:
 * For Men: BMR = 66.5 + (13.75 * Weight (kg)) + (5.003 * Height (cm)) - (6.755 * Age (years))
 * For Women: BMR = 655.1 + (9.563 * Weight (kg)) + (1.850 * Height (cm)) - (4.676 * Age (years))
 *
 * @param gender User's gender
 * @param weight Weight in kilograms
 * @param height Height in centimeters
 * @param age Age in years
 * @returns Calculated BMR value
 */
export function calculateBMRHarrisBenedict(
  gender: Gender,
  weight: number,
  height: number,
  age: number
): number {
  if (gender === "male") {
    return 66.5 + 13.75 * weight + 5.003 * height - 6.755 * age;
  } else {
    // Use female formula for both 'female' and 'other' for now
    return 655.1 + 9.563 * weight + 1.85 * height - 4.676 * age;
  }
}

/**
 * Calculate Basal Metabolic Rate (BMR) using either Mifflin-St Jeor or Harris-Benedict equation
 *
 * @param gender User's gender
 * @param weight Weight in kilograms
 * @param height Height in centimeters
 * @param age Age in years
 * @param method The BMR calculation method to use (defaults to Mifflin-St Jeor as it's more accurate)
 * @returns Calculated BMR value
 */
export function calculateBMR(
  gender: Gender,
  weight: number,
  height: number,
  age: number,
  method: BMRMethod = "mifflin-st-jeor"
): number {
  if (method === "harris-benedict") {
    return calculateBMRHarrisBenedict(gender, weight, height, age);
  } else {
    return calculateBMRMifflin(gender, weight, height, age);
  }
}

/**
 * Convert activity level string to the corresponding activity factor
 *
 * @param activityLevel User's activity level
 * @returns Activity factor as a number
 */
export function getActivityFactor(activityLevel: ActivityLevel): number {
  switch (activityLevel) {
    case "sedentary":
      return 1.2; // Sedentary (little exercise)
    case "light":
      return 1.375; // Lightly active (light exercise 1-3 days/week)
    case "moderate":
      return 1.55; // Moderately active (moderate exercise 3-5 days/week)
    case "active":
      return 1.725; // Very active (hard exercise 6-7 days/week)
    case "athlete":
      return 1.9; // Extra active (very hard exercise & physical job or 2x training)
    default:
      return 1.2; // Default to sedentary if unknown
  }
}

/**
 * Calculate Total Daily Energy Expenditure (TDEE)
 * Formula: TDEE = BMR * Activity Factor
 *
 * @param bmr Calculated Basal Metabolic Rate
 * @param activityLevel User's activity level
 * @returns Calculated TDEE value
 */
export function calculateTDEE(
  bmr: number,
  activityLevel: ActivityLevel
): number {
  const activityFactor = getActivityFactor(activityLevel);
  return bmr * activityFactor;
}

/**
 * Calculate Target Daily Caloric Intake based on TDEE and goal
 *
 * @param tdee Calculated TDEE
 * @param goal User's weight goal
 * @returns Target daily caloric intake
 */
export function calculateTargetCalories(tdee: number, goal: GoalType): number {
  // tdee is less than 1500
  switch (goal) {
    case "fat-loss":
      return tdee - 500; // 500 calorie deficit for fat loss (approximately 0.5 kg/week)
    case "muscle-building":
    case "bodybuilding":
      return tdee + 250; // 250 calorie surplus for muscle gain (approximately 0.25 kg/week)

    case "maintenance":
    case "muscle-building-with-fat-loss":
    case "general-fitness":
    case "other":
    default:
      return tdee; // Maintain current weight
  }
}

/**
 * Convert weight between kg and lb
 *
 * @param weight Weight value
 * @param fromUnit Original unit ('kg' or 'lb')
 * @param toUnit Target unit ('kg' or 'lb')
 * @returns Converted weight value
 */
export function convertWeight(
  weight: number,
  fromUnit: "kg" | "lb",
  toUnit: "kg" | "lb"
): number {
  if (fromUnit === toUnit) return weight;

  if (fromUnit === "lb" && toUnit === "kg") {
    return weight * 0.45359237; // Convert pounds to kilograms
  } else {
    return weight * 2.20462262; // Convert kilograms to pounds
  }
}

/**
 * Convert height between cm and ft
 * Note: This is a simplification. For more precise conversion, we would need to handle feet and inches separately.
 *
 * @param height Height value
 * @param fromUnit Original unit ('cm' or 'ft')
 * @param toUnit Target unit ('cm' or 'ft')
 * @returns Converted height value
 */
export function convertHeight(
  height: number,
  fromUnit: "cm" | "ft",
  toUnit: "cm" | "ft"
): number {
  if (fromUnit === toUnit) return height;

  if (fromUnit === "ft" && toUnit === "cm") {
    return height * 30.48; // Convert feet to centimeters
  } else {
    return height / 30.48; // Convert centimeters to feet
  }
}

/**
 * Calculate macronutrient distribution based on target calories and goal
 *
 * @param targetCalories Target daily caloric intake
 * @param goal Weight goal
 * @returns Object containing protein, carbs, and fat in grams
 */
export function calculateMacros(targetCalories: number, goal: GoalType) {
  let proteinPercentage: number;
  let carbsPercentage: number;
  let fatPercentage: number;

  // Set macronutrient percentages based on goal
  switch (goal) {
    case "bodybuilding":
      // Body-Building macros: 30% protein, 50% carbs, 20% fat
      proteinPercentage = 0.3;
      carbsPercentage = 0.5;
      fatPercentage = 0.2;
      break;
    case "fat-loss":
      // Weight Loss macros: 45% protein, 20% carbs, 35% fat
      proteinPercentage = 0.45;
      carbsPercentage = 0.2;
      fatPercentage = 0.35;
      break;
    case "maintenance":
    case "general-fitness":
    case "muscle-building":
    case "muscle-building-with-fat-loss":
    case "other":
    default:
      // Maintenance/General macros: 30% protein, 40% carbs, 30% fat
      proteinPercentage = 0.3;
      carbsPercentage = 0.4;
      fatPercentage = 0.3;
      break;
  }

  // Calculate macros in grams
  const proteinGrams = Math.round((targetCalories * proteinPercentage) / 4);
  const carbsGrams = Math.round((targetCalories * carbsPercentage) / 4);
  const fatGrams = Math.round((targetCalories * fatPercentage) / 9);

  return {
    protein: proteinGrams,
    carbs: carbsGrams,
    fat: fatGrams,
  };
}

```

# app/healthprofileform/layout.tsx

```tsx
import Image from "next/image";

export default function HealtProfileFormLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <main className="min-h-screen">
      <div className="container mx-auto px-4 pt-6">
        <div className="flex flex-col items-center justify-center mb-10 sm:flex-row sm:gap-4">
          <div className="relative h-20 w-20 mb-4 sm:mb-0">
            <Image
              src="/android-chrome-512x512.png"
              alt="GymNavigator Logo"
              fill
              priority
              className="object-contain drop-shadow-md"
            />
          </div>
          <div className="flex flex-col items-center sm:items-start">
            <h1 className="text-3xl font-extrabold tracking-tight drop-shadow-sm">
              <span className="font-black text-gray-800">Gym</span>
              <span className="bg-gradient-to-r from-blue-500 to-blue-700 bg-clip-text text-transparent font-black">
                Navigator
              </span>
            </h1>
            <span className="text-gray-500 text-sm mt-1 italic">
              Your Ultimate Gym Management Solution
            </span>
          </div>
        </div>
      </div>
      <div className="container mx-auto px-4">{children}</div>
    </main>
  );
}

```

# app/healthprofileform/page.tsx

```tsx
'use client';

import { useToast } from '@/hooks/use-toast';
import { gymTheme } from '@/styles/theme';
import { useRouter } from 'next/navigation';
import { useEffect, useState } from 'react';
import { submitHealthProfile } from './_actions/use-health-profile-mutation';
import { useHealthProfileStore } from './_store/health-profile-store';

import ActivityForm from './_components/activity-form';
import AgeForm from './_components/age-form';
// Form step components
import GenderForm from './_components/gender-form';
import GoalForm from './_components/goal-form';
import HeightForm from './_components/height-form';
import MedicalConditionsForm from './_components/medical-conditions-form';
import AllergiesForm from './_components/allergies-form';
import DietaryPreferencesForm from './_components/dietary-preferences-form';
import NonVegDaysForm from './_components/non-veg-days-form';
import MealTimesForm from './_components/meal-times-form';
import ReligiousPreferencesForm from './_components/religious-preferences-form';
import WeightForm from './_components/weight-form';

// Progress indicator component
const ProgressIndicator = ({ currentStep, totalSteps }: { currentStep: number; totalSteps: number }) => {
  const { gender, dietaryPreference } = useHealthProfileStore();
  
  // Adjust total steps if user is not non-vegetarian (skipping the non-veg days form)
  const adjustedTotalSteps = dietaryPreference === 'non-vegetarian' ? totalSteps : totalSteps - 1;
  
  // Only show progress after gender is selected (first step completed)
  // If gender is null, show 0%, otherwise calculate based on completed steps
  const progressPercentage = !gender ? 0 : Math.floor(((currentStep - 1) / adjustedTotalSteps) * 100);
  
  return (
    <div className="w-full mb-8">
      <div className="flex justify-between mb-2">
        <span className="text-sm text-gray-500">Step {currentStep} of {adjustedTotalSteps}</span>
        <span className="text-sm font-medium">{progressPercentage}%</span>
      </div>
      <div className="w-full bg-gray-200 rounded-full h-2.5">
        <div
          className="h-2.5 rounded-full bg-gradient-to-r from-blue-500 to-blue-600"
          style={{ width: `${progressPercentage}%` }}
        />
      </div>
    </div>
  );
};

export default function HealthProfileFormPage() {
  const { currentStep, totalSteps, resetForm, ...formState } = useHealthProfileStore();
  const [isSubmitting, setIsSubmitting] = useState(false);
  const { toast } = useToast();
  const router = useRouter();
  
  // Reset form when component unmounts
  useEffect(() => {
    return () => resetForm();
  }, [resetForm]);

  // Skip non-veg days form if user is not non-vegetarian
  useEffect(() => {
    const { dietaryPreference } = useHealthProfileStore.getState();
    if (currentStep === 10 && dietaryPreference !== 'non-vegetarian') {
      // Skip to step 11 if not a non-vegetarian
      useHealthProfileStore.getState().nextStep();
    }
  }, [currentStep]);

  const handleFormSubmit = async () => {
    setIsSubmitting(true);
    try {
      const result = await submitHealthProfile(formState);
      if (result.success) {
        toast({
          title: "Success!",
          description: "Your health profile has been saved.",
          variant: "default",
        });
        // Navigate to dashboard or appropriate page
        router.push('/dashboard');
      } else {
        toast({
          title: "Something went wrong",
          description: result.error || "Failed to save your health profile. Please try again.",
          variant: "destructive",
        });
      }
    } catch (error) {
      toast({
        title: "Error",
        description: "An unexpected error occurred. Please try again.",
        variant: "destructive",
      });
      console.error("Error submitting health profile:", error);
    } finally {
      setIsSubmitting(false);
    }
  };

  // Modified to return a Promise to match expected type
  const handleNextStep = async (): Promise<void> => {
    useHealthProfileStore.getState().nextStep();
    return Promise.resolve();
  };

  // Render the current step component
  const renderStep = () => {
    const { dietaryPreference } = useHealthProfileStore();
    const isNonVegetarian = dietaryPreference === 'non-vegetarian';
    
    switch (currentStep) {
      case 1:
        return <GenderForm />;
      case 2:
        return <AgeForm />;
      case 3:
        return <HeightForm />;
      case 4:
        return <WeightForm />;
      case 5:
        return <GoalForm />;
      case 6:
        return <ActivityForm />;
      case 7:
        return <MedicalConditionsForm onSubmit={handleNextStep} isSubmitting={false} />;
      case 8:
        return <AllergiesForm />;
      case 9:
        return <DietaryPreferencesForm />;
      case 10:
        // Show NonVegDaysForm (useEffect will handle skipping)
        return <NonVegDaysForm />;
      case 11:
        return <MealTimesForm />;
      case 12:
        return <ReligiousPreferencesForm onSubmit={handleFormSubmit} isSubmitting={isSubmitting} isLast={true} />;
      default:
        return <GenderForm />;
    }
  };

  return (
    <div className="max-w-md mx-auto px-4 py-8">
      <ProgressIndicator currentStep={currentStep} totalSteps={totalSteps} />
      {renderStep()}
    </div>
  );
}

```

# app/layout.tsx

```tsx
import './globals.css';
import RecoilContextProvider from '@/lib/RecoilContextProvider';
import { LazyMotion, domAnimation } from 'framer-motion';
import type { Metadata } from 'next';
// import Script from "next/script";
import { Toaster } from 'sonner';
import type { ToasterProps } from 'sonner';
import QueryClientProvider from './providers/QueryClientProvider';
import Providers from './providers/provider';
const siteUrl = 'https://admin.gymnavigator.in';

export const metadata: Metadata = {
  title: 'GymNavigator - Gym Management System',
  description:
    'Transform your gym management with GymNavigator. The all-in-one solution for modern gym owners and trainers.',
  metadataBase: new URL(siteUrl),
  alternates: {
    canonical: '/',
  },
  openGraph: {
    title: 'GymNavigator - Gym Management System',
    description:
      'Transform your gym management with GymNavigator. The all-in-one solution for modern gym owners and trainers.',
    url: siteUrl,
    siteName: 'GymNavigator',
    locale: 'en_US',
    type: 'website',
    images: [
      {
        url: '/gymnavigator-og.jpg', // Direct path to OG image in public directory
        width: 1200,
        height: 630,
        alt: 'GymNavigator - Modern Gym Management',
        type: 'image/jpeg',
      },
    ],
  },
  twitter: {
    card: 'summary_large_image',
    title: 'GymNavigator - Gym Management System',
    description:
      'Transform your gym management with GymNavigator. The all-in-one solution for modern gym owners and trainers.',
    images: ['/gymnavigator-og.jpg'],
  },
  other: {
    'og:image:secure_url': `${siteUrl}/gymnavigator-og.jpg`,
    'theme-color': '#1e40af',
    'msapplication-TileColor': '#1e40af',
  },
  icons: {
    icon: [{ url: '/favicon.ico' }, { url: '/icon.png', type: 'image/png' }],
    apple: [{ url: '/apple-touch-icon.png' }],
    other: [
      {
        rel: 'mask-icon',
        url: '/favicon/safari-pinned-tab.svg',
        color: '#1e40af',
      },
    ],
  },
  manifest: '/site.webmanifest',
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const toasterProps: ToasterProps = {
    richColors: true,
    theme: 'light',
    position: 'top-right',
  };

  return (
    <html lang="en">
      <head>
        <meta
          name="google-site-verification"
          content="LCLleK9nzppdl_Pl1l1Sd00aXJRgLyfl6Xjc6poUDAI"
        />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
      </head>
      <body>
        <Providers>
          <QueryClientProvider>
            <RecoilContextProvider>
              <LazyMotion features={domAnimation}>
                {children}
                <Toaster {...toasterProps} />
              </LazyMotion>
            </RecoilContextProvider>
          </QueryClientProvider>
        </Providers>
      </body>
    </html>
  );
}

```

# app/providers/provider.tsx

```tsx
'use client';
import { SessionProvider } from '@/node_modules/next-auth/react';
import type React from 'react';

export default function Providers({ children }: { children: React.ReactNode }) {
  return <SessionProvider>{children}</SessionProvider>;
}

```

# app/providers/QueryClientProvider.tsx

```tsx
'use client';
import { queryClient } from '@/lib/getQueryClient';
import { experimental_createPersister } from '@tanstack/query-persist-client-core';
// import { experimental_createPersister } from "@tanstack/react-persist-client-core";
import {
  HydrationBoundary,
  QueryClientProvider as TanstackQueryClientProvider,
} from '@tanstack/react-query';
import { ReactQueryDevtools } from '@tanstack/react-query-devtools';
import { type ReactNode, useEffect, useState } from 'react';

export default function QueryClientProvider({
  children,
  dehydratedState, // receive the dehydrated state, if available
}: {
  children: ReactNode;
  dehydratedState?: unknown;
}) {
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    if (typeof window !== 'undefined') {
      (async () => {
        try {
          const { createStore, del, get, set } = await import('idb-keyval');
          const store = createStore('tanstack-query', 'persisted-queries');

          console.log('Initializing IndexedDB store...');

          const storage = {
            getItem: async (key: string) => {
              const value = await get(key, store);
              console.log('Retrieved from IndexedDB:', { key, value });
              return value ?? null;
            },
            setItem: async (key: string, value: unknown) => {
              console.log('Storing in IndexedDB:', { key, value });
              await set(key, value, store);
            },
            removeItem: async (key: string) => {
              console.log('Removing from IndexedDB:', key);
              await del(key, store);
            },
          };

          const persister = experimental_createPersister({
            storage,
            maxAge: 1000 * 60 * 60 * 24,
            serialize: (data) => JSON.stringify(data),
            deserialize: (data) => JSON.parse(data as string),
            buster: 'v1',
          });

          queryClient.setDefaultOptions({
            queries: {
              ...queryClient.getDefaultOptions().queries,
              // @ts-ignore
              persister,
            },
          });

          console.log('IndexedDB persister initialized successfully');
        } catch (error) {
          console.error('Error initializing IndexedDB persister:', error);
        }
        setMounted(true);
      })();
    }
  }, []);

  if (!mounted) {
    return null;
  }

  return (
    <TanstackQueryClientProvider client={queryClient}>
      <HydrationBoundary state={dehydratedState ?? {}}>{children}</HydrationBoundary>
      <ReactQueryDevtools initialIsOpen={false} />
    </TanstackQueryClientProvider>
  );
}

```

# app/queryClient.ts

```ts
import { QueryClient } from '@tanstack/react-query';

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      gcTime: 1000 * 60 * 5,
      staleTime: 1000 * 60,
      refetchOnWindowFocus: false,
      refetchOnMount: false,
      refetchOnReconnect: false,
    },
  },
});

```

# app/robots.ts

```ts
import type { MetadataRoute } from 'next';

/**
 * Robots.txt configuration for Next.js app router
 * Controls search engine crawling behavior
 */
export default function robots(): MetadataRoute.Robots {
  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'https://admin.gymnavigator.in';

  return {
    rules: [
      {
        userAgent: '*',
        allow: ['/', '/home', '/gym', '/dashboard'],
        disallow: ['/api/*', '/_next/*', '/static/*', '/auth/*', '/*.json', '/*.xml'],
      },
      {
        userAgent: 'Googlebot',
        allow: ['/', '/dashboard'],
        disallow: ['/api/', '/_next/', '/static/', '/auth/'],
      },
    ],
    sitemap: `${baseUrl}/sitemap.xml`,
    host: baseUrl,
  };
}

```

# app/sitemap.ts

```ts
import type { MetadataRoute } from 'next';
import { generateStaticParams } from './gym/[gymname]/page';

const siteUrl = 'https://admin.gymnavigator.in';

/**
 * Sitemap configuration for Next.js app router
 * Helps search engines better index your site
 */
export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
  // Static routes that should be indexed
  const staticRoutes = [
    {
      url: siteUrl,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 1,
    },
    {
      url: `${siteUrl}/gym`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/trainer`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/client`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.7,
    },
    // Dashboard main routes
    {
      url: `${siteUrl}/dashboard/owner`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.9,
    },
    {
      url: `${siteUrl}/dashboard/trainer`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.9,
    },
    {
      url: `${siteUrl}/dashboard/client`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.9,
    },
    // Owner dashboard sub-routes
    {
      url: `${siteUrl}/dashboard/owner/attendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/owner/attendance/todaysattendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/attendance/showqr`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/gymdetails`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/owner/gymdetails/viewgymdetails`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/trainers`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/owner/trainers/viewtrainers`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/trainers/userstrainersassignment`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/onboarding`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/owner/onboarding/onboarding`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/onboarding/onboardedusers`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/owner/onboarding/onboardingqr`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.7,
    },
    // Trainer dashboard sub-routes
    {
      url: `${siteUrl}/dashboard/trainer/workouts`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/trainer/workouts/createworkout`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/trainer/workouts/assignworkout`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/trainer/diet`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/trainer/diet/createdietplan`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/trainer/diet/assigndietplan`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/trainer/attendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/trainer/attendance/todaysattendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/trainer/attendance/showqr`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/trainer/assignedusers`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    // Client dashboard sub-routes
    {
      url: `${siteUrl}/dashboard/client/home`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/client/home/gym`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/home/dashboard`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/workouts`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/client/workouts/viewworkout`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/workouts/allworkouts`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/diet`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/client/diet/viewdiet`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/diet/grocerylist`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/diet/eatingoutguide`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/attendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/dashboard/client/attendance/viewattendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
    {
      url: `${siteUrl}/dashboard/client/attendance/markattendance`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.7,
    },
  ];

  // Home pages routes (at root level since (home) is a route group)
  const homeRoutes = [
    {
      url: `${siteUrl}/about`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/contact`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.8,
    },
    {
      url: `${siteUrl}/pricing`,
      lastModified: new Date(),
      changeFrequency: 'weekly' as const,
      priority: 0.8,
    },
  ];

  // Static assets that should be indexed
  const staticAssets = [
    {
      url: `${siteUrl}/gymnavigator-og.jpg`,
      lastModified: new Date(),
      changeFrequency: 'yearly' as const,
      priority: 0.1,
    },
    {
      url: `${siteUrl}/icon.png`,
      lastModified: new Date(),
      changeFrequency: 'yearly' as const,
      priority: 0.1,
    },
    {
      url: `${siteUrl}/apple-touch-icon.png`,
      lastModified: new Date(),
      changeFrequency: 'yearly' as const,
      priority: 0.1,
    },
  ];

  // Get gym routes from the same function that generates static paths
  try {
    const gymParams = await generateStaticParams();
    const dynamicRoutes = gymParams.map((param) => ({
      url: `${siteUrl}/gym/${encodeURIComponent(param.gymname)}`,
      lastModified: new Date(),
      changeFrequency: 'daily' as const,
      priority: 0.6,
    }));

    return [...staticRoutes, ...homeRoutes, ...staticAssets, ...dynamicRoutes];
  } catch (error) {
    console.error('Error generating dynamic sitemap routes:', error);
    return [...staticRoutes, ...homeRoutes, ...staticAssets];
  }
}

```

# app/state/Atoms/gymAtom.ts

```ts
import { type RecoilState, atom } from 'recoil';

export interface GymAtomType {
  id: string;
  name: string;
  img: string;
}

export const GymAtom: RecoilState<GymAtomType> = atom({
  key: 'GymAtom',
  default: {
    id: '',
    name: 'as',
    img: '',
  },
});

```

# app/types/next-auth.d.ts

```ts
// next-auth.d.ts
import type { DefaultSession } from 'next-auth';

export type Rolestype = 'owner' | 'trainer' | 'client';

// Matches the backend response
export interface GymInfo {
  id: string;
  gym_name: string;
}

// Extend the default Session type to include custom fields
declare module 'next-auth' {
  interface Session {
    accessToken?: string;
    role: Rolestype;
    gym?: GymInfo;
    user: {
      name?: string;
      id?: string;
      picture?: string;
    } & DefaultSession['user'];
  }
  interface JWT {
    id?: string;
    role?: Rolestype;
    gym?: GymInfo;
    accessToken?: string;
  }
}

declare module 'next-auth' {
  interface User {
    id: string;
    name: string;
    email: string;
    role: Rolestype;
    gym?: GymInfo;
  }
}

```

# app/types/react-qr-scanner.d.ts

```ts
declare module '@yudiel/react-qr-scanner' {
  export interface Result {
    getText(): string;
  }

  export interface ScannerProps {
    onResult: (result: Result) => void | Promise<void>;
    onError?: (error: Error) => void;
  }

  export const Scanner: React.ComponentType<ScannerProps>;
}

```

# app/types/sooner.d.ts

```ts
declare module 'sonner' {
  interface ToasterProps {
    richColors?: boolean;
    theme?: 'light' | 'dark' | 'system';
    position?:
      | 'top-left'
      | 'top-right'
      | 'bottom-left'
      | 'bottom-right'
      | 'top-center'
      | 'bottom-center';
    closeButton?: boolean;
  }

  export const Toaster: React.FC<ToasterProps>;
  export const toast: {
    (message: string): void;
    success: (message: string, options?: { description?: string }) => void;
    loading: (message: string, options?: { description?: string }) => void;
    error: (message: string, options?: { description?: string }) => void;
    warning: (message: string, options?: { description?: string }) => void;
    info: (message: string, options?: { description?: string }) => void;
    dismiss: () => void;
  };
}

```

# biome.json

```json
{
  "$schema": "https://biomejs.dev/schemas/1.5.3/schema.json",
  "organizeImports": {
    "enabled": true
  },
  "linter": {
    "enabled": true,
    "rules": {
      "recommended": true,
      "correctness": {
        "noUnusedVariables": "error",
        "useExhaustiveDependencies": "error",
        "noUndeclaredVariables": "off"
      },
      "suspicious": {
        "noExplicitAny": "error",
        "noArrayIndexKey": "error"
      },
      "performance": {
        "noAccumulatingSpread": "error"
      },
      "a11y": {
        "useKeyWithClickEvents": "error",
        "useButtonType": "error"
      }
    }
  },
  "javascript": {
    "formatter": {
      "enabled": true,
      "quoteStyle": "single",
      "trailingCommas": "all",
      "semicolons": "always"
    }
  },
  "files": {
    "ignore": [
      "node_modules",
      "dist",
      ".next",
      "public"
    ]
  }
}
```

# components.json

```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}

```

# components/alerts/WarningAlert.ts

```ts
import Swal from 'sweetalert2';

export default function WarningAlert() {
  let Userchoice = false;
  Swal.fire({
    title: 'Are you sure ',
    text: 'You want to create new workout plan!',
    icon: 'warning',
    showCancelButton: true,
    confirmButtonColor: '#3085d6',
    cancelButtonColor: '#d33',
    confirmButtonText: 'Yes!',
  }).then((result) => {
    if (result.isConfirmed) {
      Userchoice = true;
      Swal.fire({
        title: 'Successs!',
        text: 'Workout is sucssfully created.',
        icon: 'success',
      });
    }
  });
  // return a state var where the result of the user choic is saved
  return Userchoice;
}

```

# components/Auth/AuthError.tsx

```tsx
import { XCircle } from 'lucide-react';

interface AuthErrorProps {
  error: string;
  onDismiss: () => void;
}

export function AuthError({ error, onDismiss }: AuthErrorProps) {
  return (
    <div className="bg-red-50 border border-red-200 rounded-md p-4 mb-6">
      <div className="flex">
        <XCircle className="h-5 w-5 text-red-400" />
        <div className="ml-3">
          <p className="text-sm text-red-700">{error}</p>
        </div>
        <button
          type="button"
          onClick={onDismiss}
          className="ml-auto text-red-400 hover:text-red-500"
        >
          <XCircle className="h-5 w-5" />
        </button>
      </div>
    </div>
  );
}

```

# components/common/Alerts/confirmaction.ts

```ts
// components/common/alerts/confirmAction.ts

import Swal, { type SweetAlertResult } from 'sweetalert2';

/**
 * Displays a confirmation dialog with customizable title and text.
 *
 * @param title - The title of the confirmation dialog.
 * @param text - The message/body of the confirmation dialog.
 * @returns A promise that resolves to `true` if confirmed, otherwise `false`.
 */
export const confirmAction = async (title: string, text: string): Promise<boolean> => {
  const result: SweetAlertResult = await Swal.fire({
    title,
    text,
    icon: 'warning',
    showCancelButton: true,
    confirmButtonColor: '#3085d6',
    cancelButtonColor: '#d33',
    confirmButtonText: 'Yes, proceed!',
    cancelButtonText: 'No, cancel',
  });

  return result.isConfirmed;
};

```

# components/common/Alerts/CustomAlerts.ts

```ts
import Swal, { type SweetAlertIcon } from 'sweetalert2';
const Toast = Swal.mixin({
  toast: true,
  position: 'bottom-end',
  showConfirmButton: false,
  timer: 4000,
  timerProgressBar: true,
  didOpen: (toast: HTMLElement) => {
    toast.onmouseenter = Swal.stopTimer;
    toast.onmouseleave = Swal.resumeTimer;
  },
});

export const coustomAlert = (icon: SweetAlertIcon, message: string) => {
  Toast.fire({
    icon: icon,
    title: message,
  });
};

```

# components/common/Auth/SigninForm.tsx

```tsx
'use client';
import { AuthError } from '@/components/Auth/AuthError';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
// Import the type definitions
import type { PasswordCredential } from '@/types/credential-management';
import { Eye, EyeOff, Lock, Mail } from 'lucide-react';
import { signIn } from 'next-auth/react';
import { useRouter } from 'next/navigation';
import { useState } from 'react';
import { toast } from 'sonner';
import GoogleButton from '../../ui/googleButton';
// Make sure the types are imported (no need to explicitly import the global declarations)
import '@/types/credential-management';

// After successful login, store the credentials
const storeCredentials = async (email: string, password: string) => {
  // Check if Credential Management API is supported
  if ('credentials' in navigator && window.PasswordCredential) {
    try {
      const cred = new window.PasswordCredential({
        id: email,
        password: password,
        name: email,
        iconURL: `${window.location.origin}/favicon.ico`,
      });
      await navigator.credentials.store(cred);
    } catch (e) {
      console.error('Error storing credentials:', e);
    }
  }
};

export default function SignInForm() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const Router = useRouter();

  const handleSubmit = async (event: React.FormEvent) => {
    event.preventDefault();
    setLoading(true);
    setError(null);

    try {
      // Use NextAuth's signIn directly - auth.config.ts handles the authentication logic
      const result = await signIn('credentials', {
        redirect: false,
        email,
        password,
      });

      if (result?.error) {
        // Parse the error JSON if it exists
        toast.dismiss();
        let errorMessage = 'Failed to sign in';
        let errorCode = 'UNKNOWN_ERROR';

        try {
          const parsedError = JSON.parse(result.error);
          errorMessage = parsedError.message || errorMessage;
          errorCode = parsedError.error || errorCode;
        } catch {
          errorMessage = result.error;
        }

        setError(errorMessage);

        // Map error codes to user-friendly toast messages
        switch (errorCode) {
          case 'USER_NOT_FOUND':
            toast.error('Account not found', {
              description: 'No account found with this email address',
            });
            break;
          case 'INVALID_CREDENTIALS':
            toast.error('Invalid credentials', {
              description: 'The email or password you entered is incorrect',
            });
            break;
          case 'SERVER_ERROR':
            toast.error('Server error', {
              description: 'Please try again later',
            });
            break;
          default:
            toast.error('Sign in failed', {
              description: errorMessage,
            });
        }
      } else if (result?.ok) {
        toast.dismiss();

        toast.success('Welcome back!', {
          description: 'Redirecting to dashboard...',
        });
        await storeCredentials(email, password);
        // router.refresh();
      }
    } catch (error) {
      toast.dismiss();
      console.error('Failed to sign in:', error);
      setError('An unexpected error occurred');
      toast.error('Sign in error', {
        description: 'An unexpected error occurred',
      });
    } finally {
      setLoading(false);
      toast.dismiss();
      toast.success('Welcome back!', {
        description: 'Redirecting to dashboard...',
      });
      Router.refresh();
    }
  };

  const handleGoogleSignIn = async () => {
    setLoading(true);
    try {
      toast.loading('Connecting to Google...');

      // Use NextAuth's Google provider directly
      // auth.config.ts handles the verification with our backend
      await signIn('google', {
        callbackUrl: '/dashboard',
      });

      // Note: No need for additional logic here since the page will redirect
      // and the signIn callback in auth.config.ts handles the verification
    } catch (error) {
      console.error('Failed to sign in with Google:', error);
      setError('Failed to sign in with Google');
      toast.error('Google Sign-in failed', { description: 'Please try again' });
      setLoading(false);
    } finally {
      toast.dismiss();
      toast.success('Welcome back!', {
        description: 'Redirecting to dashboard...',
      });
      Router.refresh();
    }
  };

  return (
    <div className="md:flex justify-center px-4 sm:px-6 lg:px-8">
      <div className="w-full max-w-md p-8 rounded-xl">
        {error && <AuthError error={error} onDismiss={() => setError(null)} />}

        <form
          onSubmit={handleSubmit}
          className="space-y-6"
          name="login"
          id="login-form"
          method="post"
          autoComplete="on"
        >
          <div className="space-y-2">
            <Label htmlFor="email" className="text-gray-300">
              Email Address
            </Label>
            <div className="relative">
              <Mail className="absolute left-3 top-3 h-5 w-5 text-blue-400" />
              <Input
                id="email"
                name="email"
                type="email"
                placeholder="john@example.com"
                className="pl-10 bg-blue-950/30 border-blue-500/30 text-white placeholder:text-gray-400"
                required
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                disabled={loading}
                autoComplete="email"
              />
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="password" className="text-gray-300">
              Password
            </Label>
            <div className="relative">
              <Lock className="absolute left-3 top-3 h-5 w-5 text-blue-400" />
              <Input
                id="password"
                name="password"
                placeholder="Your password"
                type={showPassword ? 'text' : 'password'}
                className="pl-10 pr-10 bg-blue-950/30 border-blue-500/30 text-white placeholder:text-gray-400"
                required
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                disabled={loading}
                autoComplete="current-password"
              />
              <button
                type="button"
                onClick={() => setShowPassword(!showPassword)}
                className="absolute right-3 top-3 text-blue-400 hover:text-blue-300 focus:outline-none"
                aria-label={showPassword ? 'Hide password' : 'Show password'}
              >
                {showPassword ? <EyeOff className="h-5 w-5" /> : <Eye className="h-5 w-5" />}
              </button>
            </div>
          </div>

          <Button
            type="submit"
            className="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white"
            disabled={loading}
            name="login-button"
          >
            {loading ? 'Signing in...' : 'Sign In'}
          </Button>
        </form>

        <div className="relative my-6">
          <div className="absolute inset-0 flex items-center">
            <span className="w-full border-t border-blue-500/30" />
          </div>
          <div className="relative flex justify-center text-sm">
            <span className="px-2 bg-blue-900/20 text-gray-300">Or continue with</span>
          </div>
        </div>

        <GoogleButton handleSubmit={handleGoogleSignIn} />

        <div className="mt-6 text-center text-sm text-gray-300">
          Don&apos;t have an account?{' '}
          <a href="/signup" className="font-medium text-blue-400 hover:text-blue-300">
            Sign up
          </a>
        </div>
      </div>
    </div>
  );
}

```

# components/common/Auth/Signout.tsx

```tsx
'use client';
import { signOut } from '@/node_modules/next-auth/react';
import { m } from 'framer-motion';
import React, { useState } from 'react';

export default function Signout() {
  const [isSigningOut, setIsSigningOut] = useState(false);
  const [countdown, setCountdown] = useState(3);

  const handleSignOut = async () => {
    setIsSigningOut(true);

    // Start countdown
    const timer = setInterval(() => {
      setCountdown((prev) => {
        if (prev <= 1) {
          clearInterval(timer);
          signOut({ callbackUrl: '/signin' });
        }
        return prev - 1;
      });
    }, 1000);
  };

  return (
    <div className="w-full max-w-md mx-auto backdrop-blur-md p-8 rounded-xl border border-blue-500/20 shadow-xl text-center space-y-8">
      <m.div
        initial={{ scale: 0.8, opacity: 0 }}
        animate={{ scale: 1, opacity: 1 }}
        transition={{ duration: 0.5 }}
        className="space-y-4"
      >
        <h1 className="text-3xl font-bold text-white">
          {isSigningOut ? 'Signing you out...' : 'Are you sure you want to sign out?'}
        </h1>
        <p className="text-gray-300 max-w-md mx-auto">
          {isSigningOut
            ? `Redirecting in ${countdown} seconds...`
            : 'You will need to sign in again to access your account.'}
        </p>
      </m.div>

      {!isSigningOut && (
        <m.div
          initial={{ y: 20, opacity: 0 }}
          animate={{ y: 0, opacity: 1 }}
          transition={{ delay: 0.2, duration: 0.5 }}
        >
          <button
            type="button"
            onClick={handleSignOut}
            className="px-8 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg font-semibold
                     hover:from-red-600 hover:to-red-700 transition-colors duration-200
                     focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-blue-900"
          >
            Sign Out
          </button>
        </m.div>
      )}

      {isSigningOut && (
        <m.div
          initial={{ scale: 0.8, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="flex justify-center"
        >
          <div className="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin" />
        </m.div>
      )}
    </div>
  );
}

```

# components/common/AuthKeyGenerator.tsx

```tsx
// import React, { useState } from "react";
// import { Button } from "@/components/ui/button"; // Hypothetical import, adjust based on your setup
// import fetchToken from "../../app/actions/GetTokenSA"; // Adjust the path as necessary

// const AuthKeyGenerator: React.FC = () => {
//   const [authKey, setAuthKey] = useState<string | null>(null);
//   const [error, setError] = useState<string | null>(null);

//   const generateAuthKey = async () => {
//     try {
//       const token = await fetchToken();
//       if (token) {
//         // Generate a random 10-letter auth key
//         const randomKey = Math.random().toString(36).substring(2, 12).toUpperCase();
//         setAuthKey(randomKey);
//       } else {
//         setError("Failed to fetch token");
//       }
//     } catch (err) {
//       setError("An error occurred while fetching the token");
//     }
//   };

//   return (
//     <div className="flex flex-col items-center justify-center p-4 bg-white shadow-md rounded-lg">
//       <h2 className="text-xl font-bold mb-4">Generate Auth Key</h2>
//       <Button onClick={generateAuthKey} className="mb-4">
//         Generate Key
//       </Button>
//       {authKey && (
//         <div className="text-lg font-mono text-green-600">
//           Auth Key: {authKey}
//         </div>
//       )}
//       {error && (
//         <div className="text-red-600">
//           {error}
//         </div>
//       )}
//     </div>
//   );
// };

// export default AuthKeyGenerator;

```

# components/common/Bottomnavigation/bottomnavigation.tsx

```tsx
'use client';
import type { MenuItem as BaseMenuItem } from '@/app/dashboard/_components/menuItems';
import { cn } from '@/lib/utils';
import * as LucideIcons from 'lucide-react';
import type { LucideIcon } from 'lucide-react';
import { usePathname, useRouter } from 'next/navigation';
import type React from 'react';
import { useScrollDirection } from '../../../lib/hooks/useScrollDirection';

// Extend the MenuItem type to use iconName instead of icon
interface MenuItem extends Omit<BaseMenuItem, 'icon'> {
  iconName: string;
}

interface BottomNavigationProps {
  menuItems: MenuItem[];
  basePath?: string;
}

export default function BottomNavigation({ menuItems, basePath = '' }: BottomNavigationProps) {
  const isVisible = useScrollDirection(10, 100);
  const pathname = usePathname();
  const router = useRouter();

  // Function to get the icon component from its name
  const getIconComponent = (iconName: string): LucideIcon => {
    return (
      (LucideIcons as unknown as Record<string, LucideIcon>)[iconName] || LucideIcons.HelpCircle
    );
  };

  const isActiveRoute = (item: MenuItem) => {
    if (item.link && pathname.includes(item.link)) {
      return true;
    }
    return item.subItems?.some((sub) => pathname.includes(sub.link));
  };

  const handleNavClick = (item: MenuItem) => {
    if (item.subItems && item.subItems.length > 0) {
      // Navigate to the first subroute
      const firstSubItem = item.subItems[0];
      router.push(
        firstSubItem.link.startsWith('/') ? firstSubItem.link : `${basePath}${firstSubItem.link}`,
      );
    } else if (item.link) {
      router.push(item.link.startsWith('/') ? item.link : `${basePath}${item.link}`);
    }
  };

  return (
    <nav
      className={cn(
        'fixed bottom-0 left-0 right-0 z-30 bg-white border-t border-gray-200 shadow-lg pb-safe transform transition-all duration-300 ease-in-out',
        !isVisible && 'translate-y-full opacity-0',
        'supports-[height:100dvh]:bottom-[env(safe-area-inset-bottom)]',
      )}
    >
      <div className="flex justify-around items-center h-16 px-2 max-w-md mx-auto">
        {menuItems.map((item) => {
          const Icon = getIconComponent(item.iconName);
          const isActive = isActiveRoute(item);

          return (
            <button
              type="button"
              key={item.label}
              className={cn(
                'relative flex flex-col items-center justify-center w-16 h-16 px-1',
                'hover:opacity-80 transition-all duration-200',
                isActive &&
                  'before:absolute before:top-0 before:left-1/2 before:-translate-x-1/2 before:w-10 before:h-0.5 before:bg-blue-600 before:rounded-full',
              )}
              onClick={() => handleNavClick(item)}
              onKeyDown={(e) => e.key === 'Enter' && handleNavClick(item)}
              aria-label={item.name}
            >
              <div className="flex flex-col items-center justify-center space-y-1">
                <Icon
                  className={cn(
                    'h-6 w-6 transition-colors duration-200',
                    isActive ? 'text-blue-600' : 'text-gray-400',
                  )}
                />
                <span
                  className={cn(
                    'text-xs leading-none transition-colors duration-200 max-w-full truncate',
                    isActive ? 'text-blue-600 font-medium' : 'text-gray-500',
                  )}
                >
                  {item.name}
                </span>
              </div>
            </button>
          );
        })}
      </div>
    </nav>
  );
}

```

# components/common/Registration Form/register-schema.ts

```ts
import * as z from 'zod';

/**
 * Registration form schema with validation rules
 */
export const registerSchema = z.object({
  email: z
    .string()
    .email({ message: 'Invalid email address.' })
    .max(40, { message: 'Email must be at most 40 characters.' }),
  password: z
    .string()
    .min(6, { message: 'Password must be at least 6 characters.' })
    .regex(/[a-z]/, {
      message: 'Password must contain at least one lowercase letter.',
    })
    .regex(/[A-Z]/, {
      message: 'Password must contain at least one uppercase letter.',
    })
    .regex(/[0-9]/, { message: 'Password must contain at least one number.' })
    .regex(/[^a-zA-Z0-9]/, {
      message: 'Password must contain at least one special character.',
    })
    .max(40, { message: 'Password must be at most 40 characters.' }),
  name: z
    .string()
    .min(4, { message: 'Username must be at least 4 characters.' })
    .max(40, { message: 'Username must be at most 40 characters.' }),
  role: z.enum(['owner', 'trainer', 'client'], {
    required_error: 'Please select a role',
  }),
});

// Type for use with useForm
export type RegisterFormValues = z.infer<typeof registerSchema>;

```

# components/common/Registration Form/RegisterForm.tsx

```tsx
'use client';
import { getUserByEmail } from '@/app/(common)/_actions/auth/get-userinfo';
import { storeGoogleSignupRole } from '@/app/(common)/_actions/auth/google-role-server-action';
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { zodResolver } from '@hookform/resolvers/zod';
import { Eye, EyeOff, Lock, Mail, User, UserRoundCogIcon } from 'lucide-react';
import { signIn } from 'next-auth/react';
import { useRouter } from 'next/navigation';
import React, { useState, useTransition } from 'react';
import { useForm } from 'react-hook-form';
import { toast } from 'sonner';
import { Button } from '../../ui/button';
import FormError from '../../ui/form-error';
import GoogleButton from '../../ui/googleButton';
import { Input } from '../../ui/input';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../ui/select';
import SignIn from '../Auth/SigninForm';
import { type RegisterFormValues, registerSchema } from './register-schema';

// Remove the formSchema definition as it's now in register-schema.ts

export default function RegisterForm() {
  const [error, seterror] = useState<string>('');
  const [type, settype] = useState<'success' | 'fail' | null>();
  const [ispending, startTransition] = useTransition();
  const [showPassword, setShowPassword] = useState(false);
  const router = useRouter();
  const form = useForm<RegisterFormValues>({
    resolver: zodResolver(registerSchema),
    defaultValues: {
      email: '',
      password: '',
      name: '',
      role: undefined,
    },
  });

  const {
    formState: { errors },
  } = form;

  async function onSubmit(values: RegisterFormValues) {
    console.log('form is submitted values', values);
    const { email, password, name, role } = values;

    // Store the loading toast ID so we can dismiss it later
    const loadingToastId = toast.loading('Processing registration...');

    startTransition(async () => {
      try {
        // Check if the user already exists using the updated getUserByEmail function
        const userExistsResponse = await getUserByEmail(email);

        if (userExistsResponse.success && userExistsResponse.data?.exists) {
          // User exists, show error
          settype('fail');
          seterror('Email is already registered');
          toast.error('Registration failed', {
            description: 'Email is already registered',
          });
          toast.dismiss();
          return;
        }

        // If we reach here, the user doesn't exist, so we can proceed with registration
        settype('success');
        const signInResult = await signIn('credentials', {
          name,
          password,
          email,
          role,
          redirect: false,
        });

        if (signInResult?.error) {
          settype('fail');
          try {
            const errorData = JSON.parse(signInResult.error);
            switch (errorData.error) {
              case 'USER_NOT_FOUND':
                seterror('Registration failed: Account not found');
                toast.error('Registration error', {
                  description: 'Account not found',
                });
                break;
              case 'INVALID_PASSWORD':
                seterror('Registration failed: Password error');
                toast.error('Registration error', {
                  description: 'Password error',
                });
                break;
              case 'SERVER_ERROR':
                seterror('Registration failed: Please try again later');
                toast.error('Server error', {
                  description: 'Please try again later',
                });
                break;
              default:
                seterror(errorData.message || 'Registration failed');
                toast.error('Registration failed', {
                  description: errorData.message || 'Please try again',
                });
            }
          } catch {
            seterror('Registration failed');
            toast.error('Registration failed', {
              description: 'Please try again',
            });
          }
        } else {
          seterror('Account created successfully');
          toast.success('Welcome to GymNavigator!', {
            description: 'Your account has been created successfully',
          });
          router.refresh();
        }
      } catch (error) {
        settype('fail');
        seterror('An unexpected error occurred');
        toast.error('Registration error', {
          description: 'An unexpected error occurred',
        });
        console.error('Registration error:', error);
      } finally {
        // Always dismiss the loading toast when the operation completes
        toast.dismiss();
      }
    });
  }

  async function handleGoogleSubmit() {
    const selectedRole = form.getValues('role');
    console.log('role from the form', selectedRole);

    if (!selectedRole) {
      toast.error('Role selection required', {
        description: 'Please select a role before continuing with Google',
      });
      form.setError('role', {
        type: 'manual',
        message: 'Please select a role first',
      });
      return;
    }

    // Store the role in a server-side cookie
    await storeGoogleSignupRole(selectedRole);

    // Store the loading toast ID

    startTransition(async () => {
      try {
        // Pass the role as a state parameter to Google auth
        const result = await signIn('google', {
          redirect: true,
          callbackUrl: '/dashboard',
        });
        console.log('result from the google signin', result?.status);
      } catch (error) {
        toast.error('Google sign-in failed', {
          description: 'Could not connect to Google. Please try again.',
        });
        console.error('Google sign-in error:', error);
      } finally {
        toast.dismiss();
      }
    });
  }

  return (
    <div className="w-full max-w-md mx-auto p-8 rounded-xl shadow-xl">
      <div className="space-y-8">
        <Form {...form}>
          <form
            onSubmit={form.handleSubmit(onSubmit)}
            className="space-y-6"
            method="post"
            autoComplete="on"
            name="registration"
          >
            <FormField
              control={form.control}
              name="name"
              render={({ field }) => (
                <FormItem className="space-y-1">
                  <FormLabel className="text-sm font-medium text-gray-300">
                    <div className="flex items-center space-x-2">
                      <User
                        className={`w-4 h-4 ${errors.name ? 'text-destructive' : 'text-blue-400'}`}
                      />
                      <span>Username</span>
                    </div>
                  </FormLabel>
                  <FormControl>
                    <Input
                      placeholder="Username"
                      {...field}
                      disabled={ispending}
                      type="text"
                      className="bg-blue-950/30 border-blue-500/30 text-white placeholder:text-gray-400 focus:border-blue-500/50 focus:ring-blue-500/20 focus:ring-opacity-50 focus-visible:ring-blue-500/20 focus-visible:ring-offset-blue-900/20"
                      autoComplete="name"
                      id="name"
                      name="name"
                    />
                  </FormControl>
                  <FormMessage className="text-xs" />
                </FormItem>
              )}
            />

            <div className="grid grid-cols-2 gap-4">
              <FormField
                control={form.control}
                name="email"
                render={({ field }) => (
                  <FormItem className="space-y-1">
                    <FormLabel className="text-sm font-medium text-gray-300">
                      <div className="flex items-center space-x-2">
                        <Mail
                          className={`w-4 h-4 ${
                            errors.email ? 'text-destructive' : 'text-blue-400'
                          }`}
                        />
                        <span>Email</span>
                      </div>
                    </FormLabel>
                    <FormControl>
                      <Input
                        placeholder="your@email.com"
                        {...field}
                        type="email"
                        disabled={ispending}
                        className="bg-blue-950/30 border-blue-500/30 text-white placeholder:text-gray-400 focus:border-blue-500/50 focus:ring-blue-500/20 focus:ring-opacity-50 focus-visible:ring-blue-500/20 focus-visible:ring-offset-blue-900/20"
                        autoComplete="email"
                        id="email"
                        name="email"
                      />
                    </FormControl>
                    <FormMessage className="text-xs" />
                  </FormItem>
                )}
              />
              <FormField
                control={form.control}
                name="password"
                render={({ field }) => (
                  <FormItem className="space-y-1">
                    <FormLabel className="text-sm font-medium text-gray-300">
                      <div className="flex items-center space-x-2">
                        <Lock
                          className={`w-4 h-4 ${
                            errors.password ? 'text-destructive' : 'text-blue-400'
                          }`}
                        />
                        <span>Password</span>
                      </div>
                    </FormLabel>
                    <FormControl>
                      <div className="relative">
                        <Input
                          placeholder="••••••••"
                          {...field}
                          disabled={ispending}
                          type={showPassword ? 'text' : 'password'}
                          className="bg-blue-950/30 border-blue-500/30 text-white placeholder:text-gray-400 pr-10 focus:border-blue-500/50 focus:ring-blue-500/20 focus:ring-opacity-50 focus-visible:ring-blue-500/20 focus-visible:ring-offset-blue-900/20"
                          autoComplete="new-password"
                          id="password"
                          name="password"
                        />
                        <button
                          type="button"
                          className="absolute right-3 top-1/2 -translate-y-1/2 text-blue-400 hover:text-blue-300 transition-colors"
                          onClick={() => setShowPassword(!showPassword)}
                        >
                          {showPassword ? (
                            <EyeOff className="h-4 w-4" />
                          ) : (
                            <Eye className="h-4 w-4" />
                          )}
                        </button>
                      </div>
                    </FormControl>
                    <FormMessage className="text-xs" />
                  </FormItem>
                )}
              />
            </div>
            <FormField
              control={form.control}
              name="role"
              render={({ field }) => (
                <FormItem className="space-y-1 w-full mt-4">
                  <FormLabel className="text-sm font-medium text-gray-300">
                    <div className="flex items-center space-x-2">
                      <UserRoundCogIcon
                        className={`w-4 h-4 ${errors.role ? 'text-destructive' : 'text-blue-400'}`}
                      />
                      <span>Role</span>
                    </div>
                  </FormLabel>
                  <Select
                    onValueChange={(value) => field.onChange(value)}
                    value={field.value}
                    disabled={ispending}
                  >
                    <FormControl>
                      <SelectTrigger className="w-full bg-blue-950/30 border-blue-500/30 text-white focus:ring-blue-500/20 focus:ring-offset-blue-900/20">
                        <SelectValue placeholder="Select your Role" />
                      </SelectTrigger>
                    </FormControl>
                    <SelectContent className="z-50 bg-blue-900/80 backdrop-blur-md border-blue-500/30 text-white">
                      <SelectItem value="owner" className="hover:bg-blue-800/50">
                        Gym Owner
                      </SelectItem>
                      <SelectItem value="trainer" className="hover:bg-blue-800/50">
                        Trainer
                      </SelectItem>
                      <SelectItem value="client" className="hover:bg-blue-800/50">
                        Client
                      </SelectItem>
                    </SelectContent>
                  </Select>
                  <FormMessage className="text-xs" />
                </FormItem>
              )}
            />
            <Button
              type="submit"
              className="w-full font-semibold bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-lg relative z-10"
              disabled={ispending}
              size="lg"
            >
              {ispending ? (
                <div className="flex items-center space-x-2">
                  <span className="animate-spin">⚪</span>
                  <span>Registering...</span>
                </div>
              ) : (
                'Create Account'
              )}
            </Button>
          </form>
        </Form>

        {error && type ? (
          <FormError
            FormErrorProps={{
              message: error,
              type: type as 'success' | 'fail',
            }}
          />
        ) : null}
        <div className="relative">
          <div className="absolute inset-0 flex items-center">
            <span className="w-full border-t border-blue-500/30" />
          </div>
          <div className="relative flex justify-center text-xs uppercase">
            <span className="bg-blue-900/20 px-2 text-gray-300">Or continue with</span>
          </div>
        </div>
        <GoogleButton handleSubmit={handleGoogleSubmit} />
        <div className="text-center text-sm text-gray-300">
          Already have an account?{' '}
          <a href="/signin" className="hover:underline font-medium text-blue-400">
            Sign In
          </a>
        </div>
      </div>
    </div>
  );
}

```

# components/common/SelectRole.tsx

```tsx
"use client";
import SignupWithGoogle from "@/app/(common)/_actions/auth/signup-with-google";
import { updateSessionWithRole } from "@/app/(common)/_actions/session/updateSessionWithRole";
import type { Rolestype } from "@/app/types/next-auth";
import { Card, CardContent } from "@/components/ui/card";
import {
	Dialog,
	DialogContent,
	DialogHeader,
	DialogTitle,
} from "@/components/ui/dialog";
import type {
	ApiResult,
	GoogleSignupResponseType,
} from "@/lib/AxiosInstance/Signup/sign-up-client";
import { useSession } from "@/node_modules/next-auth/react";
import { AnimatePresence, m } from "framer-motion";
import { Loader2 } from "lucide-react";
import { useRouter } from "next/navigation";
import { useState } from "react";
const roles = [
	{
		title: "Gym Owner",
		description: "Manage your gym facilities and operations",
		value: "owner",
	},
	{
		title: "Trainer",
		description: "Manage your clients and training sessions",
		value: "trainer",
	},
	{
		title: "Client",
		description: "Access your sales plans and track progress",
		value: "client",
	},
];

export default function SelectRole() {
	const [isOpen, setIsOpen] = useState(true);
	const [loading, setLoading] = useState(false);
	const [selectedRole, setSelectedRole] = useState<string | null>(null);
	const { data: session, update } = useSession();
	const router = useRouter();

	const handleRoleSelect = async (role: string) => {
		setSelectedRole(role);
		setLoading(true);
		console.log("role is this ", role);
		try {
			if (session?.user?.name && session?.user?.email) {
				const response: ApiResult<GoogleSignupResponseType> =
					await SignupWithGoogle(
						session?.user?.name,
						session?.user?.email,
						role as "owner" | "trainer" | "client",
					);

				if (response?.data?.name && response.data?.role) {
					// @ts-ignore
					await updateSessionWithRole(response.data.role as Rolestype, update);
				}
			}

			router.push(`/dashboard/${role}`);
		} catch (error) {
			console.error("Error selecting role:", error);
		} finally {
			setLoading(false);
		}
	};

	return (
		<Dialog open={isOpen} onOpenChange={setIsOpen}>
			<DialogContent className="sm:max-w-[600px] bg-white text-gray-800 border-gray-200">
				<DialogHeader>
					<DialogTitle className="text-2xl font-bold text-center text-gray-900">
						Select Your Role
					</DialogTitle>
				</DialogHeader>

				<div className="grid gap-4 py-4">
					<AnimatePresence>
						{roles.map((role, index) => (
							<m.div
								key={role.value}
								initial={{ opacity: 0, y: 20 }}
								animate={{ opacity: 1, y: 0 }}
								transition={{ delay: index * 0.1 }}
							>
								<Card
									className={`cursor-pointer transition-all duration-300 hover:scale-105 
                    ${
											selectedRole === role.value
												? "border-blue-500 bg-blue-50"
												: "bg-gray-50 border-gray-200 hover:bg-gray-100"
										}
                    ${loading ? "pointer-events-none opacity-50" : ""}`}
									onClick={() => handleRoleSelect(role.value)}
								>
									<CardContent className="p-6">
										<h3 className="text-xl font-semibold mb-2 text-gray-900">
											{role.title}
										</h3>
										<p className="text-gray-600">{role.description}</p>
									</CardContent>
								</Card>
							</m.div>
						))}
					</AnimatePresence>
				</div>

				{loading && (
					<div className="flex items-center justify-center gap-2 text-gray-700">
						<Loader2 className="h-5 w-5 animate-spin" />
						<span>Setting up your account...</span>
					</div>
				)}
			</DialogContent>
		</Dialog>
	);
}

```

# components/common/Signin.tsx

```tsx
import SignInForm from './Auth/SigninForm';

export default function SignIn() {
  return (
    <>
      <SignInForm />
    </>
  );
}

```

# components/common/Signup.tsx

```tsx
import RegisterForm from './Registration Form/RegisterForm';

export default function SignUp() {
  return (
    <>
      <RegisterForm />
    </>
  );
}

```

# components/common/StatusCard.tsx

```tsx
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import type { LucideIcon } from 'lucide-react';

export interface StatusCardProps {
  title: string;
  value: number;
  icon: LucideIcon;
  gradient: 'blue' | 'green' | 'yellow' | 'red';
}

export interface StatusData {
  title: string;
  value: number;
  icon: LucideIcon;
}

const gradientStyles = {
  blue: 'from-blue-500 to-blue-600',
  green: 'from-green-500 to-green-600',
  yellow: 'from-yellow-500 to-yellow-600',
  red: 'from-red-500 to-red-600',
} as const;

export function StatusCard({ title, value, icon: Icon, gradient }: StatusCardProps) {
  return (
    <Card className={`bg-gradient-to-br ${gradientStyles[gradient]} text-white`}>
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
        <CardTitle className="text-sm font-medium">{title}</CardTitle>
        <Icon className="h-8 w-8 opacity-75 text-white" />
      </CardHeader>
      <CardContent>
        <div className="text-2xl font-bold">{value}</div>
      </CardContent>
    </Card>
  );
}

```

# components/common/Topbar/topbar.tsx

```tsx
'use client';

import type { MenuItem } from '@/app/dashboard/_components/menuItems';
import { cn } from '@/lib/utils';
import * as LucideIcons from 'lucide-react';
import type { LucideIcon } from 'lucide-react';
import { usePathname, useRouter } from 'next/navigation';

interface TopBarProps {
  menuItems: MenuItem[];
  basePath?: string;
}

export default function TopBar({ menuItems, basePath = '' }: TopBarProps) {
  const pathname = usePathname();
  const router = useRouter();

  // Find the active main menu item based on the current path
  const activeMenuItem = menuItems.find(
    (item) =>
      (item.link && pathname.includes(item.link)) ||
      item.subItems?.some((sub) => pathname.includes(sub.link)),
  );

  // Function to get the icon component from its name
  const getIconComponent = (iconName: string): LucideIcon => {
    return (
      (LucideIcons as unknown as Record<string, LucideIcon>)[iconName] || LucideIcons.HelpCircle
    );
  };

  // If there's no active menu item or the item has no subitems, don't render the top bar
  if (!activeMenuItem || !activeMenuItem.subItems || activeMenuItem.subItems.length === 0) {
    return null;
  }

  const handleSubItemClick = (link: string) => {
    router.push(link.startsWith('/') ? link : `${basePath}${link}`);
  };

  return (
    <div className="sticky top-0 z-20 bg-white border-b border-gray-200 shadow-sm">
      <div className="overflow-x-auto scrollbar-hide">
        <div className="flex px-2 py-2 space-x-1 whitespace-nowrap">
          {activeMenuItem.subItems.map((subItem) => {
            const Icon = subItem.iconName ? getIconComponent(subItem.iconName) : null;
            const isActive = pathname.includes(subItem.link);

            return (
              <button
                type="button"
                key={subItem.name}
                onClick={() => handleSubItemClick(subItem.link)}
                className={cn(
                  'flex items-center px-3 py-2 text-sm rounded-full transition-colors',
                  'hover:bg-gray-100',
                  isActive ? 'bg-blue-50 text-blue-600 font-medium' : 'text-gray-600',
                )}
              >
                {Icon && (
                  <Icon
                    className={cn('mr-1.5 h-4 w-4', isActive ? 'text-blue-600' : 'text-gray-500')}
                  />
                )}
                <span>{subItem.name}</span>
              </button>
            );
          })}
        </div>
      </div>
    </div>
  );
}

```

# components/common/UsersTables.tsx

```tsx

```

# components/extras/beams.tsx

```tsx
'use client';
import { cn } from '@/lib/utils';
import { m } from 'framer-motion';
import React from 'react';

export const BackgroundBeams = React.memo(({ className }: { className?: string }) => {
  const paths = [
    'M-380 -189C-380 -189 -312 216 152 343C616 470 684 875 684 875',
    'M-373 -197C-373 -197 -305 208 159 335C623 462 691 867 691 867',
    'M-366 -205C-366 -205 -298 200 166 327C630 454 698 859 698 859',
    'M-359 -213C-359 -213 -291 192 173 319C637 446 705 851 705 851',
    'M-352 -221C-352 -221 -284 184 180 311C644 438 712 843 712 843',
    'M-345 -229C-345 -229 -277 176 187 303C651 430 719 835 719 835',
    'M-338 -237C-338 -237 -270 168 194 295C658 422 726 827 726 827',
    'M-331 -245C-331 -245 -263 160 201 287C665 414 733 819 733 819',
    'M-324 -253C-324 -253 -256 152 208 279C672 406 740 811 740 811',
    'M-317 -261C-317 -261 -249 144 215 271C679 398 747 803 747 803',
    'M-310 -269C-310 -269 -242 136 222 263C686 390 754 795 754 795',
    'M-303 -277C-303 -277 -235 128 229 255C693 382 761 787 761 787',
    'M-296 -285C-296 -285 -228 120 236 247C700 374 768 779 768 779',
    'M-289 -293C-289 -293 -221 112 243 239C707 366 775 771 775 771',
    'M-282 -301C-282 -301 -214 104 250 231C714 358 782 763 782 763',
    'M-275 -309C-275 -309 -207 96 257 223C721 350 789 755 789 755',
    'M-268 -317C-268 -317 -200 88 264 215C728 342 796 747 796 747',
    'M-261 -325C-261 -325 -193 80 271 207C735 334 803 739 803 739',
    'M-254 -333C-254 -333 -186 72 278 199C742 326 810 731 810 731',
    'M-247 -341C-247 -341 -179 64 285 191C749 318 817 723 817 723',
    'M-240 -349C-240 -349 -172 56 292 183C756 310 824 715 824 715',
    'M-233 -357C-233 -357 -165 48 299 175C763 302 831 707 831 707',
    'M-226 -365C-226 -365 -158 40 306 167C770 294 838 699 838 699',
    'M-219 -373C-219 -373 -151 32 313 159C777 286 845 691 845 691',
    'M-212 -381C-212 -381 -144 24 320 151C784 278 852 683 852 683',
    'M-205 -389C-205 -389 -137 16 327 143C791 270 859 675 859 675',
    'M-198 -397C-198 -397 -130 8 334 135C798 262 866 667 866 667',
    'M-191 -405C-191 -405 -123 0 341 127C805 254 873 659 873 659',
    'M-184 -413C-184 -413 -116 -8 348 119C812 246 880 651 880 651',
    'M-177 -421C-177 -421 -109 -16 355 111C819 238 887 643 887 643',
    'M-170 -429C-170 -429 -102 -24 362 103C826 230 894 635 894 635',
    'M-163 -437C-163 -437 -95 -32 369 95C833 222 901 627 901 627',
    'M-156 -445C-156 -445 -88 -40 376 87C840 214 908 619 908 619',
    'M-149 -453C-149 -453 -81 -48 383 79C847 206 915 611 915 611',
    'M-142 -461C-142 -461 -74 -56 390 71C854 198 922 603 922 603',
    'M-135 -469C-135 -469 -67 -64 397 63C861 190 929 595 929 595',
    'M-128 -477C-128 -477 -60 -72 404 55C868 182 936 587 936 587',
    'M-121 -485C-121 -485 -53 -80 411 47C875 174 943 579 943 579',
    'M-114 -493C-114 -493 -46 -88 418 39C882 166 950 571 950 571',
    'M-107 -501C-107 -501 -39 -96 425 31C889 158 957 563 957 563',
    'M-100 -509C-100 -509 -32 -104 432 23C896 150 964 555 964 555',
    'M-93 -517C-93 -517 -25 -112 439 15C903 142 971 547 971 547',
    'M-86 -525C-86 -525 -18 -120 446 7C910 134 978 539 978 539',
    'M-79 -533C-79 -533 -11 -128 453 -1C917 126 985 531 985 531',
    'M-72 -541C-72 -541 -4 -136 460 -9C924 118 992 523 992 523',
    'M-65 -549C-65 -549 3 -144 467 -17C931 110 999 515 999 515',
    'M-58 -557C-58 -557 10 -152 474 -25C938 102 1006 507 1006 507',
    'M-51 -565C-51 -565 17 -160 481 -33C945 94 1013 499 1013 499',
    'M-44 -573C-44 -573 24 -168 488 -41C952 86 1020 491 1020 491',
    'M-37 -581C-37 -581 31 -176 495 -49C959 78 1027 483 1027 483',
  ];
  return (
    <div
      className={cn(
        'absolute  h-full w-full inset-0  [mask-size:40px] [mask-repeat:no-repeat] flex items-center justify-center',
        className,
      )}
    >
      <svg
        className=" z-0 h-full w-full pointer-events-none absolute "
        width="100%"
        height="100%"
        viewBox="0 0 696 316"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
      >
        {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}
        <path
          d="M-380 -189C-380 -189 -312 216 152 343C616 470 684 875 684 875M-373 -197C-373 -197 -305 208 159 335C623 462 691 867 691 867M-366 -205C-366 -205 -298 200 166 327C630 454 698 859 698 859M-359 -213C-359 -213 -291 192 173 319C637 446 705 851 705 851M-352 -221C-352 -221 -284 184 180 311C644 438 712 843 712 843M-345 -229C-345 -229 -277 176 187 303C651 430 719 835 719 835M-338 -237C-338 -237 -270 168 194 295C658 422 726 827 726 827M-331 -245C-331 -245 -263 160 201 287C665 414 733 819 733 819M-324 -253C-324 -253 -256 152 208 279C672 406 740 811 740 811M-317 -261C-317 -261 -249 144 215 271C679 398 747 803 747 803M-310 -269C-310 -269 -242 136 222 263C686 390 754 795 754 795M-303 -277C-303 -277 -235 128 229 255C693 382 761 787 761 787M-296 -285C-296 -285 -228 120 236 247C700 374 768 779 768 779M-289 -293C-289 -293 -221 112 243 239C707 366 775 771 775 771M-282 -301C-282 -301 -214 104 250 231C714 358 782 763 782 763M-275 -309C-275 -309 -207 96 257 223C721 350 789 755 789 755M-268 -317C-268 -317 -200 88 264 215C728 342 796 747 796 747M-261 -325C-261 -325 -193 80 271 207C735 334 803 739 803 739M-254 -333C-254 -333 -186 72 278 199C742 326 810 731 810 731M-247 -341C-247 -341 -179 64 285 191C749 318 817 723 817 723M-240 -349C-240 -349 -172 56 292 183C756 310 824 715 824 715M-233 -357C-233 -357 -165 48 299 175C763 302 831 707 831 707M-226 -365C-226 -365 -158 40 306 167C770 294 838 699 838 699M-219 -373C-219 -373 -151 32 313 159C777 286 845 691 845 691M-212 -381C-212 -381 -144 24 320 151C784 278 852 683 852 683M-205 -389C-205 -389 -137 16 327 143C791 270 859 675 859 675M-198 -397C-198 -397 -130 8 334 135C798 262 866 667 866 667M-191 -405C-191 -405 -123 0 341 127C805 254 873 659 873 659M-184 -413C-184 -413 -116 -8 348 119C812 246 880 651 880 651M-177 -421C-177 -421 -109 -16 355 111C819 238 887 643 887 643M-170 -429C-170 -429 -102 -24 362 103C826 230 894 635 894 635M-163 -437C-163 -437 -95 -32 369 95C833 222 901 627 901 627M-156 -445C-156 -445 -88 -40 376 87C840 214 908 619 908 619M-149 -453C-149 -453 -81 -48 383 79C847 206 915 611 915 611M-142 -461C-142 -461 -74 -56 390 71C854 198 922 603 922 603M-135 -469C-135 -469 -67 -64 397 63C861 190 929 595 929 595M-128 -477C-128 -477 -60 -72 404 55C868 182 936 587 936 587M-121 -485C-121 -485 -53 -80 411 47C875 174 943 579 943 579M-114 -493C-114 -493 -46 -88 418 39C882 166 950 571 950 571M-107 -501C-107 -501 -39 -96 425 31C889 158 957 563 957 563M-100 -509C-100 -509 -32 -104 432 23C896 150 964 555 964 555M-93 -517C-93 -517 -25 -112 439 15C903 142 971 547 971 547M-86 -525C-86 -525 -18 -120 446 7C910 134 978 539 978 539M-79 -533C-79 -533 -11 -128 453 -1C917 126 985 531 985 531M-72 -541C-72 -541 -4 -136 460 -9C924 118 992 523 992 523M-65 -549C-65 -549 3 -144 467 -17C931 110 999 515 999 515M-58 -557C-58 -557 10 -152 474 -25C938 102 1006 507 1006 507M-51 -565C-51 -565 17 -160 481 -33C945 94 1013 499 1013 499M-44 -573C-44 -573 24 -168 488 -41C952 86 1020 491 1020 491M-37 -581C-37 -581 31 -176 495 -49C959 78 1027 483 1027 483M-30 -589C-30 -589 38 -184 502 -57C966 70 1034 475 1034 475M-23 -597C-23 -597 45 -192 509 -65C973 62 1041 467 1041 467M-16 -605C-16 -605 52 -200 516 -73C980 54 1048 459 1048 459M-9 -613C-9 -613 59 -208 523 -81C987 46 1055 451 1055 451M-2 -621C-2 -621 66 -216 530 -89C994 38 1062 443 1062 443M5 -629C5 -629 73 -224 537 -97C1001 30 1069 435 1069 435M12 -637C12 -637 80 -232 544 -105C1008 22 1076 427 1076 427M19 -645C19 -645 87 -240 551 -113C1015 14 1083 419 1083 419"
          stroke="url(#paint0_radial_242_278)"
          strokeOpacity="0.05"
          strokeWidth="0.5"
        ></path>

        {paths.map((path, index) => (
          // biome-ignore lint/style/useSelfClosingElements: <explanation>
          <m.path
            key={`path-${index as number}`}
            d={path}
            stroke={`url(#linearGradient-${index})`}
            strokeOpacity="0.4"
            strokeWidth="0.5"
          ></m.path>
        ))}
        <defs>
          {paths.map((_, index) => (
            <m.linearGradient
              id={`linearGradient-${index}`}
              key={`gradient-${index as number}`}
              initial={{
                x1: '0%',
                x2: '0%',
                y1: '0%',
                y2: '0%',
              }}
              animate={{
                x1: ['0%', '100%'],
                x2: ['0%', '95%'],
                y1: ['0%', '100%'],
                y2: ['0%', `${93 + Math.random() * 8}%`],
              }}
              transition={{
                duration: Math.random() * 10 + 10,
                ease: 'easeInOut',
                repeat: Number.POSITIVE_INFINITY,
                delay: Math.random() * 10,
              }}
            >
              <stop stopColor="#18CCFC" stopOpacity="0" />
              <stop stopColor="#18CCFC" />
              <stop offset="32.5%" stopColor="#6344F5" />
              <stop offset="100%" stopColor="#AE48FF" stopOpacity="0" />
            </m.linearGradient>
          ))}

          <radialGradient
            id="paint0_radial_242_278"
            cx="0"
            cy="0"
            r="1"
            gradientUnits="userSpaceOnUse"
            gradientTransform="translate(352 34) rotate(90) scale(555 1560.62)"
          >
            <stop offset="0.0666667" stopColor="var(--neutral-300)" />
            <stop offset="0.243243" stopColor="var(--neutral-300)" />
            <stop offset="0.43594" stopColor="white" stopOpacity="0" />
          </radialGradient>
        </defs>
      </svg>
    </div>
  );
});

BackgroundBeams.displayName = 'BackgroundBeams';

```

# components/extras/button.tsx

```tsx
'use client';
import { signIn, signOut } from '@/node_modules/next-auth/react';
import React from 'react';

export default function Button() {
  return (
    <>
      <button
        type="button"
        onClick={() => {
          signIn();
        }}
      >
        {' '}
        Signin
      </button>
      <button
        type="button"
        onClick={() => {
          signOut();
        }}
      >
        SignOut
      </button>
    </>
  );
}

```

# components/extras/EmailTemplate.tsx

```tsx
import type * as React from 'react';

interface EmailTemplateProps {
  firstName: string;
  verificationCode: string;
}

export const EmailTemplate: React.FC<Readonly<EmailTemplateProps>> = ({
  firstName,
  verificationCode,
}) => (
  <div
    style={{
      fontFamily: '"Helvetica Neue", Helvetica, Arial, sans-serif',
      lineHeight: '1.6',
      color: '#333333',
      maxWidth: '600px',
      margin: '0 auto',
      padding: '20px',
      backgroundColor: '#f4f4f4',
    }}
  >
    <table width="100%" cellPadding="0" cellSpacing="0" style={{ borderCollapse: 'collapse' }}>
      <tr>
        <td
          style={{
            backgroundColor: '#2c3e50',
            padding: '30px 20px',
            textAlign: 'center' as const,
          }}
        >
          <h1
            style={{
              color: '#ffffff',
              fontSize: '28px',
              margin: '0',
              textTransform: 'uppercase' as const,
              letterSpacing: '2px',
            }}
          >
            GymNavigator
          </h1>
        </td>
      </tr>
      <tr>
        <td
          style={{
            backgroundColor: '#ffffff',
            padding: '40px 30px',
            borderRadius: '0 0 4px 4px',
            boxShadow: '0 2px 4px rgba(0,0,0,0.1)',
          }}
        >
          <h2
            style={{
              color: '#2c3e50',
              fontSize: '24px',
              margin: '0 0 20px 0',
            }}
          >
            Welcome, {firstName}!
          </h2>
          <p
            style={{
              margin: '0 0 20px 0',
              fontSize: '16px',
            }}
          >
            Thank you for joining GymNavigator. We&apos;re excited to have you on board! Here&apos;s
            your verification code:
          </p>
          <div
            style={{
              backgroundColor: '#e8f0fe',
              border: '2px dashed #4a90e2',
              borderRadius: '4px',
              padding: '15px',
              margin: '30px 0',
              textAlign: 'center' as const,
            }}
          >
            <span
              style={{
                fontSize: '32px',
                fontWeight: 'bold',
                color: '#4a90e2',
                letterSpacing: '5px',
              }}
            >
              {verificationCode}
            </span>
          </div>
          <p
            style={{
              margin: '0 0 20px 0',
              fontSize: '16px',
            }}
          >
            Please use this code to verify your account and start your fitness journey with
            GymNavigator.
          </p>
          <div style={{ textAlign: 'center' as const, margin: '40px 0 20px' }}>
            <a
              href="https://GymNavigator.com/verify"
              style={{
                backgroundColor: '#27ae60',
                color: '#ffffff',
                padding: '14px 28px',
                textDecoration: 'none',
                borderRadius: '4px',
                fontWeight: 'bold',
                display: 'inline-block',
                fontSize: '16px',
                textTransform: 'uppercase' as const,
                letterSpacing: '1px',
                transition: 'background-color 0.3s ease',
              }}
            >
              Verify Your Account
            </a>
          </div>
          <p
            style={{
              margin: '20px 0 0 0',
              fontSize: '14px',
              color: '#666666',
            }}
          >
            If you didn&apos;t request this code, please ignore this email or contact our support
            team if you have any concerns.
          </p>
        </td>
      </tr>
      <tr>
        <td
          style={{
            padding: '20px',
            textAlign: 'center' as const,
            fontSize: '14px',
            color: '#666666',
          }}
        >
          <p style={{ margin: '0 0 10px 0' }}>© 2023 GymNavigator. All rights reserved.</p>
          <p style={{ margin: '0' }}>
            You&apos;re receiving this email because you signed up for GymNavigator.
          </p>
        </td>
      </tr>
    </table>
  </div>
);

```

# components/extras/ErrorScreen.tsx

```tsx
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { AlertCircle } from 'lucide-react';

interface ErrorScreenProps {
  error: string;
}

export default function ErrorScreen({ error }: ErrorScreenProps) {
  return (
    <div className="flex items-center justify-center h-[80vh]">
      <Alert variant="destructive" className="max-w-md">
        <AlertCircle className="h-4 w-4" />
        <AlertTitle>Error</AlertTitle>
        <AlertDescription>{error}</AlertDescription>
      </Alert>
    </div>
  );
}

```

# components/gym-owner/AddTrainerSA.ts

```ts
export type ShiftType = 'morning' | 'evening';
export interface AddTrainerRequest {
  name: string;
  shift: ShiftType;
  rating: number;
  image: string | File | undefined;
}
export interface UpdateTrainerRequest {
  id: number;
  shift: ShiftType;
  rating: number;
  image: string | File | undefined;
}
// Response Interfaces
export interface AddTrainerResponse {
  msg: string;
  trainer: AddTrainerTrainer;
}
export interface UpdateTrainerResponse {
  success: boolean;
  msg: string;
  trainer: UpdateTrainerTrainer;
}
export interface AddTrainerTrainer {
  id: number;
  name: string;
  email: string;
  password: string;
  gym_id: number;
  shift: string | null;
  rating: number | null;
  image: string | null;
}
export interface UpdateTrainerTrainer {
  id: number;
  name: string;
  email: string;
  shift: 'MORNING' | 'EVENING';
  image: string;
  rating: number;
  gym_id: number;
}
// Helper function to handle API requests
// app/actions/AddTrainerSA.ts
// Helper function to handle API requests
const handleApiRequest = async <T>(endpoint: string, method: string, data: unknown): Promise<T> => {
  try {
    const response = await fetch(`${process.env.NEXT_PUBLIC_BACKEND_URL}${endpoint}`, {
      method,
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });
    const result = await response.json();
    if (!response.ok) {
      throw new Error(result.msg || 'An error occurred during the request.');
    }
    return result;
  } catch (error) {
    throw new Error(error instanceof Error ? error.message : 'An unknown error occurred.');
  }
};
/**
 * Adds a new trainer by sending a POST request to the backend API.
 *
 * @param data - The trainer data to be added.
 * @returns A promise resolving to the API response.
 */
export const addTrainer = async (data: AddTrainerRequest): Promise<AddTrainerResponse> => {
  // Handle image upload if necessary
  let imageData: string | undefined = undefined;
  if (data.image instanceof File) {
    // Implement actual image upload logic here
    // For example, upload to Cloudinary and get the image URL
    // Placeholder: Replace with actual upload logic
    imageData = 'uploaded_image_url';
  } else if (typeof data.image === 'string') {
    imageData = data.image;
  }
  const payload = {
    name: data.name,
    shift: data.shift,
    rating: data.rating,
    image: imageData,
  };
  return await handleApiRequest<AddTrainerResponse>('/addtrainer', 'POST', payload);
};
/**
 * Updates an existing trainer by sending a PUT request to the backend API.
 *
 * @param data - The trainer data to be updated.
 * @returns A promise resolving to the API response.
 */
export const updateTrainer = async (data: UpdateTrainerRequest): Promise<UpdateTrainerResponse> => {
  // Handle image upload if necessary
  let imageData: string | undefined = undefined;
  if (data.image instanceof File) {
    // Implement actual image upload logic here
    // For example, upload to Cloudinary and get the image URL
    // Placeholder: Replace with actual upload logic
    imageData = 'uploaded_image_url';
  } else if (typeof data.image === 'string') {
    imageData = data.image;
  }
  const payload = {
    shift: data.shift,
    rating: data.rating,
    image: imageData,
    trainerId: data.id,
  };
  return await handleApiRequest<UpdateTrainerResponse>('/addtrainerdetails', 'PUT', payload);
};

```

# components/gym-owner/EditTrainers.tsx

```tsx
'use client';

import { Button } from '@/components/ui/button';
import { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Star, Upload, User } from 'lucide-react';
import Image from 'next/image';
import type React from 'react';
import { useEffect, useState } from 'react';
import Swal from 'sweetalert2';
import Loader from '../Skeltons/loaders';
import { addTrainer, updateTrainer } from './AddTrainerSA';
import type { AddTrainerRequest, ShiftType, UpdateTrainerRequest } from './AddTrainerSA';
interface AddTrainerProps {
  addTrainerProps: {
    id?: number;
    name?: string;
    shift?: ShiftType;
    image?: string;
    rating?: number;
  };
}

const ShiftArray = [
  {
    name: 'Morning',
    label: 'morning',
  },
  {
    name: 'Evening',
    label: 'evening',
  },
];

export default function AddTrainer({ addTrainerProps }: AddTrainerProps) {
  const [name, setName] = useState<string>(addTrainerProps.name || '');
  const [image, setImage] = useState<File | null>(null);
  const [imagePreview, setImagePreview] = useState<string | null>(
    typeof addTrainerProps.image === 'string' ? addTrainerProps.image : null,
  );
  const [rating, setRating] = useState<number>(addTrainerProps.rating || 0);
  const [shift, setShift] = useState<ShiftType>(addTrainerProps.shift || 'morning');
  const [imageError, setImageError] = useState<string>('');
  const [isLoading, setLoading] = useState<boolean>(false);
  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      setImage(file);
      setImageError('');

      const reader = new FileReader();
      reader.onloadend = () => {
        setImagePreview(reader.result as string);
      };
      reader.readAsDataURL(file);
    }
  };

  useEffect(() => {
    if (addTrainerProps) {
      Swal.fire({
        title: 'Warning',
        text: 'Do you want to edit the trainer details?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes',
      });
    }
  }, [addTrainerProps]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    setImageError('');

    const isEditing = !!addTrainerProps.id;

    if (!isEditing && !name.trim()) {
      Swal.fire({
        title: 'Error!',
        text: "Please enter the trainer's name.",
        icon: 'error',
        confirmButtonText: 'OK',
      });
      return;
    }

    if (!image && !imagePreview && !isEditing) {
      setImageError('Please upload an image.');
      return;
    }

    let imageUrl: string | undefined = undefined;
    try {
      setLoading(true);
      if (image) {
        const formData = new FormData();
        formData.append('image', image);

        const response = await fetch('/api/uploadimage', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ image: imagePreview }),
        });

        const result = await response.json();

        if (response.ok) {
          imageUrl = result.url;
        } else {
          throw new Error(result.error || 'Failed to upload image.');
        }
      } else if (imagePreview) {
        imageUrl = imagePreview;
      }

      const requestData = isEditing
        ? {
            id: addTrainerProps.id,
            shift,
            rating,
            image: imageUrl,
          }
        : {
            name,
            shift,
            rating,
            image: imageUrl,
          };

      const responseData = isEditing
        ? await updateTrainer(requestData as UpdateTrainerRequest)
        : await addTrainer(requestData as AddTrainerRequest);

      if ((isEditing && responseData.trainer) || (!isEditing && responseData.trainer)) {
        setLoading(false);
        Swal.fire({
          title: isEditing ? 'Updated!' : 'Added!',
          text: isEditing ? 'Trainer details have been updated.' : 'Trainer has been added.',
          icon: 'success',
          confirmButtonText: 'OK',
        }).then(() => {});
        // Optionally reset the form or redirect
      } else {
        throw new Error(responseData.msg || 'An error occurred.');
      }
    } catch (error) {
      Swal.fire({
        title: 'Error!',
        text: error instanceof Error ? error.message : 'An unexpected error occurred.',
        icon: 'error',
        confirmButtonText: 'OK',
      });
    }
  };
  if (isLoading) {
    return (
      <>
        <div className="w-full h-screen flex justify-center items-center">
          <Loader />
        </div>
      </>
    );
  }

  return (
    <Card className="w-full h-full">
      <CardHeader>
        <CardTitle className="text-2xl font-bold text-center">
          {addTrainerProps.id ? 'Edit Trainer' : 'Add Trainer'}
        </CardTitle>
      </CardHeader>
      <form onSubmit={handleSubmit}>
        <CardContent className="space-y-4">
          <div className="flex justify-center">
            <div className="w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden">
              {imagePreview ? (
                <Image
                  src={imagePreview}
                  alt="Trainer"
                  width={128}
                  height={128}
                  className="w-full h-full object-cover"
                />
              ) : (
                <User className="w-16 h-16 text-gray-400" />
              )}
            </div>
          </div>

          {
            <div>
              <Label htmlFor="name">Name</Label>
              <Input
                id="name"
                name="name"
                value={name}
                onChange={(e) => setName(e.target.value)}
                disabled={!!addTrainerProps.name}
                placeholder="Enter trainer's name"
              />
            </div>
          }

          <div>
            <Label htmlFor="shift">Shift</Label>
            <select
              id="shift"
              name="shift"
              value={shift}
              onChange={(e) => setShift(e.target.value as ShiftType)}
              className="block w-full text-sm bg-white border text-gray-700 py-2 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200"
            >
              <option value="" hidden>
                Select Shift
              </option>
              {ShiftArray.map((shiftItem, index) => (
                <option key={index as number} value={shiftItem.label}>
                  {shiftItem.name}
                </option>
              ))}
            </select>
          </div>

          <div>
            <Label htmlFor="image">Trainer Image</Label>
            <div className="flex items-center space-x-2">
              <Input
                id="image"
                name="image"
                type="file"
                onChange={handleImageChange}
                accept="image/*"
                className="hidden"
              />
              <Button
                type="button"
                variant="outline"
                onClick={() => document.getElementById('image')?.click()}
              >
                <Upload className="w-4 h-4 mr-2" />
                Upload Image
              </Button>
              <span className="text-sm text-gray-500">
                {image ? image.name : imagePreview ? 'Image Selected' : 'No file chosen'}
              </span>
            </div>
            {imageError && <p className="text-red-500 text-sm mt-1">{imageError}</p>}
          </div>

          <div>
            <Label>Initial Rating</Label>
            <div className="flex items-center space-x-1">
              {[1, 2, 3, 4, 5].map((star) => (
                <Star
                  key={star}
                  className={`w-6 h-6 cursor-pointer ${
                    star <= rating ? 'text-yellow-400 fill-current' : 'text-gray-300'
                  }`}
                  onClick={() => setRating(star)}
                />
              ))}
            </div>
          </div>
        </CardContent>
        <CardFooter>
          <Button type="submit">{addTrainerProps.id ? 'Update Trainer' : 'Add Trainer'}</Button>
        </CardFooter>
      </form>
    </Card>
  );
}

```

# components/gym-owner/QrCode.tsx

```tsx
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { QRCodeSVG } from 'qrcode.react';
import type React from 'react';

interface GymQRCodeOnboardingProps {
  qrdata: string;
  title: string;
  subtitle: string; // Add subtitle prop
}

const GymQRCode: React.FC<GymQRCodeOnboardingProps> = ({ qrdata, title, subtitle }) => {
  return (
    <Card className="w-full max-w-md mx-auto bg-white shadow-lg rounded-lg overflow-hidden min-h-[90vh] md:min-h-0">
      <CardHeader className="bg-gradient-to-r from-blue-600 to-blue-800 text-white text-center py-8">
        <CardTitle className="text-3xl font-bold">{title}</CardTitle>
        <CardDescription className="text-blue-100 mt-3 text-xl font-semibold tracking-[0.5px]">
          Welcome to your fitness journey
        </CardDescription>
      </CardHeader>

      <CardContent className="flex flex-col items-center justify-center p-8 md:p-12">
        <QRCodeSVG
          value={qrdata}
          size={300}
          bgColor={'#ffffff'}
          fgColor={'#000000'}
          level={'M'}
          includeMargin={true}
        />

        <div className="space-y-4 w-full max-w-sm text-center">
          <p className="text-lg text-gray-700 font-medium px-4">
            {subtitle} {/* Use the passed subtitle */}
          </p>

          <div className="pt-4 border-t border-gray-200">
            <p className="text-sm text-gray-500">Having trouble? Contact our support team</p>
          </div>
        </div>
      </CardContent>
    </Card>
  );
};

export default GymQRCode;

```

# components/particles/ParticlesContainer.tsx

```tsx

```

# components/Skeltons/loaders.tsx

```tsx
'use client';
import GymImage from '@/app/assests/gymd.webp';
import Image from 'next/image';
import React from 'react';

interface LoaderProps {
  size?: number;
  glowColor?: string;
  glowWidth?: number;
  animationDuration?: number;
}

export default function Loader({
  size = 200,
  glowColor = '#3b82f6',
  glowWidth = 6,
  animationDuration = 1,
}: LoaderProps) {
  return (
    <div className="flex items-center justify-center w-full h-full">
      <div
        className="relative"
        style={{
          width: size,
          height: size,
        }}
      >
        {/* Circular container for the logo */}
        <div className="absolute inset-0 rounded-full shadow-lg overflow-hidden z-10">
          <Image
            src={GymImage}
            alt="GymNavigator Logo"
            width={size}
            height={size}
            className="object-contain"
          />
        </div>

        {/* Rotating border light effect */}
        <div
          className="absolute inset-0 rounded-full"
          style={{
            border: `${glowWidth}px solid transparent`,
            background: `linear-gradient(white, white) padding-box, 
                         conic-gradient(
                           from 0deg,
                           ${glowColor} 0deg 20deg,
                           transparent 20deg 340deg,
                           ${glowColor} 340deg 360deg
                         ) border-box`,
            animation: `spin ${animationDuration}s linear infinite`,
            boxShadow: `0 0 20px ${glowColor}, 0 0 40px ${glowColor}`,
          }}
        />
      </div>

      {/* Optional loading text */}
      <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white font-bold">
        Loading...
      </div>

      {/* CSS Animations */}
      <style jsx>{`
        @keyframes spin {
          from {
            transform: rotate(0deg);
          }
          to {
            transform: rotate(360deg);
          }
        }
      `}</style>
    </div>
  );
}

```

# components/Skeltons/UserTabelsSkelton.tsx

```tsx
import { ChevronDown, UserCheck, UserX, Users } from 'lucide-react';
import React from 'react';

const STAT_CARDS = [
  { id: 'total-users', icon: Users },
  { id: 'active-users', icon: UserCheck },
  { id: 'inactive-users', icon: UserX },
];

const SKELETON_ROWS = Array.from({ length: 10 }, (_, i) => ({
  id: `skeleton-row-${i}`,
}));

export default function UserTrainerTableSkeleton() {
  return (
    <div className="container mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6 text-gray-800 text-center">User-Trainer Assignment</h1>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        {STAT_CARDS.map(({ id, icon: Icon }) => (
          <div key={id} className="bg-white p-4 rounded-lg shadow-md">
            <div className="flex items-center justify-between">
              <div>
                <div className="h-4 w-20 bg-gray-200 rounded mb-2" />
                <div className="h-8 w-16 bg-gray-200 rounded" />
              </div>
              <Icon className="h-10 w-10 text-gray-300" />
            </div>
          </div>
        ))}
      </div>

      <div className="bg-white shadow-md rounded-lg overflow-hidden">
        <table className="min-w-full table-auto">
          <thead className="bg-gray-200">
            <tr>
              <th className="px-4 py-2 text-left text-gray-600">User Name</th>
              <th className="px-4 py-2 text-left text-gray-600">Gender</th>
              <th className="px-4 py-2 text-left text-gray-600">Goal</th>
              <th className="px-4 py-2 text-left text-gray-600">Assign Trainer</th>
            </tr>
          </thead>
          <tbody>
            {SKELETON_ROWS.map(({ id }) => (
              <tr key={id} className="border-b border-gray-200 hover:bg-gray-50">
                <td className="px-4 py-2">
                  <div className="h-4 w-32 bg-gray-200 rounded" />
                </td>
                <td className="px-4 py-2">
                  <div className="h-4 w-20 bg-gray-200 rounded" />
                </td>
                <td className="px-4 py-2">
                  <div className="h-4 w-24 bg-gray-200 rounded" />
                </td>
                <td className="px-4 py-2">
                  <div className="relative">
                    <div className="h-10 w-full bg-gray-200 rounded" />
                    <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-300">
                      <ChevronDown size={20} />
                    </div>
                  </div>
                </td>
              </tr>
            ))}
          </tbody>
        </table>

        {/* mobile view   */}
      </div>
    </div>
  );
}

```

# components/Table/table.types.ts

```ts
import type { ColumnDef, ColumnFiltersState, SortingState, Table } from '@tanstack/react-table';

interface BaseData {
  id: string | number;
}

export interface DropdownOption {
  id: number | string;
  label: string;
  value: string;
}

export interface ColumnDropdownConfig {
  columnId: string;
  options: DropdownOption[];
  onSelect: (rowId: number | string, value: string) => void;
}

export interface DataTableProps<TData extends BaseData> {
  data: TData[];
  columns: ColumnDef<TData>[];
  filterColumn?: string;
  selectable?: boolean;
  dropdownConfig?: ColumnDropdownConfig;
}

export interface DataCardProps<TData> {
  data: TData[];
  renderCard: (item: TData) => React.ReactNode;
  statusColors?: Record<string, string>;
  dropdownConfig?: ColumnDropdownConfig;
}

export interface TableUIProps<TData> {
  table: Table<TData>;
  filterColumn?: string;
  columns: ColumnDef<TData>[];
}

export interface TableState {
  sorting: SortingState;
  columnFilters: ColumnFiltersState;
  columnVisibility: Record<string, boolean>;
  rowSelection: Record<string, boolean>;
}

```

# components/Table/TableUi.tsx

```tsx
import { Button } from '@/components/ui/button';
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table';
import { flexRender } from '@tanstack/react-table';
import type { TableUIProps } from './table.types';
export function TableUI<TData>({ table, columns }: TableUIProps<TData>) {
  return (
    <div className="w-full">
      <div className="rounded-md border">
        <Table>
          <TableHeader>
            {table.getHeaderGroups().map((headerGroup) => (
              <TableRow key={headerGroup.id}>
                {headerGroup.headers.map((header) => (
                  <TableHead key={header.id}>
                    {header.isPlaceholder
                      ? null
                      : flexRender(header.column.columnDef.header, header.getContext())}
                  </TableHead>
                ))}
              </TableRow>
            ))}
          </TableHeader>
          <TableBody>
            {table.getRowModel().rows?.length ? (
              table.getRowModel().rows.map((row) => (
                <TableRow key={row.id} data-state={row.getIsSelected() && 'selected'}>
                  {row.getVisibleCells().map((cell) => (
                    <TableCell key={cell.id}>
                      {flexRender(cell.column.columnDef.cell, cell.getContext())}
                    </TableCell>
                  ))}
                </TableRow>
              ))
            ) : (
              <TableRow>
                <TableCell colSpan={columns.length} className="h-24 text-center">
                  No results.
                </TableCell>
              </TableRow>
            )}
          </TableBody>
        </Table>
      </div>
      <div className="flex items-center justify-end space-x-2 py-4">
        <div className="space-x-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => table.previousPage()}
            disabled={!table.getCanPreviousPage()}
          >
            Previous
          </Button>
          <Button
            variant="outline"
            size="sm"
            onClick={() => table.nextPage()}
            disabled={!table.getCanNextPage()}
          >
            Next
          </Button>
        </div>
      </div>
    </div>
  );
}

```

# components/Table/UserCard.tsx

```tsx
import { Card } from '@/components/ui/card';
import type { DataCardProps } from './table.types';

export function DataCard<TData>({ data, renderCard }: DataCardProps<TData>) {
  return (
    <div className="space-y-4">
      {data.map((item, index) => (
        <Card key={index as number}>{renderCard(item)}</Card>
      ))}
    </div>
  );
}

```

# components/Table/UsersTable.tsx

```tsx
'use client';

import {
  type ColumnFiltersState,
  type Row,
  type SortingState,
  getCoreRowModel,
  getFilteredRowModel,
  getPaginationRowModel,
  getSortedRowModel,
  useReactTable,
} from '@tanstack/react-table';
import { useMemo, useState } from 'react';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../ui/select';
import { TableUI } from './TableUi';
import type { DataTableProps } from './table.types';

// Add interface for base data type
interface BaseData {
  id: string | number;
}

export function DataTable<TData extends BaseData>({
  data,
  columns,
  filterColumn,
  selectable = false,
  dropdownConfig,
}: DataTableProps<TData>) {
  const [sorting, setSorting] = useState<SortingState>([]);
  const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([]);
  const [columnVisibility, setColumnVisibility] = useState({});
  const [rowSelection, setRowSelection] = useState({});

  const enhancedColumns = useMemo(() => {
    if (!dropdownConfig) return columns;

    return columns.map((column) => {
      if (column.id === dropdownConfig.columnId) {
        return {
          ...column,
          cell: ({ row }: { row: Row<TData> }) => (
            <Select
              value={row.getValue(dropdownConfig.columnId)}
              onValueChange={(value) => dropdownConfig.onSelect(row.original.id, value)}
            >
              <SelectTrigger>
                <SelectValue placeholder="Select..." />
              </SelectTrigger>
              <SelectContent style={{ backgroundColor: '#D3D3D3', color: '#000000' }}>
                {dropdownConfig.options.map((option) => (
                  <SelectItem key={option.id} value={option.value}>
                    {option.label}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          ),
        };
      }
      return column;
    });
  }, [columns, dropdownConfig]);

  const table = useReactTable({
    data,
    columns: enhancedColumns,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    getSortedRowModel: getSortedRowModel(),
    getFilteredRowModel: getFilteredRowModel(),
    onSortingChange: setSorting,
    onColumnFiltersChange: setColumnFilters,
    onColumnVisibilityChange: setColumnVisibility,
    onRowSelectionChange: setRowSelection,
    enableRowSelection: selectable,
    state: {
      sorting,
      columnFilters,
      columnVisibility,
      rowSelection,
    },
  });

  return <TableUI table={table} filterColumn={filterColumn} columns={enhancedColumns} />;
}

```

# components/theme/GradientBackground.tsx

```tsx
import { BackgroundBeams } from "@/components/extras/beams";
import { cn } from "@/lib/utils";
import { gymTheme } from "@/styles/theme";
import { type MotionProps, m } from "framer-motion";

interface GradientBackgroundProps extends React.HTMLAttributes<HTMLDivElement> {
  showBeams?: boolean;
  beamOpacity?: number;
  children: React.ReactNode;
  motionProps?: MotionProps;
}

export function GradientBackground({
  children,
  className,
  motionProps,
  ...props
}: GradientBackgroundProps) {
  return (
    <section
      className={cn(
        "relative min-h-[95vh] flex items-center overflow-hidden bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))]",
        gymTheme.colors.gradients.heroBackground,
        className
      )}
      {...props}
    >
      {/* Mobile background elements */}
      {/* <div className="absolute inset-0 overflow-hidden lg:hidden">
        <div className="absolute w-[300px] h-[300px] rounded-full bg-blue-500/10 blur-3xl animate-pulse top-[-150px] left-[-150px]" />
        <div className="absolute w-[300px] h-[300px] rounded-full bg-indigo-500/10 blur-3xl animate-pulse bottom-[-150px] right-[-150px]" />
        <m.div
          initial={{ opacity: 0 }}
          animate={{ opacity: [0.1, 0.3, 0.1] }}
          transition={{ duration: 5, repeat: Number.POSITIVE_INFINITY }}
          className="absolute inset-0 bg-[url('/grid.svg')] bg-center [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black)]"
        />
      </div> */}

      {children}
    </section>
  );
}

```

# components/theme/GradientCard.tsx

```tsx
import { cn } from '@/lib/utils';
import { gymTheme } from '@/styles/theme';
import { type MotionProps, m } from 'framer-motion';
import type { LucideIcon } from 'lucide-react';

interface GradientCardProps {
  icon: LucideIcon;
  title: string;
  value: string;
  growth?: string;
  color: string;
  index?: number;
  className?: string;
  motionProps?: MotionProps;
}

export function GradientCard({
  icon: Icon,
  title,
  value,
  growth,
  color,
  index = 0,
  className,
  motionProps,
}: GradientCardProps) {
  return (
    <m.div
      initial={{ opacity: 0, y: 50, rotateX: 45 }}
      animate={{
        opacity: 1,
        y: 0,
        rotateX: 0,
        z: Math.sin(index * 0.5) * 50,
      }}
      whileHover={{
        scale: 1.05,
        z: 30,
        rotateX: 10,
        rotateY: 10,
      }}
      transition={{
        delay: index * 0.1,
        duration: 0.8,
        type: 'spring',
        stiffness: 100,
      }}
      className={cn(
        'bg-gradient-to-br border transform-style-3d shadow-xl p-6',
        gymTheme.colors.borders.light,
        gymTheme.borderRadius.card,
        className,
      )}
      {...motionProps}
    >
      <div
        className={cn(
          'rounded-full w-12 h-12 bg-gradient-to-br flex items-center justify-center mb-4',
          color,
        )}
      >
        <Icon className="w-6 h-6 text-white" />
      </div>
      <h3 className="text-lg font-semibold text-white/90">{title}</h3>
      <div className="flex items-end gap-2 mt-2">
        <span className="text-3xl font-bold text-white">{value}</span>
        {growth && <span className="text-green-400 text-sm mb-1">{growth}</span>}
      </div>

      {/* Animated graph line */}
      <m.div
        className="h-1 bg-white/10 mt-4 rounded-full overflow-hidden"
        initial={{ width: '0%' }}
        animate={{ width: '100%' }}
        transition={{ delay: index * 0.2 + 0.5, duration: 1 }}
      >
        <m.div
          className={cn('h-full bg-gradient-to-r', color)}
          animate={{
            x: ['-100%', '0%'],
            opacity: [0.5, 1],
          }}
          transition={{
            duration: 1.5,
            delay: index * 0.2 + 0.5,
            ease: 'easeOut',
          }}
        />
      </m.div>
    </m.div>
  );
}

```

# components/theme/GradientText.tsx

```tsx
import { cn } from '@/lib/utils';
import { gymTheme } from '@/styles/theme';

interface GradientTextProps {
  children: React.ReactNode;
  className?: string;
  gradient?: string;
}

export function GradientText({
  children,
  className,
  gradient = gymTheme.colors.gradients.primaryBlue,
}: GradientTextProps) {
  return (
    <span
      className={cn(
        'bg-gradient-to-r bg-clip-text text-transparent',
        gradient,
        gymTheme.animation.gradient,
        className,
      )}
    >
      {children}
    </span>
  );
}

```

# components/trainer/AddWorkouts.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Textarea } from '@/components/ui/textarea';
import { Clock, Dumbbell, Minus, Plus } from 'lucide-react';
import type React from 'react';
import { useState } from 'react';
import Swal from 'sweetalert2';

interface Exercise {
  name: string;
  sets: number;
  reps: number;
}

export default function CreateWorkout() {
  const [workoutName, setWorkoutName] = useState('');
  const [description, setDescription] = useState('');
  const [duration, setDuration] = useState('');
  const [difficulty, setDifficulty] = useState('');
  const [exercises, setExercises] = useState<Exercise[]>([{ name: '', sets: 3, reps: 10 }]);

  const addExercise = () => {
    setExercises([...exercises, { name: '', sets: 3, reps: 10 }]);
  };

  const removeExercise = (index: number) => {
    setExercises(exercises.filter((_, i) => i !== index));
  };

  const updateExercise = (index: number, field: keyof Exercise, value: string | number) => {
    const updatedExercises = exercises.map((exercise, i) => {
      if (i === index) {
        return { ...exercise, [field]: value };
      }
      return exercise;
    });
    setExercises(updatedExercises);
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    Swal.fire({
      title: 'Are you sure ',
      text: 'You want to create new workout plan!',
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes!',
    }).then((result) => {
      if (result.isConfirmed) {
        Swal.fire({
          title: 'Successs!',
          text: 'Workout is sucssfully created.',
          icon: 'success',
        }).then(() => {
          // TODO backend call to the database
          console.log('Submitting:', {
            workoutName,
            description,
            duration,
            difficulty,
            exercises,
          });
        });
      }
    });
    // Here you would typically send the data to your backend
  };

  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle className="text-2xl font-bold text-center">Create Workout</CardTitle>
      </CardHeader>
      <form onSubmit={handleSubmit}>
        <CardContent className="space-y-4">
          <div>
            <Label htmlFor="workoutName">Workout Name</Label>
            <Input
              id="workoutName"
              value={workoutName}
              onChange={(e) => setWorkoutName(e.target.value)}
              placeholder="Enter workout name"
              required
            />
          </div>
          <div>
            <Label htmlFor="description">Description</Label>
            <Textarea
              id="description"
              value={description}
              onChange={(e) => setDescription(e.target.value)}
              placeholder="Describe the workout"
              rows={3}
            />
          </div>
          <div className="flex space-x-4">
            <div className="flex-1">
              <Label htmlFor="duration">Duration (minutes)</Label>
              <div className="flex items-center">
                <Clock className="w-4 h-4 mr-2 text-gray-500" />
                <Input
                  id="duration"
                  type="number"
                  value={duration}
                  onChange={(e) => setDuration(e.target.value)}
                  placeholder="Duration"
                  min="1"
                  required
                />
              </div>
            </div>
            <div className="flex-1">
              <Label htmlFor="difficulty">Difficulty</Label>
              <Select value={difficulty} onValueChange={setDifficulty}>
                <SelectTrigger>
                  <SelectValue placeholder="Select difficulty" />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="beginner">Beginner</SelectItem>
                  <SelectItem value="intermediate">Intermediate</SelectItem>
                  <SelectItem value="advanced">Advanced</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>
          <div>
            <Label>Exercises</Label>
            {exercises.map((exercise, index) => (
              <div key={index as number} className="flex items-center space-x-2 mt-2">
                <Input
                  value={exercise.name}
                  onChange={(e) => updateExercise(index, 'name', e.target.value)}
                  placeholder="Exercise name"
                  required
                />
                <Input
                  type="number"
                  value={exercise.sets}
                  onChange={(e) => updateExercise(index, 'sets', Number.parseInt(e.target.value))}
                  placeholder="Sets"
                  min="1"
                  required
                  className="w-20"
                />
                <Input
                  type="number"
                  value={exercise.reps}
                  onChange={(e) => updateExercise(index, 'reps', Number.parseInt(e.target.value))}
                  placeholder="Reps"
                  min="1"
                  required
                  className="w-20"
                />
                <Button
                  type="button"
                  variant="outline"
                  size="icon"
                  onClick={() => removeExercise(index)}
                >
                  <Minus className="h-4 w-4" />
                </Button>
              </div>
            ))}
            <Button type="button" variant="outline" onClick={addExercise} className="mt-2">
              <Plus className="h-4 w-4 mr-2" /> Add Exercise
            </Button>
          </div>
        </CardContent>
        <CardFooter>
          <Button type="submit" className="w-full" onClick={() => {}}>
            <Dumbbell className="w-4 h-4 mr-2" /> Create Workout
          </Button>
        </CardFooter>
      </form>
    </Card>
  );
}

```

# components/trainer/AssignDietPlan.tsx

```tsx
'use client';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table';
import { Check, ChevronDown, Search, Users, Utensils, UtensilsCrossed } from 'lucide-react';
import React, { useState, useMemo } from 'react';

interface User {
  id: number;
  name: string;
  gender: string;
  goal: string;
  assignedDietPlan: string | null;
}

interface DietPlan {
  id: number;
  name: string;
}

export default function AssignWorkout() {
  const [users, setUsers] = useState<User[]>([
    {
      id: 1,
      name: 'John Doe',
      gender: 'Male',
      goal: 'Weight Loss',
      assignedDietPlan: null,
    },
    {
      id: 2,
      name: 'Jane Smith',
      gender: 'Female',
      goal: 'Muscle Gain',
      assignedDietPlan: 'Protein Rich',
    },
    {
      id: 3,
      name: 'Alex Johnson',
      gender: 'Non-binary',
      goal: 'Maintenance',
      assignedDietPlan: null,
    },
  ]);
  const [searchTerm, setSearchTerm] = useState('');

  const dietPlans: DietPlan[] = [
    { id: 1, name: 'Keto Diet' },
    { id: 2, name: 'Vegan Plan' },
    { id: 3, name: 'Protein Rich' },
    { id: 4, name: 'Balanced Nutrition' },
  ];

  const assignDietPlan = (userId: number, planName: string) => {
    setUsers(
      users.map((user) =>
        user.id === userId ? { ...user, assignedDietPlan: planName || null } : user,
      ),
    );
  };

  const filteredUsers = useMemo(() => {
    return users.filter(
      (user) =>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        user.gender.toLowerCase().includes(searchTerm.toLowerCase()) ||
        user.goal.toLowerCase().includes(searchTerm.toLowerCase()),
    );
  }, [users, searchTerm]);

  const { totalUsers, assignedUsers, unassignedUsers } = useMemo(() => {
    const total = users.length;
    const assigned = users.filter((user) => user.assignedDietPlan).length;
    return {
      totalUsers: total,
      assignedUsers: assigned,
      unassignedUsers: total - assigned,
    };
  }, [users]);

  return (
    <div className="container mx-auto p-6 pb-14">
      <h1 className="text-center lg:text-left text-2xl font-bold mb-6 text-gray-800">
        Assign Diet Plans
      </h1>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <Card>
          <CardContent className="flex items-center justify-between p-4">
            <div>
              <p className="text-sm text-gray-500">Total Users</p>
              <p className="text-2xl font-semibold text-gray-800">{totalUsers}</p>
            </div>
            <Users className="h-10 w-10 text-blue-500" />
          </CardContent>
        </Card>
        <Card>
          <CardContent className="flex items-center justify-between p-4">
            <div>
              <p className="text-sm text-gray-500">Assigned Diet Plans</p>
              <p className="text-2xl font-semibold text-gray-800">{assignedUsers}</p>
            </div>
            <Utensils className="h-10 w-10 text-green-500" />
          </CardContent>
        </Card>
        <Card>
          <CardContent className="flex items-center justify-between p-4">
            <div>
              <p className="text-sm text-gray-500">Unassigned Users</p>
              <p className="text-2xl font-semibold text-gray-800">{unassignedUsers}</p>
            </div>
            <UtensilsCrossed className="h-10 w-10 text-red-500" />
          </CardContent>
        </Card>
      </div>

      <div className="mb-6">
        <div className="relative">
          <Search
            className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
            size={20}
          />
          <Input
            type="text"
            placeholder="Search users..."
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="pl-10"
          />
        </div>
      </div>

      <Card>
        <CardContent className="p-0">
          <div className="overflow-x-auto">
            <Table>
              <TableHeader>
                <TableRow>
                  <TableHead>User Name</TableHead>
                  <TableHead>Gender</TableHead>
                  <TableHead>Goal</TableHead>
                  <TableHead>Assign Diet Plan</TableHead>
                </TableRow>
              </TableHeader>
              <TableBody>
                {filteredUsers.map((user) => (
                  <TableRow key={user.id}>
                    <TableCell>{user.name}</TableCell>
                    <TableCell>{user.gender}</TableCell>
                    <TableCell>{user.goal}</TableCell>
                    <TableCell>
                      <DropdownMenu>
                        <DropdownMenuTrigger asChild>
                          <Button variant="outline" className="w-[200px] justify-between">
                            {user.assignedDietPlan || 'Select a diet plan'}
                            <ChevronDown className="ml-2 h-4 w-4" />
                          </Button>
                        </DropdownMenuTrigger>
                        <DropdownMenuContent className="w-[200px]">
                          <DropdownMenuItem onSelect={() => assignDietPlan(user.id, '')}>
                            Unassign
                            {user.assignedDietPlan === null && (
                              <Check className="ml-auto h-4 w-4" />
                            )}
                          </DropdownMenuItem>
                          {dietPlans.map((plan) => (
                            <DropdownMenuItem
                              key={plan.id}
                              onSelect={() => assignDietPlan(user.id, plan.name)}
                            >
                              {plan.name}
                              {user.assignedDietPlan === plan.name && (
                                <Check className="ml-auto h-4 w-4" />
                              )}
                            </DropdownMenuItem>
                          ))}
                        </DropdownMenuContent>
                      </DropdownMenu>
                    </TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          </div>

          <div className="md:hidden space-y-4 p-4">
            {filteredUsers.map((user) => (
              <Card key={user.id}>
                <CardContent className="p-4 space-y-2">
                  <h3 className="font-semibold text-gray-800">{user.name}</h3>
                  <p className="text-sm text-gray-600">Gender: {user.gender}</p>
                  <p className="text-sm text-gray-600">Goal: {user.goal}</p>
                  <Label htmlFor={`diet-plan-${user.id}`}>Assign Diet Plan</Label>
                  <DropdownMenu>
                    <DropdownMenuTrigger asChild>
                      <Button
                        id={`diet-plan-${user.id}`}
                        variant="outline"
                        className="w-full justify-between"
                      >
                        {user.assignedDietPlan || 'Select a diet plan'}
                        <ChevronDown className="ml-2 h-4 w-4" />
                      </Button>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent className="w-[200px]">
                      <DropdownMenuItem onSelect={() => assignDietPlan(user.id, '')}>
                        Unassign
                        {user.assignedDietPlan === null && <Check className="ml-auto h-4 w-4" />}
                      </DropdownMenuItem>
                      {dietPlans.map((plan) => (
                        <DropdownMenuItem
                          key={plan.id}
                          onSelect={() => assignDietPlan(user.id, plan.name)}
                        >
                          {plan.name}
                          {user.assignedDietPlan === plan.name && (
                            <Check className="ml-auto h-4 w-4" />
                          )}
                        </DropdownMenuItem>
                      ))}
                    </DropdownMenuContent>
                  </DropdownMenu>
                </CardContent>
              </Card>
            ))}
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

```

# components/trainer/showqr/DateComponent.tsx

```tsx
'use client';
import React from 'react';
import { useState } from 'react';
export default function DateComponent() {
  const [currentDate] = useState(
    new Date().toLocaleDateString('en-GB', {
      day: '2-digit',
      month: 'short',
      year: 'numeric',
    }),
  );

  return (
    <>
      <div className="text-xl font-semibold text-primary bg-primary-foreground px-4 py-2 rounded-full">
        {currentDate}
      </div>
    </>
  );
}

```

# components/trainer/showqr/QrCode.tsx

```tsx
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { QRCodeSVG } from 'qrcode.react';
import type React from 'react';

interface GymQRCodeOnboardingProps {
  qrdata: string;
  title: string;
  subtitle: string; // Add subtitle prop
}

const GymQRCode: React.FC<GymQRCodeOnboardingProps> = ({ qrdata, title, subtitle }) => {
  return (
    <Card className="w-full max-w-md mx-auto bg-white shadow-lg rounded-lg overflow-hidden min-h-[90vh] md:min-h-0">
      <CardHeader className="bg-gradient-to-r from-blue-600 to-blue-800 text-white text-center py-8">
        <CardTitle className="text-3xl font-bold">{title}</CardTitle>
        <CardDescription className="text-blue-100 mt-3 text-xl font-semibold tracking-[0.5px]">
          Welcome to your fitness journey
        </CardDescription>
      </CardHeader>

      <CardContent className="flex flex-col items-center justify-center p-8 md:p-12">
        <QRCodeSVG
          value={qrdata}
          size={300}
          bgColor={'#ffffff'}
          fgColor={'#000000'}
          level={'M'}
          includeMargin={true}
        />

        <div className="space-y-4 w-full max-w-sm text-center">
          <p className="text-lg text-gray-700 font-medium px-4">
            {subtitle} {/* Use the passed subtitle */}
          </p>

          <div className="pt-4 border-t border-gray-200">
            <p className="text-sm text-gray-500">Having trouble? Contact our support team</p>
          </div>
        </div>
      </CardContent>
    </Card>
  );
};

export default GymQRCode;

```

# components/ui/accordion.tsx

```tsx
'use client';

import * as AccordionPrimitive from '@radix-ui/react-accordion';
import { ChevronDown } from 'lucide-react';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item ref={ref} className={cn('border-b', className)} {...props} />
));
AccordionItem.displayName = 'AccordionItem';

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        'flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180',
        className,
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn('pb-4 pt-0', className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };

```

# components/ui/alert.tsx

```tsx
import { type VariantProps, cva } from 'class-variance-authority';
import * as React from 'react';

import { cn } from '@/lib/utils';

const alertVariants = cva(
  'relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground',
  {
    variants: {
      variant: {
        default: 'bg-background text-foreground',
        destructive:
          'border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
);

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div ref={ref} role="alert" className={cn(alertVariants({ variant }), className)} {...props} />
));
Alert.displayName = 'Alert';

const AlertTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h5
      ref={ref}
      className={cn('mb-1 font-medium leading-none tracking-tight', className)}
      {...props}
    />
  ),
);
AlertTitle.displayName = 'AlertTitle';

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('text-sm [&_p]:leading-relaxed', className)} {...props} />
));
AlertDescription.displayName = 'AlertDescription';

export { Alert, AlertTitle, AlertDescription };

```

# components/ui/avatar.tsx

```tsx
'use client';

import * as AvatarPrimitive from '@radix-ui/react-avatar';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn('relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full', className)}
    {...props}
  />
));
Avatar.displayName = AvatarPrimitive.Root.displayName;

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn('aspect-square h-full w-full', className)}
    {...props}
  />
));
AvatarImage.displayName = AvatarPrimitive.Image.displayName;

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      'flex h-full w-full items-center justify-center rounded-full bg-muted',
      className,
    )}
    {...props}
  />
));
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;

export { Avatar, AvatarImage, AvatarFallback };

```

# components/ui/badge.tsx

```tsx
import { type VariantProps, cva } from 'class-variance-authority';
import type * as React from 'react';

import { cn } from '@/lib/utils';

const badgeVariants = cva(
  'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',
  {
    variants: {
      variant: {
        default: 'border-transparent bg-primary text-primary-foreground hover:bg-primary/80',
        secondary:
          'border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80',
        destructive:
          'border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80',
        outline: 'text-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
);

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return <div className={cn(badgeVariants({ variant }), className)} {...props} />;
}

export { Badge, badgeVariants };

```

# components/ui/button.tsx

```tsx
import { Slot } from '@radix-ui/react-slot';
import { type VariantProps, cva } from 'class-variance-authority';
import * as React from 'react';

import { cn } from '@/lib/utils';

const buttonVariants = cva(
  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive: 'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline: 'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary: 'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  },
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button';
    return (
      <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />
    );
  },
);
Button.displayName = 'Button';

export { Button, buttonVariants };

```

# components/ui/calendar.tsx

```tsx
'use client';

import { ChevronLeft, ChevronRight } from 'lucide-react';
import type * as React from 'react';
import { DayPicker } from 'react-day-picker';

import { buttonVariants } from '@/components/ui/button';
import { cn } from '@/lib/utils';

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({ className, classNames, showOutsideDays = true, ...props }: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn('p-3', className)}
      classNames={{
        months: 'flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0',
        month: 'space-y-4',
        caption: 'flex justify-center pt-1 relative items-center',
        caption_label: 'text-sm font-medium',
        nav: 'space-x-1 flex items-center',
        nav_button: cn(
          buttonVariants({ variant: 'outline' }),
          'h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100',
        ),
        nav_button_previous: 'absolute left-1',
        nav_button_next: 'absolute right-1',
        table: 'w-full border-collapse space-y-1',
        head_row: 'flex',
        head_cell: 'text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]',
        row: 'flex w-full mt-2',
        cell: 'h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20',
        day: cn(
          buttonVariants({ variant: 'ghost' }),
          'h-9 w-9 p-0 font-normal aria-selected:opacity-100',
        ),
        day_range_end: 'day-range-end',
        day_selected:
          'bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground',
        day_today: 'bg-accent text-accent-foreground',
        day_outside:
          'day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground',
        day_disabled: 'text-muted-foreground opacity-50',
        day_range_middle: 'aria-selected:bg-accent aria-selected:text-accent-foreground',
        day_hidden: 'invisible',
        ...classNames,
      }}
      components={{
        IconLeft: ({ className, ...props }) => (
          <ChevronLeft className={cn('h-4 w-4', className)} {...props} />
        ),
        IconRight: ({ className, ...props }) => (
          <ChevronRight className={cn('h-4 w-4', className)} {...props} />
        ),
      }}
      {...props}
    />
  );
}
Calendar.displayName = 'Calendar';

export { Calendar };

```

# components/ui/card.tsx

```tsx
import * as React from 'react';

import { cn } from '@/lib/utils';

const Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      className={cn('rounded-lg border bg-card text-card-foreground shadow-sm', className)}
      {...props}
    />
  ),
);
Card.displayName = 'Card';

const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn('flex flex-col space-y-1.5 p-6', className)} {...props} />
  ),
);
CardHeader.displayName = 'CardHeader';

const CardTitle = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      className={cn('text-2xl font-semibold leading-none tracking-tight', className)}
      {...props}
    />
  ),
);
CardTitle.displayName = 'CardTitle';

const CardDescription = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn('text-sm text-muted-foreground', className)} {...props} />
  ),
);
CardDescription.displayName = 'CardDescription';

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />
  ),
);
CardContent.displayName = 'CardContent';

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn('flex items-center p-6 pt-0', className)} {...props} />
  ),
);
CardFooter.displayName = 'CardFooter';

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };

```

# components/ui/checkbox.tsx

```tsx
'use client';

import * as CheckboxPrimitive from '@radix-ui/react-checkbox';
import { Check } from 'lucide-react';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      'peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground',
      className,
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator className={cn('flex items-center justify-center text-current')}>
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };

```

# components/ui/command.tsx

```tsx
'use client';

import type { DialogProps } from '@radix-ui/react-dialog';
import { Command as CommandPrimitive } from 'cmdk';
import { Search } from 'lucide-react';
import * as React from 'react';

import { Dialog, DialogContent } from '@/components/ui/dialog';
import { cn } from '@/lib/utils';

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      'flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground',
      className,
    )}
    {...props}
  />
));
Command.displayName = CommandPrimitive.displayName;

const CommandDialog = ({ children, ...props }: DialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        'flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50',
        className,
      )}
      {...props}
    />
  </div>
));

CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn('max-h-[300px] overflow-y-auto overflow-x-hidden', className)}
    {...props}
  />
));

CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => (
  <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />
));

CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      'overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground',
      className,
    )}
    {...props}
  />
));

CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 h-px bg-border', className)}
    {...props}
  />
));
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
      className,
    )}
    {...props}
  />
));

CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn('ml-auto text-xs tracking-widest text-muted-foreground', className)}
      {...props}
    />
  );
};
CommandShortcut.displayName = 'CommandShortcut';

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
};

```

# components/ui/dialog.tsx

```tsx
'use client';

import * as DialogPrimitive from '@radix-ui/react-dialog';
import { X } from 'lucide-react';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className,
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className,
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)} {...props} />
);
DialogHeader.displayName = 'DialogHeader';

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
    {...props}
  />
);
DialogFooter.displayName = 'DialogFooter';

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold leading-none tracking-tight', className)}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};

```

# components/ui/dropdown-menu.tsx

```tsx
'use client';

import * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';
import { Check, ChevronRight, Circle } from 'lucide-react';
import * as React from 'react';

import { cn } from '@/lib/utils';

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
      inset && 'pl-8',
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className,
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn('px-2 py-1.5 text-sm font-semibold', inset && 'pl-8', className)}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span className={cn('ml-auto text-xs tracking-widest opacity-60', className)} {...props} />
  );
};
DropdownMenuShortcut.displayName = 'DropdownMenuShortcut';

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};

```

# components/ui/form-error.tsx

```tsx
import React from 'react';
interface FormErrorPropsType {
  message: string;
  type: 'success' | 'fail';
}
import { CheckCircle } from 'lucide-react';
import { BsExclamationCircle } from 'react-icons/bs';
export default function FormError({
  FormErrorProps,
}: {
  FormErrorProps: FormErrorPropsType;
}) {
  return (
    <div className="text-center h-6  flex *:rounded-lg ">
      {FormErrorProps && FormErrorProps.type === 'fail' ? (
        <div className="w-full bg-red-100 h-full flex items-center gap-1 justify-center">
          <BsExclamationCircle className=" w-4 h-4 text-red-600 " />
          <p className="text-sm text-red-600 ">{FormErrorProps.message} </p>
        </div>
      ) : (
        <div className="w-full bg-green-100 h-full flex items-center gap-1 justify-center">
          <CheckCircle className="w-4 h-4 text-green-600 flex items-center gap-1" />
          <p className="text-green-700 text-sm">{FormErrorProps.message}</p>
        </div>
      )}
    </div>
  );
}

```

# components/ui/form.tsx

```tsx
'use client';

import type * as LabelPrimitive from '@radix-ui/react-label';
import { Slot } from '@radix-ui/react-slot';
import * as React from 'react';
import {
  Controller,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
  FormProvider,
  useFormContext,
} from 'react-hook-form';

import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { cn } from '@/lib/utils';

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>({} as FormFieldContextValue);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState, formState } = useFormContext();

  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error('useFormField should be used within <FormField>');
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>({} as FormItemContextValue);

const FormItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => {
    const id = React.useId();

    return (
      <FormItemContext.Provider value={{ id }}>
        <div ref={ref} className={cn('space-y-2', className)} {...props} />
      </FormItemContext.Provider>
    );
  },
);
FormItem.displayName = 'FormItem';

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return (
    <Label
      ref={ref}
      className={cn(error && 'text-red-500 dark:text-red-900', className)}
      htmlFor={formItemId}
      {...props}
    />
  );
});
FormLabel.displayName = 'FormLabel';

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField();

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={!error ? `${formDescriptionId}` : `${formDescriptionId} ${formMessageId}`}
      aria-invalid={!!error}
      {...props}
    />
  );
});
FormControl.displayName = 'FormControl';

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField();

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn('text-sm text-gray-500', className)}
      {...props}
    />
  );
});
FormDescription.displayName = 'FormDescription';

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField();
  const body = error ? String(error?.message) : children;

  if (!body) {
    return null;
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn('text-sm font-medium text-red-500', className)}
      {...props}
    >
      {body}
    </p>
  );
});
FormMessage.displayName = 'FormMessage';

// Add FormInput component to match your import needs
const FormInput = React.forwardRef<
  HTMLInputElement,
  React.InputHTMLAttributes<HTMLInputElement> & {
    label?: string;
    description?: string;
  }
>(({ className, label, description, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return (
    <div className="w-full space-y-1">
      {label && (
        <FormLabel htmlFor={formItemId}>
          {label}
          {props.required && <span className="text-red-500 ml-1">*</span>}
        </FormLabel>
      )}

      <FormControl>
        <Input
          ref={ref}
          className={cn(
            'block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:cursor-not-allowed disabled:opacity-50',
            error && 'border-red-500 focus:border-red-500 focus:ring-red-500',
            className,
          )}
          {...props}
        />
      </FormControl>

      {description && <FormDescription>{description}</FormDescription>}
      <FormMessage />
    </div>
  );
});
FormInput.displayName = 'FormInput';

export {
  Form,
  FormField,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormInput,
  useFormField,
};

```

# components/ui/googleButton.tsx

```tsx
import { Button } from '@/components/ui/button';
import React from 'react';
export default function GoogleButton({
  handleSubmit,
}: {
  handleSubmit: () => void;
}) {
  return (
    <Button
      variant="outline"
      className="w-full hover:bg-muted/50 border-muted-foreground/20 transition-colors duration-300"
      onClick={handleSubmit}
    >
      <svg
        className="mr-2 h-4 w-4"
        aria-hidden="true"
        focusable="false"
        data-prefix="fab"
        data-icon="github"
        role="img"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
      >
        <path
          d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
          fill="#4285F4"
        />
        <path
          d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
          fill="#34A853"
        />
        <path
          d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
          fill="#FBBC05"
        />
        <path
          d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
          fill="#EA4335"
        />
        <path d="M1 1h22v22H1z" fill="none" />
      </svg>
      Continue with Google
    </Button>
  );
}

```

# components/ui/input.tsx

```tsx
import { cn } from '@/lib/utils';
import * as React from 'react';

export interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type || 'text'}
        className={cn(
          'flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Input.displayName = 'Input';

export { Input };

```

# components/ui/label.tsx

```tsx
'use client';

import { cn } from '@/lib/utils';
import * as LabelPrimitive from '@radix-ui/react-label';
import * as React from 'react';

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(
      'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70',
      className,
    )}
    {...props}
  />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };

```

# components/ui/popover.tsx

```tsx
'use client';

import * as PopoverPrimitive from '@radix-ui/react-popover';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        'z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className,
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };

```

# components/ui/radio-group.tsx

```tsx
"use client";

import * as React from "react";
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group";
import { cn } from "@/lib/utils";
import { Circle } from "lucide-react";

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Root
      className={cn("grid gap-2", className)}
      {...props}
      ref={ref}
    />
  );
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-5 w-5 rounded-full border border-gray-300 text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-3 w-3 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };
```

# components/ui/scroll-area.tsx

```tsx
'use client';

import * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area';
import * as React from 'react';

import { cn } from '@/lib/utils';

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn('relative overflow-hidden', className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
));
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = 'vertical', ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      'flex touch-none select-none transition-colors',
      orientation === 'vertical' && 'h-full w-2.5 border-l border-l-transparent p-[1px]',
      orientation === 'horizontal' && 'h-2.5 flex-col border-t border-t-transparent p-[1px]',
      className,
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
));
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;

export { ScrollArea, ScrollBar };

```

# components/ui/select.tsx

```tsx
"use client";

import * as SelectPrimitive from "@radix-ui/react-select";
import { Check, ChevronDown, ChevronUp } from "lucide-react";
import * as React from "react";

import { cn } from "@/lib/utils";

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "z-50 flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)}
    {...props}
  />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};

```

# components/ui/separator.tsx

```tsx
'use client';

import * as SeparatorPrimitive from '@radix-ui/react-separator';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(({ className, orientation = 'horizontal', decorative = true, ...props }, ref) => (
  <SeparatorPrimitive.Root
    ref={ref}
    decorative={decorative}
    orientation={orientation}
    className={cn(
      'shrink-0 bg-border',
      orientation === 'horizontal' ? 'h-[1px] w-full' : 'h-full w-[1px]',
      className,
    )}
    {...props}
  />
));
Separator.displayName = SeparatorPrimitive.Root.displayName;

export { Separator };

```

# components/ui/sheet.tsx

```tsx
'use client';

import * as SheetPrimitive from '@radix-ui/react-dialog';
import { type VariantProps, cva } from 'class-variance-authority';
import { X } from 'lucide-react';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className,
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        bottom:
          'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  },
);

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = 'right', className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
));
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn('flex flex-col space-y-2 text-center sm:text-left', className)} {...props} />
);
SheetHeader.displayName = 'SheetHeader';

const SheetFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
    {...props}
  />
);
SheetFooter.displayName = 'SheetFooter';

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold text-foreground', className)}
    {...props}
  />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
};

```

# components/ui/sidebar.tsx

```tsx
'use client';

import { Slot } from '@radix-ui/react-slot';
import { type VariantProps, cva } from 'class-variance-authority';
import { PanelLeft } from 'lucide-react';
import * as React from 'react';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Separator } from '@/components/ui/separator';
import { Sheet, SheetContent } from '@/components/ui/sheet';
import { Skeleton } from '@/components/ui/skeleton';
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';
import { useIsMobile } from '@/hooks/use-mobile';
import { cn } from '@/lib/utils';

const SIDEBAR_COOKIE_NAME = 'sidebar:state';
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = '16rem';
const SIDEBAR_WIDTH_MOBILE = '18rem';
const SIDEBAR_WIDTH_ICON = '3rem';
const SIDEBAR_KEYBOARD_SHORTCUT = 'b';

type SidebarContext = {
  state: 'expanded' | 'collapsed';
  open: boolean;
  setOpen: (open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContext | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error('useSidebar must be used within a SidebarProvider.');
  }

  return context;
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
  }
>(
  (
    {
      defaultOpen = true,
      open: openProp,
      onOpenChange: setOpenProp,
      className,
      style,
      children,
      ...props
    },
    ref,
  ) => {
    const isMobile = useIsMobile();
    const [openMobile, setOpenMobile] = React.useState(false);

    // This is the internal state of the sidebar.
    // We use openProp and setOpenProp for control from outside the component.
    const [_open, _setOpen] = React.useState(defaultOpen);
    const open = openProp ?? _open;
    const setOpen = React.useCallback(
      (value: boolean | ((value: boolean) => boolean)) => {
        if (setOpenProp) {
          return setOpenProp?.(typeof value === 'function' ? value(open) : value);
        }

        _setOpen(value);

        // This sets the cookie to keep the sidebar state.
        document.cookie = `${SIDEBAR_COOKIE_NAME}=${open}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
      },
      [setOpenProp, open],
    );
    // Helper to toggle the sidebar.
    const toggleSidebar = React.useCallback(() => {
      return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
    }, [isMobile, setOpen]);

    // Adds a keyboard shortcut to toggle the sidebar.
    React.useEffect(() => {
      const handleKeyDown = (event: KeyboardEvent) => {
        if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
          event.preventDefault();
          toggleSidebar();
        }
      };

      window.addEventListener('keydown', handleKeyDown);
      return () => window.removeEventListener('keydown', handleKeyDown);
    }, [toggleSidebar]);

    // We add a state so that we can do data-state="expanded" or "collapsed".
    // This makes it easier to style the sidebar with Tailwind classes.
    const state = open ? 'expanded' : 'collapsed';

    const contextValue = React.useMemo<SidebarContext>(
      () => ({
        state,
        open,
        setOpen,
        isMobile,
        openMobile,
        setOpenMobile,
        toggleSidebar,
      }),
      [state, open, setOpen, isMobile, openMobile, toggleSidebar],
    );

    return (
      <SidebarContext.Provider value={contextValue}>
        <TooltipProvider delayDuration={0}>
          <div
            style={
              {
                '--sidebar-width': SIDEBAR_WIDTH,
                '--sidebar-width-icon': SIDEBAR_WIDTH_ICON,
                ...style,
              } as React.CSSProperties
            }
            className={cn(
              'group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar',
              className,
            )}
            ref={ref}
            {...props}
          >
            {children}
          </div>
        </TooltipProvider>
      </SidebarContext.Provider>
    );
  },
);
SidebarProvider.displayName = 'SidebarProvider';

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    side?: 'left' | 'right';
    variant?: 'sidebar' | 'floating' | 'inset';
    collapsible?: 'offcanvas' | 'icon' | 'none';
  }
>(
  (
    {
      side = 'left',
      variant = 'sidebar',
      collapsible = 'offcanvas',
      className,
      children,
      ...props
    },
    ref,
  ) => {
    const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

    if (collapsible === 'none') {
      return (
        <div
          className={cn(
            'flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground',
            className,
          )}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      );
    }

    if (isMobile) {
      return (
        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
          <SheetContent
            data-sidebar="sidebar"
            data-mobile="true"
            className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
            style={
              {
                '--sidebar-width': SIDEBAR_WIDTH_MOBILE,
              } as React.CSSProperties
            }
            side={side}
          >
            <div className="flex h-full w-full flex-col">{children}</div>
          </SheetContent>
        </Sheet>
      );
    }

    return (
      <div
        ref={ref}
        className="group peer hidden md:block text-sidebar-foreground"
        data-state={state}
        data-collapsible={state === 'collapsed' ? collapsible : ''}
        data-variant={variant}
        data-side={side}
      >
        {/* This is what handles the sidebar gap on desktop */}
        <div
          className={cn(
            'duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear',
            'group-data-[collapsible=offcanvas]:w-0',
            'group-data-[side=right]:rotate-180',
            variant === 'floating' || variant === 'inset'
              ? 'group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]'
              : 'group-data-[collapsible=icon]:w-[--sidebar-width-icon]',
          )}
        />
        <div
          className={cn(
            'duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex',
            side === 'left'
              ? 'left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]'
              : 'right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]',
            // Adjust the padding for floating and inset variants.
            variant === 'floating' || variant === 'inset'
              ? 'p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]'
              : 'group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l',
            className,
          )}
          {...props}
        >
          <div
            data-sidebar="sidebar"
            className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
          >
            {children}
          </div>
        </div>
      </div>
    );
  },
);
Sidebar.displayName = 'Sidebar';

const SidebarTrigger = React.forwardRef<
  React.ElementRef<typeof Button>,
  React.ComponentProps<typeof Button>
>(({ className, onClick, ...props }, ref) => {
  const { toggleSidebar } = useSidebar();

  return (
    <Button
      ref={ref}
      data-sidebar="trigger"
      variant="ghost"
      size="icon"
      className={cn('h-7 w-7', className)}
      onClick={(event) => {
        onClick?.(event);
        toggleSidebar();
      }}
      {...props}
    >
      <PanelLeft />
      <span className="sr-only">Toggle Sidebar</span>
    </Button>
  );
});
SidebarTrigger.displayName = 'SidebarTrigger';

const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<'button'>>(
  ({ className, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <button
        ref={ref}
        data-sidebar="rail"
        aria-label="Toggle Sidebar"
        tabIndex={-1}
        onClick={toggleSidebar}
        title="Toggle Sidebar"
        className={cn(
          'absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex',
          '[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize',
          '[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize',
          'group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar',
          '[[data-side=left][data-collapsible=offcanvas]_&]:-right-2',
          '[[data-side=right][data-collapsible=offcanvas]_&]:-left-2',
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarRail.displayName = 'SidebarRail';

const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<'main'>>(
  ({ className, ...props }, ref) => {
    return (
      <main
        ref={ref}
        className={cn(
          'relative flex min-h-svh flex-1 flex-col bg-background',
          'peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow',
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarInset.displayName = 'SidebarInset';

const SidebarInput = React.forwardRef<
  React.ElementRef<typeof Input>,
  React.ComponentProps<typeof Input>
>(({ className, ...props }, ref) => {
  return (
    <Input
      ref={ref}
      data-sidebar="input"
      className={cn(
        'h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring',
        className,
      )}
      {...props}
    />
  );
});
SidebarInput.displayName = 'SidebarInput';

const SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
  ({ className, ...props }, ref) => {
    return (
      <div
        ref={ref}
        data-sidebar="header"
        className={cn('flex flex-col gap-2 p-2', className)}
        {...props}
      />
    );
  },
);
SidebarHeader.displayName = 'SidebarHeader';

const SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
  ({ className, ...props }, ref) => {
    return (
      <div
        ref={ref}
        data-sidebar="footer"
        className={cn('flex flex-col gap-2 p-2', className)}
        {...props}
      />
    );
  },
);
SidebarFooter.displayName = 'SidebarFooter';

const SidebarSeparator = React.forwardRef<
  React.ElementRef<typeof Separator>,
  React.ComponentProps<typeof Separator>
>(({ className, ...props }, ref) => {
  return (
    <Separator
      ref={ref}
      data-sidebar="separator"
      className={cn('mx-2 w-auto bg-sidebar-border', className)}
      {...props}
    />
  );
});
SidebarSeparator.displayName = 'SidebarSeparator';

const SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
  ({ className, ...props }, ref) => {
    return (
      <div
        ref={ref}
        data-sidebar="content"
        className={cn(
          'flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden',
          className,
        )}
        {...props}
      />
    );
  },
);
SidebarContent.displayName = 'SidebarContent';

const SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
  ({ className, ...props }, ref) => {
    return (
      <div
        ref={ref}
        data-sidebar="group"
        className={cn('relative flex w-full min-w-0 flex-col p-2', className)}
        {...props}
      />
    );
  },
);
SidebarGroup.displayName = 'SidebarGroup';

const SidebarGroupLabel = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : 'div';

  return (
    <Comp
      ref={ref}
      data-sidebar="group-label"
      className={cn(
        'duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
        'group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0',
        className,
      )}
      {...props}
    />
  );
});
SidebarGroupLabel.displayName = 'SidebarGroupLabel';

const SidebarGroupAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'> & { asChild?: boolean }
>(({ className, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : 'button';

  return (
    <Comp
      ref={ref}
      data-sidebar="group-action"
      className={cn(
        'absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
        // Increases the hit area of the button on mobile.
        'after:absolute after:-inset-2 after:md:hidden',
        'group-data-[collapsible=icon]:hidden',
        className,
      )}
      {...props}
    />
  );
});
SidebarGroupAction.displayName = 'SidebarGroupAction';

const SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      data-sidebar="group-content"
      className={cn('w-full text-sm', className)}
      {...props}
    />
  ),
);
SidebarGroupContent.displayName = 'SidebarGroupContent';

const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(
  ({ className, ...props }, ref) => (
    <ul
      ref={ref}
      data-sidebar="menu"
      className={cn('flex w-full min-w-0 flex-col gap-1', className)}
      {...props}
    />
  ),
);
SidebarMenu.displayName = 'SidebarMenu';

const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(
  ({ className, ...props }, ref) => (
    <li
      ref={ref}
      data-sidebar="menu-item"
      className={cn('group/menu-item relative', className)}
      {...props}
    />
  ),
);
SidebarMenuItem.displayName = 'SidebarMenuItem';

const sidebarMenuButtonVariants = cva(
  'peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'hover:bg-sidebar-accent hover:text-sidebar-accent-foreground',
        outline:
          'bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]',
      },
      size: {
        default: 'h-8 text-sm',
        sm: 'h-7 text-xs',
        lg: 'h-12 text-sm group-data-[collapsible=icon]:!p-0',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  },
);

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(
  (
    {
      asChild = false,
      isActive = false,
      variant = 'default',
      size = 'default',
      tooltip,
      className,
      ...props
    },
    ref,
  ) => {
    const Comp = asChild ? Slot : 'button';
    const { isMobile, state } = useSidebar();

    const button = (
      <Comp
        ref={ref}
        data-sidebar="menu-button"
        data-size={size}
        data-active={isActive}
        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
        {...props}
      />
    );

    if (!tooltip) {
      return button;
    }

    if (typeof tooltip === 'string') {
      tooltip = {
        children: tooltip,
      };
    }

    return (
      <Tooltip>
        <TooltipTrigger asChild>{button}</TooltipTrigger>
        <TooltipContent
          side="right"
          align="center"
          hidden={state !== 'collapsed' || isMobile}
          {...tooltip}
        />
      </Tooltip>
    );
  },
);
SidebarMenuButton.displayName = 'SidebarMenuButton';

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<'button'> & {
    asChild?: boolean;
    showOnHover?: boolean;
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : 'button';

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        'absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0',
        // Increases the hit area of the button on mobile.
        'after:absolute after:-inset-2 after:md:hidden',
        'peer-data-[size=sm]/menu-button:top-1',
        'peer-data-[size=default]/menu-button:top-1.5',
        'peer-data-[size=lg]/menu-button:top-2.5',
        'group-data-[collapsible=icon]:hidden',
        showOnHover &&
          'group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0',
        className,
      )}
      {...props}
    />
  );
});
SidebarMenuAction.displayName = 'SidebarMenuAction';

const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
  ({ className, ...props }, ref) => (
    <div
      ref={ref}
      data-sidebar="menu-badge"
      className={cn(
        'absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none',
        'peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground',
        'peer-data-[size=sm]/menu-button:top-1',
        'peer-data-[size=default]/menu-button:top-1.5',
        'peer-data-[size=lg]/menu-button:top-2.5',
        'group-data-[collapsible=icon]:hidden',
        className,
      )}
      {...props}
    />
  ),
);
SidebarMenuBadge.displayName = 'SidebarMenuBadge';

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    showIcon?: boolean;
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);

  return (
    <div
      ref={ref}
      data-sidebar="menu-skeleton"
      className={cn('rounded-md h-8 flex gap-2 px-2 items-center', className)}
      {...props}
    >
      {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
      <Skeleton
        className="h-4 flex-1 max-w-[--skeleton-width]"
        data-sidebar="menu-skeleton-text"
        style={
          {
            '--skeleton-width': width,
          } as React.CSSProperties
        }
      />
    </div>
  );
});
SidebarMenuSkeleton.displayName = 'SidebarMenuSkeleton';

const SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(
  ({ className, ...props }, ref) => (
    <ul
      ref={ref}
      data-sidebar="menu-sub"
      className={cn(
        'mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5',
        'group-data-[collapsible=icon]:hidden',
        className,
      )}
      {...props}
    />
  ),
);
SidebarMenuSub.displayName = 'SidebarMenuSub';

const SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(
  ({ ...props }, ref) => <li ref={ref} {...props} />,
);
SidebarMenuSubItem.displayName = 'SidebarMenuSubItem';

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<'a'> & {
    asChild?: boolean;
    size?: 'sm' | 'md';
    isActive?: boolean;
  }
>(({ asChild = false, size = 'md', isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : 'a';

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        'flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground',
        'data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground',
        size === 'sm' && 'text-xs',
        size === 'md' && 'text-sm',
        'group-data-[collapsible=icon]:hidden',
        className,
      )}
      {...props}
    />
  );
});
SidebarMenuSubButton.displayName = 'SidebarMenuSubButton';

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};

```

# components/ui/skeleton.tsx

```tsx
import { cn } from '@/lib/utils';

function Skeleton({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn(
        'relative isolate overflow-hidden rounded-md bg-gray-200/60 before:absolute before:inset-0 before:-translate-x-full before:animate-[shimmer_2s_infinite] before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent',
        className,
      )}
      {...props}
    />
  );
}

export { Skeleton };

```

# components/ui/slider.tsx

```tsx
'use client';

import * as SliderPrimitive from '@radix-ui/react-slider';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn('relative flex w-full touch-none select-none items-center', className)}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
));
Slider.displayName = SliderPrimitive.Root.displayName;

export { Slider };

```

# components/ui/table.tsx

```tsx
import * as React from 'react';

import { cn } from '@/lib/utils';

const Table = React.forwardRef<HTMLTableElement, React.HTMLAttributes<HTMLTableElement>>(
  ({ className, ...props }, ref) => (
    <div className="relative w-full overflow-auto">
      <table ref={ref} className={cn('w-full caption-bottom text-sm', className)} {...props} />
    </div>
  ),
);
Table.displayName = 'Table';

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn('[&_tr]:border-b', className)} {...props} />
));
TableHeader.displayName = 'TableHeader';

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody ref={ref} className={cn('[&_tr:last-child]:border-0', className)} {...props} />
));
TableBody.displayName = 'TableBody';

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn('border-t bg-muted/50 font-medium [&>tr]:last:border-b-0', className)}
    {...props}
  />
));
TableFooter.displayName = 'TableFooter';

const TableRow = React.forwardRef<HTMLTableRowElement, React.HTMLAttributes<HTMLTableRowElement>>(
  ({ className, ...props }, ref) => (
    <tr
      ref={ref}
      className={cn(
        'border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted',
        className,
      )}
      {...props}
    />
  ),
);
TableRow.displayName = 'TableRow';

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      'h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0',
      className,
    )}
    {...props}
  />
));
TableHead.displayName = 'TableHead';

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn('p-4 align-middle [&:has([role=checkbox])]:pr-0', className)}
    {...props}
  />
));
TableCell.displayName = 'TableCell';

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption ref={ref} className={cn('mt-4 text-sm text-muted-foreground', className)} {...props} />
));
TableCaption.displayName = 'TableCaption';

export { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };

```

# components/ui/tabs.tsx

```tsx
'use client';

import * as TabsPrimitive from '@radix-ui/react-tabs';
import * as React from 'react';

import { cn } from '@/lib/utils';

const Tabs = TabsPrimitive.Root;

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      'inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground',
      className,
    )}
    {...props}
  />
));
TabsList.displayName = TabsPrimitive.List.displayName;

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      'inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm',
      className,
    )}
    {...props}
  />
));
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      'mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',
      className,
    )}
    {...props}
  />
));
TabsContent.displayName = TabsPrimitive.Content.displayName;

export { Tabs, TabsList, TabsTrigger, TabsContent };

```

# components/ui/textarea.tsx

```tsx
import * as React from 'react';

import { cn } from '@/lib/utils';

const Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Textarea.displayName = 'Textarea';

export { Textarea };

```

# components/ui/toast.tsx

```tsx
'use client';

import * as ToastPrimitives from '@radix-ui/react-toast';
import { type VariantProps, cva } from 'class-variance-authority';
import { X } from 'lucide-react';
import * as React from 'react';

import { cn } from '@/lib/utils';

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      'fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]',
      className,
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  'group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full',
  {
    variants: {
      variant: {
        default: 'border bg-background text-foreground',
        destructive:
          'destructive group border-destructive bg-destructive text-destructive-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> & VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  );
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      'inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive',
      className,
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      'absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600',
      className,
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title ref={ref} className={cn('text-sm font-semibold', className)} {...props} />
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn('text-sm opacity-90', className)}
    {...props}
  />
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};

```

# components/ui/toaster.tsx

```tsx
'use client';

import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from '@/components/ui/toast';
import { useToast } from '@/hooks/use-toast';

export function Toaster() {
  const { toasts } = useToast();

  return (
    <ToastProvider>
      {toasts.map(({ id, title, description, action, ...props }) => (
        <Toast key={id} {...props}>
          <div className="grid gap-1">
            {title && <ToastTitle>{title}</ToastTitle>}
            {description && <ToastDescription>{description}</ToastDescription>}
          </div>
          {action}
          <ToastClose />
        </Toast>
      ))}
      <ToastViewport />
    </ToastProvider>
  );
}

```

# components/ui/tooltip.tsx

```tsx
'use client';

import * as TooltipPrimitive from '@radix-ui/react-tooltip';
import * as React from 'react';

import { cn } from '@/lib/utils';

const TooltipProvider = TooltipPrimitive.Provider;

const Tooltip = TooltipPrimitive.Root;

const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      'z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };

```

# google954e91bbb2fe0c6c.html

```html
google-site-verification: google954e91bbb2fe0c6c.html
```

# hooks/use-mobile.tsx

```tsx
import * as React from 'react';

const MOBILE_BREAKPOINT = 768;

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined);

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    };
    mql.addEventListener('change', onChange);
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    return () => mql.removeEventListener('change', onChange);
  }, []);

  return !!isMobile;
}

```

# hooks/use-toast.ts

```ts
'use client';

// Inspired by react-hot-toast library
import * as React from 'react';

import type { ToastActionElement, ToastProps } from '@/components/ui/toast';

const TOAST_LIMIT = 1;
const TOAST_REMOVE_DELAY = 1000000;

type ToasterToast = ToastProps & {
  id: string;
  title?: React.ReactNode;
  description?: React.ReactNode;
  action?: ToastActionElement;
};

const actionTypes = {
  ADD_TOAST: 'ADD_TOAST',
  UPDATE_TOAST: 'UPDATE_TOAST',
  DISMISS_TOAST: 'DISMISS_TOAST',
  REMOVE_TOAST: 'REMOVE_TOAST',
} as const;

let count = 0;

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER;
  return count.toString();
}

type ActionType = typeof actionTypes;

type Action =
  | {
      type: ActionType['ADD_TOAST'];
      toast: ToasterToast;
    }
  | {
      type: ActionType['UPDATE_TOAST'];
      toast: Partial<ToasterToast>;
    }
  | {
      type: ActionType['DISMISS_TOAST'];
      toastId?: ToasterToast['id'];
    }
  | {
      type: ActionType['REMOVE_TOAST'];
      toastId?: ToasterToast['id'];
    };

interface State {
  toasts: ToasterToast[];
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return;
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId);
    dispatch({
      type: 'REMOVE_TOAST',
      toastId: toastId,
    });
  }, TOAST_REMOVE_DELAY);

  toastTimeouts.set(toastId, timeout);
};

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case 'ADD_TOAST':
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      };

    case 'UPDATE_TOAST':
      return {
        ...state,
        toasts: state.toasts.map((t) => (t.id === action.toast.id ? { ...t, ...action.toast } : t)),
      };

    case 'DISMISS_TOAST': {
      const { toastId } = action;

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId);
      } else {
        for (const toast of state.toasts) {
          addToRemoveQueue(toast.id);
        }
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t,
        ),
      };
    }
    case 'REMOVE_TOAST':
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        };
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      };
  }
};

const listeners: Array<(state: State) => void> = [];

let memoryState: State = { toasts: [] };

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action);
  for (const listener of listeners) {
    listener(memoryState);
  }
}

type Toast = Omit<ToasterToast, 'id'>;

function toast({ ...props }: Toast) {
  const id = genId();

  const update = (props: ToasterToast) =>
    dispatch({
      type: 'UPDATE_TOAST',
      toast: { ...props, id },
    });
  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id });

  dispatch({
    type: 'ADD_TOAST',
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss();
      },
    },
  });

  return {
    id: id,
    dismiss,
    update,
  };
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState);

  // biome-ignore lint/correctness/useExhaustiveDependencies: <explanation>
  React.useEffect(() => {
    listeners.push(setState);
    return () => {
      const index = listeners.indexOf(setState);
      if (index > -1) {
        listeners.splice(index, 1);
      }
    };
  }, [state]);

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),
  };
}

export { useToast, toast };

```

# hooks/useAttendanceQr.ts

```ts
export function createQrValue(gymData: { gymname: string; gymid: number }) {
  const now = new Date();
  now.setMinutes(0, 0, 0);

  return JSON.stringify({
    AttendanceAction: {
      gymname: gymData.gymname,
      gymid: gymData.gymid,
      timestamp: now.toISOString(),
    },
  });
}

```

# jest.config.js

```js
module.exports = {
  testEnvironment: 'jsdom',
  moduleFileExtensions: ['js', 'jsx', 'ts', 'tsx', 'json', 'node'],
  testPathIgnorePatterns: ['/node_modules/', '/dist/'],
  transform: {
    '^.+\\.(ts|tsx)$': 'ts-jest',
  },
};

```

# lib/AI/client.ts

```ts
'use server';

import { GoogleGenerativeAI } from '@google/generative-ai';
import type { Message } from 'ai';
import { OpenAI } from 'openai';
import type { ChatCompletionMessageParam } from 'openai/resources/chat/completions';
import { v4 as uuidv4 } from 'uuid';

// Get API key with fallbacks for different environment variable names
const geminiApiKey = process.env.GOOGLE_GEMINI_API_KEY || process.env.GEMINI_API_KEY || '';

// Initialize AI providers
const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY || '',
});

// Debug logging
console.log('Environment test var:', process.env.TEST_ENV);
console.log('Initializing Gemini with API key available:', !!geminiApiKey);
console.log('API key first 4 chars:', geminiApiKey ? geminiApiKey.substring(0, 4) : 'none');

const genAI = new GoogleGenerativeAI(geminiApiKey);

/**
 * Generate content with Gemini model
 */
export async function generateWithGemini(
  prompt: string,
  options?: {
    temperature?: number;
    maxOutputTokens?: number;
  },
) {
  try {
    // Additional validation to provide clearer error messages
    if (!geminiApiKey) {
      throw new Error('Gemini API key is not configured. Please check your environment variables.');
    }

    // Using free tier model instead of pro models
    // Try gemini-1.0-pro-vision-latest first (available on free tier)
    const modelName = 'gemini-1.5-flash';

    const model = genAI.getGenerativeModel({
      model: modelName,
      generationConfig: {
        temperature: options?.temperature || 0.4,
        topK: 32,
        topP: 0.95,
        maxOutputTokens: options?.maxOutputTokens || 4096,
      },
    });

    console.log(`Trying to generate content with ${modelName} model...`);

    // Regular non-streaming response
    try {
      const result = await model.generateContent(prompt);
      return result.response.text();
    } catch (modelError: unknown) {
      console.log('modelError', modelError);
      // If the first model fails, try another free model
      console.log(`${modelName} failed, trying gemini-pro...`);
      const fallbackModel = genAI.getGenerativeModel({
        model: 'gemini-pro',
        generationConfig: {
          temperature: options?.temperature || 0.4,
          topK: 32,
          topP: 0.95,
          maxOutputTokens: options?.maxOutputTokens || 2048, // Reduced tokens
        },
      });

      const fallbackResult = await fallbackModel.generateContent(prompt);
      return fallbackResult.response.text();
    }
  } catch (error) {
    console.error('Gemini API error details:', error);

    // If OpenAI key is available, fallback to OpenAI
    if (process.env.OPENAI_API_KEY) {
      console.log('Falling back to OpenAI...');
      try {
        return await generateWithOpenAI([{ role: 'user', content: prompt, id: uuidv4() }], {
          temperature: options?.temperature,
        });
      } catch (openaiError) {
        console.error('OpenAI fallback error:', openaiError);
        throw new Error('Failed to generate content with both Gemini and OpenAI');
      }
    }

    throw new Error(
      `Failed to generate content with Gemini: ${
        error instanceof Error ? error.message : 'Unknown error'
      }`,
    );
  }
}

/**
 * Generate content with OpenAI
 */
export async function generateWithOpenAI(
  messages: Message[],
  options?: {
    temperature?: number;
    maxTokens?: number;
    model?: string;
  },
) {
  try {
    // Convert ai.Message to OpenAI's expected format
    const openaiMessages: ChatCompletionMessageParam[] = messages.map((msg) => {
      // Only include the role and content properties that OpenAI expects
      return {
        role: msg.role === 'user' ? 'user' : msg.role === 'assistant' ? 'assistant' : 'system',
        content: msg.content,
      };
    });

    const response = await openai.chat.completions.create({
      model: options?.model || 'gpt-3.5-turbo',
      messages: openaiMessages,
      temperature: options?.temperature || 0.7,
      max_tokens: options?.maxTokens || 2048,
    });

    return response.choices[0].message.content;
  } catch (error) {
    console.error('OpenAI API error:', error);
    throw new Error('Failed to generate content with OpenAI');
  }
}

/**
 * Generate structured content with retry logic
 */
export async function generateStructuredContent<T>(
  prompt: string,
  validateFn: (data: string) => { valid: boolean; data?: T; errors?: unknown },
  options?: {
    provider?: 'gemini' | 'openai';
    maxAttempts?: number;
    temperature?: number;
  },
) {
  // Default to OpenAI if OPENAI_API_KEY is available and no provider is specified
  const defaultProvider = process.env.OPENAI_API_KEY ? 'openai' : 'gemini';
  const provider = options?.provider || defaultProvider;
  const maxAttempts = options?.maxAttempts || 3;
  let attempts = 0;
  let lastResponse = '';
  let currentPrompt = prompt;

  while (attempts < maxAttempts) {
    attempts++;
    try {
      // Generate response based on provider
      const response =
        provider === 'gemini'
          ? await generateWithGemini(currentPrompt, {
              temperature: options?.temperature,
            })
          : await generateWithOpenAI([{ role: 'user', content: currentPrompt, id: uuidv4() }], {
              temperature: options?.temperature,
            });

      lastResponse = response as string;

      // Validate response
      const validation = validateFn(lastResponse || '');

      if (validation.valid && validation.data) {
        console.log('Validation passed: form the AI', validation.data);
        return {
          success: true,
          data: validation.data,
          attempts,
        };
      }

      // If invalid, refine the prompt with error feedback
      currentPrompt = `
I tried to generate a structured response but received these errors:
${JSON.stringify(validation.errors || 'Invalid format')}

Please fix these issues and provide a response that strictly follows the specified format.

Original prompt:
${prompt}
`;
    } catch (error) {
      console.error(`Error on attempt ${attempts}:`, error);

      // If we were using Gemini and it failed, try OpenAI if available
      if (provider === 'gemini' && process.env.OPENAI_API_KEY && attempts === maxAttempts) {
        console.log('Switching to OpenAI for final attempt...');
        try {
          const openaiResponse = await generateWithOpenAI(
            [{ role: 'user', content: currentPrompt, id: uuidv4() }],
            {
              temperature: options?.temperature,
            },
          );

          lastResponse = openaiResponse as string;
          const validation = validateFn(lastResponse);

          if (validation.valid && validation.data) {
            return {
              success: true,
              data: validation.data,
              attempts,
              provider: 'openai',
            };
          }
        } catch (openaiError) {
          console.error('OpenAI fallback error:', openaiError);
        }
      }
    }
  }

  // If all attempts failed
  throw new Error(
    `Failed to generate valid structured content after ${maxAttempts} attempts. Last response: ${lastResponse}`,
  );
}

/**
 * Generate with feedback for iterative improvement
 */
export async function regenerateWithFeedback<T>(
  originalPrompt: string,
  originalResponse: unknown,
  feedback: string,
  validateFn: (data: string) => { valid: boolean; data?: T; errors?: unknown },
  options?: {
    provider?: 'gemini' | 'openai';
    temperature?: number;
  },
) {
  const provider = options?.provider || 'gemini';

  const feedbackPrompt = `
I previously generated this response:
${JSON.stringify(originalResponse, null, 2)}

Based on this feedback:
"${feedback}"

I need to create an improved version that addresses this feedback while maintaining the same structure.
Please provide a complete response that incorporates the feedback.

Original request:
${originalPrompt}
`;

  try {
    // Generate improved response with feedback
    const response =
      provider === 'gemini'
        ? await generateWithGemini(feedbackPrompt, {
            temperature: options?.temperature || 0.5,
          })
        : await generateWithOpenAI([{ role: 'user', content: feedbackPrompt, id: uuidv4() }], {
            temperature: options?.temperature || 0.5,
          });

    // Validate response
    const validation = validateFn(response || '');

    if (validation.valid && validation.data) {
      console.log('Validation passed:', validation.data);
      return {
        success: true,
        data: validation.data,
      };
    }

    throw new Error('Generated response did not pass validation');
  } catch (error) {
    console.error('Error regenerating with feedback:', error);
    throw new Error('Failed to regenerate content based on feedback');
  }
}

```

# lib/AI/index.ts

```ts
// Export all AI functionality
export * from './client';
export * from './schema-validation';

// Export types
export * from './types/workout-types';
export * from './types/diet-types';

// Export prompts
export * from './prompts/workout-prompts';
export * from './prompts/diet-prompts';

```

# lib/AI/prompts/diet-prompts.ts

```ts
import type { DietPlan } from '@/app/dashboard/trainer/diet/assigndietplan/_actions /GetallDiets';
import type { AssignedUser } from '@/app/dashboard/trainer/workouts/assignworkout/GetuserassignedTotrainers';

// Define interface for HealthProfile to properly type the properties
interface HealthProfile {
  height?: number;
  weight?: number;
  gender?: string;
  goal?: string;
}

/**
 * Generate a diet plan for a user based on their profile and trainer preferences
 */
export function buildDietPlanPrompt(
  user: AssignedUser,
  preferences: {
    dailyCalories?: number;
    mealsPerDay?: number;
    dietType?: string;
    restrictions?: string[];
    goal?: 'weight_loss' | 'maintenance' | 'muscle_gain';
    proteinTarget?: 'high' | 'moderate' | 'low';
    specialInstructions?: string;
  },
) {
  const {
    dailyCalories,
    mealsPerDay = 5,
    dietType = 'balanced',
    restrictions = [],
    goal = 'maintenance',
    proteinTarget = 'moderate',
    specialInstructions = '',
  } = preferences;

  // Extract health profile data safely with proper typing
  const healthProfile = (user.HealthProfile || {}) as HealthProfile;
  const height = healthProfile.height || 'Unknown';
  const weight = healthProfile.weight || 'Unknown';
  const gender = healthProfile.gender || user.gender || 'Unknown';
  const userGoal = healthProfile.goal || user.goal || 'General fitness';

  // Calculate daily calories if not provided
  const calculatedCalories =
    dailyCalories ||
    (gender.toLowerCase() === 'male'
      ? Math.round(
          (typeof weight === 'number' ? weight : 70) * 10 +
            (typeof height === 'number' ? height : 170) * 6.25 -
            5 * 25 +
            5,
        ) * 1.55
      : Math.round(
          (typeof weight === 'number' ? weight : 60) * 10 +
            (typeof height === 'number' ? height : 160) * 6.25 -
            5 * 25 -
            161,
        ) * 1.55);

  // Adjust calories based on goal
  const adjustedCalories =
    goal === 'weight_loss'
      ? Math.round(calculatedCalories * 0.8)
      : goal === 'muscle_gain'
        ? Math.round(calculatedCalories * 1.1)
        : calculatedCalories;

  // Calculate macros based on protein target - fixed variable declarations
  let proteinPercentage: number;
  let carbsPercentage: number;
  let fatsPercentage: number;

  switch (proteinTarget) {
    case 'high':
      proteinPercentage = 40;
      carbsPercentage = 30;
      fatsPercentage = 30;
      break;
    case 'low':
      proteinPercentage = 15;
      carbsPercentage = 60;
      fatsPercentage = 25;
      break;
    // Combined moderate and default since they're the same
    default:
      proteinPercentage = 30;
      carbsPercentage = 40;
      fatsPercentage = 30;
      break;
  }

  return `
Create a personalized diet plan for a client with the following profile:
- Gender: ${gender}
- Weight: ${weight} kg
- Height: ${height} cm
- Fitness goal: ${userGoal}
- Diet goal: ${goal.replace('_', ' ')}

Diet parameters:
- Type: ${dietType}
- Daily calories: ${adjustedCalories} kcal
- Meals per day: ${mealsPerDay}
- Protein target: ${proteinTarget} (${proteinPercentage}%)
- Carbohydrates: ${carbsPercentage}%
- Fats: ${fatsPercentage}%

${restrictions.length ? `Dietary restrictions:\n${restrictions.map((r) => `- ${r}`).join('\n')}` : ''}
${specialInstructions ? `Special instructions: ${specialInstructions}` : ''}

RESPONSE FORMAT:
You must respond with a valid JSON object that strictly follows this schema:
{
  "name": "Name of the diet plan",
  "description": "Brief overview of the diet plan",
  "dailyCalories": ${adjustedCalories},
  "proteinPercentage": ${proteinPercentage},
  "carbsPercentage": ${carbsPercentage},
  "fatsPercentage": ${fatsPercentage},
  "meals": [
    {
      "name": "Meal name (e.g., Breakfast)",
      "timeOfDay": "Time of day (e.g., 8:00 AM)",
      "totalCalories": 500, // Calories for this meal
      "items": [
        {
          "name": "Food item",
          "portion": "Portion size (e.g., '1 cup')",
          "calories": 200, // Calories for this item
          "protein": 20, // Protein in grams
          "carbs": 30, // Carbs in grams
          "fats": 5, // Fats in grams
          "description": "Brief preparation instructions"
        }
        // Include all items in this meal
      ]
    }
    // Include all meals for the day
  ],
  "waterIntake": 2500, // Daily water intake in ml
  "supplements": ["Supplement 1", "Supplement 2"], // Optional supplements
  "notes": "Additional notes about the diet plan" // Optional notes
}

IMPORTANT:
1. Respond ONLY with the JSON. No introduction or explanations.
2. Ensure all required fields are included and properly typed.
3. Make sure the total calories across all meals equals the daily calorie target.
4. Ensure macronutrient percentages match the specified targets.
5. Include practical, easy-to-prepare meals that are realistic for daily consumption.
6. Consider the client's dietary restrictions.
`;
}

interface DietGenerationParams {
  dietPreference: string;
  medicalConditions: string[];
  location: string;
  country: string;
  targetCalories?: number;
  specialInstructions?: string;
}

/**
 * Generate a diet plan prompt based on user parameters
 */
export function generateDietPrompt(params: DietGenerationParams): string {
  const {
    dietPreference,
    medicalConditions = [],
    location,
    country,
    targetCalories,
    specialInstructions = '',
  } = params;

  // Format medical conditions for the prompt
  const medicalConditionsText = medicalConditions.length
    ? `The user has the following medical conditions to consider: ${medicalConditions.join(', ')}.`
    : '';

  // Format special instructions
  const specialInstructionsText = specialInstructions
    ? `Additional requirements: ${specialInstructions}`
    : '';

  // Format target calories
  const caloriesText = targetCalories
    ? `with a target caloric intake of ${targetCalories} calories per day`
    : 'with appropriate caloric intake based on standard dietary guidelines';

  return `
Create a personalized diet plan for a client with ${dietPreference} dietary preference, located in ${location}, ${country} ${caloriesText}.
${medicalConditionsText}
${specialInstructionsText}

Consider local food availability and cultural preferences based on the location.

Provide a complete diet plan in JSON format with the following structure:
{
  "name": "Descriptive name for the diet plan",
  "description": "Brief overview of the diet plan and its benefits",
  "targetCalories": number,
  "proteinRatio": number (percentage as decimal),
  "carbsRatio": number (percentage as decimal),
  "fatsRatio": number (percentage as decimal),
  "meals": [
    {
      "id": number,
      "name": "Meal name",
      "timeOfDay": "Time of day (e.g., 'Breakfast', 'Lunch')",
      "calories": number,
      "protein": number (in grams),
      "carbs": number (in grams),
      "fats": number (in grams),
      "instructions": "Brief instructions for meal preparation"
    }
    // Additional meals...
  ]
}

Please ensure the diet plan:
1. Respects the specified dietary preferences
2. Accounts for any medical conditions
3. Includes locally available ingredients
4. Provides balanced nutrition
5. Is culturally appropriate for the location
`;
}

/**
 * Generate feedback-based improvements to a diet plan
 */
export function buildDietFeedbackPrompt(originalPlan: DietPlan, feedback: string): string {
  return `
I previously generated this diet plan:
${JSON.stringify(originalPlan, null, 2)}

The trainer provided this feedback:
"${feedback}"

Please adjust the diet plan to address this feedback. Maintain the same JSON structure as the original plan:
{
  "name": "Plan name",
  "description": "Plan description",
  "targetCalories": number,
  "proteinRatio": number,
  "carbsRatio": number,
  "fatsRatio": number,
  "meals": [
    {
      "id": number,
      "name": "Meal name",
      "timeOfDay": "Time of day",
      "calories": number,
      "protein": number,
      "carbs": number,
      "fats": number,
      "instructions": "Instructions"
    }
  ]
}

IMPORTANT:
1. Respond ONLY with the updated JSON. No explanation needed.
2. Keep the same structure but modify the content based on feedback.
3. Ensure all fields from the original plan remain in the response.
`;
}

```

# lib/AI/prompts/workout-prompts.ts

```ts
import type { WorkoutGenerationParams } from '@/app/dashboard/trainer/workouts/assigncustomworkoutswithai/_actions/generate-ai-workout';
import type { Exercise, WorkoutPlan, WorkoutSchedule } from '../types/workout-types';

interface FeedbackPromptParams {
  userId: string;
  originalWorkoutPlan: WorkoutPlan;
  feedback: string;
  conversationHistory: string;
}

/**
 * Generate a workout plan prompt based on user parameters
 */
export function generateWorkoutPrompt(params: WorkoutGenerationParams): string {
  const {
    goals,
    fitnessLevel,
    preferredDays = [],
    focusAreas = [],
    healthConditions = [],
    workoutDuration = 45,
    specialInstructions = '',
  } = params;

  // Format focus areas for the prompt
  const focusAreasText = focusAreas.length ? `with special focus on: ${focusAreas.join(', ')}` : '';

  // Format health conditions for the prompt
  const healthConditionsText = healthConditions.length
    ? `The user has the following health conditions to consider: ${healthConditions.join(', ')}.`
    : '';

  // Format preferred days
  const daysPerWeek = preferredDays.length;
  const daysText = `${daysPerWeek} days per week specifically on these days: ${preferredDays.join(
    ', ',
  )}`;

  // Format special instructions
  const specialInstructionsText = specialInstructions
    ? `Additional requirements: ${specialInstructions}`
    : '';

  return `
Create a personalized workout plan for a ${fitnessLevel} level client with the primary goal of ${goals} ${focusAreasText}.
The workout plan should be designed for ${daysText}, with each workout lasting approximately ${workoutDuration} minutes.
${healthConditionsText}
${specialInstructionsText}

IMPORTANT: Generate workouts ONLY for these specific days: ${preferredDays.join(
    ', ',
  )}. Do not add workouts for any other days.

Provide a complete workout plan in JSON format with the following structure:
{
  "name": "Descriptive name for the workout plan",
  "description": "Brief overview of the workout plan and its benefits",
  "schedules": [
    {
      "dayOfWeek": "Monday",
      "muscleTarget": "Primary muscle groups targeted",
      "duration": duration in minutes,
      "calories": estimated calories burned,
      "exercises": [
        {
          "name": "Exercise name",
          "sets": number of sets,
          "reps": "repetition scheme (e.g. '10-12' or '3x10')",
          "description": "Brief description of how to perform the exercise",
          "order": 0,
          
        }
        // Additional exercises...
      ]
    }
    // Additional workout days...
  ]
}

Please ensure the workout plan follows best practices for exercise selection, sequencing, and recovery. Include appropriate warm-up and cool-down recommendations.
`;
}

/**
 * Generate feedback-based improvements to a workout plan
 */
export function buildWorkoutFeedbackPrompt(originalPlan: WorkoutPlan, feedback: string) {
  return `
I previously generated this workout plan:
${JSON.stringify(originalPlan, null, 2)}

The trainer provided this feedback:
"${feedback}"

Please adjust the workout plan to address this feedback. Maintain the same JSON structure:
{
  "name": "Plan name",
  "description": "Plan description",
  "schedules": [
    {
      "dayOfWeek": "Day",
      "muscleTarget": "Target muscles",
      "duration": duration_in_minutes,
      "calories": calories_burned,
      "exercises": [
        {
          "name": "Exercise name",
          "sets": number_of_sets,
          "reps": "rep_range",
          "description": "Instructions",
          "order": order_number,
          
        }
      ]
    }
  ]
}

IMPORTANT:
1. Respond ONLY with the updated JSON. No explanation needed.
2. Keep the same structure but modify the content based on feedback.
3. Ensure all fields from the original plan remain in the response.
`;
}

export function generateFeedbackPrompt(params: FeedbackPromptParams): string {
  const { originalWorkoutPlan, feedback, conversationHistory } = params;

  // Serialize the workout plan to provide context to the AI
  const workoutDetails = `
  Workout Name: ${originalWorkoutPlan.name}
  Description: ${originalWorkoutPlan.description || 'Not provided'}
  Schedule:
  ${originalWorkoutPlan.schedules
    .map(
      (s: WorkoutSchedule) => `
  - Day: ${s.dayOfWeek}
    Target: ${s.muscleTarget}
    Duration: ${s.duration} minutes
    Exercises: ${s.exercises
      .map((e: Exercise) => `${e.name} (${e.sets}x${e.reps})`)
      .join(', ')}
  `,
    )
    .join('')}
  `;

  return `
  You are an expert fitness trainer tasked with refining workout plans based on client feedback.
  
  THE ORIGINAL WORKOUT PLAN:
  ${workoutDetails}
  
  CONVERSATION HISTORY:
  ${conversationHistory}
  
  RECENT FEEDBACK FROM TRAINER:
  "${feedback}"
  
  Based on this feedback, please create a refined version of the workout plan that addresses the concerns or requested changes.
  
  Your response should follow this exact JSON structure:
  {
    "name": "Name of the workout plan",
    "description": "Brief description of the workout plan's goal and approach",
    "schedules": [
      {
        "dayOfWeek": "Monday/Tuesday/etc.",
        "muscleTarget": "Target muscle groups for this day",
        "duration": duration_in_minutes,
        "calories": estimated_calories_burned,
        "exercises": [
          {
            "name": "Exercise name",
            "sets": number_of_sets,
            "reps": "repetition scheme (e.g. '8-12' or '10')",
            "description": "Brief instructions or notes about the exercise",
            "order": 1,
            
          }
          // Additional exercises...
        ]
      }
      // Additional days...
    ]
  }
  
  IMPORTANT NOTES:
  1. Maintain the same overall structure but modify specific elements based on the feedback
  2. Keep exercise descriptions concise but informative
  3. Ensure appropriate progression and balance across the workout week
  4. The workout should be tailored to address the specific feedback provided
  5. If the feedback mentions intensity, modify sets, reps, or exercise selection accordingly
  6. If the feedback mentions time constraints, adjust the duration and exercise count
  7. Return ONLY valid JSON that follows the exact structure above
  `;
}

```

# lib/AI/schema-validation.ts

```ts
import { z } from 'zod';

/**
 * Extract JSON from a string that might contain markdown or explanatory text
 */
export function extractJsonFromString(text: string): unknown | null {
  try {
    // Try to parse the string directly first
    try {
      return JSON.parse(text);
    } catch (_e) {
      // Not a direct JSON string, try to extract JSON
    }

    // Look for JSON object pattern
    const jsonMatch = text.match(/{[\s\S]*}/);
    if (jsonMatch) {
      try {
        // Clean the JSON string - replace multiple spaces after colons with single space
        const cleanedJson = jsonMatch[0].replace(/:\s+/g, ': ');
        return JSON.parse(cleanedJson);
      } catch (e) {
        console.error('Failed to parse JSON match:', e);
      }
    }

    // Look for JSON patterns in code blocks (common in AI responses)
    const codeBlockMatch = text.match(/\`\`\`(?:json)?\s*([\s\S]*?)\s*\`\`\`/);
    if (codeBlockMatch?.[1]) {
      try {
        // Clean the JSON string - replace multiple spaces after colons with single space
        const cleanedJson = codeBlockMatch[1].replace(/:\s+/g, ': ');
        return JSON.parse(cleanedJson);
      } catch (e) {
        console.error('Failed to parse code block JSON:', e);
      }
    }

    // If we can't find a JSON object, return null
    return null;
  } catch (error) {
    console.error('Failed to extract JSON from string:', error);
    return null;
  }
}

/**
 * Validate AI response against schema and extract structured data
 */
export function validateResponseWithSchema<T>(
  response: string,
  schema: z.ZodType<T>,
): { valid: boolean; data?: T; errors?: z.ZodError } {
  try {
    // Extract JSON from response
    const extractedData = extractJsonFromString(response);

    if (!extractedData) {
      return {
        valid: false,
        errors: new z.ZodError([
          {
            code: 'custom',
            message: 'No JSON data found in response',
            path: [],
          },
        ]),
      };
    }

    // Validate against schema
    const result = schema.safeParse(extractedData);

    if (result.success) {
      return {
        valid: true,
        data: result.data,
      };
    }

    return {
      valid: false,
      errors: result.error,
    };
  } catch (error) {
    console.error('Validation error:', error);
    return {
      valid: false,
      errors:
        error instanceof z.ZodError
          ? error
          : new z.ZodError([
              {
                code: 'custom',
                // @ts-ignore
                message: error.message || 'Unknown error during validation',
                path: [],
              },
            ]),
    };
  }
}

```

# lib/AI/types/diet-types.ts

```ts
import { z } from 'zod';

// Zod schemas for diet plan validation
export const MealSchema = z.object({
  id: z.number(),
  name: z.string().min(1, 'Meal name is required'),
  timeOfDay: z.string().min(1, 'Time of day is required'),
  calories: z.number().min(1, 'Calories must be provided'),
  protein: z.number().min(0, 'Protein must be non-negative'),
  carbs: z.number().min(0, 'Carbs must be non-negative'),
  fats: z.number().min(0, 'Fats must be non-negative'),
  instructions: z.string(),
});

export const DietPlanSchema = z.object({
  id: z.number().optional(), // Optional for AI generation, required when saved
  name: z.string().min(3, 'Plan name must be at least 3 characters'),
  description: z.string().optional(),
  targetCalories: z.number().min(500, 'Target calories should be at least 500'),
  proteinRatio: z.number().min(0.1).max(0.6), // 10-60% as decimal
  carbsRatio: z.number().min(0.1).max(0.6), // 10-60% as decimal
  fatsRatio: z.number().min(0.1).max(0.6), // 10-60% as decimal
  meals: z.array(MealSchema).min(1, 'At least one meal is required'),
});

// TypeScript types (inferred from the Zod schemas)
export type Meal = z.infer<typeof MealSchema>;
export type DietPlan = z.infer<typeof DietPlanSchema>;

/**
 * Validate a diet plan against the schema
 */
export function validateDietPlan(data: unknown) {
  try {
    // If data is a string, try to parse it as JSON
    let parsedData = data;
    if (typeof data === 'string') {
      try {
        // Clean up the string by removing extra spaces after colons
        const cleanedString = data.replace(/:\s+/g, ': ');
        parsedData = JSON.parse(cleanedString);
      } catch (e) {
        console.error('Failed to parse string data:', e);
      }
    }

    // Additional preprocessing for meal names that might have extra spaces
    if (parsedData && typeof parsedData === 'object' && 'meals' in parsedData) {
      // Use a more specific type
      type PartialDietPlan = {
        meals?: Array<{
          name?: string;
          timeOfDay?: string;
          [key: string]: unknown;
        }>;
        proteinRatio?: number;
        carbsRatio?: number;
        fatsRatio?: number;
        [key: string]: unknown;
      };

      const typedData = parsedData as PartialDietPlan;

      // Clean up any meal names that might have extra spaces
      if (Array.isArray(typedData.meals)) {
        typedData.meals = typedData.meals.map((meal) => {
          if (meal?.name) {
            meal.name = meal.name.trim();
          }
          if (meal?.timeOfDay) {
            meal.timeOfDay = meal.timeOfDay.trim();
          }
          return meal;
        });
      }

      // Ensure ratios sum to approximately 1
      if (
        typedData.proteinRatio !== undefined &&
        typedData.carbsRatio !== undefined &&
        typedData.fatsRatio !== undefined
      ) {
        const sum = typedData.proteinRatio + typedData.carbsRatio + typedData.fatsRatio;
        if (Math.abs(sum - 1) > 0.01) {
          console.warn(`Macro ratios don't sum to 1: ${sum}`);
        }
      }

      parsedData = typedData;
    }

    return DietPlanSchema.safeParse(parsedData);
  } catch (error) {
    console.error('Error preprocessing diet plan data:', error);
    return DietPlanSchema.safeParse(data);
  }
}

/**
 * Checks if the macronutrient ratios sum to approximately 1 (allowing small floating point errors)
 */
export function validateMacroRatios(dietPlan: DietPlan): boolean {
  const { proteinRatio, carbsRatio, fatsRatio } = dietPlan;
  const sum = proteinRatio + carbsRatio + fatsRatio;
  return Math.abs(sum - 1) < 0.01; // Allow for small floating point errors
}

```

# lib/AI/types/workout-types.ts

```ts
import { z } from 'zod';

// Zod schemas for workout data
export const ExerciseSchema = z.object({
  name: z.string().min(1, 'Exercise name is required'),
  sets: z.number().min(1, 'At least one set is required'),
  reps: z.string().min(1, 'Repetition information is required'),
  description: z.string().min(1, 'Exercise description is required'),
  order: z.number().min(0, 'Order must be non-negative'),
});

export const WorkoutScheduleSchema = z.object({
  dayOfWeek: z.string().min(1, 'Day of week is required'),
  muscleTarget: z.string().min(1, 'Target muscle group is required'),
  duration: z.number().min(10, 'Workout should be at least 10 minutes'),
  calories: z.number().min(1, 'Calorie information is required'),
  exercises: z.array(ExerciseSchema).min(1, 'At least one exercise is required'),
});

export const WorkoutPlanSchema = z.object({
  name: z.string().min(3, 'Plan name must be at least 3 characters'),
  description: z.string().nullable(),
  schedules: z.array(WorkoutScheduleSchema).min(1, 'At least one workout day is required'),
});

// TypeScript types (inferred from Zod schemas)
export type Exercise = z.infer<typeof ExerciseSchema>;
export type WorkoutSchedule = z.infer<typeof WorkoutScheduleSchema>;
export type WorkoutPlan = z.infer<typeof WorkoutPlanSchema>;

/**
 * Validate a workout plan against the schema
 */
export function validateWorkoutPlan(data: unknown) {
  return WorkoutPlanSchema.safeParse(data);
}

```

# lib/AxiosInstance/clientAxios.ts

```ts
'use server';
import { auth } from '@/app/(auth)/auth';
import axios, { type AxiosInstance } from 'axios';

export const ClientReqConfig = async (): Promise<AxiosInstance> => {
  const session = await auth();
  console.log('session from the client axios', session);
  const clientAxios: AxiosInstance = await axios.create({
    baseURL: `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/user/`,
    headers: {
      Authorization: `${JSON.stringify(session)}`,
    },
  });

  return clientAxios;
};

```

# lib/AxiosInstance/ownerAxios.ts

```ts
'use server';
import { auth } from '@/app/(auth)/auth';
import axios, { type AxiosInstance } from 'axios';

export const OwnerReqConfig = async (): Promise<AxiosInstance> => {
  const session = await auth();
  console.log('session from the owner axios', session?.user);
  const ownerAxios: AxiosInstance = await axios.create({
    baseURL: `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/owner`,
    headers: {
      Authorization: `${JSON.stringify(session)}`,
    },
  });

  return ownerAxios;
};

```

# lib/AxiosInstance/salesAxios.ts

```ts
// FILE: salesAxios.ts

'use server';
import { auth } from '@/app/(auth)/auth';
import axios, { type AxiosInstance } from 'axios';

export const SalesReqConfig = async (): Promise<AxiosInstance> => {
  const session = await auth();

  const salesAxios: AxiosInstance = axios.create({
    baseURL: process.env.NEXT_PUBLIC_BACKEND_URL,
    headers: {
      Authorization: `${JSON.stringify(session)}`,
    },
  });
  console.log('salesAxios from the salesAxios file is ', salesAxios);

  return salesAxios;
};

```

# lib/AxiosInstance/Signin/sign-in-axios.ts

```ts
import axios, { type AxiosInstance } from 'axios';

export const SigninReqConfig = async (): Promise<AxiosInstance> => {
  const SigninAxios: AxiosInstance = await axios.create({
    baseURL: `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/login`,
    headers: {
      'Content-Type': 'application/json',
      Accept: 'application/json',
    },
    timeout: 10000, // 10 second timeout
  });

  // Enhanced response interceptor with better error handling
  SigninAxios.interceptors.response.use(
    (response) => response,
    (error) => {
      console.error('API request failed:', error);

      // Preserve original axios error structure for status code checks
      if (error.response?.status === 404) {
        // Keep original structure for 404s so the status check works
        return Promise.reject(error);
      }

      // Format other errors with consistent structure
      const errorResponse = error.response?.data;
      const formattedError = {
        success: false,
        error: {
          code: errorResponse?.error || 'SERVER_ERROR',
          message: errorResponse?.message || error.message || 'Unknown error occurred',
        },
      };

      return Promise.reject(formattedError);
    },
  );

  return SigninAxios;
};

```

# lib/AxiosInstance/Signin/sign-in-client.ts

```ts
import { SigninReqConfig } from './sign-in-axios';

// Define the standard API response format from backend
export interface ApiResponse<T = unknown> {
  success: boolean;
  message: string;
  data?: T;
  error?: string;
}

// Define the standardized result format for frontend
export interface ApiResult<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
  };
}

// Define auth-specific types
export type Rolestype = 'owner' | 'trainer' | 'client';

export interface SigninResponseType {
  token: string;
  user: {
    id: string;
    name: string;
    email: string;
    role: Rolestype;
    gym_id?: string | null;
    gym?: {
      id: number;
      name: string;
    } | null;
  };
}

// Update the UserInfoResponse type to include the exists flag
export interface UserInfoResponse {
  exists: boolean;
  role?: Rolestype;
}

// Update interfaces to handle the exists flag
export interface GoogleAuthResponse extends SigninResponseType {
  exists: boolean;
}

/**
 * Authentication API client with typed methods for all login-related operations
 */
export const authClient = {
  /**
   * Sign in with email and password
   */
  signInWithCredentials: async (
    email: string,
    password: string,
  ): Promise<ApiResult<SigninResponseType>> => {
    try {
      const axiosInstance = await SigninReqConfig();
      const response = await axiosInstance.get('/login', {
        params: { email, password },
      });

      const apiResponse = response.data as ApiResponse<SigninResponseType>;

      if (!apiResponse.success) {
        return {
          success: false,
          error: {
            code: apiResponse.error || 'UNKNOWN_ERROR',
            message: apiResponse.message || 'Unknown error occurred',
          },
        };
      }

      return {
        success: true,
        data: apiResponse.data,
      };
    } catch (error: unknown) {
      // The error is already formatted by the axios interceptor
      return error as ApiResult<never>;
    }
  },

  /**
   * Sign in with Google
   */
  signInWithGoogle: async (email: string): Promise<ApiResult<GoogleAuthResponse>> => {
    try {
      const axiosInstance = await SigninReqConfig();
      const response = await axiosInstance.get('/google', {
        params: { email },
      });

      const apiResponse = response.data as ApiResponse<GoogleAuthResponse | { exists: boolean }>;

      // Handle user doesn't exist case
      if (
        apiResponse.success &&
        apiResponse.data &&
        'exists' in apiResponse.data &&
        !apiResponse.data.exists
      ) {
        return {
          success: true,
          data: {
            exists: false,
            token: '',
            user: {
              id: '',
              name: '',
              email: '',
              role: 'client',
            },
          } as GoogleAuthResponse,
        };
      }

      // Handle normal success case
      if (apiResponse.success) {
        return {
          success: true,
          data: apiResponse.data as GoogleAuthResponse,
        };
      }

      // Handle error case
      return {
        success: false,
        error: {
          code: apiResponse.error || 'UNKNOWN_ERROR',
          message: apiResponse.message || 'Unknown error occurred',
        },
      };
    } catch (error: unknown) {
      // Handle network errors or other unexpected issues
      if (error && typeof error === 'object') {
        return {
          success: false,
          error: {
            code: 'REQUEST_FAILED',
            message: 'Failed to authenticate with Google',
          },
        };
      }

      return error as ApiResult<never>;
    }
  },

  /**
   * Get user information by email
   */
  getUserInfo: async (email: string): Promise<ApiResult<UserInfoResponse>> => {
    try {
      const axiosInstance = await SigninReqConfig();
      const response = await axiosInstance.get('/getuserinfo', {
        params: { email },
      });

      const apiResponse = response.data as ApiResponse<UserInfoResponse>;

      if (!apiResponse.success) {
        return {
          success: false,
          error: {
            code: apiResponse.error || 'UNKNOWN_ERROR',
            message: apiResponse.message || 'Unknown error occurred',
          },
        };
      }

      return {
        success: true,
        data: apiResponse.data,
      };
    } catch (error: unknown) {
      // Handle network errors or other unexpected issues
      if (error && typeof error === 'object') {
        return {
          success: false,
          error: {
            code: 'REQUEST_FAILED',
            message: 'Failed to check user existence',
          },
        };
      }

      return {
        success: false,
        error: {
          code: 'UNKNOWN_ERROR',
          message: 'An unknown error occurred',
        },
      };
    }
  },
};

```

# lib/AxiosInstance/Signup/sign-up-axios.ts

```ts
import axios, { type AxiosInstance } from 'axios';

/**
 * Axios instance for unauthenticated requests related to signup/registration
 *
 * Available endpoints:
 * - POST /createaccount - Create a new user (owner, trainer, client, sales)
 * - POST /isexists - Check if a user exists by email
 * - POST /google/:role - Google signup with specific role
 *
 * @returns Configured AxiosInstance
 */
export const SignupReqConfig = async (): Promise<AxiosInstance> => {
  const SignupAxios: AxiosInstance = await axios.create({
    baseURL: `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/signup`,
    headers: {
      'Content-Type': 'application/json',
      Accept: 'application/json',
    },
    timeout: 10000, // 10 second timeout
  });

  // Enhanced response interceptor with better error handling
  SignupAxios.interceptors.response.use(
    (response) => response,
    (error) => {
      console.error('API request failed:', error);

      // Format the error with consistent structure
      const errorResponse = error.response?.data;
      const formattedError = {
        success: false,
        error: {
          code: errorResponse?.error || 'SERVER_ERROR',
          message: errorResponse?.message || error.message || 'Unknown error occurred',
        },
      };

      return Promise.reject(formattedError);
    },
  );

  return SignupAxios;
};

```

# lib/AxiosInstance/Signup/sign-up-client.ts

```ts
import { SignupReqConfig } from './sign-up-axios';

// Define the standard API response format from backend
export interface ApiResponse<T = unknown> {
  success: boolean;
  message: string;
  data?: T;
  error?: string;
}

// Define the standardized result format for frontend
export interface ApiResult<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
  };
}

// Define signup-specific types
export type RoleType = 'owner' | 'trainer' | 'client' | 'sales';

export interface SignupResponseType {
  id: string;
  name: string;
  email: string;
  role: string;
}

export interface GoogleSignupResponseType {
  name: string;
  email: string;
  role: RoleType;
}

/**
 * Signup API client with typed methods for all registration-related operations
 */
export const signupClient = {
  /**
   * Sign up with email, password and role
   */
  signupWithCredentials: async (
    role: string,
    name: string,
    email: string,
    password: string,
  ): Promise<ApiResult<SignupResponseType>> => {
    try {
      const axiosInstance = await SignupReqConfig();
      const response = await axiosInstance.post('/createaccount', {
        name,
        email,
        password,
        role: role.toLowerCase(),
      });

      const apiResponse = response.data as ApiResponse<SignupResponseType>;

      if (!apiResponse.success) {
        return {
          success: false,
          error: {
            code: apiResponse.error || 'UNKNOWN_ERROR',
            message: apiResponse.message || 'Unknown error occurred',
          },
        };
      }

      // Extract the user data from the API response wrapper
      const userData = apiResponse.data;

      if (!userData) {
        return {
          success: false,
          error: {
            code: 'NO_DATA',
            message: 'No user data received',
          },
        };
      }

      return {
        success: true,
        data: {
          id: String(userData.id),
          name: userData.name,
          email: userData.email,
          role: role.toLowerCase(),
        },
      };
    } catch (error: unknown) {
      // The error is already formatted by the axios interceptor
      return error as ApiResult<never>;
    }
  },

  /**
   * Sign up with Google
   */
  signupWithGoogle: async (
    name: string,
    email: string,
    role: RoleType,
  ): Promise<ApiResult<GoogleSignupResponseType>> => {
    try {
      const axiosInstance = await SignupReqConfig();
      const response = await axiosInstance.post(`/google/${role}`, {
        name,
        email,
      });

      const apiResponse = response.data;

      // Handle the different response format from the Google signup endpoint
      if (!apiResponse.user) {
        return {
          success: false,
          error: {
            code: 'USER_NOT_CREATED',
            message: apiResponse.msg || 'Failed to create user',
          },
        };
      }

      return {
        success: true,
        data: apiResponse.user,
      };
    } catch (error: unknown) {
      // The error is already formatted by the axios interceptor
      return error as ApiResult<never>;
    }
  },

  /**
   * Check if user exists
   */
  checkUserExists: async (email: string): Promise<ApiResult<boolean>> => {
    try {
      const axiosInstance = await SignupReqConfig();
      const response = await axiosInstance.post('/isexists', {
        email,
      });

      const apiResponse = response.data;

      // Handle unsuccessful responses properly
      if (!apiResponse.success) {
        return {
          success: false,
          error: {
            code: apiResponse.error || 'USER_CHECK_FAILED',
            message: apiResponse.message || 'Failed to check user existence',
          },
        };
      }

      return {
        success: true,
        data: apiResponse.exists,
      };
    } catch (error: unknown) {
      // The error is already formatted by the axios interceptor
      return error as ApiResult<never>;
    }
  },
};

```

# lib/AxiosInstance/trainerAxios.ts

```ts
// FILE: trainerAxios.ts

'use server';
import { auth } from '@/app/(auth)/auth';
import axios, { type AxiosInstance } from 'axios';

export const TrainerReqConfig = async (): Promise<AxiosInstance> => {
  const session = await auth();
  console.log('session information is this trainer axios', session);
  const trainerAxios: AxiosInstance = axios.create({
    baseURL: `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/trainer`,
    headers: {
      Authorization: `${JSON.stringify(session)}`,
    },
  });

  return trainerAxios;
};

```

# lib/getQueryClient.ts

```ts
import { QueryClient } from '@tanstack/react-query';

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      gcTime: 1000 * 60 * 5,
      staleTime: 1000 * 60,
      refetchOnWindowFocus: false,
      refetchOnMount: false,
      refetchOnReconnect: false,
    },
  },
});

```

# lib/hooks/useScrollDirection.ts

```ts
import { useEffect, useState } from 'react';

export function debounce<T extends (...args: never[]) => void>(
  func: T,
  wait: number,
): (...args: Parameters<T>) => void {
  let timeout: NodeJS.Timeout;
  return function executedFunction(...args: Parameters<T>) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

export function useScrollDirection(threshold = 10, delay = 100) {
  const [isVisible, setIsVisible] = useState(true);
  const [lastScrollY, setLastScrollY] = useState(0);

  useEffect(() => {
    if (typeof window === 'undefined') return;

    const scrollContainer = document.querySelector('.scroll-container');
    if (!scrollContainer) return;

    const handleScroll = (e: Event) => {
      const container = e.target as HTMLElement;
      const currentScrollY = container.scrollTop;

      if (currentScrollY < threshold) {
        setIsVisible(true);
        setLastScrollY(currentScrollY);
        return;
      }

      const isScrollingDown = currentScrollY > lastScrollY;

      if (Math.abs(currentScrollY - lastScrollY) > threshold) {
        setIsVisible(!isScrollingDown);
        setLastScrollY(currentScrollY);
      }
    };

    const debouncedHandleScroll = debounce(handleScroll, delay);
    scrollContainer.addEventListener('scroll', debouncedHandleScroll, { passive: true });

    return () => {
      scrollContainer.removeEventListener('scroll', debouncedHandleScroll);
    };
  }, [lastScrollY, threshold, delay]);

  return isVisible;
}

```

# lib/is-client.ts

```ts

```

# lib/is-owner.ts

```ts
import type { Session } from 'next-auth';

export const IsOwner = (session: Session | null) => {
  return session?.role === 'owner';
};

```

# lib/is-trainer.ts

```ts
import type { Session } from 'next-auth';

export const IsTrainer = (session: Session | null) => {
  return session?.role === 'trainer';
};

```

# lib/RecoilContextProvider.tsx

```tsx
'use client';
import React, { type ReactNode } from 'react';
import { RecoilRoot } from 'recoil';

const RecoilContextProvider = ({ children }: { children: ReactNode }) => {
  return <RecoilRoot>{children}</RecoilRoot>;
};
export default RecoilContextProvider;

```

# lib/services/attendance.ts

```ts
import axios from 'axios';

interface AttendanceResponse {
  msg: string;
  users: {
    id: number;
    name: string;
    isPresent: boolean;
    trainerid: number | null;
    attendanceTime: string | null;
  }[];
}

export const getTodaysAttendance = async (): Promise<AttendanceResponse> => {
  const response = await axios.get<AttendanceResponse>(
    `${process.env.NEXT_PUBLIC_BACKEND_URL}/api/v1/owner/protected/todaysattendance`,
    {
      headers: {
        Authorization: `Bearer ${localStorage.getItem('jwt')}`,
      },
    },
  );
  return response.data;
};

```

# lib/utils.ts

```ts
import type { MenuItem } from '@/app/dashboard/_components/menuItems';
import { type ClassValue, clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

export function findActiveMenuItem(menuItems: MenuItem[], pathname: string): MenuItem | undefined {
  return menuItems.find(
    (item) =>
      (item.link && pathname.includes(item.link)) ||
      item.subItems?.some((sub) => pathname.includes(sub.link)),
  );
}

```

# middleware.ts

```ts
import NextAuth from 'next-auth';
import type { Session } from 'next-auth';
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';
import { auth } from './app/(auth)/auth';
import authConfig from './app/(auth)/auth.config';
import { IsOwner } from './lib/is-owner';
import { IsTrainer } from './lib/is-trainer';
/**
 * Public routes that are accessible without authentication
 * @type {string[]}
 */
const publicRoutes: string[] = ['/', '/about', '/contact', '/pricing'];

/**
 * Prefix for all authentication-related API routes
 * @type {string}
 */
const ApiRoutesPrefix: string = '/api/auth';

/**
 * Routes used for authentication purposes (login/signup)
 * @type {string[]}
 */
const AuthRoutes: string[] = ['/signin', '/signup'];

/**
 * Protected routes that require authentication and specific roles
 * @type {string[]}
 */
const ProtectedRoutes: string[] = ['/dashboard', '/settings', '/profile'];

/**
 * Main middleware function to handle authentication and authorization
 */
export default async function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;
  const session = await auth();

  // Check authentication status
  const isLoggedIn = !!session;

  // Check route types
  const isApiRoute = pathname.startsWith(ApiRoutesPrefix);
  const isPublicRoute = publicRoutes.some((route) => pathname === route);
  const isAuthRoute = AuthRoutes.some((route) => pathname === route);
  const isProtectedRoute = ProtectedRoutes.some((route) => pathname.startsWith(route));

  // 1. API Routes - Always pass through
  if (isApiRoute) {
    return NextResponse.next();
  }

  // 2. Authentication Routes (signin/signup)
  if (isAuthRoute) {
    // If user is already logged in, redirect to their role-specific dashboard
    if (isLoggedIn && session?.role) {
      return NextResponse.redirect(
        new URL(`/dashboard/${session.role.toLowerCase()}`, request.url),
      );
    }
    return NextResponse.next();
  }

  // 3. Public Routes - Always accessible
  if (isPublicRoute) {
    return NextResponse.next();
  }

  // 4. Protected Routes - Requires authentication
  if (isProtectedRoute) {
    // Not logged in - redirect to signin
    if (!isLoggedIn || !session) {
      const redirectUrl = new URL('/signin', request.url);
      redirectUrl.searchParams.set('callbackUrl', request.url);
      return NextResponse.redirect(redirectUrl);
    }

    // Role selection required
    if (!session.role) {
      return NextResponse.redirect(new URL('/selectrole', request.url));
    }

    // Trainer needs to select a gym
    if (session.role === 'trainer' && !session.gym) {
      return NextResponse.redirect(new URL('/selectgym', request.url));
    }

    // Role-based access control for specific dashboard paths
    if (pathname.startsWith('/dashboard/owner')) {
      if (!IsOwner(session)) {
        return NextResponse.redirect(new URL('/unauthorized', request.url));
      }
    } else if (pathname.startsWith('/dashboard/trainer')) {
      if (!IsTrainer(session)) {
        return NextResponse.redirect(new URL('/unauthorized', request.url));
      }
    }

    // If accessing general dashboard, redirect to role-specific dashboard
    if (pathname === '/dashboard') {
      return NextResponse.redirect(
        new URL(`/dashboard/${session.role.toLowerCase()}`, request.url),
      );
    }

    return NextResponse.next();
  }

  // 5. Default behavior - allow access to any other routes
  return NextResponse.next();
}

/**
 * Matcher configuration for the middleware
 * Excludes specific paths from middleware processing
 */
export const config = {
  matcher: ['/((?!api|_next/static|_next/image|favicon.ico|.*\\..*).*)'],
};

```

# next-env.d.ts

```ts
/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

```

# next-php.php

```php


```

# next.config.mjs

```mjs
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: false,

  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'res.cloudinary.com',
      },
      {
        protocol: 'https',
        hostname: 'images.unsplash.com',
      },
      {
        protocol: 'https',
        hostname: 'source.unsplash.com',
      },
      {
        protocol: 'https',
        hostname: 'cdn.muscleandstrength.com',
      },
    ],
  },

  async redirects() {
    return [
      {
        source: '/:path*',
        has: [
          {
            type: 'host',
            value: 'gymdominatoradmin.vercel.app',
          },
        ],
        destination: 'https://admin.gymnavigator.in/:path*',
        permanent: true,
      },
    ];
  },

  async headers() {
    return [
      {
        source: '/:path*', // Apply to all routes
        headers: [
          {
            key: 'Host',
            value: 'admin.gymnavigator.in',
          },
          {
            // Prevent iframe embedding
            key: 'X-Frame-Options',
            value: 'DENY',
          },
          {
            // Prevent MIME type sniffing
            key: 'X-Content-Type-Options',
            value: 'nosniff',
          },
          {
            // Force HTTPS
            key: 'Strict-Transport-Security',
            value: 'max-age=31536000; includeSubDomains',
          },
          {
            // Broader CSP for React Three Fiber and 3D components
            key: 'Content-Security-Policy',
            value:
              "default-src 'self'; connect-src 'self' https://cdn.jsdelivr.net https://*.pmnd.rs https://*.githubusercontent.com https://raw.githack.com; img-src 'self' https: data:; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob:; style-src 'self' 'unsafe-inline'; font-src 'self' https://cdn.jsdelivr.net data:; worker-src 'self' blob:; frame-src 'self' https://*.youtube.com https://youtube.com https://*.youtube-nocookie.com;",
          },
          {
            // Prevent XSS attacks
            key: 'X-XSS-Protection',
            value: '1; mode=block',
          },
        ],
      },
    ];
  },

  experimental: {
    serverActions: {
      allowedOrigins: ['localhost:3000', 'admin.gymnavigator.in'],
    },
  },
};

export default nextConfig;

```

# package.json

```json
{
  "name": "gymdominator-admin-2",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "bun run --bun next dev --turbopack",
    "build": "bun run --bun next build",
    "start": "bun run --env-file=.env.production --bun next start",
    "format": "biome format --write .",
    "lint": "biome lint . --write",
    "check": "biome check --write ."
  },
  "dependencies": {
    "@emotion/react": "^11.14.0",
    "@emotion/styled": "^11.14.0",
    "@google/generative-ai": "^0.24.0",
    "@headlessui/react": "^2.2.0",
    "@heroicons/react": "^2.2.0",
    "@hookform/resolvers": "^3.10.0",
    "@mui/material": "^6.4.5",
    "@next/bundle-analyzer": "^15.2.2",
    "@next/font": "^14.2.15",
    "@radix-ui/react-accordion": "^1.2.3",
    "@radix-ui/react-avatar": "^1.1.3",
    "@radix-ui/react-checkbox": "^1.1.4",
    "@radix-ui/react-dialog": "^1.1.6",
    "@radix-ui/react-dropdown-menu": "^2.1.6",
    "@radix-ui/react-label": "^2.1.2",
    "@radix-ui/react-popover": "^1.1.6",
    "@radix-ui/react-radio-group": "^1.2.3",
    "@radix-ui/react-scroll-area": "^1.2.3",
    "@radix-ui/react-select": "^2.1.6",
    "@radix-ui/react-separator": "^1.1.2",
    "@radix-ui/react-slider": "^1.2.3",
    "@radix-ui/react-slot": "^1.1.2",
    "@radix-ui/react-tabs": "^1.1.3",
    "@radix-ui/react-toast": "^1.2.6",
    "@radix-ui/react-tooltip": "^1.1.8",
    "@react-navigation/bottom-tabs": "^7.2.0",
    "@react-spring/web": "^9.7.5",
    "@react-three/drei": "^10.0.5",
    "@react-three/fiber": "^9.1.0",
    "@react-three/postprocessing": "^3.0.4",
    "@tanstack/query-persist-client-core": "^5.67.2",
    "@tanstack/react-query": "^5.67.1",
    "@tanstack/react-query-devtools": "^5.67.1",
    "@tanstack/react-query-next-experimental": "^5.66.0",
    "@tanstack/react-table": "^8.20.6",
    "@types/chart.js": "^2.9.41",
    "@types/react-beautiful-dnd": "^13.1.8",
    "@types/uuid": "^10.0.0",
    "ai": "^4.1.61",
    "axios": "^1.7.7",
    "bcrypt": "^5.1.1",
    "bcryptjs": "^2.4.3",
    "chart.js": "^4.4.7",
    "class-variance-authority": "^0.7.0",
    "cloudinary": "^2.5.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.0.0",
    "cookie": "^1.0.1",
    "date-fns": "^3.6.0",
    "framer-motion": "^11.18.2",
    "html5-qrcode": "2.2.7",
    "idb-keyval": "^6.2.1",
    "jsonwebtoken": "^9.0.2",
    "lucide-react": "^0.447.0",
    "next": "15.2.1",
    "next-auth": "^5.0.0-beta.25",
    "next-cloudinary": "^6.16.0",
    "openai": "^4.87.3",
    "qrcode.react": "^4.0.1",
    "react": "19.0.0",
    "react-beautiful-dnd": "^13.1.1",
    "react-chartjs-2": "^5.3.0",
    "react-day-picker": "^8.10.1",
    "react-dom": "19.0.0",
    "react-headroom": "^3.2.1",
    "react-hook-form": "^7.54.2",
    "react-hot-toast": "^2.4.1",
    "react-icons": "^5.3.0",
    "react-pin-input": "^1.3.1",
    "react-qr-code": "^2.0.15",
    "react-tsparticles": "^2.12.2",
    "recoil": "^0.7.7",
    "resend": "^4.0.1",
    "server-only": "^0.0.1",
    "sharp": "^0.33.5",
    "sonner": "^1.7.0",
    "sweetalert2": "^11.14.5",
    "tailwind-merge": "^2.6.0",
    "tailwindcss-animate": "^1.0.7",
    "uuid": "^11.0.3",
    "zod": "^3.24.2",
    "zustand": "^5.0.3"
  },
  "devDependencies": {
    "@biomejs/biome": "^1.9.4",
    "@tailwindcss/forms": "^0.5.10",
    "@types/bcrypt": "^5.0.2",
    "@types/bcryptjs": "^2.4.6",
    "@types/node": "^20",
    "@types/react": "19.0.10",
    "@types/react-dom": "19.0.4",
    "@types/react-headroom": "^3.2.3",
    "autoprefixer": "^10.4.20",
    "postcss": "^8.5.2",
    "tailwindcss": "^3.4.17",
    "typescript": "^5"
  },
  "overrides": {
    "@types/react": "19.0.10",
    "@types/react-dom": "19.0.4"
  }
}

```

# postcss.config.mjs

```mjs
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

export default config;

```

# public/android-chrome-192x192.png

This is a binary file of the type: Image

# public/android-chrome-512x512.png

This is a binary file of the type: Image

# public/apple-touch-icon.png

This is a binary file of the type: Image

# public/favicon-16x16.png

This is a binary file of the type: Image

# public/favicon-32x32.png

This is a binary file of the type: Image

# public/favicon.ico

This is a binary file of the type: Binary

# public/gymnavigator-og.jpg

This is a binary file of the type: Image

# public/manifest.json

```json
{
  "name": "GymNavigator Client",
  "short_name": "GymNav",
  "description": "Your personal gym companion",
  "start_url": "/dashboard/client",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#000000",
  "icons": [
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}

```

# public/site.webmanifest

```webmanifest
{
  "name": "",
  "short_name": "",
  "icons": [
    {
      "src": "/android-chrome-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/android-chrome-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  "theme_color": "#ffffff",
  "background_color": "#ffffff",
  "display": "standalone"
}

```

# styles/theme.ts

```ts
export const gymTheme = {
  colors: {
    primary: {
      50: '#e6f1ff',
      100: '#c2dcff',
      200: '#99c3ff',
      300: '#66a9ff',
      400: '#3390ff',
      500: '#0077ff',
      600: '#0062d6',
      700: '#004eac',
      800: '#003a83',
      900: '#002659',
    },
    gradients: {
      primaryBlue: 'from-blue-400 via-blue-500 to-blue-600',
      heroBackground: 'from-blue-900 via-black to-gray-950',
      greenCard: 'from-green-500 to-green-600',
      purpleCard: 'from-purple-500 to-purple-600',
      orangeCard: 'from-orange-500 to-orange-600',
      badge: 'from-blue-400 to-purple-500',
    },
    text: {
      primary: 'text-white',
      secondary: 'text-gray-300',
      muted: 'text-gray-400',
      accent: 'text-blue-400',
      gradient:
        'bg-gradient-to-r from-blue-400 via-blue-500 to-blue-600 bg-clip-text text-transparent',
    },
    backgrounds: {
      card: 'bg-white/5',
      cardHover: 'hover:bg-gray-800/50',
      buttonHover: 'hover:bg-white/5',
    },
    borders: {
      light: 'border-white/10',
      accent: 'border-blue-500/20',
      button: 'border-gray-700',
      buttonHover: 'hover:border-blue-500',
    },
  },
  animation: {
    gradient: 'animate-gradient',
    pulse: 'animate-pulse',
  },
  borderRadius: {
    card: 'rounded-xl',
    button: 'rounded-lg',
    badge: 'rounded-full',
  },
};

export type GymTheme = typeof gymTheme;

```

# tailwind.config.ts

```ts
import type { Config } from 'tailwindcss';

const config = {
  darkMode: ['class'],
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
    './src/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        border: 'hsl(var(--border))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        card: {
          DEFAULT: 'hsl(var(--card))',
          foreground: 'hsl(var(--card-foreground))',
        },
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))',
        },
        destructive: {
          DEFAULT: 'hsl(var(--destructive))',
          foreground: 'hsl(var(--destructive-foreground))',
        },
        muted: {
          DEFAULT: 'hsl(var(--muted))',
          foreground: 'hsl(var(--muted-foreground))',
        },
        accent: {
          DEFAULT: 'hsl(var(--accent))',
          foreground: 'hsl(var(--accent-foreground))',
        },
      },
      borderRadius: {
        lg: 'var(--radius)',
        md: 'calc(var(--radius) - 2px)',
        sm: 'calc(var(--radius) - 4px)',
      },
      keyframes: {
        shimmer: {
          '100%': {
            transform: 'translateX(100%)',
          },
        },
        'accordion-down': {
          from: {
            height: '0',
          },
          to: {
            height: 'var(--radix-accordion-content-height)',
          },
        },
        'accordion-up': {
          from: {
            height: 'var(--radix-accordion-content-height)',
          },
          to: {
            height: '0',
          },
        },
      },
      animation: {
        'accordion-down': 'accordion-down 0.2s ease-out',
        'accordion-up': 'accordion-up 0.2s ease-out',
      },
    },
  },
  plugins: [require('@tailwindcss/forms')],
} satisfies Config;

export default config;

```

# tsconfig.json

```json
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    },
    "target": "ES2017"
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    "app/(home)/(pages)/layout.tsx"
  ],
  "exclude": ["node_modules"]
}

```

# types.d.ts

```ts
type gender = 'Male' | 'Female';

type Rolestype = 'owner' | 'trainer' | 'sales';
type GenderType = 'Male' | 'Female';

interface GymInfo {
  id: number;
  gym_name: string;
}

interface UserHealthProfileType {
  id: number;
  fullname: string;
  gender: GenderType;
  goal: string;
  contact: string;
  weight: number;
  height: number;
  address: string;
  userid: number;
}

interface UserType {
  name: string;
  email: string;
  id: number;
  trainerid?: number | null;
  trainer?: TrainerType;
  HealthProfile: UserHealthProfileType;
}

interface gym {
  id: string;
  name: string;
  img: string;
}

interface mockUsersType {
  id: number;
  name: string;
  gender: gender;
  todaysAttendance: boolean;
}

interface RegisterInput {
  email: string;
  password: string;
  name: string;
  role: Role;
}

interface RegisterResponse {
  msg: string;
  user: {
    name: string;
    email: string;
  } | null;
}

interface UserFromDBType {
  name: string;
  email: string;
  password: string;
}

interface TrainerType {
  id: number;
  name: string;
  assignedClients: number;
  shift: 'Morning' | 'Evening';
  image: string;
}

interface SignupResponse {
  msg: string;
  owner: {
    id: number;
    gym_auth_token: null;
    name: string;
    role: string;
    email: string;
    password: string;
    gym_id: number;
  };
}

interface TrainersResponse {
  msg: string;
  trainers: Trainer[];
}

type GymDetails = {
  name: string;
  logo: string;
  address: string;
  phone: string;
  email: string;
};

interface FormData {
  username: string;
  password: string;
}

interface User {
  name: string;
  HealthProfile: {
    diet: string;
    id: number;
    fullname: string;
    contact: string;
    weight: number;
    height: number;
    address: string;
    userid: number;
  };
}

interface FetchUserType {
  msg: string;
  data: User[];
}

interface User {
  id: number;
  name: string;
  gender: string;
  goal: string;
  assignedTrainer: string | null;
}

interface Trainer {
  id: number;
  name: string;
}

```

# types/credential-management.ts

```ts
/**
 * Type declarations for the Credential Management API
 */

export interface PasswordCredential extends Credential {
  password: string;
}

export interface PasswordCredentialData {
  id: string;
  password: string;
  name?: string;
  iconURL?: string;
}

export interface FederatedCredentialData {
  id: string;
  provider: string;
  name?: string;
  iconURL?: string;
  protocol?: string;
}

export interface CredentialCreationOptions {
  password?: PasswordCredentialData;
  federated?: FederatedCredentialData;
  publicKey?: PublicKeyCredentialCreationOptions;
}

// Augment the global interfaces for the Credential Management API
declare global {
  interface Window {
    PasswordCredential?: {
      new (data: PasswordCredentialData): PasswordCredential;
    };
    FederatedCredential?: {
      new (data: FederatedCredentialData): FederatedCredential;
    };
  }

  interface FederatedCredential extends Credential {
    provider: string;
    protocol?: string;
  }

  interface CredentialsContainer {
    create(options?: CredentialCreationOptions): Promise<Credential | null>;
    get(options?: CredentialRequestOptions): Promise<Credential | null>;
    store(credential: Credential): Promise<Credential>;
    preventSilentAccess(): Promise<void>;
  }
}

```

# types/env.d.ts

```ts

```

# types/toaster.d.ts

```ts
import type { ToasterProps as SonnerToasterProps } from 'sonner';

declare module 'sonner' {
  interface Toast {
    dismiss: () => void;
  }
}

export interface CustomToasterProps extends SonnerToasterProps {
  richColors?: boolean;
  theme?: 'light' | 'dark' | 'system';
  position?:
    | 'top-left'
    | 'top-right'
    | 'bottom-left'
    | 'bottom-right'
    | 'top-center'
    | 'bottom-center';
  closeButton?: boolean;
}

```

